<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Documentation (v 5.23.0)</title>
<style>

/* normalize.css */

button,hr,input{overflow:visible}audio,canvas,progress,video{display:inline-block}progress,sub,sup{vertical-align:baseline}html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0} menu,article,aside,details,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{}button,select{text-transform:none}[type=submit], [type=reset],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:ButtonText dotted 1px}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}[hidden],template{display:none}/*# sourceMappingURL=normalize.min.css.map */

/* tocbot 2.1.4 */

.toc{overflow-y:auto}.toc>ul{overflow:hidden;position:relative}.toc-list{margin:0;padding-left:10px}a.toc-link{color:currentColor;height:100%}.is-collapsible{max-height:1000px;overflow:hidden;transition:all 300ms ease-in-out}.is-collapsed{max-height:0}.is-position-fixed{position:fixed !important;top:0}.is-active-link{font-weight:700}.toc-link::before{background-color:#f9f9fb;content:' ';display:inline-block;height:inherit;left:8px;margin-top:-1px;position:absolute;width:2px}.is-active-link::before{background-color:#54BC4B}


/* Activiti Specific */

body {
  color: #494d55;
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

html, body {
  height: 100%;
  width: 100%;
  background: #f9f9f9;
  font-family: "Helvetica Neue",Helvetica,Roboto,Arial,sans-serif;
  font color: #484848
}

.page-wrapper {
  min-height: 100%;
  /* equal to footer height */
  margin-bottom: -50px;
}

.page-wrapper:after {
  content: "";
  display: block;
  height: 50px;
}

#header {
  position:fixed;
  top:0px;
  z-index:100000;
  width:100%;
}

#header > h1 {
    background: #a0cc47;
    color: #f9f9f9;
    border-bottom: 2px solid #042944;
    padding: 20px 0 20px 20px;
    font-size: 40px;
    font-weight: 800;
    line-height: 1.1;
    margin: 0;
}

#header > h1:before {
  background:url('images/logo.png');
  background-size: 337px 54px; background-repeat: no-repeat;
  width: 337px;
  height: 54px;
  display:inline-block;
  content:'';
  margin-right: 30px;
}

#author {
  margin-left: 25%;
  font-size: 40px;
}

#content {
  margin: 129px 0 0 27%;
  padding: 10px 40px 0 20px;
  padding-right: 40px;
  line-height: 1.7;
  width: 65%;
  overflow-x: auto;
}

h2, h3, h4 {
  color: #00345a;
}

h2 {
  font-size: 26px;
  margin-top: 0;
  margin-bottom: 20px;
  font-weight: bold;
  padding-bottom: 10px;
  border-bottom: 1px solid #d7d7d7;
}

h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 0;
  font-weight: bold;
  padding-bottom: 10px;
  /*border-bottom: 1px solid #d7d7d7;*/
}

.sect1, .sect2 {
  margin-bottom: 20px;
}

.clear
{
  clear: both;
}

.note, .listingblock{
  padding-left: 8px;
  padding-right: 8px;
  margin-bottom: 14px;
  background-color: #f7f7f9;
  border: 1px solid #e1e1e8;
  border-radius: 4px;
  color: #808080;
}

table.tableblock {
  width: 100%;
  max-width: 100%;
  margin-bottom: 20px;
  background-color: transparent;
  border-spacing: 0;
  border-collapse: collapse;
  border: 1px solid #ddd;
  table-layout: fixed;
}

table.tableblock>caption+thead>tr:first-child>td, table.tableblock>caption+thead>tr:first-child>th, table.tableblock>colgroup+thead>tr:first-child>td, table.tableblock>colgroup+thead>tr:first-child>th, table.tableblock>thead:first-child>tr:first-child>td, table.tableblock>thead:first-child>tr:first-child>th {
    border-top: 0;
}

table.tableblock > thead > tr > th {
    border-bottom-color: #8bd6d8;
}

table.tableblock>thead>tr>th {
    vertical-align: bottom;
    border-bottom: 1px solid #ddd;
}

table.tableblock>tbody>tr>td, table.tableblock>tbody>tr>th, table.tableblock>tfoot>tr>td, table.tableblock>tfoot>tr>th, table.tableblock>thead>tr>td, table.tableblock>thead>tr>th {
    padding: 8px;
    line-height: 1.42857143;
    vertical-align: top;
    border-top: 1px solid #ddd;
}

th {
    text-align: left;
}

table.tableblock > tbody > tr:nth-of-type(odd) {
    background-color: #f5f5f5;
}

table.tableblock > tbody > tr:nth-of-type(odd) {
    background-color: #f9f9f9;
}

td > p {
  margin:0;
}

td.content {
  white-space: normal;
}

pre, td, th {
   white-space: pre-wrap;
   white-space: -moz-pre-wrap;
   white-space: -pre-wrap;
   white-space: -o-pre-wrap;
   word-wrap: break-word;
}

img {
  max-width: 100%;
}

a {
  color: #007387;
}

a:hover {
  color: #004c59;
}

#toc-parent {
  width: 25%;
  float: left;
  height: 100%;
  overflow-y: auto;
  position: fixed;
  padding: 10px;
  border-right: 1px solid #ccc;
}

#generated-toc {
    width: 100%;
    height: 100%;
    font-size: 16px;
}

.toc-link {
  text-decoration: none;
}

.toc-list {
  margin: 0 20px 0 10px;
}

.toc-list-item {
  padding: 4px 0 4px 0;
}

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #f8f8f8; }
.listingblock .pygments .tok-c { color: #408080; font-style: italic } /* Comment */
.listingblock .pygments .tok-err { border: 1px solid #FF0000 } /* Error */
.listingblock .pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
.listingblock .pygments .tok-o { color: #666666 } /* Operator */
.listingblock .pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
.listingblock .pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
.listingblock .pygments .tok-ge { font-style: italic } /* Generic.Emph */
.listingblock .pygments .tok-gr { color: #FF0000 } /* Generic.Error */
.listingblock .pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
.listingblock .pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
.listingblock .pygments .tok-go { color: #888888 } /* Generic.Output */
.listingblock .pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.listingblock .pygments .tok-gs { font-weight: bold } /* Generic.Strong */
.listingblock .pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.listingblock .pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
.listingblock .pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #B00040 } /* Keyword.Type */
.listingblock .pygments .tok-m { color: #666666 } /* Literal.Number */
.listingblock .pygments .tok-s { color: #BA2121 } /* Literal.String */
.listingblock .pygments .tok-na { color: #7D9029 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #008000 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
.listingblock .pygments .tok-no { color: #880000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #0000FF } /* Name.Function */
.listingblock .pygments .tok-nl { color: #A0A000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.listingblock .pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #19177C } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.listingblock .pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
.listingblock .pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #008000 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
<script type="text/javascript">

/*
 * Tocbot.min.js version 2.1.4
 */

 !function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([/*!*************************!*\
   !*** ./src/js/index.js ***!
   \*************************/
 function(e,t,n){var o,i,r;(function(l){!function(n,l){i=[],o=l(n),r="function"==typeof o?o.apply(t,i):o,!(void 0!==r&&(e.exports=r))}("undefined"!=typeof l?l:this.window||this.global,function(e){"use strict";function t(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)h.call(n,o)&&(e[o]=n[o])}return e}function o(e,t,n){t||(t=250);var o,i;return function(){var r=n||this,l=+new Date,s=arguments;o&&l<o+t?(clearTimeout(i),i=setTimeout(function(){o=l,e.apply(r,s)},t)):(o=l,e.apply(r,s))}}var i,r,l,s=n(/*! smooth-scroll */1),c=n(/*! ./default-options.js */2),a={},u={},d=n(/*! ./build-html.js */3),f=n(/*! ./parse-content.js */4),m=(e.document,document.body,!!e.document.querySelector&&!!e.addEventListener),h=Object.prototype.hasOwnProperty;return u.destroy=function(){try{document.querySelector(a.tocSelector).innerHTML=""}catch(e){console.warn("Element not found: "+a.tocSelector)}document.removeEventListener("scroll",this._scrollListener,!1),document.removeEventListener("resize",this._scrollListener,!1),i&&document.removeEventListener("click",this._clickListener,!1),s&&s.destroy()},u.init=function(e){if(m&&(a=t(c,e||{}),this.options=a,this.state={},i=d(a),r=f(a),this._buildHtml=i,this._parseContent=r,u.destroy(),l=r.selectHeadings(a.contentSelector,a.headingSelector),null!==l)){var n=r.nestHeadingsArray(l),h=n.nest;return i.render(a.tocSelector,h),this._scrollListener=o(function(){i.updateToc(l)},a.throttleTimeout),this._scrollListener(),document.addEventListener("scroll",this._scrollListener,!1),document.addEventListener("resize",this._scrollListener,!1),this._clickListener=o(function(e){i.disableTocAnimation(e),i.updateToc(l)},a.throttleTimeout),document.addEventListener("click",this._clickListener,!1),s&&(this.smoothScroll=s.init(t(a.smoothScrollOptions,{callback:i.enableTocAnimation}))),this}},u.refresh=function(e){u.destroy(),u.init(e||this.options)},e.tocbot=u,u})}).call(t,function(){return this}())},/*!******************************************************!*\
   !*** ./~/smooth-scroll/dist/js/smooth-scroll.min.js ***!
   \******************************************************/
 function(e,t,n){var o,i,r;(function(n){/*! smooth-scroll v10.0.1 | (c) 2016 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/smooth-scroll */
 !function(n,l){i=[],o=l(n),r="function"==typeof o?o.apply(t,i):o,!(void 0!==r&&(e.exports=r))}("undefined"!=typeof n?n:this.window||this.global,function(e){"use strict";var t,n,o,i,r,l,s,c={},a="querySelector"in document&&"addEventListener"in e,u={selector:"[data-scroll]",selectorHeader:null,speed:500,easing:"easeInOutCubic",offset:0,callback:function(){}},d=function(){var e={},t=!1,n=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n++);for(var i=function(n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t&&"[object Object]"===Object.prototype.toString.call(n[o])?e[o]=d(!0,e[o],n[o]):e[o]=n[o])};o>n;n++){var r=arguments[n];i(r)}return e},f=function(e){return Math.max(e.scrollHeight,e.offsetHeight,e.clientHeight)},m=function(e,t){var n,o,i=t.charAt(0),r="classList"in document.documentElement;for("["===i&&(t=t.substr(1,t.length-2),n=t.split("="),n.length>1&&(o=!0,n[1]=n[1].replace(/"/g,"").replace(/'/g,"")));e&&e!==document&&1===e.nodeType;e=e.parentNode){if("."===i)if(r){if(e.classList.contains(t.substr(1)))return e}else if(new RegExp("(^|\\s)"+t.substr(1)+"(\\s|$)").test(e.className))return e;if("#"===i&&e.id===t.substr(1))return e;if("["===i&&e.hasAttribute(n[0])){if(!o)return e;if(e.getAttribute(n[0])===n[1])return e}if(e.tagName.toLowerCase()===t)return e}return null},h=function(e){"#"===e.charAt(0)&&(e=e.substr(1));for(var t,n=String(e),o=n.length,i=-1,r="",l=n.charCodeAt(0);++i<o;){if(t=n.charCodeAt(i),0===t)throw new InvalidCharacterError("Invalid character: the input contains U+0000.");r+=t>=1&&31>=t||127==t||0===i&&t>=48&&57>=t||1===i&&t>=48&&57>=t&&45===l?"\\"+t.toString(16)+" ":t>=128||45===t||95===t||t>=48&&57>=t||t>=65&&90>=t||t>=97&&122>=t?n.charAt(i):"\\"+n.charAt(i)}return"#"+r},p=function(e,t){var n;return"easeInQuad"===e&&(n=t*t),"easeOutQuad"===e&&(n=t*(2-t)),"easeInOutQuad"===e&&(n=.5>t?2*t*t:-1+(4-2*t)*t),"easeInCubic"===e&&(n=t*t*t),"easeOutCubic"===e&&(n=--t*t*t+1),"easeInOutCubic"===e&&(n=.5>t?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1),"easeInQuart"===e&&(n=t*t*t*t),"easeOutQuart"===e&&(n=1- --t*t*t*t),"easeInOutQuart"===e&&(n=.5>t?8*t*t*t*t:1-8*--t*t*t*t),"easeInQuint"===e&&(n=t*t*t*t*t),"easeOutQuint"===e&&(n=1+--t*t*t*t*t),"easeInOutQuint"===e&&(n=.5>t?16*t*t*t*t*t:1+16*--t*t*t*t*t),n||t},v=function(e,t,n){var o=0;if(e.offsetParent)do o+=e.offsetTop,e=e.offsetParent;while(e);return o=Math.max(o-t-n,0),Math.min(o,b()-g())},g=function(){return Math.max(document.documentElement.clientHeight,e.innerHeight||0)},b=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},C=function(e){return e&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(e):{}},S=function(e){return e?f(e)+e.offsetTop:0},y=function(t,n,o){o||(t.focus(),document.activeElement.id!==t.id&&(t.setAttribute("tabindex","-1"),t.focus(),t.style.outline="none"),e.scrollTo(0,n))};c.animateScroll=function(n,o,l){var c=C(o?o.getAttribute("data-options"):null),a=d(t||u,l||{},c),f="[object Number]"===Object.prototype.toString.call(n),m=f||!n.tagName?null:n;if(f||m){var h=e.pageYOffset;a.selectorHeader&&!i&&(i=document.querySelector(a.selectorHeader)),r||(r=S(i));var g,x,N=f?n:v(m,r,parseInt(a.offset,10)),L=N-h,O=b(),E=0,A=function(t,i,r){var l=e.pageYOffset;(t==i||l==i||e.innerHeight+l>=O)&&(clearInterval(r),y(n,i,f),a.callback(n,o))},H=function(){E+=16,g=E/parseInt(a.speed,10),g=g>1?1:g,x=h+L*p(a.easing,g),e.scrollTo(0,Math.floor(x)),A(x,N,s)},T=function(){clearInterval(s),s=setInterval(H,16)};0===e.pageYOffset&&e.scrollTo(0,0),T()}};var x=function(t){e.location.hash,n&&(n.id=n.getAttribute("data-scroll-id"),c.animateScroll(n,o),n=null,o=null)},N=function(i){if(0===i.button&&!i.metaKey&&!i.ctrlKey&&(o=m(i.target,t.selector),o&&"a"===o.tagName.toLowerCase()&&o.hostname===e.location.hostname&&o.pathname===e.location.pathname&&/#/.test(o.href))){var r=h(o.hash);if("#"===r){i.preventDefault(),n=document.body;var l=n.id?n.id:"smooth-scroll-top";return n.setAttribute("data-scroll-id",l),n.id="",void(e.location.hash.substring(1)===l?x():e.location.hash=l)}n=document.querySelector(r),n&&(n.setAttribute("data-scroll-id",n.id),n.id="",o.hash===e.location.hash&&(i.preventDefault(),x()))}},L=function(e){l||(l=setTimeout(function(){l=null,r=S(i)},66))};return c.destroy=function(){t&&(document.removeEventListener("click",N,!1),e.removeEventListener("resize",L,!1),t=null,n=null,o=null,i=null,r=null,l=null,s=null)},c.init=function(n){a&&(c.destroy(),t=d(u,n||{}),i=t.selectorHeader?document.querySelector(t.selectorHeader):null,r=S(i),document.addEventListener("click",N,!1),e.addEventListener("hashchange",x,!1),i&&e.addEventListener("resize",L,!1))},c})}).call(t,function(){return this}())},/*!***********************************!*\
   !*** ./src/js/default-options.js ***!
   \***********************************/
 function(e,t){e.exports={tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h1, h2, h3",ignoreSelector:".js-toc-ignore",linkClass:"toc-link",extraLinkClasses:"",activeLinkClass:"is-active-link",listClass:"toc-list",extraListClasses:"",isCollapsedClass:"is-collapsed",collapsibleClass:"is-collapsible",listItemClass:"toc-list-item",collapseDepth:0,smoothScrollOptions:{easing:"easeInOutCubic",offset:0,speed:300,updateURL:!0},headingsOffset:0,throttleTimeout:50,positionFixedSelector:null,positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto",includeHtml:!1}},/*!******************************!*\
   !*** ./src/js/build-html.js ***!
   \******************************/
 function(e,t){e.exports=function(e){function t(e,n){var r=n.appendChild(o(e));if(e.children.length){var l=i(e.isCollapsed);e.children.forEach(function(e){t(e,l)}),r.appendChild(l)}}function n(e,n){var o=!1,r=i(o);n.forEach(function(e){t(e,r)});var l=document.querySelector(e);if(null!==l)return l.firstChild&&l.removeChild(l.firstChild),l.appendChild(r)}function o(t){var n=document.createElement("li"),o=document.createElement("a");return e.listItemClass&&n.setAttribute("class",e.listItemClass),e.includeHtml&&t.childNodes.length?u.call(t.childNodes,function(e){o.appendChild(e.cloneNode(!0))}):o.textContent=t.textContent,o.setAttribute("data-scroll",""),o.setAttribute("href","#"+t.id),o.setAttribute("class",e.linkClass+h+"node-name--"+t.nodeName+h+e.extraLinkClasses),n.appendChild(o),n}function i(t){var n=document.createElement("ul"),o=e.listClass+h+e.extraListClasses;return t&&(o+=h+e.collapsibleClass,o+=h+e.isCollapsedClass),n.setAttribute("class",o),n}function r(){var t=document.documentElement.scrollTop||f.scrollTop,n=document.querySelector(e.positionFixedSelector);"auto"===e.fixedSidebarOffset&&(e.fixedSidebarOffset=document.querySelector(e.tocSelector).offsetTop),t>e.fixedSidebarOffset?n.className.indexOf(e.positionFixedClass)===-1&&(n.className+=h+e.positionFixedClass):n.className=n.className.split(h+e.positionFixedClass).join("")}function l(t){var n=document.documentElement.scrollTop||f.scrollTop;e.positionFixedSelector&&r();var o,i=t;if(m&&null!==document.querySelector(e.tocSelector)&&i.length>0){d.call(i,function(t,r){if(t.offsetTop>n+e.headingsOffset){var l=0===r?r:r-1;return o=i[l],!0}if(r===i.length-1)return o=i[i.length-1],!0});var l=document.querySelector(e.tocSelector).querySelectorAll("."+e.linkClass);u.call(l,function(t){t.className=t.className.split(h+e.activeLinkClass).join("")});var c=document.querySelector(e.tocSelector).querySelector("."+e.linkClass+".node-name--"+o.nodeName+'[href="#'+o.id+'"]');c.className+=h+e.activeLinkClass;var a=document.querySelector(e.tocSelector).querySelectorAll("."+e.listClass+"."+e.collapsibleClass);u.call(a,function(t){var n=h+e.isCollapsedClass;t.className.indexOf(n)===-1&&(t.className+=h+e.isCollapsedClass)}),c.nextSibling&&(c.nextSibling.className=c.nextSibling.className.split(h+e.isCollapsedClass).join("")),s(c.parentNode.parentNode)}}function s(t){return t.className.indexOf(e.collapsibleClass)!==-1?(t.className=t.className.split(h+e.isCollapsedClass).join(""),s(t.parentNode.parentNode)):t}function c(t){var n=t.target||t.srcElement;n.className.indexOf(e.linkClass)!==-1&&(m=!1)}function a(){m=!0}var u=[].forEach,d=[].some,f=document.body,m=!0,h=" ";return{enableTocAnimation:a,disableTocAnimation:c,render:n,updateToc:l}}},/*!*********************************!*\
   !*** ./src/js/parse-content.js ***!
   \*********************************/
 function(e,t){e.exports=function(e){function t(e){return e[e.length-1]}function n(e){return+e.nodeName.split("H").join("")}function o(t){var o={id:t.id,children:[],nodeName:t.nodeName,headingLevel:n(t),textContent:t.textContent.trim()};return e.includeHtml&&(o.childNodes=t.childNodes),o}function i(i,r){for(var l=o(i),s=n(i),c=r,a=t(c),u=a?a.headingLevel:0,d=s-u;d>0;)a=t(c),a&&void 0!==a.children&&(c=a.children),d--;return s>=e.collapseDepth&&(l.isCollapsed=!0),c.push(l),c}function r(t,n){var o=n;e.ignoreSelector&&(o=n.split(",").map(function(t){return t.trim()+":not("+e.ignoreSelector+")"}));try{return document.querySelector(t).querySelectorAll(o)}catch(i){return console.warn("Element not found: "+t),null}}function l(e){return s.call(e,function(e,t){var n=o(t);return i(n,e.nest),e},{nest:[]})}var s=[].reduce;return{nestHeadingsArray:l,selectHeadings:r}}}]);
 //# sourceMappingURL=tocbot.min.js.map

</script>

<script type="text/javascript">

  var generateToc = function() {
    var readyState = document.readyState;
    if (readyState === 'interactive' || readyState == 'complete') {

      var headerSize = 140;

      var tocParentNode = document.createElement("div");
      tocParentNode.setAttribute("id", "toc-parent");

      var generatedTocNode = document.createElement("div");
      generatedTocNode.setAttribute("id", "generated-toc");
      tocParentNode.appendChild(generatedTocNode);

      var contentNode = document.getElementById("content");
      contentNode.parentNode.insertBefore(tocParentNode, contentNode);

      var clearNode = document.createElement("div");
      clearNode.setAttribute("class", "clear");
      contentNode.parentNode.appendChild(clearNode);

      tocbot.init({
        tocSelector: '#generated-toc',
        contentSelector: '#content',
        headingSelector: 'h2, h3, h4',
        headingsOffset: headerSize,
        smoothScrollOptions: {
          easing: 'easeInOutCubic',
          offset: headerSize,
          speed: 300, // animation duration.
          updateURL: true
        },
        collapseDepth: 0
      });

    } else {
      window.setTimeout(function(){
        generateToc();
      }, 50);
    }

  }
  generateToc();

</script>
</head>
<body class="book">
<div id="header">
<h1>Documentation (v 5.23.0)</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="license">1.1. License</h3>
<div class="paragraph">
<p>Flowable is distributed under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">the Apache V2 license</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="download">1.2. Download</h3>
<div class="paragraph">
<p><a href="http://www.flowable.org/downloads.html"><a href="http://flowable.org/downloads.html" class="bare">http://www.flowable.org/downloads.html</a></a></p>
</div>
</div>
<div class="sect2">
<h3 id="sources">1.3. Sources</h3>
<div class="paragraph">
<p>The distribution contains most of the sources as jar files. The source code of Flowable can be found on
  <a href="https://github.com/flowable/flowable-engine"><a href="https://github.com/flowable/flowable-engine" class="bare">https://github.com/flowable/flowable-engine</a></a></p>
</div>
</div>
<div class="sect2">
<h3 id="required.software">1.4. Required software</h3>
<div class="sect3">
<h4 id="_jdk_7">1.4.1. JDK 7+</h4>
<div class="paragraph">
<p>Flowable runs on a JDK higher than or equal to version 7.  Go to <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Oracle Java SE downloads</a> and click on button "Download JDK".  There are installation instructions on that page as well. To verify that your installation was successful, run <code>java -version</code> on the command line.  That should print the installed version of your JDK.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ide">1.4.2. IDE</h4>
<div class="paragraph">
<p>Flowable development can be done with the IDE of your choice. If you would like to use the Flowable Designer then you need Eclipse Kepler or Luna.
Download the eclipse distribution of your choice from <a href="http://www.eclipse.org/downloads/">the Eclipse download page</a>. Unzip the downloaded file and then you should be able to start it with the eclipse file in the directory <code>eclipse</code>.
Further in this user guide, there is a section on <a href="#eclipseDesignerInstallation">installing our eclipse designer plugin</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reporting.problems">1.5. Reporting problems</h3>
<div class="paragraph">
<p>Every self-respecting developer should have read <a href="http://www.catb.org/~esr/faqs/smart-questions.html">How to ask questions the smart way</a>.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve done that you can post questions and comments on <a href="http://forum.flowable.org">the Users forum</a> and create issues in <a href="https://github.com/flowable/flowable-engine/issues">our Github issue tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="experimental">1.6. Experimental features</h3>
<div class="paragraph">
<p>Sections marked with <strong>[EXPERIMENTAL]</strong> should
  not be considered stable.</p>
</div>
<div class="paragraph">
<p>All classes that have <code>.impl.</code> in the package name are internal implementation classes and cannot be considered stable.  However, if the user guide mentions those classes as configuration values, they are supported and can be considered stable.</p>
</div>
</div>
<div class="sect2">
<h3 id="internal">1.7. Internal implementation classes</h3>
<div class="paragraph">
<p>In the jar file, all classes in packages that have <code>.impl.</code> (e.g. <code>org.activiti.engine.impl.db</code>) in them are implementation classes and should be considered internal. No stability guarantees are given on classes or interfaces that are in implementation classes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">2. Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_flowable">2.1. What is Flowable?</h3>
<div class="paragraph">
<p>Flowable is a light-weight business process engine written in Java. The Flowable process engine allows you to deploy BPMN 2.0 process definitions (an industry XML standard for defining processes), creating process instance of those process definitions, running queries, accessing active or historical process instances and related data, plus much more. This section will gradually introduce various concepts and APIs to do that using examples that you can follow on your own development machine.</p>
</div>
<div class="paragraph">
<p>Flowable is extremely flexible when it comes to adding it to your application/services/architecture. You can <em>embed</em> the engine in your application or services by including the Flowable library, which is shipped as a jar. Since it&#8217;s a jar, you can add it easily to any Java environment: Java SE; servlet containers such as Tomcat or Jetty, Spring; Java EE servers like JBoss or Websphere, etc. Alternatively, you can use the Flowable REST API to communicate over HTTP. There is also the Flowable Application, that offers an out-of-the-box UI for working with processes and tasks.</p>
</div>
<div class="paragraph">
<p>Common to all the ways of setting up Flowable is the core engine, which can be seen as a collection of services that expose APIs to manage and execute business processes. The various tutorials below start by introducing how to set up and use this core engine. The sections afterwards build upon the knowledge acquired in the previous sections.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#getting.started.command.line">first section</a> shows how to run Flowable in the simplest way possible: a regular Java main using only Java SE. Many core concepts and API&#8217;s will be explained here.</p>
</li>
<li>
<p>The <a href="#getting.started.rest">section on the Flowable REST API</a> shows how to run and use the same API via REST.</p>
</li>
<li>
<p>The <a href="#getting.started.flowable.app">section on the Flowable App</a>, will guide you through the basics of using the out-of-the-box Flowable user interface.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_flowable_and_activiti">2.2. Flowable and Activiti</h3>
<div class="paragraph">
<p>Flowable is a fork of Activiti (registered trademark by Alfresco). In the all the following sections youâ€™ll notice that the package names, configuration files, etc. use <em>activiti</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="getting.started.command.line">2.3. Building a command-line application</h3>
<div class="sect3">
<h4 id="_creating_a_process_engine">2.3.1. Creating a process engine</h4>
<div class="paragraph">
<p>In this first tutorial we&#8217;re going to build a simple example that shows you how to create a Flowable process engine, introduces some core concepts and shows how to work with the API. The screenshots show Eclipse, but any IDE works. We&#8217;ll use Maven to fetch the Flowable dependencies and manage the build, but likewise any alternative also works (Gradle, Ivy, etc.).</p>
</div>
<div class="paragraph">
<p>The example we&#8217;ll build is a simple <em>holiday request</em> process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <em>employee</em> asks for a number of holidays</p>
</li>
<li>
<p>the <em>manager</em> either approves or rejects the request</p>
</li>
<li>
<p>we&#8217;ll mimic registering the request in some external system and send out an email to the employee with the result</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>First, we create a new Maven project via <em>File &#8594; New &#8594; Other &#8594; Maven Project</em></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.new.maven.png" alt="getting.started.new.maven">
</div>
</div>
<div class="paragraph">
<p>In the next screen, we check <em><em>create a simple project (skip archetype selection)</em></em></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.new.maven2.png" alt="getting.started.new.maven2">
</div>
</div>
<div class="paragraph">
<p>And fill in some <em>'Group Id'</em> and <em>'Artifact id'</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.new.maven3.png" alt="getting.started.new.maven3">
</div>
</div>
<div class="paragraph">
<p>We now have an empty Maven project, to which we&#8217;ll add two dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Flowable process engine, which will allow us to create a ProcessEngine object and access the Flowable API&#8217;s.</p>
</li>
<li>
<p>An in-memory database, H2 in this case, as the Flowable engine needs a database to store execution and historical data while running process instances. Note that the H2 dependency includes both the database <em>and</em> the driver. If you use another database (e.g. PostgresQL, MySQL, etc.), you&#8217;ll need to add the specific database driver dependency.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add the following to your <em>pom.xml</em> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependencies&gt;</span>
  <span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>flowable-engine<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>6.0.0.RC1-SNAPSHOT<span class="tok-nt">&lt;/version&gt;</span>
  <span class="tok-nt">&lt;/dependency&gt;</span>
  <span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>com.h2database<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>h2<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>1.4.192<span class="tok-nt">&lt;/version&gt;</span>
  <span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;/dependencies&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the dependent jars are not automatically retrieved for some reason, you can right-click the project and select <em><em>Maven &#8594; Update Project'</em> to force a manual refresh (but this should not be needed normally). In the project, under '<em>Maven Dependencies</em></em>, you should now see the <em>flowable-engine</em> and various other (transitive) dependencies.</p>
</div>
<div class="paragraph">
<p>Create a new Java class and add a regular Java main method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-kn">package</span> <span class="tok-nn">org.flowable</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">HolidayRequest</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>

  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first thing we need to do is to instantiate a <strong>ProcessEngine</strong> instance. This is a thread-safe object that you typically have to instantiate only once in an application. A <em>ProcessEngine</em> is created from a <strong>ProcessEngineConfiguration</strong> instance, which allows you to configure and tweak the settings for the process engine. Often, the <em>ProcessEngineConfiguration</em> is created using a configuration XML file, but (as we do here) you can also create it programmatically.  The minimum configuration a ProcessEngineConfiguration_ needs is a JDBC connection to a database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-kn">package</span> <span class="tok-nn">org.flowable</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.ProcessEngine</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.ProcessEngineConfiguration</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">HolidayRequest</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">ProcessEngineConfiguration</span> <span class="tok-n">cfg</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">StandaloneProcessEngineConfiguration</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">setJdbcUrl</span><span class="tok-o">(</span><span class="tok-s">&quot;jdbc:h2:mem:flowable;DB_CLOSE_DELAY=-1&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">setJdbcUsername</span><span class="tok-o">(</span><span class="tok-s">&quot;sa&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">setJdbcPassword</span><span class="tok-o">(</span><span class="tok-s">&quot;&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">setJdbcDriver</span><span class="tok-o">(</span><span class="tok-s">&quot;org.h2.Driver&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">setDatabaseSchemaUpdate</span><span class="tok-o">(</span><span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">DB_SCHEMA_UPDATE_TRUE</span><span class="tok-o">);</span>

    <span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">cfg</span><span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the code above, on line 10 a <em>standalone</em> configuration object is created. The <em>'standalone'</em> here refers to the fact that the engine is created and used completely by itself (and not, for example, in a Spring environment, where you&#8217;d use the <em>SpringProcessEngineConfiguration</em> class instead). On lines 11 to 14, the JDBC connection parameters to an in-memory H2 database instance are passed. Note that such a database does not survive a JVM restart. If you want your data to be persistent, you&#8217;ll need to switch to a persistent database and switch the connection parameters accordingly. On line 15 we&#8217;re setting a flag to <em>true</em> to make sure that the database schema is created if it doesn&#8217;t already exist in the database pointed to by the JDBC parameters. Alternatively, Flowable ships with a set of SQL files that can be used to create the database schema with all the tables manually.</p>
</div>
<div class="paragraph">
<p>The <strong>ProcessEngine</strong> object is then created using this configuration (line 17).</p>
</div>
<div class="paragraph">
<p>You can now run this. The easiest in Eclipse is to right-click on the class file and select <em>Run As &#8594; Java Application</em></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.run.main.png" alt="getting.started.run.main">
</div>
</div>
<div class="paragraph">
<p>The application runs without problems, however, no useful information is shown in the console except a message stating that the logging has not been configured properly:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.console.logging.png" alt="getting.started.console.logging">
</div>
</div>
<div class="paragraph">
<p>Flowable uses <a href="http://www.slf4j.org/">SLF4J</a> as its logging framework internally. For this example, we&#8217;ll use the log4j logger over SLF4j. Add the following dependencies to the pom.xml file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.slf4j<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>slf4j-api<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>1.7.21<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.slf4j<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>1.7.21<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j needs a properties file for configuration. Add a <em>log4j.properties</em> file to the <em>src/main/resources</em> folder with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>log4j.rootLogger=DEBUG, CA

log4j.appender.CA=org.apache.log4j.ConsoleAppender
log4j.appender.CA.layout=org.apache.log4j.PatternLayout
log4j.appender.CA.layout.ConversionPattern= %d{hh:mm:ss,SSS} [%t] %-5p %c %x - %m%n</pre>
</div>
</div>
<div class="paragraph">
<p>Rerun the application. You should now see informative logging about the engine booting up and the database schema being created in the database:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.console.logging2.png" alt="getting.started.console.logging2">
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve now got a process engine booted up and ready to go. Time to feed it a process!</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploying_a_process_definition">2.3.2. Deploying a process definition</h4>
<div class="paragraph">
<p>The process we&#8217;ll build is a very simple holiday request process. The Flowable engine expects processes to be defined in the BPMN 2.0 format, which is an XML standard that is widely accepted in the industry. In Flowable terminology, we speak about this as a <strong>process definition</strong>. From a <em>process definition</em> many <strong>process instances</strong> can be started. Think of the <em>process definition</em> as the blueprint for many executions of the process. In this particular case, the <em>process definition</em> defines the different steps involved in requesting holidays, while one <em>process instance</em> matches the request for the holiday for one particular employee.</p>
</div>
<div class="paragraph">
<p>BPMN 2.0 is stored as XML, but it has a visualization part too: it defines in a standard way how each different step type (a human task, an automatic service call, etc.) is represented and how to connect these different steps to each other. This way, the BPMN 2.0 standard allows technical and business people to communicate about business processes in a way that both parties understand.</p>
</div>
<div class="paragraph">
<p>The process definition we&#8217;ll use is the following:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.bpmn.process.png" alt="getting.started.bpmn.process">
</div>
</div>
<div class="paragraph">
<p>The process should be quite self-explanatory, but for clarity&#8217;s sake let&#8217;s describe the different bits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We assume the process is started by providing some information, such as the employee name, the amount of holiday requested and a description. Of course, this could be modeled as a separate first step in the process. But by having it as <em>input data</em> for the process, a process instance is only really created when a real request has been made. In the alternative case, a user could change his mind and cancel before submitting, yet the process instance would be there already. In some scenarios this could be valuable information (e.g. how many times is a request started, but not finished), depending on the business goal.</p>
</li>
<li>
<p>The circle on the left is called a <strong>start event</strong>. It&#8217;s the starting point of a process instance.</p>
</li>
<li>
<p>The first rectangle is a <strong>user task</strong>. This is a step in the process that a human user has to perform. In this case, the manager needs to approve or reject the request.</p>
</li>
<li>
<p>Depending on what the manager decides, the <strong>exclusive gateway</strong> (the diamond shape with the cross) will route the process instance to either the approval or the rejection path.</p>
</li>
<li>
<p>In case of approval, we have to register the request in some external system, which is followed by a user task again for the original employee to notify him/her of the decision. This could of course be replaced by an email.</p>
</li>
<li>
<p>In case of rejection, an email is sent to the employee.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typically, such a <em>process definition</em> is modeled with a visual modeling tool, like the Flowable Designer (Eclipse) or the Flowable Web Modeler.</p>
</div>
<div class="paragraph">
<p>Here, however, we&#8217;re going to write the XML itself to familiarize ourselves with BPMN 2.0 and its concepts.</p>
</div>
<div class="paragraph">
<p>The BPMN 2.0 XML matching the the diagram above is shown below. Note that this is only the <em>process part</em>. If you&#8217;d used a graphical modeling tool, the actual XML file also contains the <em>visualization</em> part that describes the graphical information, like the coordinates of the various elements of the process definition below (all graphical information is contained in the <em>BPMNDiagram</em> tag in the xml, which is a child element of the <em>definitions</em> tag).</p>
</div>
<div class="paragraph">
<p>Save the following xml in a file named <em>holiday-request.bpmn20.xml</em> under the <em>src/main/resources</em> folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;definitions</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
  <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="tok-na">xmlns:xsd=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
  <span class="tok-na">xmlns:bpmndi=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/DI&quot;</span>
  <span class="tok-na">xmlns:omgdc=</span><span class="tok-s">&quot;http://www.omg.org/spec/DD/20100524/DC&quot;</span>
  <span class="tok-na">xmlns:omgdi=</span><span class="tok-s">&quot;http://www.omg.org/spec/DD/20100524/DI&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">typeLanguage=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>
  <span class="tok-na">expressionLanguage=</span><span class="tok-s">&quot;http://www.w3.org/1999/XPath&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;http://www.flowable.org/processdef&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;holidayRequest&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Holiday Request&quot;</span> <span class="tok-na">isExecutable=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;startEvent&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;startEvent&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;approveTask&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;approveTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Approve or reject request&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;approveTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;decision&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;exclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;decision&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;decision&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;externalSystemCall&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">          ${approved}</span>
<span class="tok-cp">        ]]&gt;</span>
      <span class="tok-nt">&lt;/conditionExpression&gt;</span>
    <span class="tok-nt">&lt;/sequenceFlow&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span>  <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;decision&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;sendRejectionMail&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">          ${!approved}</span>
<span class="tok-cp">        ]]&gt;</span>
      <span class="tok-nt">&lt;/conditionExpression&gt;</span>
    <span class="tok-nt">&lt;/sequenceFlow&gt;</span>

    <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;externalSystemCall&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Enter holidays in external system&quot;</span>   <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.flowable.CallExternalSystemDelegate&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;externalSystemCall&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;holidayApprovedTask&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;holidayApprovedTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Holiday approved&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;holidayApprovedTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;approveEnd&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendRejectionMail&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Send out rejection email&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.flowable.SendRejectionMail&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;sendRejectionMail&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;rejectEnd&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;approveEnd&quot;</span><span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;rejectEnd&quot;</span><span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Lines 2 to 11 look a bit daunting, but for all subsequent process definitions it&#8217;ll be the same. It&#8217;s kind of <em>boilerplate</em> stuff that&#8217;s needed to be fully compatible with the BPMN 2.0 standard specification.</p>
</div>
<div class="paragraph">
<p>Every step, or in BPMN 2.0 termninology <strong><em>activity</em></strong> , has an <em>id</em> attribute that gives it a unique identifier in the XML file. All <em>activities</em> can have an optional name too, which increases the readability of the visual diagram of course.</p>
</div>
<div class="paragraph">
<p>The <em>activities</em> are connected with a <strong>sequence flow</strong>, which is a directed arrow in the visual diagram. When executing a process instance, the execution will flow from the <em>start event</em> to the next <em>activity</em>, following the <em>sequence flow</em>.</p>
</div>
<div class="paragraph">
<p>The <em>sequence flows</em> leaving the <em>exclusive gateway</em> (the diamond shape with the X) are clearly special: both have a <em>condition</em> defined in the form of an <em>expression</em> (see line 25 and 32). When the process instance execution reaches this <em>gateway</em>, the <em>conditions</em> are evaluated and the first that resolves to <em>true</em> is taken. This is what the <em>exclusive</em> stands for here (only one is selected), other types of gateways are of course possible if different routing behavior is needed.</p>
</div>
<div class="paragraph">
<p>The condition written here as an <em>expression</em> is of the form <em>${approved}</em>, which is a shorthand for <em>${approved == true}</em>. The variable <em>approved</em> is called a <strong>process variable</strong>. A <em>process variable</em> is a persistent bit of data that is stored together with the process instance and can be used during the lifetime of the process instance. In this case, it does mean that we will have to set this <em>process variable</em> at a certain point (when the manager user task is submitted or, in Flowable terminology, <em>completed</em>) in the process instance, as it&#8217;s not data that is available when the process instance starts.</p>
</div>
<div class="paragraph">
<p>Now we have the process BPMN 2.0 XML file, we next need to <strong><em>deploy</em></strong> it to the engine. <em>Deploying</em> a process definition means that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the process engine will store the XML file in the database, so it can be retrieved when needed later</p>
</li>
<li>
<p>the process definition is parsed to an executable object model internally, so that <em>process instances</em> can be started from it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To <em>deploy</em> a process definition to the Flowable engine, the <em>RepositoryService</em> is used, which can be retrieved from the <em>ProcessEngine</em> objects. Using the <em>RepositoryService</em>, a new <em>Deployment</em> is created by passing the location of the XML file and calling the <em>deploy()</em> method to actually execute it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRepositoryService</span><span class="tok-o">();</span>
<span class="tok-n">Deployment</span> <span class="tok-n">deployment</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;holiday-request.bpmn20.xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now verify that the process definition is known to the engine (and learn a bit about the API) by querying it via the API. This is done by creating a new <em>ProcessDefinitionQuery</em> object via the <em>RepositoryService</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">ProcessDefinition</span> <span class="tok-n">processDefinition</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createProcessDefinitionQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">deploymentId</span><span class="tok-o">(</span><span class="tok-n">deployment</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())</span>
  <span class="tok-o">.</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Found process definition : &quot;</span> <span class="tok-o">+</span> <span class="tok-n">processDefinition</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_starting_a_process_instance">2.3.3. Starting a process instance</h4>
<div class="paragraph">
<p>We now have the process definition <em>deployed</em> to the process engine, so <em>process instances</em> can be started using this <em>process definition</em> as <em>blueprint</em>.</p>
</div>
<div class="paragraph">
<p>To start the process instance, we need to provide some initial <em>process variables</em>. Typically, you&#8217;ll get these via a form that is presented to the user or via a REST API when a process is triggered by something automatic. In this example, we&#8217;ll keep it simple and use the java.util.Scanner class to simply input some data on the command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-n">Scanner</span> <span class="tok-n">scanner</span><span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">Scanner</span><span class="tok-o">(</span><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">in</span><span class="tok-o">);</span>

<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Who are you?&quot;</span><span class="tok-o">);</span>
<span class="tok-n">String</span> <span class="tok-n">employee</span> <span class="tok-o">=</span> <span class="tok-n">scanner</span><span class="tok-o">.</span><span class="tok-na">nextLine</span><span class="tok-o">();</span>

<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;How many holidays do you want to request?&quot;</span><span class="tok-o">);</span>
<span class="tok-n">Integer</span> <span class="tok-n">nrOfHolidays</span> <span class="tok-o">=</span> <span class="tok-n">Integer</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-n">scanner</span><span class="tok-o">.</span><span class="tok-na">nextLine</span><span class="tok-o">());</span>

<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Why do you need them?&quot;</span><span class="tok-o">);</span>
<span class="tok-n">String</span> <span class="tok-n">description</span> <span class="tok-o">=</span> <span class="tok-n">scanner</span><span class="tok-o">.</span><span class="tok-na">nextLine</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, we can start a <em>process instance</em> via the <em>RuntimeService</em>. The collected data is passed as a <em>java.util.Map</em> instance, where the key is the identifier that will be used to retrieve the variables later on. The process instance is started using a <em>key</em>. This <em>key</em> matches the <em>id</em> attribute that is set in the BPMN 2.0 XML file, in this case <em>holidayRequest</em>.</p>
</div>
<div class="paragraph">
<p>(note: there are many ways you&#8217;ll learn later on to start a process instance, beyond using a key)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;holidayRequest&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Holiday Request&quot;</span> <span class="tok-na">isExecutable=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>

<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
<span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;employee&quot;</span><span class="tok-o">,</span> <span class="tok-n">employee</span><span class="tok-o">);</span>
<span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;nrOfHolidays&quot;</span><span class="tok-o">,</span> <span class="tok-n">nrOfHolidays</span><span class="tok-o">);</span>
<span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;description&quot;</span><span class="tok-o">,</span> <span class="tok-n">description</span><span class="tok-o">);</span>
<span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span>
  <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;holidayRequest&quot;</span><span class="tok-o">,</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the process instance is started, an <strong>execution</strong> is created and put in the start event. From there, this <em>execution</em> follows the sequence flow to the user task for the manager approval and executes the user task behavior. This behavior will create a task in the database that can be found using queries later on. A user task is a <em>wait state</em> and the engine will stop executing anything further, thus returning the API call.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sidetrack_transactionality">2.3.4. Sidetrack: transactionality</h4>
<div class="paragraph">
<p>In Flowable, database transactions play a crucial role, to guarantee data consistency and solve concurrency problems. When you make a Flowable API call, by default, everything is synchronous and part of the same transaction. Meaning: when the method call returns, a transaction will be started and committed.</p>
</div>
<div class="paragraph">
<p>When a process instance is started, there will be <strong>one database transaction</strong> from the start of the process instance to the next <em>wait state</em>. In this example, this is the first user task. When the engine reaches this user task, the state is persisted to the database and the transaction is committed and the API call returns.</p>
</div>
<div class="paragraph">
<p>In Flowable, when continuing a process instance, there will always be one database transaction going from the previous <em>wait state</em> to the next <em>wait state</em>. Once persisted, the data can be in the database for a long time, even years if it has to be, until an API call is executed that takes the process instance further. Note that no computing nor memory resources are consumed when the process instance is in such a wait state, waiting for the next API call.</p>
</div>
<div class="paragraph">
<p>In the example here, when the first user task is completed, one database transaction will be used to go from the user task through the exclusive gateway (the automatic logic) until the second user task. Or straight to the end with the other path.</p>
</div>
</div>
<div class="sect3">
<h4 id="_querying_and_completing_tasks">2.3.5. Querying and completing tasks</h4>
<div class="paragraph">
<p>In a more realistic application, there will be a user interface where the employees and the managers can log in and see their task lists. In such task list, they can inspect the process instance data which is stored as <em>process variables</em> and decide what they want to do with the task. In this example, we will mimic these task lists by executing the API calls that normally would behind a service call that drives a UI.</p>
</div>
<div class="paragraph">
<p>We haven&#8217;t yet configured the assignment for the user tasks. We want the first task to go the the <em>managers</em> group and the second user task to be assigned to the original requester of the holiday. To do this, add the <em>candidateGroups</em> attribute to the first task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;approveTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Approve or reject request&quot;</span> <span class="tok-na">activiti:candidateGroups=</span><span class="tok-s">&quot;managers&quot;</span><span class="tok-nt">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and the <em>assignee</em> attribute to the second task as shown below. Note that we&#8217;re not using a static value like the <em>managers</em> value above, but a dynamic assignment based on a process variable that we&#8217;ve passed when the process instance was started:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;holidayApprovedTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Holiday approved&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${employee}&quot;</span><span class="tok-nt">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the actual task list, we create a <em>TaskQuery</em> via the <em>TaskService</em> and we configure the query to only return the tasks for the <em>managers</em> group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">TaskService</span> <span class="tok-n">taskService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getTaskService</span><span class="tok-o">();</span>
<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;managers&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;You have &quot;</span> <span class="tok-o">+</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-s">&quot; tasks:&quot;</span><span class="tok-o">);</span>
<span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-kt">int</span> <span class="tok-n">i</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-o">;</span> <span class="tok-n">i</span><span class="tok-o">&lt;</span><span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">();</span> <span class="tok-n">i</span><span class="tok-o">++)</span> <span class="tok-o">{</span>
  <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">((</span><span class="tok-n">i</span><span class="tok-o">+</span><span class="tok-mi">1</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot;) &quot;</span> <span class="tok-o">+</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">i</span><span class="tok-o">).</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the task identifier, we can now get the specific process instance variables and show on the screen the actual request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Which task would you like to complete?&quot;</span><span class="tok-o">);</span>
<span class="tok-kt">int</span> <span class="tok-n">taskIndex</span> <span class="tok-o">=</span> <span class="tok-n">Integer</span><span class="tok-o">.</span><span class="tok-na">valueOf</span><span class="tok-o">(</span><span class="tok-n">scanner</span><span class="tok-o">.</span><span class="tok-na">nextLine</span><span class="tok-o">());</span>
<span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">=</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-n">taskIndex</span> <span class="tok-o">-</span> <span class="tok-mi">1</span><span class="tok-o">);</span>
<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">processVariables</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">getVariables</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">processVariables</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-s">&quot;employee&quot;</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot; wants &quot;</span> <span class="tok-o">+</span> <span class="tok-n">processVariables</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-s">&quot;nrOfHolidays&quot;</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot; of holidays. Do you approve this?&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which, if you run this, should look something like this:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.console.logging3.png" alt="getting.started.console.logging3">
</div>
</div>
<div class="paragraph">
<p>The manager can now <strong>complete the task</strong>. In reality, this often means that a form is sumitted by the user. The data from the form is then passed as <em>process variables</em>. Here, we&#8217;ll mimic this by passing a map with the <em>approved</em> variable (the name is important, as it&#8217;s used later on in the conditions of the sequence flow!) when the task is completed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-kt">boolean</span> <span class="tok-n">approved</span> <span class="tok-o">=</span> <span class="tok-n">scanner</span><span class="tok-o">.</span><span class="tok-na">nextLine</span><span class="tok-o">().</span><span class="tok-na">toLowerCase</span><span class="tok-o">().</span><span class="tok-na">equals</span><span class="tok-o">(</span><span class="tok-s">&quot;y&quot;</span><span class="tok-o">);</span>
<span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
<span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;approved&quot;</span><span class="tok-o">,</span> <span class="tok-n">approved</span><span class="tok-o">);</span>
<span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The task is now completed and one of the two paths leaving the exclusive gateway is selected based on the <em>approved</em> process variable.</p>
</div>
</div>
<div class="sect3">
<h4 id="getting.started.delegate">2.3.6. Writing a JavaDelegate</h4>
<div class="paragraph">
<p>There is a last piece of the puzzle still missing: we haven&#8217;t implemented the automatic logic that will get executed when the request is approved. In the BPMN 2.0 xml this is a <strong>service task</strong> and it looked above like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;externalSystemCall&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Enter holidays in external system&quot;</span>   <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.flowable.CallExternalSystemDelegate&quot;</span><span class="tok-nt">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In reality, this logic could be anything ranging from doing an HTTP REST call to some system, to doing some legacy code calls to a system the company has been using for decades. We won&#8217;t implement the actual logic here, but have a simple logging statement inside.</p>
</div>
<div class="paragraph">
<p>Create a new class (<em>File &#8594; New &#8594; Class</em> in Eclipse), fill in <em>org.flowable</em> as package name and <em>CallExternalSystemDelegate</em> as class name. Make that class implement the <em>org.activiti.engine.delegate.JavaDelegate</em> interface and implement the <em>execute</em> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kn">package</span> <span class="tok-nn">org.flowable</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.delegate.DelegateExecution</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.delegate.JavaDelegate</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CallExternalSystemDelegate</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

	<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-o">{</span>
		<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Calling the external system for employee &quot;</span>
      <span class="tok-o">+</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;employee&quot;</span><span class="tok-o">));</span>
	<span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the <em>execution</em> arrives at the <em>service task</em>, the class that is referenced in the BPMN 2.0 xml is instantiated and called.</p>
</div>
<div class="paragraph">
<p>When running the example now, the logging message is shown, demonstrating the custom logic is indeed executed:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/getting.started.console.logging4.png" alt="getting.started.console.logging4">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_historical_data">2.3.7. Working with historical data</h4>
<div class="paragraph">
<p>One of the many reasons for choosing to use a process engine like Flowable is because it automatically stores <strong>audit data</strong> or <strong>historical data</strong> for all the process instances. This data allows the creation of rich reports that give insights into how the company works, where the bottlenecks are, etc.</p>
</div>
<div class="paragraph">
<p>For example, suppose we want to show the duration of the process instance that we&#8217;ve been executing so far. To do this, we get the <em>HistoryService</em>  from the <em>ProcessEngine</em> and create a query for <em>historical activities</em>. In the snippet below you can see we add some additional filtering:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>only the activities for one particular process instance</p>
</li>
<li>
<p>only the activities which are finished</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The results are also sorted by end time, meaning that we&#8217;ll get them in execution order.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-n">HistoryService</span> <span class="tok-n">historyService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getHistoryService</span><span class="tok-o">();</span>
<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">HistoricActivityInstance</span><span class="tok-o">&gt;</span> <span class="tok-n">activities</span> <span class="tok-o">=</span>
  <span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricActivityInstanceQuery</span><span class="tok-o">()</span>
   <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">processInstance</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())</span>
   <span class="tok-o">.</span><span class="tok-na">finished</span><span class="tok-o">()</span>
   <span class="tok-o">.</span><span class="tok-na">orderByHistoricActivityInstanceEndTime</span><span class="tok-o">().</span><span class="tok-na">asc</span><span class="tok-o">()</span>
   <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>

<span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">HistoricActivityInstance</span> <span class="tok-n">activity</span> <span class="tok-o">:</span> <span class="tok-n">activities</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-n">activity</span><span class="tok-o">.</span><span class="tok-na">getActivityId</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-s">&quot; took &quot;</span>
    <span class="tok-o">+</span> <span class="tok-n">activity</span><span class="tok-o">.</span><span class="tok-na">getDurationInMillis</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-s">&quot; milliseconds&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the example again, we now see something like this in the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>startEvent took 1 milliseconds
approveTask took 2638 milliseconds
decision took 3 milliseconds
externalSystemCall took 1 milliseconds</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_conclusion">2.3.8. Conclusion</h4>
<div class="paragraph">
<p>This tutorial introduced various Flowable and BPMN 2.0 concepts and terminology while also demonstrating how use the Flowable API programmatically.</p>
</div>
<div class="paragraph">
<p>Of course, this is just the start of the journey. The following sections will dive more deeply into the many options and features that the Flowable engine supports. Other sections go into the various ways the Flowable engine can be set up and used, and describe in detail all the BPMN 2.0 constructs that are possible.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting.started.rest">2.4. Getting started with the Flowable REST API</h3>
<div class="paragraph">
<p>This section shows the same example as the <a href="#getting.started.command.line">previous section</a>: deploying a process definition, starting a process instance, getting a task list and completing a task. If you haven&#8217;t read that section, it might be good to skim through it to get an idea of what is done there.</p>
</div>
<div class="paragraph">
<p>This time, the Flowable REST API is used instead of the Java API. You&#8217;ll soon notice that the REST API closely matches the Java API, and knowing the one automatically means that you can find your way around the other.</p>
</div>
<div class="paragraph">
<p>To get a full detailed overview of the Flowable REST API, check out the <a href="#restApiChapter">REST API chapter</a>.</p>
</div>
<div class="sect3">
<h4 id="_setting_up_the_rest_application">2.4.1. Setting up the REST application</h4>
<div class="paragraph">
<p>When you download the .zip file from the flowable.org website, the REST application can be found in the <em>wars</em> folder. You&#8217;ll need a servlet container like <a href="http://tomcat.apache.org//">Tomcat</a>, <a href="http://www.eclipse.org/jetty//">Jetty</a>, etc. to run the war file.</p>
</div>
<div class="paragraph">
<p>When using Tomcat the steps are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download and unzip the latest and greatest Tomcat zip file (choose the <em>Core</em> distribution from the Tomcat website).</p>
</li>
<li>
<p>Copy the flowable-rest.war file from the <em>wars</em> folder of the unzipped Flowable distribution to the <em>webapps</em> folder of the unzipped Tomcat folder.</p>
</li>
<li>
<p>On the command line, go to the <em>bin</em> folder of the Tomcat folder.</p>
</li>
<li>
<p>Execute <em><em>./catalina run</em></em> to boot up the Tomcat server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>During the server boot up, you&#8217;ll notice some Flowable logging messages passing by. At the end a message like <em><em>INFO [main] org.apache.catalina.startup.Catalina.start Server startup in xyz ms</em></em> signifies that the server is ready to receives requests. Note that by default an in-memory H2 database instance is used, which means that data won&#8217;t survive a server restart.</p>
</div>
<div class="paragraph">
<p>In the following sections, we&#8217;ll use cURL to demonstrate the various REST calls. All REST calls are by default protected with <em>basic authentication</em>. The user <em>kermit</em> with password <em>kermit</em> is used in all calls.</p>
</div>
<div class="paragraph">
<p>After bootup, verify the application is running correctly by executing</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit http://localhost:8080/flowable-rest/service/management/engine</pre>
</div>
</div>
<div class="paragraph">
<p>If you get back a proper json response, the REST API is up and running.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploying_a_process_definition_2">2.4.2. Deploying a process definition</h4>
<div class="paragraph">
<p>The first step is to deploy a process definition. With the REST API, this is done by uploading a .bpmn20.xml file (or .zip file for multiple process definitions) as <em>multipart/formdata</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit -F "file=@holiday-request.bpmn20.xml" http://localhost:8080/flowable-rest/service/repository/deployments</pre>
</div>
</div>
<div class="paragraph">
<p>To verify that the process definition is deployed correctly, the list of process definitions can be requested:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit http://localhost:8080/flowable-rest/service/repository/process-definitions</pre>
</div>
</div>
<div class="paragraph">
<p>which returns a list of all process definitions currently deployed to the engine.</p>
</div>
</div>
<div class="sect3">
<h4 id="_start_a_process_instance">2.4.3. Start a process instance</h4>
<div class="paragraph">
<p>Starting a process instance via the REST API is similar to doing the same via the Java API: a <em>key</em> is provided to identify the process definition to use along with a map of initial process variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit -H "Content-Type: application/json" -X POST -d '{ "processDefinitionKey":"holidayRequest", "variables": [ { "name":"employee", "value": "John Doe" }, { "name":"nrOfHolidays", "value": 7 }]}' http://localhost:8080/flowable-rest/service/runtime/process-instances</pre>
</div>
</div>
<div class="paragraph">
<p>which returns something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"id":"43","url":"http://localhost:8080/flowable-rest/service/runtime/process-instances/43","businessKey":null,"suspended":false,"ended":false,"processDefinitionId":"holidayRequest:1:42","processDefinitionUrl":"http://localhost:8080/flowable-rest/service/repository/process-definitions/holidayRequest:1:42","activityId":null,"variables":[],"tenantId":"","completed":false}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_task_list_and_completing_a_task">2.4.4. Task list and completing a task</h4>
<div class="paragraph">
<p>When the process instance is started, the first task is assigned to the <em>managers</em> group. To get all tasks for this group, a task query can be done via the REST API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit -H "Content-Type: application/json" -X POST -d '{ "candidateGroup" : "managers" }' http://localhost:8080/flowable-rest/service/query/tasks</pre>
</div>
</div>
<div class="paragraph">
<p>which returns a list of all tasks for the <em>managers</em> group</p>
</div>
<div class="paragraph">
<p>Such a task can now be completed using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl --user kermit:kermit -H "Content-Type: application/json" -X POST -d '{ "action" : "complete", "variables" : [ { "name" : "approved", "value" : true} ]  }' http://localhost:8080/flowable-rest/service/runtime/tasks/25</pre>
</div>
</div>
<div class="paragraph">
<p>However, you most likely will get an error like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{"message":"Internal server error","exception":"couldn't instantiate class org.flowable.CallExternalSystemDelegate"}</pre>
</div>
</div>
<div class="paragraph">
<p>This means that the engine couldn&#8217;t find the <em>CallExternalSystemDelegate</em> class that is referenced in the service task. To solve this, the class needs to be put on the classpath of the application (which will require a restart). Create the class as described in <a href="#getting.started.delegate">this section</a>, package it up as a jar and put it in the <em>WEB-INF/lib</em> folder of the flowable-rest folder under the <em>webapps</em> folder of Tomcat.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">3. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuration">3.1. Creating a ProcessEngine</h3>
<div class="paragraph">
<p>The Flowable process engine is configured through an XML file called <code>activiti.cfg.xml</code>. Note that this is <strong>not</strong> applicable if you&#8217;re using <a href="#springintegration">the Spring style of building a process engine</a>.</p>
</div>
<div class="paragraph">
<p>The easiest way to obtain a <code>ProcessEngine</code>, is to use the <code>org.activiti.engine.ProcessEngines</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">getDefaultProcessEngine</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will look for an <code>activiti.cfg.xml</code> file on the classpath and construct an engine based on the configuration in that file. The following snippet shows an example configuration.  The following sections will give a detailed overview of the configuration properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-nt">&lt;beans</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcUrl&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc:h2:mem:activiti;DB_CLOSE_DELAY=1000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcDriver&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;org.h2.Driver&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcUsername&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;sa&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcPassword&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;asyncExecutorActivate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;mailServerHost&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;mail.my-corp.com&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;mailServerPort&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;5025&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the configuration XML is in fact a Spring configuration. <strong>This does not mean that Flowable can only be used in a Spring environment!</strong> We are simply leveraging the parsing and dependency injection capabilities of Spring internally for building up the engine.</p>
</div>
<div class="paragraph">
<p>The ProcessEngineConfiguration object can also be created programmatically using the configuration file. It is also possible to use a different bean id (e.g. see line 3).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span>
  <span class="tok-nf">createProcessEngineConfigurationFromResourceDefault</span><span class="tok-o">();</span>
  <span class="tok-n">createProcessEngineConfigurationFromResource</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">resource</span><span class="tok-o">);</span>
  <span class="tok-n">createProcessEngineConfigurationFromResource</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">resource</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">beanName</span><span class="tok-o">);</span>
  <span class="tok-n">createProcessEngineConfigurationFromInputStream</span><span class="tok-o">(</span><span class="tok-n">InputStream</span> <span class="tok-n">inputStream</span><span class="tok-o">);</span>
  <span class="tok-n">createProcessEngineConfigurationFromInputStream</span><span class="tok-o">(</span><span class="tok-n">InputStream</span> <span class="tok-n">inputStream</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">beanName</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible not to use a configuration file, and create a configuration based on
defaults (see <a href="#configurationClasses">the different supported classes</a> for more information).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">createStandaloneProcessEngineConfiguration</span><span class="tok-o">();</span>
<span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">createStandaloneInMemProcessEngineConfiguration</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All these <code>ProcessEngineConfiguration.createXXX()</code> methods return a <code>ProcessEngineConfiguration</code> that can further be tweaked if needed. After calling the <code>buildProcessEngine()</code> operation, a <code>ProcessEngine</code> is created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">createStandaloneInMemProcessEngineConfiguration</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">setDatabaseSchemaUpdate</span><span class="tok-o">(</span><span class="tok-n">ProcessEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">DB_SCHEMA_UPDATE_FALSE</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">setJdbcUrl</span><span class="tok-o">(</span><span class="tok-s">&quot;jdbc:h2:mem:my-own-db;DB_CLOSE_DELAY=1000&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">setAsyncExecutorActivate</span><span class="tok-o">(</span><span class="tok-kc">false</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurationRoot">3.2. ProcessEngineConfiguration bean</h3>
<div class="paragraph">
<p>The <code>activiti.cfg.xml</code> must contain a bean that has the id <code>'processEngineConfiguration'</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span> <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This bean is then used to construct the <code>ProcessEngine</code>. There are multiple classes available that can be used to define the <code>processEngineConfiguration</code>. These classes represent different environments, and set defaults accordingly. It&#8217;s a best practice to select the class the matches (the most) your environment, to minimalise the number of properties needed to configure the engine. The following classes are currently available (more will follow in future releases): <a id="configurationClasses"></a></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration</strong>: the process engine is used in a standalone way. Flowable will take care of the transactions. By default, the database will only be checked when the engine boots (and an exception is thrown if there is no Flowable schema or the schema version is incorrect).</p>
</li>
<li>
<p><strong>org.activiti.engine.impl.cfg.StandaloneInMemProcessEngineConfiguration</strong>: this is a convenience class for unit testing purposes. Flowable will take care of the transactions. An H2 in-memory database is used by default. The database will be created and dropped when the engine boots and shuts down. When using this, probably no additional configuration is needed (except when using for example the job executor or mail capabilities).</p>
</li>
<li>
<p><strong>org.activiti.spring.SpringProcessEngineConfiguration</strong>: To be used when the process engine is used in a Spring environment.  See <a href="#springintegration">the Spring integration section</a> for more information.</p>
</li>
<li>
<p><strong>org.activiti.engine.impl.cfg.JtaProcessEngineConfiguration</strong>: To be used when the engine runs in standalone mode, with JTA transactions.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="databaseConfiguration">3.3. Database configuration</h3>
<div class="paragraph">
<p>There are two ways to configure the database that the Flowable engine will use. The first option is to define the JDBC properties of the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>jdbcUrl</strong>: JDBC URL of the database.</p>
</li>
<li>
<p><strong>jdbcDriver</strong>: implementation of the driver for the specific database type.</p>
</li>
<li>
<p><strong>jdbcUsername</strong>: username to connect to the database.</p>
</li>
<li>
<p><strong>jdbcPassword</strong>: password to connect to the database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The data source that is constructed based on the provided JDBC properties will have the default <a href="http://www.mybatis.org/">MyBatis</a> connection pool settings. The following attributes can optionally be set to tweak that connection pool (taken from the MyBatis documentation):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>jdbcMaxActiveConnections</strong>: The number of active connections that the connection pool at maximum at any time can contain. Default is 10.</p>
</li>
<li>
<p><strong>jdbcMaxIdleConnections</strong>: The number of idle connections that the connection pool at maximum at any time can contain.</p>
</li>
<li>
<p><strong>jdbcMaxCheckoutTime</strong>: The amount of time in milliseconds a connection can be <em>checked out</em> from the connection pool before it is forcefully returned. Default is 20000 (20 seconds).</p>
</li>
<li>
<p><strong>jdbcMaxWaitTime</strong>: This is a low level setting that gives the pool a chance to print a log status and re-attempt the acquisition of a connection in the case that it is taking unusually long (to avoid failing silently forever if the pool is misconfigured) Default is 20000 (20 seconds).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example database configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcUrl&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc:h2:mem:activiti;DB_CLOSE_DELAY=1000&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcDriver&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;org.h2.Driver&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcUsername&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;sa&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcPassword&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Our benchmarks have shown that the MyBatis connection pool is not the most efficient or resilient when dealing with a lot of concurrent requests. As such, it is advised to us a <code>javax.sql.DataSource</code> implementation and inject it into the process engine configuration (For example DBCP, C3P0, Hikari, Tomcat Connection Pool, etc.):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.apache.commons.dbcp.BasicDataSource&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;driverClassName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;com.mysql.jdbc.Driver&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;url&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc:mysql://localhost:3306/activiti&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;username&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;activiti&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;password&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;activiti&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;defaultAutoCommit&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-nt">/&gt;</span>
    ...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that Flowable does not ship with a library that allows to define such a data source. So you have to make sure that the libraries are on your classpath.</p>
</div>
<div class="paragraph">
<p>The following properties can be set, regardless of whether you are using the JDBC or data source approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>databaseType</strong>: it&#8217;s normally not necessary to specify this property as it is automatically analyzed from the database connection metadata. Should only be specified in case automatic detection fails. Possible values: {h2, mysql, oracle, postgres, mssql, db2}. This setting will determine which create/drop scripts and queries will be used. See <a href="#supporteddatabases">the <em>supported databases</em> section</a> for an overview of which types are supported.</p>
</li>
<li>
<p><strong>databaseSchemaUpdate</strong>: allows to set the strategy to handle the database schema on process engine boot and shutdown.</p>
<div class="ulist">
<ul>
<li>
<p><code>false</code> (default): Checks the version of the DB schema against the library when the process engine is being created and throws an exception if the versions don&#8217;t match.</p>
</li>
<li>
<p><code>true</code>: Upon building the process engine, a check is performed and an update of the schema is performed if it is necessary. If the schema doesn&#8217;t exist, it is created.</p>
</li>
<li>
<p><code>create-drop</code>: Creates the schema when the process engine is being created and drops the schema when the process engine is being closed.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="jndiDatasourceConfig">3.4. JNDI Datasource Configuration</h3>
<div class="paragraph">
<p>By default, the database configuration for Flowable is contained within the db.properties files in the WEB-INF/classes of each web application. This isn&#8217;t always ideal because it
requires users to either modify the db.properties in the Flowable source and recompile the war file, or explode the war and modify the db.properties on every deployment.</p>
</div>
<div class="paragraph">
<p>By using JNDI (Java Naming and Directory Interface) to obtain the database connection, the connection is fully managed by the Servlet Container and the configuration can be managed outside the war deployment. This also allows more control over the connection parameters than what is provided by the db.properties file.</p>
</div>
<div class="sect3">
<h4 id="jndi_configuration">3.4.1. Configuration</h4>
<div class="paragraph">
<p>Configuration of the JNDI datasource will differ depending on what servlet container application you are using. The instructions below will work for Tomcat, but for other container applications, please refer to the documentation for your container app.</p>
</div>
<div class="paragraph">
<p>If using Tomcat, the JNDI resource is configured within $CATALINA_BASE/conf/[enginename]/[hostname]/[warname].xml (for the Flowable UI this will usually be $CATALINA_BASE/conf/Catalina/localhost/activiti-app.xml). The default context is copied from the Flowable war file when the application is first deployed, so if it already exists, you will need to replace it. To change the JNDI resource so that the application connects to MySQL instead of H2, for example, change the file to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
    <span class="tok-nt">&lt;Context</span> <span class="tok-na">antiJARLocking=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">path=</span><span class="tok-s">&quot;/activiti-app&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;Resource</span> <span class="tok-na">auth=</span><span class="tok-s">&quot;Container&quot;</span>
            <span class="tok-na">name=</span><span class="tok-s">&quot;jdbc/activitiDB&quot;</span>
            <span class="tok-na">type=</span><span class="tok-s">&quot;javax.sql.DataSource&quot;</span>
            <span class="tok-na">description=</span><span class="tok-s">&quot;JDBC DataSource&quot;</span>
            <span class="tok-na">url=</span><span class="tok-s">&quot;jdbc:mysql://localhost:3306/activiti&quot;</span>
            <span class="tok-na">driverClassName=</span><span class="tok-s">&quot;com.mysql.jdbc.Driver&quot;</span>
            <span class="tok-na">username=</span><span class="tok-s">&quot;sa&quot;</span>
            <span class="tok-na">password=</span><span class="tok-s">&quot;&quot;</span>
            <span class="tok-na">defaultAutoCommit=</span><span class="tok-s">&quot;false&quot;</span>
            <span class="tok-na">initialSize=</span><span class="tok-s">&quot;5&quot;</span>
            <span class="tok-na">maxWait=</span><span class="tok-s">&quot;5000&quot;</span>
            <span class="tok-na">maxActive=</span><span class="tok-s">&quot;120&quot;</span>
            <span class="tok-na">maxIdle=</span><span class="tok-s">&quot;5&quot;</span><span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;/Context&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jndi_properties">3.4.2. JNDI properties</h4>
<div class="paragraph">
<p>To configure a JNDI Datasource, use following properties in the properties file for the Flowable UI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>datasource.jndi.name: the JNDI name of the Datasource.</p>
</li>
<li>
<p>datasource.jndi.resourceRef: Set whether the lookup occurs in a J2EE container, i.e. if the prefix "java:comp/env/" needs to be added if the JNDI name doesn&#8217;t already contain it. Default is "true".</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="supporteddatabases">3.5. Supported databases</h3>
<div class="paragraph">
<p>Listed below are the types (case sensitive!) that Flowable uses to refer to databases.</p>
</div>
<table id="databaseTypes" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flowable database type</th>
<th class="tableblock halign-left valign-top">Example JDBC URL</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:h2:tcp://localhost/activiti</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default configured database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mysql</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:mysql://localhost:3306/activiti?autoReconnect=true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested using mysql-connector-java database driver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">oracle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:oracle:thin:@localhost:1521:xe</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">postgres</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:postgresql://localhost:5432/activiti</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">db2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:db2://localhost:50000/activiti</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mssql</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:sqlserver://localhost:1433;databaseName=activiti (jdbc.driver=com.microsoft.sqlserver.jdbc.SQLServerDriver) <em>OR</em> jdbc:jtds:sqlserver://localhost:1433/activiti (jdbc.driver=net.sourceforge.jtds.jdbc.Driver)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tested using Microsoft JDBC Driver 4.0 (sqljdbc4.jar) and JTDS Driver</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="creatingDatabaseTable">3.6. Creating the database tables</h3>
<div class="paragraph">
<p>The easiest way to create the database tables for your database is to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the flowable-engine jars to your classpath</p>
</li>
<li>
<p>Add a suitable database driver</p>
</li>
<li>
<p>Add a Flowable configuration file (<em>activiti.cfg.xml</em>) to your classpath, pointing to your database (see <a href="#databaseConfiguration">database configuration section</a>)</p>
</li>
<li>
<p>Execute the main method of the <em>DbSchemaCreate</em> class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, often only database administrators can execute DDL statements on a database. On a production system, this is also the wisest of choices. The SQL DDL statements can be found on the Flowable downloads page or inside the Flowable distribution folder, in the <code>database</code> subdirectory. The scripts are also in the engine jar (<em>flowable-engine-x.jar</em>), in the package <em>org/activiti/db/create</em> (the <em>drop</em> folder contains the drop statements). The SQL files are of the form</p>
</div>
<div class="listingblock">
<div class="content">
<pre>activiti.{db}.{create|drop}.{type}.sql</pre>
</div>
</div>
<div class="paragraph">
<p>Where <em>db</em> is any of the <a href="#supporteddatabases">supported databases</a> and <em>type</em> is</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>engine:</strong> the tables needed for engine execution. Required.</p>
</li>
<li>
<p><strong>identity:</strong> the tables containing users, groups and memberships of users to groups. These tables are optional and should be used when using the default identity management as shipped with the engine.</p>
</li>
<li>
<p><strong>history:</strong> the tables that contain the history and audit information. Optional: not needed when history level is set to <em>none</em>. Note that this will also disable some features (such as commenting on tasks) which store the data in the history database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note for MySQL users:</strong> MySQL version lower than 5.6.4 has no support for timestamps or dates with millisecond precision. To make things even worse, some version will throw an exception when trying to create such a column but other versions don&#8217;t. When doing auto-creation/upgrade, the engine will change the DDL when executing it. When using the DDL file approach, both a regular version and a special file with <em>mysql55</em> in it are available (this applies on anything lower than 5.6.4). This latter file will have column types with no millisecond precision in it.</p>
</div>
<div class="paragraph">
<p>Concretely, the following applies for MySQL version</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>&lt;5.6:</strong> No millisecond precision available. DDL files available (look for files containing <em>mysql55</em>). Auto creation/update will work out of the box.</p>
</li>
<li>
<p><strong>5.6.0 - 5.6.3:</strong> No millisecond precision available. Auto creation/update will NOT work. It is advised to upgrade to a newer database version anyway. DDL files for <em>mysql 5.5</em> could be used if really needed.</p>
</li>
<li>
<p><strong>5.6.4+:</strong> Millisecond precision available. DDL files available (default file containing <em>mysql</em>). Auto creation/update works out of the box.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Do note that in the case of upgrading the MySQL database later on and the Flowable tables are already created/upgraded, the column type change will have to be done manually!</p>
</div>
</div>
<div class="sect2">
<h3 id="database.tables.explained">3.7. Database table names explained</h3>
<div class="paragraph">
<p>The database names of Flowable all start with <strong>ACT_</strong>. The second part is a two-character identification of the use case of the table. This use case will also roughly match the service API.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ACT_RE_</strong>*: <em>RE</em> stands for <code>repository</code>. Tables with this prefix contain <em>static</em> information such as process definitions and process resources (images, rules, etc.).</p>
</li>
<li>
<p><strong>ACT_RU_</strong>*: <em>RU</em> stands for <code>runtime</code>. These are the runtime tables that contain the runtime data of process instances, user tasks, variables, jobs, etc. Flowable only stores the runtime data during process instance execution, and removes the records when a process instance ends. This keeps the runtime tables small and fast.</p>
</li>
<li>
<p><strong>ACT_ID_</strong>*: <em>ID</em> stands for <code>identity</code>. These tables contain identity information, such as users, groups, etc.</p>
</li>
<li>
<p><strong>ACT_HI_</strong>*: <em>HI</em> stands for <code>history</code>. These are the tables that contain historic data, such as past process instances, variables, tasks, etc.</p>
</li>
<li>
<p><strong>ACT_GE_</strong>*: <code>general</code> data, which is used in various use cases.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="databaseUpgrade">3.8. Database upgrade</h3>
<div class="paragraph">
<p>Make sure you make a backup of your database (using your database backup capabilities) before you run an upgrade.</p>
</div>
<div class="paragraph">
<p>By default, a version check will be performed each time a process engine is created. This typically happens once at boot time of your application or of the Flowable webapps. If the Flowable library notices a difference between the library version and the version of the Flowable database tables, then an exception is thrown.</p>
</div>
<div class="paragraph">
<p>To upgrade, you have to start with putting the following configuration property in your activiti.cfg.xml configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;beans</span> <span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-c">&lt;!-- ... --&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-c">&lt;!-- ... --&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Also, include a suitable database driver for your database to the classpath.</strong> Upgrade the Flowable libraries in your application. Or start up a new version of Flowable and point it to a database that contains an older version.  With <code>databaseSchemaUpdate</code> set to <code>true</code>, Flowable will automatically upgrade the DB schema to the newer version the first time when it notices that libraries and DB schema are out of sync.</p>
</div>
<div class="paragraph">
<p><strong>As an alternative you can also run the upgrade DDL statements.</strong> It&#8217;s also possible to run the upgrade database scripts, available on the Flowable downloads page.</p>
</div>
</div>
<div class="sect2">
<h3 id="jobExecutorConfiguration">3.9. Job Executor (since version 6.0.0)</h3>
<div class="paragraph">
<p>The async executor of Flowable 5 is the only available job executor in Flowable 6 as it is a more performant and more database friendly way of executing asynchronous jobs in the Flowable Engine.
The old job executor of Flowable 5 is removed. More information can be found in the advanced section of the user guide.</p>
</div>
<div class="paragraph">
<p>Moreover, if running under Java EE 7, JSR-236 compliant <code>ManagedAsyncJobExecutor</code> can be used for letting the container manage the threads. In order to enable them, the thread factory should be passed in the configuration as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;threadFactory&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.jndi.JndiObjectFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jndiName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;java:jboss/ee/concurrency/factory/default&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;customJobExecutor&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.jobexecutor.ManagedAsyncJobExecutor&quot;</span><span class="tok-nt">&gt;</span>
   <span class="tok-c">&lt;!-- ... --&gt;</span>
   <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;threadFactory&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;threadFactory&quot;</span> <span class="tok-nt">/&gt;</span>
   <span class="tok-c">&lt;!-- ... --&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The managed implementation fall back to their default counterparts if the thread factory is not specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="_job_executor_activation">3.10. Job executor activation</h3>
<div class="paragraph">
<p>The <code>AsyncExecutor</code> is a component that manages a thread pool to fire timers and other asynchronous tasks. Other implementations are possible (for example using a message queue, see the advanced section of the user guide).</p>
</div>
<div class="paragraph">
<p>By default, the <code>AsyncExecutor</code> is not activated and not started. With the following configuration the async executor can be started together with the Flowable Engine.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;asyncExecutorActivate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The property asyncExecutorActivate instructs the Flowable Engine to startup the Async executor at startup.</p>
</div>
</div>
<div class="sect2">
<h3 id="mailServerConfiguration">3.11. Mail server configuration</h3>
<div class="paragraph">
<p>Configuring a mail server is optional. Flowable supports sending e-mails in business processes. To actually send an e-mail, a valid SMTP mail server configuration is required. See the <a href="#bpmnEmailTaskServerConfiguration">e-mail task</a> for the configuration options.</p>
</div>
</div>
<div class="sect2">
<h3 id="historyConfiguration">3.12. History configuration</h3>
<div class="paragraph">
<p>Customizing the configuration of history storage is optional. This allows you to tweak settings that influence the <a href="#history">history capabilities</a> of the engine. See <a href="#historyConfig">history configuration</a> for more details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;history&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;audit&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exposingConfigurationBeans">3.13. Exposing configuration beans in expressions and scripts</h3>
<div class="paragraph">
<p>By default, all beans that you specify in the <code>activiti.cfg.xml</code> configuration or in your own Spring configuration file are available to expressions and in the scripts. If you want to limit the visibility of beans in your configuration file, you can configure a property called <code>beans</code> in your process engine configuration. The beans property in <code>ProcessEngineConfiguration</code> is a map. When you specify that property, only beans specified in that map will be visible to expressions and scripts.  The exposed beans will be exposed with the names as you specify in that map.</p>
</div>
</div>
<div class="sect2">
<h3 id="processDefinitionCacheConfiguration">3.14. Deployment cache configuration</h3>
<div class="paragraph">
<p>All process definition are cached (after they&#8217;re parsed) to avoid hitting the database every time a process definition is needed and because process definition data doesn&#8217;t change. By default, there is no limit on this cache. To limit the process definition cache, add following property</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processDefinitionCacheLimit&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;10&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting this property will swap the default hashmap cache with a LRU cache that has the provided hard limit. Of course, the <em>best</em> value of this property depends on the total amount of process definitions stored and the number of process definitions actually used at runtime by all the runtime process instances.</p>
</div>
<div class="paragraph">
<p>You can also inject your own cache implementation. This must be a bean that implements the org.activiti.engine.impl.persistence.deploy.DeploymentCache interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processDefinitionCache&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyCache&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is a similar property called <code>knowledgeBaseCacheLimit</code> and <code>knowledgeBaseCache</code> for configuring the rules cache. This is only needed when you use the rules task in your processes.</p>
</div>
</div>
<div class="sect2">
<h3 id="loggingConfiguration">3.15. Logging</h3>
<div class="paragraph">
<p>All logging (flowable, spring, mybatis, &#8230;&#8203;) is routed through SLF4J and allows for selecting the logging-implementation of your choice.</p>
</div>
<div class="paragraph">
<p><strong>By default no SFL4J-binding jar is present in the flowable-engine dependencies, this should be added in your project in order to use the logging framework of your choice.</strong> If no implementation jar is added, SLF4J will use a NOP-logger, not logging anything at all, other than a warning that nothing will be logged. For more info on these bindings <a href="http://www.slf4j.org/codes.html#StaticLoggerBinder"><a href="http://www.slf4j.org/codes.html#StaticLoggerBinder" class="bare">http://www.slf4j.org/codes.html#StaticLoggerBinder</a></a>.</p>
</div>
<div class="paragraph">
<p>With Maven, add for example a dependency like this (here using log4j), note that you still need to add a version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.slf4j<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>slf4j-log4j12<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The flowable-ui and flowable-rest webapps are configured to use Log4j-binding. Log4j is also used when running the tests for all the flowable-* modules.</p>
</div>
<div class="paragraph">
<p><strong>Important note when using a container with commons-logging in the classpath:</strong> In order to route the spring-logging through SLF4J, a bridge is used (see <a href="http://www.slf4j.org/legacy.html#jclOverSLF4J"><a href="http://www.slf4j.org/legacy.html#jclOverSLF4J" class="bare">http://www.slf4j.org/legacy.html#jclOverSLF4J</a></a>). If your container provides a commons-logging implementation, please follow directions on this page: <a href="http://www.slf4j.org/codes.html#release"><a href="http://www.slf4j.org/codes.html#release" class="bare">http://www.slf4j.org/codes.html#release</a></a> to ensure stability.</p>
</div>
<div class="paragraph">
<p>Example when using Maven (version omitted):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.slf4j<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>jcl-over-slf4j<span class="tok-nt">&lt;/artifactId&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="MDC">3.16. Mapped Diagnostic Contexts</h3>
<div class="paragraph">
<p>Flowable supports Mapped Diagnostic Contexts feature of SLF4j. These basic information are passed to the underlying logger along with what is going to be logged:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>processDefinition Id as mdcProcessDefinitionID</p>
</li>
<li>
<p>processInstance Id as mdcProcessInstanceID</p>
</li>
<li>
<p>execution Id as mdcExecutionId</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>None of these information are logged by default. The logger can be configured to show them in desired format, extra to the usual logged messages. For example in Log4j the following sample layout definition  causes the logger to show the above mentioned information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="properties"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-na">log4j.appender.consoleAppender.layout.ConversionPattern</span><span class="tok-o">=</span><span class="tok-s">ProcessDefinitionId=%X{mdcProcessDefinitionID}</span>
<span class="tok-na">executionId</span><span class="tok-o">=</span><span class="tok-s">%X{mdcExecutionId} mdcProcessInstanceID=%X{mdcProcessInstanceID} mdcBusinessKey=%X{mdcBusinessKey} %m%n</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is useful when the logs contain information that needs to checked in real time, by means of a log analyzer for example.</p>
</div>
</div>
<div class="sect2">
<h3 id="eventDispatcher">3.17. Event handlers</h3>
<div class="paragraph">
<p>The event mechanism in the Flowable engine allows you to get notified when various events occur within the engine. Take a look at <a href="#eventDispatcherEventTypes">all supported event types</a> for an overview of the events available.</p>
</div>
<div class="paragraph">
<p>It&#8217;s possible to register a listener for certain types of events as opposed to getting notified when any type of event is dispatched. You can either add engine-wide event listeners <a href="#eventDispatcherConfiguration">through the configuration</a>, add engine-wide event listeners <a href="#eventDispatcherConfigurationRuntime">at runtime using the API</a> or add event-listeners to <a href="#eventDispatcherConfigurationProcessDefinition">specific process definitions in the BPMN XML</a>.</p>
</div>
<div class="paragraph">
<p>All events dispatched are a subtype of <code>org.activiti.engine.delegate.event.ActivitiEvent</code>. The event exposes (if available) the <code>type</code>, <code>executionId</code>, <code>processInstanceId</code> and <code>processDefinitionId</code>. Certain events contain additional context related to the event that occurred, additional information about additional payload can be found in the list of <a href="#eventDispatcherEventTypes">all supported event types</a>.</p>
</div>
<div class="sect3">
<h4 id="eventDispatcherListener">3.17.1. Event listener implementation</h4>
<div class="paragraph">
<p>The only requirement an event-listener has, is to implement <code>org.activiti.engine.delegate.event.ActivitiEventListener</code>. Below is an example implementation of a listener, which outputs all events received to the standard-out, with exception of events related to job-execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyEventListener</span> <span class="tok-kd">implements</span> <span class="tok-n">ActivitiEventListener</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">onEvent</span><span class="tok-o">(</span><span class="tok-n">ActivitiEvent</span> <span class="tok-n">event</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">switch</span> <span class="tok-o">(</span><span class="tok-n">event</span><span class="tok-o">.</span><span class="tok-na">getType</span><span class="tok-o">())</span> <span class="tok-o">{</span>

      <span class="tok-k">case</span> <span class="tok-n">JOB_EXECUTION_SUCCESS</span><span class="tok-o">:</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;A job well done!&quot;</span><span class="tok-o">);</span>
        <span class="tok-k">break</span><span class="tok-o">;</span>

      <span class="tok-k">case</span> <span class="tok-n">JOB_EXECUTION_FAILURE</span><span class="tok-o">:</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;A job has failed...&quot;</span><span class="tok-o">);</span>
        <span class="tok-k">break</span><span class="tok-o">;</span>

<span class="tok-nl">      default:</span>
        <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Event received: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">event</span><span class="tok-o">.</span><span class="tok-na">getType</span><span class="tok-o">());</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">boolean</span> <span class="tok-nf">isFailOnException</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-c1">// The logic in the onEvent method of this listener is not critical, exceptions</span>
    <span class="tok-c1">// can be ignored if logging fails...</span>
    <span class="tok-k">return</span> <span class="tok-kc">false</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>isFailOnException()</code> method determines the behaviour in case the <code>onEvent(..)</code> method throws an exception when an event is dispatched. In case <code>false</code> is returned, the exception is ignored. When <code>true</code> is returned, the exception is not ignored and bubbles up, effectively failing the current ongoing command. In case the event was part of an API-call (or any other transactional operation, e.g. job-execution), the transaction will be rolled back. In case the behaviour in the event-listener is not business-critical, it&#8217;s recommended to return <code>false</code>.</p>
</div>
<div class="paragraph">
<p>There are a few base implementations provided by Flowable to facilitate common use cases of event-listeners. These can be used as base-class or as an example listener implementation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>org.activiti.engine.delegate.event.BaseEntityEventListener</strong>: An event-listener base-class that can be used to listen for entity-related events for a specific type of entity or for all entities. It hides away the type-checking and offers 4 methods that should be overridden: <code>onCreate(..)</code>, <code>onUpdate(..)</code> and <code>onDelete(..)</code> when an entity is created, updated or deleted. For all other entity-related events, the <code>onEntityEvent(..) </code>is called.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherConfiguration">3.17.2. Configuration and setup</h4>
<div class="paragraph">
<p>If an event-listener is configured in the process engine configuration, it will be active when the process engine starts and will remain active after subsequent reboots of the engine.</p>
</div>
<div class="paragraph">
<p>The property <code>eventListeners</code> expects a list of <code>org.activiti.engine.delegate.event.ActivitiEventListener</code> instances. As usual, you can either declare an inline bean definition or use a <code>ref</code> to an existing bean instead. The snippet below adds an event-listener to the configuration that is notified when any event is dispatched, regardless of its type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
    ...
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;eventListeners&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;list&gt;</span>
         <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.example.MyEventListener&quot;</span> <span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;/list&gt;</span>
    <span class="tok-nt">&lt;/property&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To get notified when certain types of events get dispatched, use the <code>typedEventListeners</code> property, which expects a map. The key of a map-entry is a comma-separated list of event-names (or a single event-name). The value of a map-entry is a list of <code>org.activiti.engine.delegate.event.ActivitiEventListener</code> instances. The snippet below adds an event-listener to the configuration, that is notified when a job execution was successful or failed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
    ...
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;typedEventListeners&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;map&gt;</span>
        <span class="tok-nt">&lt;entry</span> <span class="tok-na">key=</span><span class="tok-s">&quot;JOB_EXECUTION_SUCCESS,JOB_EXECUTION_FAILURE&quot;</span> <span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;list&gt;</span>
            <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.example.MyJobEventListener&quot;</span> <span class="tok-nt">/&gt;</span>
          <span class="tok-nt">&lt;/list&gt;</span>
        <span class="tok-nt">&lt;/entry&gt;</span>
      <span class="tok-nt">&lt;/map&gt;</span>
    <span class="tok-nt">&lt;/property&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The order of dispatching events is determined on the order the listeners were added. First, all normal event-listeners are called (<code>eventListeners</code> property) in the order they are defined in the <code>list</code>. After that, all typed event listeners (<code>typedEventListeners</code> properties) are called, if an event of the right type is dispatched.</p>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherConfigurationRuntime">3.17.3. Adding listeners at runtime</h4>
<div class="paragraph">
<p>It&#8217;s possible to add and remove additional event-listeners to the engine by using the API (<code>RuntimeService</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Adds an event-listener which will be notified of ALL events by the dispatcher.</span>
<span class="tok-cm"> * @param listenerToAdd the listener to add</span>
<span class="tok-cm"> */</span>
<span class="tok-kt">void</span> <span class="tok-nf">addEventListener</span><span class="tok-o">(</span><span class="tok-n">ActivitiEventListener</span> <span class="tok-n">listenerToAdd</span><span class="tok-o">);</span>

<span class="tok-cm">/**</span>
<span class="tok-cm"> * Adds an event-listener which will only be notified when an event occurs, which type is in the given types.</span>
<span class="tok-cm"> * @param listenerToAdd the listener to add</span>
<span class="tok-cm"> * @param types types of events the listener should be notified for</span>
<span class="tok-cm"> */</span>
<span class="tok-kt">void</span> <span class="tok-nf">addEventListener</span><span class="tok-o">(</span><span class="tok-n">ActivitiEventListener</span> <span class="tok-n">listenerToAdd</span><span class="tok-o">,</span> <span class="tok-n">ActivitiEventType</span><span class="tok-o">...</span> <span class="tok-n">types</span><span class="tok-o">);</span>

<span class="tok-cm">/**</span>
<span class="tok-cm"> * Removes the given listener from this dispatcher. The listener will no longer be notified,</span>
<span class="tok-cm"> * regardless of the type(s) it was registered for in the first place.</span>
<span class="tok-cm"> * @param listenerToRemove listener to remove</span>
<span class="tok-cm"> */</span>
 <span class="tok-kt">void</span> <span class="tok-nf">removeEventListener</span><span class="tok-o">(</span><span class="tok-n">ActivitiEventListener</span> <span class="tok-n">listenerToRemove</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the listeners added at runtime <strong>are not retained when the engine is rebooted.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherConfigurationProcessDefinition">3.17.4. Adding listeners to process definitions</h4>
<div class="paragraph">
<p>It&#8217;s possible to add listeners to a specific process-definition. The listeners will only be called for events related to the process definition and to all events related to process instances that are started with that specific process definition. The listener implementations can be defined using a fully qualified classname, an expression that resolves to a bean that implements the listener interface or can be configured to throw a message/signal/error BPMN event.</p>
</div>
<div class="sect4">
<h5 id="_listeners_executing_user_defined_logic">Listeners executing user-defined logic</h5>
<div class="paragraph">
<p>The snippet below adds 2 listeners to a process-definition. The first listener will receive events of any type, with a listener implementation based on a fully-qualified class name. The second listener is only notified when a job is successfully executed or when it failed, using a listener that has been defined in the <code>beans</code> property of the process engine configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.test.MyEventListener&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">delegateExpression=</span><span class="tok-s">&quot;${testEventListener}&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;JOB_EXECUTION_SUCCESS,JOB_EXECUTION_FAILURE&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>

  ...

<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For events related to entities, it&#8217;s also possible to add listeners to a process-definition that get only notified when entity-events occur for a certain entity type. The snippet below shows how this can be achieved. It can be used along for ALL entity-events (first example) or for specific event types only (second example).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.test.MyEventListener&quot;</span> <span class="tok-na">entityType=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">delegateExpression=</span><span class="tok-s">&quot;${testEventListener}&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;ENTITY_CREATED&quot;</span> <span class="tok-na">entityType=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>

  ...

<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Supported values for the <code>entityType</code> are: <code>attachment</code>, <code>comment</code>, <code>execution</code>, <code>identity-link</code>, <code>job</code>, <code>process-instance</code>, <code>process-definition</code>, <code>task</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_listeners_throwing_bpmn_events">Listeners throwing BPMN events</h5>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a></p>
</div>
<div class="paragraph">
<p>Another way of handling events being dispatched is to throw a BPMN event. Please bear in mind that it only makes sense to throw BPMN-events with certain kinds of Flowable event types. For example, throwing a BPMN event when the process-instance is deleted will result in an error. The snippet below shows how to throw a signal inside process-instance, throw a signal to an external process (global), throw a message-event inside the process-instance and throw an error-event inside the process-instance. Instead of using the <code>class</code> or <code>delegateExpression</code>, the attribute <code>throwEvent</code> is used, along with an additional attribute, specific to the type of event being thrown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">throwEvent=</span><span class="tok-s">&quot;signal&quot;</span> <span class="tok-na">signalName=</span><span class="tok-s">&quot;My signal&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;TASK_ASSIGNED&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">throwEvent=</span><span class="tok-s">&quot;globalSignal&quot;</span> <span class="tok-na">signalName=</span><span class="tok-s">&quot;My signal&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;TASK_ASSIGNED&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">throwEvent=</span><span class="tok-s">&quot;message&quot;</span> <span class="tok-na">messageName=</span><span class="tok-s">&quot;My message&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;TASK_ASSIGNED&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;testEventListeners&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:eventListener</span> <span class="tok-na">throwEvent=</span><span class="tok-s">&quot;error&quot;</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;123&quot;</span> <span class="tok-na">events=</span><span class="tok-s">&quot;TASK_ASSIGNED&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If additional logic is needed to decide whether or not to throw the BPMN-event, it&#8217;s possible to extend the listener-classes provided by Flowable. By overriding the <code>isValidEvent(ActivitiEvent event) in your subclass, the BPMN-event throwing can be prevented. The classes involved are +org.activiti.engine.test.api.event.SignalThrowingEventListenerTest</code>, <code>org.activiti.engine.impl.bpmn.helper.MessageThrowingEventListener</code> and <code>org.activiti.engine.impl.bpmn.helper.ErrorThrowingEventListener</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_notes_on_listeners_on_a_process_definition">Notes on listeners on a process-definition</h5>
<div class="ulist">
<ul>
<li>
<p>Event-listeners can only be declared on the <code>process</code> element, as a child-element of the <code>extensionElements</code>. Listeners cannot be defined on individual activities in the process.</p>
</li>
<li>
<p>Expressions used in the <code>delegateExpression</code> do not have access to the execution-context, as other expressions (e.g. in gateways) have. They can only reference beans defined in the <code>beans</code> property of the process engine configuration or when using spring (and the beans property is absent) to any spring-bean that implements the listener interface.</p>
</li>
<li>
<p>When using the <code>class</code> attribute of a listener, there will only be a single instance of that class created. Make sure the listener implementations do not rely on member-fields or ensure safe usage from multiple threads/contexts.</p>
</li>
<li>
<p>When an illegal event-type is used in the <code>events</code> attribute or illegal <code>throwEvent</code> value is used, an exception will be thrown when the process-definition is deployed (effectively failing the deployment). When an illegal value for <code>class</code> or <code>delegateExecution</code> is supplied (either a nonexistent class, a nonexistent bean reference or a delegate not implementing listener interface), an exception will be thrown when the process is started (or when the first valid event for that process-definition is dispatched to the listener). Make sure the referenced classes are on the classpath and that the expressions resolve to a valid instance.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherCustomEvents">3.17.5. Dispatching events through API</h4>
<div class="paragraph">
<p>We opened up the event-dispatching mechanism through the API, to allow you to dispatch custom events to any listeners that are registered in the engine. It&#8217;s recommended (although not enforced) to only dispatch <code>ActivitiEvents</code> with type <code>CUSTOM</code>. Dispatching the event can be done using the <code>RuntimeService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Dispatches the given event to any listeners that are registered.</span>
<span class="tok-cm"> * @param event event to dispatch.</span>
<span class="tok-cm"> *</span>
<span class="tok-cm"> * @throws ActivitiException if an exception occurs when dispatching the event or when the {@link ActivitiEventDispatcher}</span>
<span class="tok-cm"> * is disabled.</span>
<span class="tok-cm"> * @throws ActivitiIllegalArgumentException when the given event is not suitable for dispatching.</span>
<span class="tok-cm"> */</span>
 <span class="tok-kt">void</span> <span class="tok-nf">dispatchEvent</span><span class="tok-o">(</span><span class="tok-n">ActivitiEvent</span> <span class="tok-n">event</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherEventTypes">3.17.6. Supported event types</h4>
<div class="paragraph">
<p>Listed below are all event types that can occur in the engine. Each type corresponds to an enum value in the <code>org.activiti.engine.delegate.event.ActivitiEventType</code>.</p>
</div>
<table id="eventTypes" class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Supported events</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Event name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Event classes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENGINE_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process-engine this listener is attached to, has been created and is ready for API-calls.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENGINE_CLOSED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process-engine this listener is attached to, has been closed. API-calls to the engine are no longer possible.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A new entity is created. The new entity is contained in the event.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_INITIALIZED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A new entity has been created and is fully initialized. If any children are created as part of the creation of an entity, this event will be fired AFTER the create/initialisation of the child entities as opposed to the <code>ENTITY_CREATE</code> event.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_UPDATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing is updated. The updated entity is contained in the event.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing entity is deleted. The deleted entity is contained in the event.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_SUSPENDED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing entity is suspended. The suspended entity is contained in the event. Will be dispatched for ProcessDefinitions, ProcessInstances and Tasks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENTITY_ACTIVATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing entity is activated. The activated entity is contained in the event. Will be dispatched for ProcessDefinitions, ProcessInstances and Tasks.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOB_EXECUTION_SUCCESS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A job has been executed successfully. The event contains the job that was executed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOB_EXECUTION_FAILURE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The execution of a job has failed. The event contains the job that was executed and the exception.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code> and <code>org.activiti&#8230;&#8203;ActivitiExceptionEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOB_RETRIES_DECREMENTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of job retries have been decremented due to a failed job. The event contains the job that was updated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMER_FIRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A timer has been fired. The event contains the job that was executed?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JOB_CANCELED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A job has been canceled. The event contains the job that was canceled. Job can be canceled by
                  API call, task was completed and associated boundary timer was canceled, on the new process definition
                  deployment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_STARTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity is starting to execute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiActivityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity is completed successfully</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiActivityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_CANCELLED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity is going to be cancelled. There can be three reasons for activity cancellation (MessageEventSubscriptionEntity, SignalEventSubscriptionEntity, TimerEntity).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiActivityCancelledEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_SIGNALED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity received a signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiSignalEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_MESSAGE_RECEIVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity received a message. Dispatched before the activity receives the message. When received, a <code>ACTIVITY_SIGNAL</code> or <code>ACTIVITY_STARTED</code> will
                be dispatched for this activity, depending on the type (boundary-event or event-subprocess start-event)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiMessageEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_ERROR_RECEIVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity has received an error event. Dispatched before the actual error has been handled by
                 the activity. The event&#8217;s <code>activityId</code> contains a reference to the error-handling activity.
                 This event will be either followed by a <code>ACTIVITY_SIGNALLED</code> event or <code>ACTIVITY_COMPLETE</code>
                  for the involved activity, if the error was delivered successfully.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiErrorEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNCAUGHT_BPMN_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An uncaught BPMN error has been thrown. The process did not have any handlers for that specific error. The event&#8217;s <code>activityId</code> will be empty.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiErrorEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACTIVITY_COMPENSATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An activity is about to be compensated. The event contains the id of the activity that is will be executed for compensation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiActivityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARIABLE_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A variable has been created. The event contains the variable name, value and related execution and task (if any).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiVariableEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARIABLE_UPDATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing variable has been updated. The event contains the variable name, updated value and related execution and task (if any).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiVariableEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARIABLE_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An existing variable has been deleted. The event contains the variable name, last known value and related execution and task (if any).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiVariableEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TASK_ASSIGNED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A task has been assigned to a user. The event contains the task</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TASK_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A task has been created. This is dispatched after the <code>ENTITY_CREATE</code> event. In case the task is part of a process, this event will be
                  fired before the task listeners are executed.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TASK_COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A task has been completed. This is dispatched before the <code>ENTITY_DELETE</code> event. In case the task is part of a process, this event will be
                fired before the process has moved on and will be followed by a <code>ACTIVITY_COMPLETE</code> event, targeting the activity that represents the completed task.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROCESS_COMPLETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A process has been completed. Dispatched after the last activity <code>ACTIVITY_COMPLETED </code> event. Process is completed when it reaches state in which process instance does not have
                  any transition to take.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiEntityEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROCESS_CANCELLED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A process has been cancelled. Dispatched before the process instance is deleted from runtime. Process instance is cancelled by API call <code>RuntimeService.deleteProcessInstance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiCancelledEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEMBERSHIP_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user has been added to a group. The event contains the ids of the user and group involved.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiMembershipEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEMBERSHIP_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A user has been removed from a group. The event contains the ids of the user and group involved.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiMembershipEvent</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEMBERSHIPS_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All members will be removed from a group. The event is thrown before the members are removed, so they are still accessible. No individual
                <code>MEMBERSHIP_DELETED</code> events will be thrown if all members are deleted at once, for performance reasons.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.activiti&#8230;&#8203;ActivitiMembershipEvent</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All <code>ENTITY_\*</code> events are related to entities inside the engine. The list below show an overview of what entity-events are dispatched for which entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>ENTITY_CREATED, ENTITY_INITIALIZED, ENTITY_DELETED</code></strong>: Attachment, Comment, Deployment, Execution, Group, IdentityLink, Job, Model, ProcessDefinition, ProcessInstance, Task, User.</p>
</li>
<li>
<p><strong><code>ENTITY_UPDATED</code></strong>: Attachment, Deployment, Execution, Group, IdentityLink, Job, Model, ProcessDefinition, ProcessInstance, Task, User.</p>
</li>
<li>
<p><strong><code>ENTITY_SUSPENDED, ENTITY_ACTIVATED</code></strong>: ProcessDefinition, ProcessInstance/Execution, Task.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="eventDispatcherRemarks">3.17.7. Additional remarks</h4>
<div class="paragraph">
<p><strong>Only listeners are notified in the engine the events are dispatched from.</strong> So in case you have different engines - running against the same database - only events that originated in the engine the listener is registered for, are dispatched to that listener. The events that occur in the other engine are not dispatched to the listeners, regardless of the fact they are running in the same JVM or not.</p>
</div>
<div class="paragraph">
<p>Certain event-types (related to entities) expose the targeted entity. Depending on the type or event, these entities cannot be updated anymore (e.g. when the entity is deleted). If possible, use the <code>EngineServices</code> exposed by the event to interact in a safe way with the engine. Even then, you need to be cautious with updates/operations on entities that are involved in the dispatched event.</p>
</div>
<div class="paragraph">
<p>No entity-events are dispatched related to history, as they all have a runtime-counterpart which have their events dispatched.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapterApi">4. The Flowable API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="apiEngine">4.1. The Process Engine API and services</h3>
<div class="paragraph">
<p>The engine API is the most common way of interacting with Flowable. The central starting point is the <code>ProcessEngine</code>, which can be created in several ways as described in the  <a href="#configuration">configuration section</a>. From the ProcessEngine, you can obtain the various services that contain the workflow/BPM methods.  ProcessEngine and the services objects are thread safe. So you can keep a reference to 1 of those for a whole server.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.services.png" alt="api.services">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">getDefaultProcessEngine</span><span class="tok-o">();</span>

<span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>
<span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRepositoryService</span><span class="tok-o">();</span>
<span class="tok-n">TaskService</span> <span class="tok-n">taskService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getTaskService</span><span class="tok-o">();</span>
<span class="tok-n">ManagementService</span> <span class="tok-n">managementService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getManagementService</span><span class="tok-o">();</span>
<span class="tok-n">IdentityService</span> <span class="tok-n">identityService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getIdentityService</span><span class="tok-o">();</span>
<span class="tok-n">HistoryService</span> <span class="tok-n">historyService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getHistoryService</span><span class="tok-o">();</span>
<span class="tok-n">FormService</span> <span class="tok-n">formService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getFormService</span><span class="tok-o">();</span>
<span class="tok-n">DynamicBpmnService</span> <span class="tok-n">dynamicBpmnService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getDynamicBpmnService</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ProcessEngines.getDefaultProcessEngine()</code> will initialize and build a process engine the first time it is called and afterwards always return the same process engine. Proper creation and closing of all process engines can be done with <code>ProcessEngines.init()</code>  and <code>ProcessEngines.destroy()</code>.</p>
</div>
<div class="paragraph">
<p>The ProcessEngines class will scan for all <code>activiti.cfg.xml</code> and <code>activiti-context.xml</code> files. For all <code>activiti.cfg.xml</code> files, the process engine will be built in the typical Flowable way: <code>ProcessEngineConfiguration.createProcessEngineConfigurationFromInputStream(inputStream).buildProcessEngine()</code>. For all <code>activiti-context.xml</code> files, the process engine will be built in the Spring way: First the Spring application context is created and then the process engine is obtained from that application context.</p>
</div>
<div class="paragraph">
<p>All services are stateless. This means that you can easily run Flowable on multiple nodes in a cluster, each going to the same database, without having to worry about which machine actually executed previous calls. Any call to any service is idempotent regardless of where it is executed.</p>
</div>
<div class="paragraph">
<p>The <strong>RepositoryService</strong> is probably the first service needed when working with the Flowable engine. This service offers operations for managing and manipulating <code>deployments</code> and <code>process definitions</code>. Without going into much detail here, a process definition is a Java counterpart of BPMN 2.0 process. It is a representation of the structure and behaviour of each of the steps of a process. A <code>deployment</code> is the unit of packaging within the Flowable engine. A deployment can contain multiple BPMN 2.0 xml files and any other resource. The choice of what is included in one deployment is up to the developer. It can range from a single process BPMN 2.0 xml file to a whole package of processes and relevant resources (for example the deployment <em>hr-processes</em> could contain everything related to hr processes). The <code>RepositoryService</code> allows to <code>deploy</code> such packages. Deploying a deployment means it is uploaded to the engine, where all processes are inspected and parsed before being stored in the database. From that point on, the deployment is known to the system and any process included in the deployment can now be started.</p>
</div>
<div class="paragraph">
<p>Furthermore, this service allows to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Query on deployments and process definitions known to the engine.</p>
</li>
<li>
<p>Suspend and activate deployments as a whole or specific process definitions. Suspending means no further operations can be done on them, while activation is the opposite operation.</p>
</li>
<li>
<p>Retrieve various resources such as files contained within the deployment or process diagrams that were auto generated by the engine.</p>
</li>
<li>
<p>Retrieve a POJO version of the process definition which can be used to introspect the process using Java rather than xml.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While the <code>RepositoryService</code> is rather about static information (i.e. data that doesn&#8217;t change, or at least not a lot), the <strong>RuntimeService</strong> is quite the opposite. It deals with starting new process instances of process definitions. As said above, a <code>process definition</code> defines the structure and behaviour of the different steps in a process. A process instance is one execution of such a process definition. For each process definition there typically are many instances running at the same time. The <code>RuntimeService</code> also is the service which is used to retrieve and store <code>process variables</code>. This is data which is specific to the given process instance and can be used by various constructs in the process (e.g. an exclusive gateway often uses process variables to determine which path is chosen to continue the process). The <code>Runtimeservice</code> also allows to query on process instances and executions. Executions are a representation of the <code>'token'</code> concept of BPMN 2.0. Basically an execution is a pointer pointing to where the process instance currently is. Lastly, the <code>RuntimeService</code> is used whenever a process instance is waiting for an external trigger and the process needs to be continued. A process instance can have various <code>wait states</code> and this service contains various operations to <em>signal</em> the instance that the external trigger is received and the process instance can be continued.</p>
</div>
<div class="paragraph">
<p>Tasks that need to be performed by actual human users of the system are core to a BPM engine such as Flowable. Everything around tasks is grouped in the <strong>TaskService</strong>, such as</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Querying tasks assigned to users or groups</p>
</li>
<li>
<p>Creating new <em>standalone</em> tasks. These are tasks that are not related to a process instances.</p>
</li>
<li>
<p>Manipulating to which user a task is assigned or which users are in some way involved with the task.</p>
</li>
<li>
<p>Claiming and completing a task. Claiming means that someone decided to be the assignee for the task, meaning that this user will complete the task. Completing means <em>doing the work of the tasks</em>. Typically this is filling in a form of sorts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>IdentityService</strong> is pretty simple. It allows the management (creation, update, deletion, querying, &#8230;&#8203;) of groups and users. It is important to understand that Flowable actually doesn&#8217;t do any checking on users at runtime. For example, a task could be assigned to any user, but the engine does not verify if that user is known to the system. This is because the Flowable engine can also be used in conjunction with services such as LDAP, Active Directory, etc.</p>
</div>
<div class="paragraph">
<p>The <strong>FormService</strong> is an optional service. Meaning that Flowable can perfectly be used without it, without sacrificing any functionality. This service introduces the concept of a <em>start form</em> and a <em>task form</em>. A <em>start form</em> is a form that is shown to the user before the process instance is started, while a <em>task form</em> is the form that is displayed when a user wants to complete a form. Flowable allows to define these forms in the BPMN 2.0 process definition. This service exposes this data in an easy way to work with. But again, this is optional as forms don&#8217;t need to be embedded in the process definition.</p>
</div>
<div class="paragraph">
<p>The <strong>HistoryService</strong> exposes all historical data gathered by the Flowable engine. When executing processes, a lot of data can be kept by the engine (this is configurable) such as process instance start times, who did which tasks, how long it took to complete the tasks, which path was followed in each process instance, etc. This service exposes mainly query  capabilities to access this data.</p>
</div>
<div class="paragraph">
<p>The <strong>ManagementService</strong> is typically not needed when coding custom application using Flowable. It allows to retrieve information about the database tables and table metadata. Furthermore, it exposes query capabilities and management operations for jobs. Jobs are used in Flowable for various things such as timers, asynchronous continuations, delayed suspension/activation, etc. Later on, these topics will be discussed in more detail.</p>
</div>
<div class="paragraph">
<p>The <strong>DynamicBpmnService</strong> can be used to change part of the process definition without needing to redeploy it. You can for example change the assignee definition for a user task in a process definition, or change the class name of a service task.</p>
</div>
<div class="paragraph">
<p>For more detailed information on the service operations and the engine API, see <a href="flowable/index.html">the javadocs</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_exception_strategy">4.2. Exception strategy</h3>
<div class="paragraph">
<p>The base exception in Flowable is the <code>org.activiti.engine.ActivitiException</code>, an unchecked exception. This exception can be thrown at all times by the API, but <em>expected</em> exceptions that happen in specific methods are documented in the <a href="http://www.flowable.org/javadocs/index.html"> the javadocs</a>. For example, an extract from <code>TaskService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * Called when the task is successfully executed.</span>
<span class="tok-cm"> * @param taskId the id of the task to complete, cannot be null.</span>
<span class="tok-cm"> * @throws ActivitiObjectNotFoundException when no task exists with the given id.</span>
<span class="tok-cm"> */</span>
 <span class="tok-kt">void</span> <span class="tok-nf">complete</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">taskId</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, when an id is passed for which no task exists, an exception will be thrown. Also, since the javadoc <strong>explicitly states that taskId cannot be null, an <code>ActivitiIllegalArgumentException</code> will be thrown when <code>null</code> is passed</strong>.</p>
</div>
<div class="paragraph">
<p>Even though we want to avoid a big exception hierarchy, the following subclasses were added which are thrown in specific cases. All other errors that occur during process-execution or API-invocation that don&#8217;t fit into the possible exceptions below, are thrown as regular <code>ActivitiExceptions</code>s.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ActivitiWrongDbException</code>: Thrown when the Flowable engine discovers a mismatch between the database schema version and the engine version.</p>
</li>
<li>
<p><code>ActivitiOptimisticLockingException</code>: Thrown when an optimistic locking occurs in the data store caused by concurrent access of the same data entry.</p>
</li>
<li>
<p><code>ActivitiClassLoadingException</code>: Thrown when a class requested to load was not found or when an error occurred while loading it (e.g. JavaDelegates, TaskListeners, &#8230;&#8203;).</p>
</li>
<li>
<p><code>ActivitiObjectNotFoundException</code>: Thrown when an object that is requested or action on does not exist.</p>
</li>
<li>
<p><code>ActivitiIllegalArgumentException</code>: An exception indicating that an illegal argument has been supplied in a Flowable API-call, an illegal value was configured in the engine&#8217;s configuration or an illegal value has been supplied or an illegal value is used in a process-definition.</p>
</li>
<li>
<p><code>ActivitiTaskAlreadyClaimedException</code>: Thrown when a task is already claimed, when the <code>taskService.claim(&#8230;&#8203;)</code> is called.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="queryAPI">4.3. Query API</h3>
<div class="paragraph">
<p>There are two ways of querying data from the engine: The query API and native queries. The Query API allows to program completely typesafe queries with a fluent API. You can add various conditions to your queries (all of which are applied together as a logical AND) and precisely one ordering. The following code shows an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">processVariableValueEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;orderId&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;0815&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">orderByDueDate</span><span class="tok-o">().</span><span class="tok-na">asc</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes you need more powerful queries, e.g. queries using an OR operator or restrictions you cannot express using the Query API. For these cases, we introduced native queries, which allow you to write your own SQL queries. The return type is defined by the Query object you use and the data is mapped into the correct objects, e.g. Task, ProcessInstance, Execution, etc&#8230;&#8203;. Since the query will be fired at the database you have to use table and column names as they are defined in the database; this requires some knowledge about the internal data structure and it is recommended to use native queries with care. The table names can be retrieved via the API to keep the dependency as small as possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createNativeTaskQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">sql</span><span class="tok-o">(</span><span class="tok-s">&quot;SELECT count(*) FROM &quot;</span> <span class="tok-o">+</span> <span class="tok-n">managementService</span><span class="tok-o">.</span><span class="tok-na">getTableName</span><span class="tok-o">(</span><span class="tok-n">Task</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot; T WHERE T.NAME_ = #{taskName}&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">parameter</span><span class="tok-o">(</span><span class="tok-s">&quot;taskName&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;gonzoTask&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>

<span class="tok-kt">long</span> <span class="tok-n">count</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createNativeTaskQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">sql</span><span class="tok-o">(</span><span class="tok-s">&quot;SELECT count(*) FROM &quot;</span> <span class="tok-o">+</span> <span class="tok-n">managementService</span><span class="tok-o">.</span><span class="tok-na">getTableName</span><span class="tok-o">(</span><span class="tok-n">Task</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot; T1, &quot;</span>
    <span class="tok-o">+</span> <span class="tok-n">managementService</span><span class="tok-o">.</span><span class="tok-na">getTableName</span><span class="tok-o">(</span><span class="tok-n">VariableInstanceEntity</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span> <span class="tok-o">+</span> <span class="tok-s">&quot; V1 WHERE V1.TASK_ID_ = T1.ID_&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">count</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="apiVariables">4.4. Variables</h3>
<div class="paragraph">
<p>Every process instance needs and uses data to execute the steps it exists of. In Flowable, this data is called <em>variables</em>, which are stored in the database. Variables can be used in expressions (for example to select the correct outgoing sequence flow in an exclusive gateway), in java service tasks when calling external services (for example to provide the input or store the result of the service call), etc.</p>
</div>
<div class="paragraph">
<p>A process instance can have variables (called <em>process variables</em>), but also <em>executions</em> (which are specific pointers to where the process is active) and user tasks can have variables. A process instance can have any number of variables. Each variable is stored in a row in the <em>ACT_RU_VARIABLE</em> database table.</p>
</div>
<div class="paragraph">
<p>Any of the <em>startProcessInstanceXXX</em> methods have an optional parameters to provide the variables when the process instance is created and started. For example, from the <em>RuntimeService</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">processDefinitionKey</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Variables can be added during process execution. For example (<em>RuntimeService</em>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-kt">void</span> <span class="tok-nf">setVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">value</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setVariableLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">value</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setVariables</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-o">?</span> <span class="tok-kd">extends</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setVariablesLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-o">?</span> <span class="tok-kd">extends</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that variables can be set <em>local</em> for a given execution (remember a process instance consists of a tree of executions). The variable will only be visible on that execution, and not higher in the tree of executions. This can be useful if data shouldn&#8217;t be propagated to the process instance level, or the variable has a new value for a certain path in the process instance (for example when using parallel paths).</p>
</div>
<div class="paragraph">
<p>Variables can also be fetched again, as shown below. Note that similar methods exist on the <em>TaskService</em>. This means that tasks, like executions, can have local variables that are <em>alive</em> just for the duration of the task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getVariables</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">);</span>
<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getVariablesLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">);</span>
<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getVariables</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">Collection</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">variableNames</span><span class="tok-o">);</span>
<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getVariablesLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">Collection</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">variableNames</span><span class="tok-o">);</span>
<span class="tok-n">Object</span> <span class="tok-nf">getVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>
<span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-o">&gt;</span> <span class="tok-n">T</span> <span class="tok-nf">getVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Class</span><span class="tok-o">&lt;</span><span class="tok-n">T</span><span class="tok-o">&gt;</span> <span class="tok-n">variableClass</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Variables are often used in <a href="#bpmnJavaServiceTask">Java delegates</a>, <a href="#apiExpressions">expressions</a>, execution- or tasklisteners, scripts, etc. In those constructs, the current <em>execution</em> or <em>task</em> object is available and it can be used for variable setting and/or retrieval. The simplest methods are these:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariables</span><span class="tok-o">();</span>
<span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariables</span><span class="tok-o">(</span><span class="tok-n">Collection</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">variableNames</span><span class="tok-o">);</span>
<span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>

<span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariables</span><span class="tok-o">(</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
<span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">value</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a variant with <em>local</em> is also available for all of the above.</p>
</div>
<div class="paragraph">
<p>For historical (and backwards compatible reasons), when doing any of the calls above, behind the scenes actually <strong>all</strong> variables will be fetched from the database. This means that if you have 10 variables, and only get one through <em>getVariable("myVariable")</em>, behind the scenes the other 9 will be fetched and cached. This is not bad, as subsequent calls will not hit the database again.  For example, when your process definition has three sequential service tasks (and thus one database transaction), using one call to fetch all variables in the first service task might be better then fetching the variables needed in each service task separately. Note that this applies <strong>both</strong> for getting and setting variables.</p>
</div>
<div class="paragraph">
<p>Of course, when using a lot of variables or simply when you want tight control on the database query and traffic, this is not appropriate. Additional methods have been introduced to give a tighter control on this, by adding in new methods that have an optional parameter that tells the engine whether or not behind the scenes all variables need to be fetched and cached:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getVariables</span><span class="tok-o">(</span><span class="tok-n">Collection</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">variableNames</span><span class="tok-o">,</span> <span class="tok-kt">boolean</span> <span class="tok-n">fetchAllVariables</span><span class="tok-o">);</span>
<span class="tok-n">Object</span> <span class="tok-nf">getVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-kt">boolean</span> <span class="tok-n">fetchAllVariables</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">value</span><span class="tok-o">,</span> <span class="tok-kt">boolean</span> <span class="tok-n">fetchAllVariables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When using <em>true</em> for the parameter <em>fetchAllVariables</em>, the behaviour will be exactly as described above: when getting or setting a variable, all other variables will be fetched and cached.</p>
</div>
<div class="paragraph">
<p>However, when using <em>false</em> as value, a specific query will be used and no other variables will be fetched nor cached. Only the value of the variable in question here will be cached for subsequent use.</p>
</div>
</div>
<div class="sect2">
<h3 id="apiTransientVariables">4.5. Transient variables</h3>
<div class="paragraph">
<p>Transient variables are variables that behave like regular variables, but are not persisted. Typically, transient variables are used for advanced use cases (i.e. when in doubt, use a regular process variable).</p>
</div>
<div class="paragraph">
<p>The following applies for transient variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There is no history stored at all for transient variables.</p>
</li>
<li>
<p>Like <em>regular</em> variables, transient variables are put on the <em>highest parent</em> when set. This means that when setting a variable on an execution, the transient variable is actually stored on the process instance execution. Like regular variables, a <em>local</em> variant of the method exists if the variable should be set on the specific execution or task.</p>
</li>
<li>
<p>A transient variable can only be accessed until the next <em>wait state</em> in the process definition. After that, they are gone. The wait state means here the point in the process instance where it is persisted to the data store. Note that an <em>async</em> activity also is a <em>wait state</em> in this definition!</p>
</li>
<li>
<p>Transient variables can only be set by the <em>setTransientVariable(name, value)</em>, but transient variables are also returned when calling <em>getVariable(name)</em> (a <em>getTransientVariable(name)</em> also exists, that only checks the transient variables). The reason for this is to make the writing of expressions easy and existing logic using variables works for both types.</p>
</li>
<li>
<p>A transient variable <em>shadows</em> a persistent variable with the same name. This means that when both a persistent and transient variable is set on a process instance and the <em>getVariable("someVariable")</em> is used, the transient variable value will be returned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Transient variables can be got and/or set in most places where regular variables are exposed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On <em>DelegateExecution</em> in <em>JavaDelegate</em> implementations</p>
</li>
<li>
<p>On <em>DelegateExecution</em> in <em>ExecutionListener</em> implementations and on <em>DelegateTask</em> on <em>TaskListener</em> implementations</p>
</li>
<li>
<p>In script task via the <em>execution</em> object</p>
</li>
<li>
<p>When starting a process instance via the runtime service</p>
</li>
<li>
<p>When completing a task</p>
</li>
<li>
<p>When calling the <em>runtimeService.trigger</em> method</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The methods follow the naming convention of the regular process variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kt">void</span> <span class="tok-nf">setTransientVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">variableValue</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setTransientVariableLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">,</span> <span class="tok-n">Object</span> <span class="tok-n">variableValue</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setTransientVariables</span><span class="tok-o">(</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">transientVariables</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">setTransientVariablesLocal</span><span class="tok-o">(</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">transientVariables</span><span class="tok-o">);</span>

<span class="tok-n">Object</span> <span class="tok-nf">getTransientVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>
<span class="tok-n">Object</span> <span class="tok-nf">getTransientVariableLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>

<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTransientVariables</span><span class="tok-o">();</span>
<span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTransientVariablesLocal</span><span class="tok-o">();</span>

<span class="tok-kt">void</span> <span class="tok-nf">removeTransientVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">removeTransientVariableLocal</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Following BPMN diagram shows a typical example:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.transient.variable.example.png" alt="api.transient.variable.example">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s assume the <em>Fetch Data</em> service task calls some remote service (for example using REST). Let&#8217;s also assume some config parameters are needed and need to be provided when starting the process instance. Also, these config parameters are not important for historical audit purposes, so we pass them as transient variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceBuilder</span><span class="tok-o">()</span>
       <span class="tok-o">.</span><span class="tok-na">processDefinitionKey</span><span class="tok-o">(</span><span class="tok-s">&quot;someKey&quot;</span><span class="tok-o">)</span>
       <span class="tok-o">.</span><span class="tok-na">transientVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;configParam01&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;A&quot;</span><span class="tok-o">)</span>
       <span class="tok-o">.</span><span class="tok-na">transientVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;configParam02&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;B&quot;</span><span class="tok-o">)</span>
       <span class="tok-o">.</span><span class="tok-na">transientVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;configParam03&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;C&quot;</span><span class="tok-o">)</span>
       <span class="tok-o">.</span><span class="tok-na">start</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the variables will be available until the user task is reached and persisted to the database. For example, in the <em>Additional Work</em> user task they are not available anymore. Also note that if <em>Fetch Data</em> would have been asynchronous, they won&#8217;t be available after that step too.</p>
</div>
<div class="paragraph">
<p>The <em>Fetch Data</em> (simplified) could be something like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">class</span> <span class="tok-nc">FetchDataServiceTask</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">configParam01</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">)</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-n">configParam01</span><span class="tok-o">);</span>
    <span class="tok-c1">// ...</span>

    <span class="tok-n">RestReponse</span> <span class="tok-n">restResponse</span> <span class="tok-o">=</span> <span class="tok-n">executeRestCall</span><span class="tok-o">();</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setTransientVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;response&quot;</span><span class="tok-o">,</span> <span class="tok-n">restResponse</span><span class="tok-o">.</span><span class="tok-na">getBody</span><span class="tok-o">());</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setTransientVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;status&quot;</span><span class="tok-o">,</span> <span class="tok-n">restResponse</span><span class="tok-o">.</span><span class="tok-na">getStatus</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>Process Data</em> would get the response transient variable, parse it and store the relevant data in real process variables as we need them later.</p>
</div>
<div class="paragraph">
<p>The condition on the sequence flow leaving the exclusive gateway are oblivious to whether persistent or transient variables are used (in this case the <em>status</em> transient variable):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${status == 200}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="apiExpressions">4.6. Expressions</h3>
<div class="paragraph">
<p>Flowable uses UEL for expression-resolving. UEL stands for <em>Unified Expression Language</em> and is part of the EE6 specification (see <a href="http://docs.oracle.com/javaee/6/tutorial/doc/gjddd.html"> the EE6 specification</a> for detailed information). To support all features of latest UEL spec on ALL environments, we use a modified version of JUEL.</p>
</div>
<div class="paragraph">
<p>Expressions can be used in for example <a href="#bpmnJavaServiceTaskXML">Java Service tasks</a>, <a href="#executionListeners">Execution Listeners</a>, <a href="#taskListeners">Task Listeners</a> and <a href="#conditionalSequenceFlowXml">Conditional sequence flows</a>. Although there are 2 types of expressions, value-expression and method-expression, Flowable abstracts  this so they can both be used where an <code>expression</code> is needed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Value expression</strong>: resolves to a value. By default, all process variables are available to use. Also all spring-beans (if using Spring) are available to use in expressions. Some examples:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>${myVar}
${myBean.myProperty}</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Method expression</strong>: invokes a method, with or without parameters. <strong>When invoking a method without parameters, be sure to add empty parentheses after the method-name (as this distinguishes the expression from a value expression).</strong> The passed parameters can be literal values or expressions that are resolved themselves. Examples:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>${printer.print()}
${myBean.addNewOrder('orderName')}
${myBean.doSomething(myVar, execution)}</pre>
</div>
</div>
<div class="paragraph">
<p>Note that these expressions support resolving primitives (incl. comparing them), beans, lists, arrays and maps.</p>
</div>
<div class="paragraph">
<p>On top of all process variables, there are a few default objects available to be used in expressions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>execution</code>: The <code>DelegateExecution</code> that holds additional information about the ongoing execution.</p>
</li>
<li>
<p><code>task</code>: The <code>DelegateTask</code> that holds additional information about the current Task. <strong>Note: Only works in expressions evaluated from task listeners.</strong></p>
</li>
<li>
<p><code>authenticatedUserId</code>: The id of the user that is currently authenticated. If no user is authenticated, the variable is not available.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more concrete usage and examples, check out <a href="#springExpressions">Expressions in Spring</a>, <a href="#bpmnJavaServiceTaskXML">Java Service tasks</a>, <a href="#executionListeners">Execution Listeners</a>,  <a href="#taskListeners">Task Listeners</a> or <a href="#conditionalSequenceFlowXml">Conditional sequence flows</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="apiUnitTesting">4.7. Unit testing</h3>
<div class="paragraph">
<p>Business processes are an integral part of software projects and they should be tested in the same way normal application logic is tested: with unit tests. Since Flowable is an embeddable Java engine, writing unit tests for business processes is as simple as writing regular unit tests.</p>
</div>
<div class="paragraph">
<p>Flowable supports both JUnit versions 3 and 4 styles of unit testing. In the JUnit 3 style, the <code>org.activiti.engine.test.ActivitiTestCase</code> must be extended. This will make the ProcessEngine and the services available through protected member fields. In the <code>setup()</code> of the test,  the processEngine will be initialized by default with the <code>activiti.cfg.xml</code> resource on the classpath.  To specify a different configuration file, override the <em>getConfigurationResource()</em> method. Process engines are cached statically over multiple unit tests when the configuration resource is the same.</p>
</div>
<div class="paragraph">
<p>By extending <code>ActivitiTestCase</code>, you can annotate test methods with <code>org.activiti.engine.test.Deployment</code>. Before the test is run, a resource file of the form <code>testClassName.testMethod.bpmn20.xml</code> in the same package as the test class, will be deployed. At the end of the test, the deployment will be deleted, including all related process instances, tasks, etc. The <code>Deployment</code> annotation also supports setting the resource location explicitly. See the class itself for more information.</p>
</div>
<div class="paragraph">
<p>Taking all that in account, a JUnit 3 style test looks as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyBusinessProcessTest</span> <span class="tok-kd">extends</span> <span class="tok-n">ActivitiTestCase</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Deployment</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">testSimpleProcess</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;simpleProcess&quot;</span><span class="tok-o">);</span>

    <span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;My Task&quot;</span><span class="tok-o">,</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>

    <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the same functionality when using the JUnit 4 style of writing unit tests, the <code>org.activiti.engine.test.ActivitiRule</code> Rule must be used. Through this rule, the process engine and services are available through getters. As with the <code>ActivitiTestCase</code> (see above), including this <code>Rule</code> will enable the use of the <code>org.activiti.engine.test.Deployment</code> annotation (see above for an explanation of its use and configuration) and it will look for the default configuration file on the classpath. Process engines are statically cached over multiple unit tests when using the same configuration resource.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows an example of using the JUnit 4 style of testing and the usage of the <code>ActivitiRule</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyBusinessProcessTest</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Rule</span>
  <span class="tok-kd">public</span> <span class="tok-n">ActivitiRule</span> <span class="tok-n">activitiRule</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ActivitiRule</span><span class="tok-o">();</span>

  <span class="tok-nd">@Test</span>
  <span class="tok-nd">@Deployment</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">ruleUsageExample</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">activitiRule</span><span class="tok-o">.</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>
    <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;ruleUsage&quot;</span><span class="tok-o">);</span>

    <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span> <span class="tok-o">=</span> <span class="tok-n">activitiRule</span><span class="tok-o">.</span><span class="tok-na">getTaskService</span><span class="tok-o">();</span>
    <span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;My Task&quot;</span><span class="tok-o">,</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>

    <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="apiDebuggingUnitTest">4.8. Debugging unit tests</h3>
<div class="paragraph">
<p>When using the in-memory H2 database for unit tests, the following instructions allow to easily inspect the data in the Flowable database during a debugging session. The screenshots here are taken in Eclipse, but the mechanism should be similar for other IDEs.</p>
</div>
<div class="paragraph">
<p>Suppose we have put a <em>breakpoint</em> somewhere in our unit test. In Eclipse this is done by double-clicking in the left border next to the code:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.breakpoint.png" alt="api.test.debug.breakpoint">
</div>
</div>
<div class="paragraph">
<p>If we now run the unit test in <em>debug</em> mode (right-click in test class, select <em>Run as</em> and then <em>JUnit test</em>), the test execution halts at our breakpoint, where we can now inspect the variables of our test as shown in the right upper panel.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.view.png" alt="api.test.debug.view">
</div>
</div>
<div class="paragraph">
<p>To inspect the Flowable data, open up the <em>'Display'</em> window (if this window isn&#8217;t there, open Window&#8594;Show View&#8594;Other and select <em>Display</em>.) and type (code completion is available) <code>org.h2.tools.Server.createWebServer("-web").start()</code></p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.start.h2.server.png" alt="api.test.debug.start.h2.server">
</div>
</div>
<div class="paragraph">
<p>Select the line you&#8217;ve just typed and right-click on it. Now select <em>Display</em> (or execute the shortcut instead of right-clicking)</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.start.h2.server.2.png" alt="api.test.debug.start.h2.server.2">
</div>
</div>
<div class="paragraph">
<p>Now open up a browser and go to <a href="http://localhost:8082"><a href="http://localhost:8082" class="bare">http://localhost:8082</a></a>, and fill in the JDBC URL to the in-memory database (by default this is <code>jdbc:h2:mem:activiti</code>), and hit the connect button.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.h2.login.png" alt="api.test.debug.h2.login">
</div>
</div>
<div class="paragraph">
<p>You can now see the Flowable data and use it to understand how and why your unit test is executing your process in a certain way.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/api.test.debug.h2.tables.png" alt="api.test.debug.h2.tables">
</div>
</div>
</div>
<div class="sect2">
<h3 id="apiProcessEngineInWebApp">4.9. The process engine in a web application</h3>
<div class="paragraph">
<p>The <code>ProcessEngine</code> is a thread-safe class and can easily be shared among multiple threads. In a web application, this means it is possible to create the process engine once when the container boots and shut down the engine when the container goes down.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how you can write a simple <code>ServletContextListener</code> to initialize and destroy process engines in a plain Servlet environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ProcessEnginesServletContextListener</span> <span class="tok-kd">implements</span> <span class="tok-n">ServletContextListener</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">contextInitialized</span><span class="tok-o">(</span><span class="tok-n">ServletContextEvent</span> <span class="tok-n">servletContextEvent</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">init</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">contextDestroyed</span><span class="tok-o">(</span><span class="tok-n">ServletContextEvent</span> <span class="tok-n">servletContextEvent</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">destroy</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>contextInitialized</code> method will delegate to <code>ProcessEngines.init()</code>. That will look for <code>activiti.cfg.xml</code> resource files on the classpath, and create a <code>ProcessEngine</code> for the given configurations (e.g. multiple jars with a configuration file). If you have multiple such resource files on the classpath, make sure they all have different names. When the process engine is needed, it can be fetched using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">getDefaultProcessEngine</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessEngines</span><span class="tok-o">.</span><span class="tok-na">getProcessEngine</span><span class="tok-o">(</span><span class="tok-s">&quot;myName&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course, it is also possible to use any of the variants of creating a process engine,
as described in the <a href="#configuration">configuration section</a>.</p>
</div>
<div class="paragraph">
<p>The <code>contextDestroyed</code> method of the context-listener delegates to <code>ProcessEngines.destroy()</code>. That will properly close all initialized process engines.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="springintegration">5. Spring integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While you can definitely use Flowable without Spring, we&#8217;ve provided some very nice integration features that are explained in this chapter.</p>
</div>
<div class="sect2">
<h3 id="_processenginefactorybean">5.1. ProcessEngineFactoryBean</h3>
<div class="paragraph">
<p>The <code>ProcessEngine</code> can be configured as a regular Spring bean. The starting point of the integration is the class <code>org.activiti.spring.ProcessEngineFactoryBean</code>. That bean takes a process engine configuration and creates the process engine.  This means that the creation and configuration of properties for Spring is the same as documented in the <a href="#configuration">configuration section</a>. For Spring integration the configuration and engine beans will look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
    ...
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.ProcessEngineFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>processEngineConfiguration</code> bean now uses the <code>org.activiti.spring.SpringProcessEngineConfiguration</code> class.</p>
</div>
</div>
<div class="sect2">
<h3 id="_transactions">5.2. Transactions</h3>
<div class="paragraph">
<p>We&#8217;ll explain the <code>SpringTransactionIntegrationTest</code> found in the Spring examples of the distribution step by step.   Below is the Spring configuration file that we use in this example  (you can find it in SpringTransactionIntegrationTest-context.xml). The section shown below  contains the dataSource, transactionManager, processEngine and the Flowable Engine services.</p>
</div>
<div class="paragraph">
<p>When passing the DataSource to the <code>SpringProcessEngineConfiguration</code> (using property "dataSource"), Flowable uses a <code>org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy</code> internally, which wraps the passed DataSource. This is done to make sure the SQL connections retrieved from the DataSource and the Spring transactions play well together. This implies that it&#8217;s no longer needed to proxy the dataSource yourself in Spring configuration, although it&#8217;s still allowed to pass a <code>TransactionAwareDataSourceProxy</code> into the <code>SpringProcessEngineConfiguration</code>. In this case no additional wrapping will occur.</p>
</div>
<div class="paragraph">
<p><strong>Make sure when declaring a <code>TransactionAwareDataSourceProxy</code> in Spring configuration yourself, that you don&#8217;t use it for resources that are already aware of Spring-transactions (e.g. DataSourceTransactionManager and JPATransactionManager need the un-proxied dataSource).</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</div></td><td class="code"><span></span><span class="tok-nt">&lt;beans</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans&quot;</span>
       <span class="tok-na">xmlns:context=</span><span class="tok-s">&quot;http://www.springframework.org/schema/context&quot;</span>
       <span class="tok-na">xmlns:tx=</span><span class="tok-s">&quot;http://www.springframework.org/schema/tx&quot;</span>
       <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
       <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans.xsd</span>
<span class="tok-s">                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd</span>
<span class="tok-s">                           http://www.springframework.org/schema/tx      http://www.springframework.org/schema/tx/spring-tx-3.0.xsd&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.jdbc.datasource.SimpleDriverDataSource&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;driverClass&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;org.h2.Driver&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;url&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc:h2:mem:activiti;DB_CLOSE_DELAY=1000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;username&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;sa&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;password&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;asyncExecutorActivate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.ProcessEngineFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;repositoryService&quot;</span> <span class="tok-na">factory-bean=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">factory-method=</span><span class="tok-s">&quot;getRepositoryService&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;runtimeService&quot;</span> <span class="tok-na">factory-bean=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">factory-method=</span><span class="tok-s">&quot;getRuntimeService&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;taskService&quot;</span> <span class="tok-na">factory-bean=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">factory-method=</span><span class="tok-s">&quot;getTaskService&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;historyService&quot;</span> <span class="tok-na">factory-bean=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">factory-method=</span><span class="tok-s">&quot;getHistoryService&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;managementService&quot;</span> <span class="tok-na">factory-bean=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">factory-method=</span><span class="tok-s">&quot;getManagementService&quot;</span> <span class="tok-nt">/&gt;</span>

...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The remainder of that Spring configuration file contains the beans and configuration that we&#8217;ll use in this particular example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;beans&gt;</span>
  ...
  <span class="tok-nt">&lt;tx:annotation-driven</span> <span class="tok-na">transaction-manager=</span><span class="tok-s">&quot;transactionManager&quot;</span><span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;userBean&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.test.UserBean&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;runtimeService&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;runtimeService&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/bean&gt;</span>

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;printer&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.test.Printer&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>First the application context is created with any of the Spring ways to do that. In this  example you could use a classpath XML resource to configure our Spring application context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-n">ClassPathXmlApplicationContext</span> <span class="tok-n">applicationContext</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ClassPathXmlApplicationContext</span><span class="tok-o">(</span>
	<span class="tok-s">&quot;org/activiti/examples/spring/SpringTransactionIntegrationTest-context.xml&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or since it is a test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nd">@ContextConfiguration</span><span class="tok-o">(</span><span class="tok-s">&quot;classpath:org/activiti/spring/test/transaction/SpringTransactionIntegrationTest-context.xml&quot;</span><span class="tok-o">)</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we can get the service beans and invoke methods on them.  The ProcessEngineFactoryBean will have  added an extra interceptor to the services that applies Propagation.REQUIRED transaction semantics on  the Flowable service methods.  So, for example, we can use the repositoryService to deploy a process like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span> <span class="tok-o">=</span>
  <span class="tok-o">(</span><span class="tok-n">RepositoryService</span><span class="tok-o">)</span> <span class="tok-n">applicationContext</span><span class="tok-o">.</span><span class="tok-na">getBean</span><span class="tok-o">(</span><span class="tok-s">&quot;repositoryService&quot;</span><span class="tok-o">);</span>
<span class="tok-n">String</span> <span class="tok-n">deploymentId</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span>
  <span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;org/activiti/spring/test/hello.bpmn20.xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The other way around also works.  In this case, the Spring transaction will  be around the userBean.hello() method and the Flowable service method invocation will join that  same transaction.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-n">UserBean</span> <span class="tok-n">userBean</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">UserBean</span><span class="tok-o">)</span> <span class="tok-n">applicationContext</span><span class="tok-o">.</span><span class="tok-na">getBean</span><span class="tok-o">(</span><span class="tok-s">&quot;userBean&quot;</span><span class="tok-o">);</span>
<span class="tok-n">userBean</span><span class="tok-o">.</span><span class="tok-na">hello</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The UserBean looks like this.  Remember from above in the Spring bean configuration we injected the  repositoryService into the userBean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">UserBean</span> <span class="tok-o">{</span>

  <span class="tok-cm">/** injected by Spring */</span>
  <span class="tok-kd">private</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>

  <span class="tok-nd">@Transactional</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">hello</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-c1">// here you can do transactional stuff in your domain model</span>
    <span class="tok-c1">// and it will be combined in the same transaction as</span>
    <span class="tok-c1">// the startProcessInstanceByKey to the Flowable RuntimeService</span>
    <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;helloProcess&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setRuntimeService</span><span class="tok-o">(</span><span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="springExpressions">5.3. Expressions</h3>
<div class="paragraph">
<p>When using the ProcessEngineFactoryBean, by default, all <a href="#apiExpressions">expressions</a> in the BPMN processes will also <em>see</em> all the Spring beans. It&#8217;s possible to limit the beans you want to expose in expressions or even exposing no beans at all using a map that you can configure.  The example below exposes a single bean (printer), available to use under the key "printer".  <strong>To have NO beans exposed at all, just pass an empty list as <em>beans</em> property on the SpringProcessEngineConfiguration. When no <em>beans</em> property is set, all Spring beans in the context will be available.</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
  ...
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;beans&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;map&gt;</span>
      <span class="tok-nt">&lt;entry</span> <span class="tok-na">key=</span><span class="tok-s">&quot;printer&quot;</span> <span class="tok-na">value-ref=</span><span class="tok-s">&quot;printer&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/map&gt;</span>
  <span class="tok-nt">&lt;/property&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;printer&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.examples.spring.Printer&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the exposed beans can be used in expressions: for example, the SpringTransactionIntegrationTest <code>hello.bpmn20.xml</code> shows how a method on a Spring bean can be invoked using a UEL method expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;definitions&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;helloProcess&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;print&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;print&quot;</span> <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;#{printer.printMessage()}&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;print&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>Printer</code> looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">Printer</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">printMessage</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;hello world&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>And the Spring bean configuration (also shown above) looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;beans&gt;</span>
  ...

  <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;printer&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.examples.spring.Printer&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_automatic_resource_deployment">5.4. Automatic resource deployment</h3>
<div class="paragraph">
<p>Spring integration also has a special feature for deploying resources.  In the process engine configuration, you can specify a set of resources. When the process engine is created, all those resources will be scanned and deployed.  There is filtering in place that prevents duplicate deployments.  Only when the resources actually have changed,  will new deployments be deployed to the Flowable DB. This makes sense in a lot of use case, where the Spring container is rebooted often (e.g. testing).</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
  ...
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;deploymentResources&quot;</span>
    <span class="tok-na">value=</span><span class="tok-s">&quot;classpath*:/org/activiti/spring/test/autodeployment/autodeploy.*.bpmn20.xml&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.ProcessEngineFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the configuration above will group all of the resources matching the filtering into a single deployment to the Flowable engine. The duplicate filtering to prevent re-deployment of unchanged  resources applies to the whole deployment. In some cases, this may not be what you want. For instance, if you deploy a set of process resources this way and only a single
 process definition in those resources has changed, the deployment as a whole will be considered new and all of the process definitions in that deployment will be re-deployed, resulting in new  versions of each of the process definitions, even though only one was actually changed.</p>
</div>
<div class="paragraph">
<p>To be able to customize the way deployments are determined, you can specify an additional property in the <code>SpringProcessEngineConfiguration</code>, <code>deploymentMode</code>. This  property defines the way deployments will be determined from the set of resources that match the filter. There are 3 values that are supported by default for this property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>default</code>: Group all resources into a single deployment and apply duplicate filtering to that deployment. This is the default value and it will be used if you don&#8217;t specify a value.</p>
</li>
<li>
<p><code>single-resource</code>: Create a separate deployment for each individual resource and apply duplicate filtering to that deployment. This is the  value you would use to have each process definition be deployed separately and only create a new process definition version if it has changed.</p>
</li>
<li>
<p><code>resource-parent-folder</code>: Create a separate deployment for resources that share the same parent folder and apply duplicate filtering to that  deployment. This value can be used to create separate deployments for most resources, but still be able to group some by placing them in a shared folder. Here&#8217;s an example of how to specify the <code>single-resource</code> configuration for <code>deploymentMode</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span>
    <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
  ...
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;deploymentResources&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;classpath*:/activiti/*.bpmn&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;deploymentMode&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;single-resource&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to using the values listed above for <code>deploymentMode</code>, you may require customized behavior towards determining deployments. If so,  you can create a subclass of <code>SpringProcessEngineConfiguration</code> and override the <code>getAutoDeploymentStrategy(String deploymentMode)</code> method.  This method determines which deployment strategy is used for a certain value of the <code>deploymentMode</code> configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="springUnitTest">5.5. Unit testing</h3>
<div class="paragraph">
<p>When integrating with Spring, business processes can be tested very easily using the standard <a href="#apiUnitTesting">Flowable testing facilities</a>. The following example shows how a business process is tested in a typical Spring-based unit test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-nd">@RunWith</span><span class="tok-o">(</span><span class="tok-n">SpringJUnit4ClassRunner</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span>
<span class="tok-nd">@ContextConfiguration</span><span class="tok-o">(</span><span class="tok-s">&quot;classpath:org/activiti/spring/test/junit4/springTypicalUsageTest-context.xml&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyBusinessProcessTest</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Autowired</span>
  <span class="tok-kd">private</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>

  <span class="tok-nd">@Autowired</span>
  <span class="tok-kd">private</span> <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span><span class="tok-o">;</span>

  <span class="tok-nd">@Autowired</span>
  <span class="tok-nd">@Rule</span>
  <span class="tok-kd">public</span> <span class="tok-n">ActivitiRule</span> <span class="tok-n">activitiSpringRule</span><span class="tok-o">;</span>

  <span class="tok-nd">@Test</span>
  <span class="tok-nd">@Deployment</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">simpleProcessTest</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;simpleProcess&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;My Task&quot;</span><span class="tok-o">,</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>

    <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>

  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that for this to work, you need to define a <em>org.activiti.engine.test.ActivitiRule</em> bean in the Spring configuration (which is injected by auto-wiring in the example above).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;activitiRule&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.test.ActivitiRule&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;processEngine&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jpa_with_hibernate_4_2_x">5.6. JPA with Hibernate 4.2.x</h3>
<div class="paragraph">
<p>When using Hibernate 4.2.x JPA in service task or listener logic in the Flowable Engine an additional dependency to Spring ORM is needed. This is not needed for Hibernate 4.1.x or lower. The following dependency should be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.springframework<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>spring-orm<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>${org.springframework.version}<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="springSpringBoot">5.7. Spring Boot</h3>
<div class="paragraph">
<p>Spring Boot is an application framework which, according to <a href="http://projects.spring.io/spring-boot/">its website</a>, <em>makes it easy to create stand-alone, production-grade Spring based Applications that can you can "just run". It takes an opinionated view of the Spring platform and third-party libraries so you can get started with minimum fuss. Most Spring Boot applications need very little Spring configuration</em>.</p>
</div>
<div class="paragraph">
<p>For more information on Spring Boot, see <a href="http://projects.spring.io/spring-boot/"><a href="http://projects.spring.io/spring-boot/" class="bare">http://projects.spring.io/spring-boot/</a></a></p>
</div>
<div class="paragraph">
<p>The Spring Boot - Flowable integration is currently experimental. It has been developer together with Spring committers, but it is still early days. We welcome all to try it out and provide feedback.</p>
</div>
<div class="sect3">
<h4 id="_compatibility">5.7.1. Compatibility</h4>
<div class="paragraph">
<p>Spring Boot requires a JDK 7 runtime. Please check the Spring Boot documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_getting_started_2">5.7.2. Getting started</h4>
<div class="paragraph">
<p>Spring Boot is all about convention over configuration. To get started, simply add the <em>spring-boot-starters-basic</em> dependency to your project. For example for Maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>flowable-spring-boot-starter-basic<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>${flowable.version}<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s all that&#8217;s needed. This dependency will transitively add the correct Flowable and Spring dependencies to the classpath. You can now write the Spring Boot application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-kn">import</span> <span class="tok-nn">org.springframework.boot.SpringApplication</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.springframework.context.annotation.ComponentScan</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.springframework.context.annotation.Configuration</span><span class="tok-o">;</span>

<span class="tok-nd">@Configuration</span>
<span class="tok-nd">@ComponentScan</span>
<span class="tok-nd">@EnableAutoConfiguration</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyApplication</span> <span class="tok-o">{</span>

    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">SpringApplication</span><span class="tok-o">.</span><span class="tok-na">run</span><span class="tok-o">(</span><span class="tok-n">MyApplication</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">,</span> <span class="tok-n">args</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Flowable needs a database to store its data. If you would run the code above, it would give you an informative exception message that you need to add a database driver dependency to the classpath. For now, add the H2 database dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>com.h2database<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>h2<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>1.4.183<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The application can now be started. You will see output like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v1.1.6.RELEASE)

MyApplication                            : Starting MyApplication on ...
s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@33cb5951: startup date [Wed Dec 17 15:24:34 CET 2014]; root of context hierarchy
a.s.b.AbstractProcessEngineConfiguration : No process definitions were found using the specified path (classpath:/processes/**.bpmn20.xml).
o.activiti.engine.impl.db.DbSqlSession   : performing create on engine with resource org/activiti/db/create/activiti.h2.create.engine.sql
o.activiti.engine.impl.db.DbSqlSession   : performing create on history with resource org/activiti/db/create/activiti.h2.create.history.sql
o.activiti.engine.impl.db.DbSqlSession   : performing create on identity with resource org/activiti/db/create/activiti.h2.create.identity.sql
o.a.engine.impl.ProcessEngineImpl        : ProcessEngine default created
o.a.e.i.a.DefaultAsyncJobExecutor        : Starting up the default async job executor [org.activiti.spring.SpringAsyncExecutor].
o.a.e.i.a.AcquireTimerJobsRunnable       : {} starting to acquire async jobs due
o.a.e.i.a.AcquireAsyncJobsDueRunnable    : {} starting to acquire async jobs due
o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup
MyApplication                            : Started MyApplication in 2.019 seconds (JVM running for 2.294)</pre>
</div>
</div>
<div class="paragraph">
<p>So by just adding the dependency to the classpath and using the <em>@EnableAutoConfiguration</em> annotation a lot has happened behind the scenes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An in-memory datasource is created automatically (since the H2 driver is on the classpath) and passed to the Flowable process engine configuration</p>
</li>
<li>
<p>A Flowable ProcessEngine bean is created and exposed</p>
</li>
<li>
<p>All the Flowable services are exposed as Spring beans</p>
</li>
<li>
<p>The Spring Job Executor is created</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, any BPMN 2.0 process definition in the <em>processes</em> folder would be automatically deployed. Create a folder <em>processes</em> and add a dummy process definition (named <em>one-task-process.bpmn20.xml</em>) to this folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;definitions</span>
        <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
        <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
        <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;Examples&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;oneTaskProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;The One Task Process&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my task&quot;</span> <span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also add following code lines to test if the deployment actually worked. The <em>CommandLineRunner</em> is a special kind of Spring bean that is executed when the application boots:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</div></td><td class="code"><span></span><span class="tok-nd">@Configuration</span>
<span class="tok-nd">@ComponentScan</span>
<span class="tok-nd">@EnableAutoConfiguration</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyApplication</span> <span class="tok-o">{</span>

    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">SpringApplication</span><span class="tok-o">.</span><span class="tok-na">run</span><span class="tok-o">(</span><span class="tok-n">MyApplication</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">,</span> <span class="tok-n">args</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Bean</span>
    <span class="tok-kd">public</span> <span class="tok-n">CommandLineRunner</span> <span class="tok-nf">init</span><span class="tok-o">(</span><span class="tok-kd">final</span> <span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span><span class="tok-o">,</span>
                                  <span class="tok-kd">final</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">,</span>
                                  <span class="tok-kd">final</span> <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span><span class="tok-o">)</span> <span class="tok-o">{</span>

        <span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-n">CommandLineRunner</span><span class="tok-o">()</span> <span class="tok-o">{</span>
            <span class="tok-nd">@Override</span>
            <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">run</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">...</span> <span class="tok-n">strings</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
                <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Number of process definitions : &quot;</span>
                	<span class="tok-o">+</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createProcessDefinitionQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>
                <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Number of tasks : &quot;</span> <span class="tok-o">+</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>
                <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;oneTaskProcess&quot;</span><span class="tok-o">);</span>
                <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Number of tasks after process start: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">count</span><span class="tok-o">());</span>
            <span class="tok-o">}</span>
        <span class="tok-o">};</span>

    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output will be as expected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Number of process definitions : 1
Number of tasks : 0
Number of tasks after process start : 1</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_database_and_connection_pool">5.7.3. Changing the database and connection pool</h4>
<div class="paragraph">
<p>As stated above, Spring Boot is about convention over configuration. By default, by having only H2 on the classpath, it created an in memory datasource and passed that to the Flowable process engine configuration.</p>
</div>
<div class="paragraph">
<p>To change the datasource, simply override the default by providing a Datasource bean. We&#8217;re using the <em>DataSourceBuilder</em> class here, which is a helper class from Spring Boot. If Tomcat, HikariCP or Commons DBCP are on the classpath one of them will be selected (in that order with Tomcat first). For example, to switch to a MySQL database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nd">@Bean</span>
<span class="tok-kd">public</span> <span class="tok-n">DataSource</span> <span class="tok-nf">database</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">DataSourceBuilder</span><span class="tok-o">.</span><span class="tok-na">create</span><span class="tok-o">()</span>
        <span class="tok-o">.</span><span class="tok-na">url</span><span class="tok-o">(</span><span class="tok-s">&quot;jdbc:mysql://127.0.0.1:3306/flowable-spring-boot?characterEncoding=UTF-8&quot;</span><span class="tok-o">)</span>
        <span class="tok-o">.</span><span class="tok-na">username</span><span class="tok-o">(</span><span class="tok-s">&quot;flowable&quot;</span><span class="tok-o">)</span>
        <span class="tok-o">.</span><span class="tok-na">password</span><span class="tok-o">(</span><span class="tok-s">&quot;flowable&quot;</span><span class="tok-o">)</span>
        <span class="tok-o">.</span><span class="tok-na">driverClassName</span><span class="tok-o">(</span><span class="tok-s">&quot;com.mysql.jdbc.Driver&quot;</span><span class="tok-o">)</span>
        <span class="tok-o">.</span><span class="tok-na">build</span><span class="tok-o">();</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Remove H2 from the Maven dependencies and add the MySQL driver and the Tomcat connection pooling to the classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>mysql<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>5.1.34<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.apache.tomcat<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>tomcat-jdbc<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>8.0.15<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the app is now booted up, you&#8217;ll see it uses MySQL as database (and the Tomcat connection pooling framework):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.activiti.engine.impl.db.DbSqlSession   : performing create on engine with resource org/activiti/db/create/activiti.mysql.create.engine.sql
org.activiti.engine.impl.db.DbSqlSession   : performing create on history with resource org/activiti/db/create/activiti.mysql.create.history.sql
org.activiti.engine.impl.db.DbSqlSession   : performing create on identity with resource org/activiti/db/create/activiti.mysql.create.identity.sql</pre>
</div>
</div>
<div class="paragraph">
<p>When you reboot the application multiple times, you&#8217;ll see the number of tasks go up (the H2 in-memory database does not survive a shutdown, the MySQL does).</p>
</div>
</div>
<div class="sect3">
<h4 id="_rest_support">5.7.4. REST support</h4>
<div class="paragraph">
<p>Often, a REST API is needed on top of the embedded Flowable engine (interacting with the different services in a company). Spring Boot makes this really easy. Add following dependency to the classpath:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.springframework.boot<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>${spring.boot.version}<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Create a new class, a Spring service, and create two methods: one to start our process and one to get a task list for a given assignee. We simply wrap Flowable calls here, but in real-life scenario&#8217;s this obviously will be more complex obviously.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-nd">@Service</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyService</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span><span class="tok-o">;</span>

	<span class="tok-nd">@Transactional</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">startProcess</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;oneTaskProcess&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

	<span class="tok-nd">@Transactional</span>
    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTasks</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">assignee</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-n">assignee</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now create a REST endpoint by annotating a class with <em>@RestController</em>. Here, we simply delegate to the service defined above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</div></td><td class="code"><span></span><span class="tok-nd">@RestController</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyRestController</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">MyService</span> <span class="tok-n">myService</span><span class="tok-o">;</span>

    <span class="tok-nd">@RequestMapping</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;/process&quot;</span><span class="tok-o">,</span> <span class="tok-n">method</span><span class="tok-o">=</span> <span class="tok-n">RequestMethod</span><span class="tok-o">.</span><span class="tok-na">POST</span><span class="tok-o">)</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">startProcessInstance</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-n">myService</span><span class="tok-o">.</span><span class="tok-na">startProcess</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@RequestMapping</span><span class="tok-o">(</span><span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s">&quot;/tasks&quot;</span><span class="tok-o">,</span> <span class="tok-n">method</span><span class="tok-o">=</span> <span class="tok-n">RequestMethod</span><span class="tok-o">.</span><span class="tok-na">GET</span><span class="tok-o">,</span> <span class="tok-n">produces</span><span class="tok-o">=</span><span class="tok-n">MediaType</span><span class="tok-o">.</span><span class="tok-na">APPLICATION_JSON_VALUE</span><span class="tok-o">)</span>
    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">TaskRepresentation</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTasks</span><span class="tok-o">(</span><span class="tok-nd">@RequestParam</span> <span class="tok-n">String</span> <span class="tok-n">assignee</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">myService</span><span class="tok-o">.</span><span class="tok-na">getTasks</span><span class="tok-o">(</span><span class="tok-n">assignee</span><span class="tok-o">);</span>
        <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">TaskRepresentation</span><span class="tok-o">&gt;</span> <span class="tok-n">dtos</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ArrayList</span><span class="tok-o">&lt;</span><span class="tok-n">TaskRepresentation</span><span class="tok-o">&gt;();</span>
        <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">:</span> <span class="tok-n">tasks</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-n">dtos</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">TaskRepresentation</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">()));</span>
        <span class="tok-o">}</span>
        <span class="tok-k">return</span> <span class="tok-n">dtos</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">static</span> <span class="tok-kd">class</span> <span class="tok-nc">TaskRepresentation</span> <span class="tok-o">{</span>

        <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">;</span>
        <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">;</span>

        <span class="tok-kd">public</span> <span class="tok-nf">TaskRepresentation</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">id</span> <span class="tok-o">=</span> <span class="tok-n">id</span><span class="tok-o">;</span>
            <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">name</span> <span class="tok-o">=</span> <span class="tok-n">name</span><span class="tok-o">;</span>
        <span class="tok-o">}</span>

         <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getId</span><span class="tok-o">()</span> <span class="tok-o">{</span>
            <span class="tok-k">return</span> <span class="tok-n">id</span><span class="tok-o">;</span>
        <span class="tok-o">}</span>
        <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setId</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">id</span> <span class="tok-o">=</span> <span class="tok-n">id</span><span class="tok-o">;</span>
        <span class="tok-o">}</span>
        <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
            <span class="tok-k">return</span> <span class="tok-n">name</span><span class="tok-o">;</span>
        <span class="tok-o">}</span>
        <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setName</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">name</span> <span class="tok-o">=</span> <span class="tok-n">name</span><span class="tok-o">;</span>
        <span class="tok-o">}</span>

    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the <em>@Service</em> and the <em>@RestController</em> will be found by the automatic component scan (<em>@ComponentScan</em>) we added to our application class. Run the application class again. We can now interact with the REST API by using for example cURL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl http://localhost:8080/tasks?assignee=kermit
[]

curl -X POST  http://localhost:8080/process
curl http://localhost:8080/tasks?assignee=kermit
[{"id":"10004","name":"my task"}]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jpa_support">5.7.5. JPA support</h4>
<div class="paragraph">
<p>To add in JPA support for Flowable in Spring Boot, add following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>flowable-spring-boot-starter-jpa<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>${flowable.version}<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add in the Spring configuration and beans for using JPA. By default the JPA provider will be Hibernate.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create a simple Entity class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</div></td><td class="code"><span></span><span class="tok-nd">@Entity</span>
<span class="tok-kd">class</span> <span class="tok-nc">Person</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Id</span>
    <span class="tok-nd">@GeneratedValue</span>
    <span class="tok-kd">private</span> <span class="tok-n">Long</span> <span class="tok-n">id</span><span class="tok-o">;</span>

    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">username</span><span class="tok-o">;</span>

    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>

    <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>

    <span class="tok-kd">private</span> <span class="tok-n">Date</span> <span class="tok-n">birthDate</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-nf">Person</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-nf">Person</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">username</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">firstName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">lastName</span><span class="tok-o">,</span> <span class="tok-n">Date</span> <span class="tok-n">birthDate</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">username</span> <span class="tok-o">=</span> <span class="tok-n">username</span><span class="tok-o">;</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">firstName</span> <span class="tok-o">=</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">lastName</span> <span class="tok-o">=</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">birthDate</span> <span class="tok-o">=</span> <span class="tok-n">birthDate</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">Long</span> <span class="tok-nf">getId</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">id</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setId</span><span class="tok-o">(</span><span class="tok-n">Long</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">id</span> <span class="tok-o">=</span> <span class="tok-n">id</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getUsername</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">username</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setUsername</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">username</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">username</span> <span class="tok-o">=</span> <span class="tok-n">username</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getFirstName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setFirstName</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">firstName</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">firstName</span> <span class="tok-o">=</span> <span class="tok-n">firstName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getLastName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setLastName</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">lastName</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">lastName</span> <span class="tok-o">=</span> <span class="tok-n">lastName</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">Date</span> <span class="tok-nf">getBirthDate</span><span class="tok-o">()</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">birthDate</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setBirthDate</span><span class="tok-o">(</span><span class="tok-n">Date</span> <span class="tok-n">birthDate</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">birthDate</span> <span class="tok-o">=</span> <span class="tok-n">birthDate</span><span class="tok-o">;</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, when not using an in-memory database, the tables won&#8217;t be created automatically. Create a file <em>application.properties</em> on the classpath and add following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>spring.jpa.hibernate.ddl-auto=update</pre>
</div>
</div>
<div class="paragraph">
<p>Add following class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">PersonRepository</span> <span class="tok-kd">extends</span> <span class="tok-n">JpaRepository</span><span class="tok-o">&lt;</span><span class="tok-n">Person</span><span class="tok-o">,</span> <span class="tok-n">Long</span><span class="tok-o">&gt;</span> <span class="tok-o">{</span>

    <span class="tok-n">Person</span> <span class="tok-nf">findByUsername</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">username</span><span class="tok-o">);</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a Spring repository, which offers CRUD out of the box. We add the method to find a Person by username. Spring will automagically implement this based on conventions (i.e. the property names used).</p>
</div>
<div class="paragraph">
<p>We now enhance our service further:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by adding <em>@Transactional</em> to the class. Note that by adding the JPA dependency above, the DataSourceTransactionManager which we were using before is now automatically swapped out by a JpaTransactionManager.</p>
</li>
<li>
<p>The <em>startProcess</em> now gets an assignee username in, which is used to look up the Person, and put the Person JPA object as a process variable in the process instance.</p>
</li>
<li>
<p>A method to create Dummy users is added. This is used in the CommandLineRunner to populate the database.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</div></td><td class="code"><span></span><span class="tok-nd">@Service</span>
<span class="tok-nd">@Transactional</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyService</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span><span class="tok-o">;</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">PersonRepository</span> <span class="tok-n">personRepository</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">startProcess</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">assignee</span><span class="tok-o">)</span> <span class="tok-o">{</span>

        <span class="tok-n">Person</span> <span class="tok-n">person</span> <span class="tok-o">=</span> <span class="tok-n">personRepository</span><span class="tok-o">.</span><span class="tok-na">findByUsername</span><span class="tok-o">(</span><span class="tok-n">assignee</span><span class="tok-o">);</span>

        <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
        <span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;person&quot;</span><span class="tok-o">,</span> <span class="tok-n">person</span><span class="tok-o">);</span>
        <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;oneTaskProcess&quot;</span><span class="tok-o">,</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-nf">getTasks</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">assignee</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-n">assignee</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">createDemoUsers</span><span class="tok-o">()</span> <span class="tok-o">{</span>
		 <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">personRepository</span><span class="tok-o">.</span><span class="tok-na">findAll</span><span class="tok-o">().</span><span class="tok-na">size</span><span class="tok-o">()</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-n">personRepository</span><span class="tok-o">.</span><span class="tok-na">save</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Person</span><span class="tok-o">(</span><span class="tok-s">&quot;jbarrez&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Joram&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Barrez&quot;</span><span class="tok-o">,</span> <span class="tok-k">new</span> <span class="tok-n">Date</span><span class="tok-o">()));</span>
            <span class="tok-n">personRepository</span><span class="tok-o">.</span><span class="tok-na">save</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Person</span><span class="tok-o">(</span><span class="tok-s">&quot;trademakers&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Tijs&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Rademakers&quot;</span><span class="tok-o">,</span> <span class="tok-k">new</span> <span class="tok-n">Date</span><span class="tok-o">()));</span>
        <span class="tok-o">}</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The CommandLineRunner now looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nd">@Bean</span>
<span class="tok-kd">public</span> <span class="tok-n">CommandLineRunner</span> <span class="tok-nf">init</span><span class="tok-o">(</span><span class="tok-kd">final</span> <span class="tok-n">MyService</span> <span class="tok-n">myService</span><span class="tok-o">)</span> <span class="tok-o">{</span>

	<span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-n">CommandLineRunner</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    	<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">run</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">...</span> <span class="tok-n">strings</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
        	<span class="tok-n">myService</span><span class="tok-o">.</span><span class="tok-na">createDemoUsers</span><span class="tok-o">();</span>
        <span class="tok-o">}</span>
    <span class="tok-o">};</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The RestController is also slightly changed to incorporate the changes above (only showing new methods) and the HTTP POST now has a body that contains the assignee username:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@RestController
public class MyRestController {

    @Autowired
    private MyService myService;

    @RequestMapping(value="/process", method= RequestMethod.POST)
    public void startProcessInstance(@RequestBody StartProcessRepresentation startProcessRepresentation) {
        myService.startProcess(startProcessRepresentation.getAssignee());
    }

   ...

    static class StartProcessRepresentation {

        private String assignee;

        public String getAssignee() {
            return assignee;
        }

        public void setAssignee(String assignee) {
            this.assignee = assignee;
        }
    }</pre>
</div>
</div>
<div class="paragraph">
<p>And lastly, to try out the Spring-JPA-Flowable integration, we assign the task using the id of the Person JPA object in the process definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my task&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${person.id}&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now start a new process instance, providing the user name in the POST body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl -H "Content-Type: application/json" -d '{"assignee" : "jbarrez"}' http://localhost:8080/process</pre>
</div>
</div>
<div class="paragraph">
<p>And the task list is now fetched using the person id:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>curl http://localhost:8080/tasks?assignee=1

[{"id":"12505","name":"my task"}]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_further_reading">5.7.6. Further Reading</h4>
<div class="paragraph">
<p>Obviously there is a lot about Spring Boot that hasn&#8217;t been touched yet, like very easy JTA integration or building a war file that can be run on major application servers. And there is a lot more to the Spring Boot integration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Actuator support</p>
</li>
<li>
<p>Spring Integration support</p>
</li>
<li>
<p>Rest API integration: boot up the Flowable Rest API embedded within the Spring application</p>
</li>
<li>
<p>Spring Security support</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All these areas are a first version at the moment, but they will evolved in the future further.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chDeployment">6. Deployment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_business_archives">6.1. Business archives</h3>
<div class="paragraph">
<p>To deploy processes, they have to be wrapped in a business archive.  A business archive is the unit of deployment to a Flowable Engine. A business archive is equivalent to a zip file.  It can contain  BPMN 2.0 processes, task forms, rules and any other type of file.  In general, a business archive contains a collection of named resources.</p>
</div>
<div class="paragraph">
<p>When a business archive is deployed, it is scanned for BPMN files with a <code>.bpmn20.xml</code> or <code>.bpmn</code> extension. Each of those will be parsed and may contain multiple process definitions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Java classes present in the business archive <strong>will not be added to the classpath</strong>. All custom classes used in process definitions in the business archive (for example Java service tasks or event listener implementations) should be present on the Flowable Engine classpath in order to run the processes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_deploying_programmatically">6.1.1. Deploying programmatically</h4>
<div class="paragraph">
<p>Deploying a business archive from a zip file can be done like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-n">String</span> <span class="tok-n">barFileName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;path/to/process-one.bar&quot;</span><span class="tok-o">;</span>
<span class="tok-n">ZipInputStream</span> <span class="tok-n">inputStream</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ZipInputStream</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">FileInputStream</span><span class="tok-o">(</span><span class="tok-n">barFileName</span><span class="tok-o">));</span>

<span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">name</span><span class="tok-o">(</span><span class="tok-s">&quot;process-one.bar&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">addZipInputStream</span><span class="tok-o">(</span><span class="tok-n">inputStream</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to build a deployment from individual resources. See the javadocs for more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_external_resources">6.2. External resources</h3>
<div class="paragraph">
<p>Process definitions live in the Flowable database. These process definitions can reference delegation classes when using Service Tasks or execution listeners or Spring beans from the Flowable configuration file. These classes and the Spring configuration file have to be available to all process engines that may execute the process definitions.</p>
</div>
<div class="sect3">
<h4 id="_java_classes">6.2.1. Java classes</h4>
<div class="paragraph">
<p>All custom classes that are used in your process (e.g. JavaDelegates used in Service Tasks or event-listeners, TaskListeners, &#8230;&#8203;) should be present on the engine&#8217;s classpath when an instance of the process is started.</p>
</div>
<div class="paragraph">
<p>During deployment of a business archive however, those classes don&#8217;t have to be present on the classpath. This means that your delegation classes don&#8217;t have to be on the classpath when deploying a new business archive with Ant.</p>
</div>
<div class="paragraph">
<p>When you are using the demo setup and you want to add your custom classes, you should add a jar containing your classes to the flowable-app or flowable-rest webapp lib. Don&#8217;t forget to include the dependencies of your custom classes (if any) as well. Alternatively, you can include your dependencies in the libraries directory of your Tomcat installation, <code>${tomcat.home}/lib</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_using_spring_beans_from_a_process">6.2.2. Using Spring beans from a process</h4>
<div class="paragraph">
<p>When expressions or scripts use Spring beans, those beans have to be available to the engine when executing the process definition. If you are building your own webapp and you configure your process engine in your context as described in <a href="#springintegration">the spring integration section</a>, that is straightforward. But bear in mind that you also should update the Flowable rest webapp with that context if you use it. You can do that by replacing the <code>activiti.cfg.xml</code> in the <code>flowable-rest/lib/activiti-cfg.jar</code> JAR file with an <code>activiti-context.xml</code> file containing your Spring context configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_creating_a_single_app">6.2.3. Creating a single app</h4>
<div class="paragraph">
<p>Instead of making sure that all process engines have all the delegation classes on their classpath and use the right Spring configuration, you may consider including the Flowable rest webapp inside your own webapp so that there is only a single <code>ProcessEngine</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="versioningOfProcessDefinitions">6.3. Versioning of process definitions</h3>
<div class="paragraph">
<p>BPMN doesn&#8217;t have a notion of versioning.  That is actually good because the executable BPMN process file will probably live in a version control system repository (e.g. Subversion, Git or Mercurial) as part of your development project.  Versions of process definitions are created during deployment. During deployment, Flowable will assign a version to the <code>ProcessDefinition</code> before it is stored in the Flowable DB.</p>
</div>
<div class="paragraph">
<p>For each process definition in a business archive the following steps are performed to initialize the properties <code>key</code>, <code>version</code>, <code>name</code> and <code>id</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The process definition <code>id</code> attribute in the XML file is used as the process definition <code>key</code> property.</p>
</li>
<li>
<p>The process definition <code>name</code> attribute in the XML file is used as the process definition <code>name</code> property. If the name attribute is not specified, then id attribute is used as the name.</p>
</li>
<li>
<p>The first time a process with a particular key is deployed, version 1 is assigned.  For all subsequent deployments of process definitions with the same key, the version will be set 1 higher than the maximum currently deployed version. The key property is used to distinguish process definitions.</p>
</li>
<li>
<p>The id property is set to {processDefinitionKey}:{processDefinitionVersion}:{generated-id}, where <code>generated-id</code> is a unique number added to guarantee uniqueness of the process id for the process definition caches in a clustered environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Take for example the following process</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myDefinitions&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My important process&quot;</span> <span class="tok-nt">&gt;</span>
    ...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When deploying this process definition, the process definition in the database will look like this:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">key</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess:1:676</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Suppose we now deploy an updated version of the same process (e.g. changing some user tasks), but the <code>id</code> of the process definition remains the same. The process definition table will now contain the following entries:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">key</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess:1:676</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess:2:870</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When the <code>runtimeService.startProcessInstanceByKey("myProcess")</code> is called, it will now use the process definition with version <code>2</code>, as this is the latest version of the process definition.</p>
</div>
<div class="paragraph">
<p>Should we create a second process, as defined below and deploy this to Flowable, a third row will be added to the table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myNewDefinitions&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myNewProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My important process&quot;</span> <span class="tok-nt">&gt;</span>
    ...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The table will look like this:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">key</th>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess:1:676</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess:2:870</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">myNewProcess:1:1033</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">myNewProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">My important process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note how the key for the new process is different from our first process. Even though the name is the same (we should probably have changed that too), Flowable only considers the <code>id</code> attribute when distinguishing processes. The new process is therefore deployed with version 1.</p>
</div>
</div>
<div class="sect2">
<h3 id="providingProcessDiagram">6.4. Providing a process diagram</h3>
<div class="paragraph">
<p>A process diagram image can be added to a deployment. This image will be stored in the Flowable repository and is accessible through the API. This image is also used to visualize the process in Flowable apps.</p>
</div>
<div class="paragraph">
<p>Suppose we have a process on our classpath, <code>org/activiti/expenseProcess.bpmn20.xml</code> that has a process key <em>expense</em>. The following naming conventions for the process diagram image apply (in this specific order):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an image resource exists in the deployment that has a name of the BPMN 2.0 XML file name concatenated with the process key and an image suffix, this image is used. In our example, this would be <code>org/activiti/expenseProcess.expense.png</code> (or .jpg/gif). In case you have multiple images defined in one BPMN 2.0 XML file, this approach makes most sense. Each diagram image will then have the process key in its file name.</p>
</li>
<li>
<p>If no such image exists, am image resource in the deployment matching the name of the BPMN 2.0 XML file is searched for. In our example this would be <code>org/activiti/expenseProcess.png</code>. Note that this means that <strong>every process definition</strong> defined in the same BPMN 2.0 file has the same process diagram image. In case there is only one process definition in each BPMN 2.0 XML file, this is obviously not a problem.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example when deploying programmatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">name</span><span class="tok-o">(</span><span class="tok-s">&quot;expense-process.bar&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;org/activiti/expenseProcess.bpmn20.xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;org/activiti/expenseProcess.png&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The image resource can be retrieved through the API afterwards:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-n">ProcessDefinition</span> <span class="tok-n">processDefinition</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createProcessDefinitionQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processDefinitionKey</span><span class="tok-o">(</span><span class="tok-s">&quot;expense&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>

<span class="tok-n">String</span> <span class="tok-n">diagramResourceName</span> <span class="tok-o">=</span> <span class="tok-n">processDefinition</span><span class="tok-o">.</span><span class="tok-na">getDiagramResourceName</span><span class="tok-o">();</span>
<span class="tok-n">InputStream</span> <span class="tok-n">imageStream</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">getResourceAsStream</span><span class="tok-o">(</span>
    <span class="tok-n">processDefinition</span><span class="tok-o">.</span><span class="tok-na">getDeploymentId</span><span class="tok-o">(),</span> <span class="tok-n">diagramResourceName</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="generatingProcessDiagram">6.5. Generating a process diagram</h3>
<div class="paragraph">
<p>In case no image is provided in the deployment, as described in the <a href="#providingProcessDiagram">previous section</a>, the Flowable engine will generate a diagram image if the process definition contains the necessary <em>diagram interchange</em> information.</p>
</div>
<div class="paragraph">
<p>The resource can be retrieved in exactly the same way as when <a href="#providingProcessDiagram">an image is provided</a> in the deployment.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/deployment.image.generation.png" alt="deployment.image.generation">
</div>
</div>
<div class="paragraph">
<p>If, for some reason, it is not necessary or wanted to generate a diagram during deployment the <code>isCreateDiagramOnDeploy</code> property can be set on the process engine configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;createDiagramOnDeploy&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>No diagram will be generated now.</p>
</div>
</div>
<div class="sect2">
<h3 id="deploymentCategory">6.6. Category</h3>
<div class="paragraph">
<p>Both deployments and process definitions have user defined categories.  The process definition category is initialized value in attribute in the BPMN file: <code>&lt;definitions &#8230;&#8203; targetNamespace="yourCategory" &#8230;&#8203;</code></p>
</div>
<div class="paragraph">
<p>The deployment category can be specified in the API like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">repositoryService</span>
    <span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">category</span><span class="tok-o">(</span><span class="tok-s">&quot;yourCategory&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">...</span>
    <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bpmn20">7. BPMN 2.0 Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="whatIsBpmn">7.1. What is BPMN?</h3>
<div class="paragraph">
<p>BPMN is a widely accepted and supported standard notation for representing processes <a href="http://www.bpmn.org/">OMG BPMN Standard</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="bpmnDefiningProcess">7.2. Defining a process</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This introduction is written under the assumption you are using the <a href="http://eclipse.org/">Eclipse IDE</a> to create and edit files. Very little of this is specific to Eclipse, however. You can use any other tool you prefer to create XML files containing BPMN 2.0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a new XML file (<em>right-click on any project and select New&#8594;Other&#8594;XML-XML File</em>) and give it a name. Make sure that the file <strong>ends with .bpmn20.xml or .bpmn</strong>, since otherwise the engine won&#8217;t pick up this file for deployment.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/new.bpmn.procdef.png" alt="new.bpmn.procdef">
</div>
</div>
<div class="paragraph">
<p>The root element of the BPMN 2.0 schema is the <code>definitions</code> element. Within this element, multiple process definitions can be defined (although we advise to have only one process definition in each file, since this simplifies maintenance later in the development process). An empty process definition looks as listed below. Note that the minimal <code>definitions</code> element only needs the <code>xmlns</code> and <code>targetNamespace</code> declaration. The <code>targetNamespace</code> can be anything, and is useful for categorizing process definitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;Examples&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My First Process&quot;</span><span class="tok-nt">&gt;</span>
    ..
  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally you can also add the online schema location of the BPMN 2.0 XML schema, as an alternative to the XML catalog configuration in Eclipse.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xsi:schemaLocation=&quot;http://www.omg.org/spec/BPMN/20100524/MODEL
                    http://www.omg.org/spec/BPMN/2.0/20100501/BPMN20.xsd
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>process</code> element has two attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>id</strong>: this attribute is <strong>required</strong> and maps to the <strong>key</strong> property of a Flowable <code>ProcessDefinition</code> object. This <code>id</code> can then be used to start a new process instance of the process definition, through the  <code>startProcessInstanceByKey</code> method on the <code>RuntimeService</code>. This method will always take the <strong>latest deployed version</strong> of the process definition.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;myProcess&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Important to note here is that this is not the same as calling the  <code>startProcessInstanceById</code> method. This method expects the String id  that was generated at deploy time by the Flowable engine, and can be retrieved by calling the <code>processDefinition.getId()</code> method. The format of the generated id is <strong><em>key:version</em></strong>, and the length is <strong>constrained to 64 characters</strong>. If you get an <code>ActivitiException</code> stating that the generated id is too long, limit the text in the <em>key</em> field of the process.</p>
</li>
<li>
<p><strong>name</strong>: this attribute is <strong>optional</strong> and maps to the <em>name</em> property of a <code>ProcessDefinition</code>. The engine itself doesn&#8217;t use this property, so it can be used for displaying a more human-friendly name in a user interface, for example.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>[[10minutetutorial]]</p>
</div>
</div>
<div class="sect2">
<h3 id="_getting_started_10_minute_tutorial">7.3. Getting started: 10 minute tutorial</h3>
<div class="paragraph">
<p>In this section we will cover a (very simple) business process that we will use to introduce some basic Flowable concepts and the Flowable API.</p>
</div>
<div class="sect3">
<h4 id="bpmn10MinuteTutorialPrerequisites">7.3.1. Prerequisites</h4>
<div class="paragraph">
<p>This tutorial assumes that you have the <a href="#demo.setup.one.minute.version">Flowable demo setup running</a>, and that you are using a standalone H2 server. Edit <code>db.properties</code> and set the <code>jdbc.url=jdbc:h2:tcp://localhost/activiti</code>, and then run the standalone server according to <a href="http://www.h2database.com/html/tutorial.html#using_server">H2&#8217;s documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmn10MinuteTutorialGoal">7.3.2. Goal</h4>
<div class="paragraph">
<p>The goal of this tutorial is to learn about Flowable and some basic BPMN 2.0 concepts. The end result will be a simple Java SE program that deploys a process definition, and interacts with this process through the Flowable engine API. We&#8217;ll also touch some of the tooling around Flowable. Of course, what you&#8217;ll learn in this tutorial can also be used when building your own web applications around your business processes.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleUseCase">7.3.3. Use case</h4>
<div class="paragraph">
<p>The use case is straightforward: we have a company, let&#8217;s call it BPMCorp. In BPMCorp, a financial report needs to be written every month for the company shareholders. This is the responsibility of the accountancy department. When the report is finished, one of the members of the upper management needs to approve the document before it is sent to all the shareholders.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleDiagram">7.3.4. Process diagram</h4>
<div class="paragraph">
<p>The business process as described above can be graphically visualized using the   <a href="#flowableDesigner">Flowable Designer</a>. However, for this tutorial we&#8217;ll type the XML ourselves, as we learn the most this way at this point. The graphical BPMN 2.0 notation of our process looks like this:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/financial.report.example.diagram.png" alt="financial.report.example.diagram">
</div>
</div>
<div class="paragraph">
<p>What we see is a <a href="#bpmnNoneStartEvent">none Start Event</a> (circle on the left), followed by two <a href="#bpmnUserTask">User Tasks</a>: <em>'Write monthly financial report'</em> and  <em>'Verify monthly financial report'</em>, ending in a <a href="#bpmnNoneEndEvent">none end event</a> (circle with thick border on the right).</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleXml">7.3.5. XML representation</h4>
<div class="paragraph">
<p>The XML version of this business process (<em>FinancialReportProcess.bpmn20.xml</em>) looks as shown below. It&#8217;s easy to recognize the main elements of our process (click on the links for going to the detailed section of that BPMN 2.0 construct):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#bpmnNoneStartEvent">(none) start event</a> tells us what the <em>entry point</em> to the process is.</p>
</li>
<li>
<p>The <a href="#bpmnUserTask">User Tasks</a> declarations are the representation of the human tasks of our process. Note that the first task is assigned to the <em>accountancy</em> group, while the second task is assigned to the <em>management</em> group. See <a href="#bpmnUserTaskAssignment">the section on user task assignment</a> for more information on how users and groups can be assigned to user tasks.</p>
</li>
<li>
<p>The process ends when the <a href="#bpmnNoneEndEvent">none end event</a> is reached.</p>
</li>
<li>
<p>The elements are connected with each other through <a href="#bpmnSequenceFlow">sequence flows</a>. These sequence flows have a <code>source</code> and <code>target</code>, defining the <em>direction</em> of the sequence flow.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;definitions&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;http://activiti.org/bpmn20&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span><span class="tok-nt">&gt;</span>

	<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;financialReport&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Monthly financial report reminder process&quot;</span><span class="tok-nt">&gt;</span>

	  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>

	  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;writeReportTask&quot;</span> <span class="tok-nt">/&gt;</span>

	  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;writeReportTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Write monthly financial report&quot;</span> <span class="tok-nt">&gt;</span>
	    <span class="tok-nt">&lt;documentation&gt;</span>
	      Write monthly financial report for publication to shareholders.
	    <span class="tok-nt">&lt;/documentation&gt;</span>
	    <span class="tok-nt">&lt;potentialOwner&gt;</span>
	      <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
	        <span class="tok-nt">&lt;formalExpression&gt;</span>accountancy<span class="tok-nt">&lt;/formalExpression&gt;</span>
	      <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
	    <span class="tok-nt">&lt;/potentialOwner&gt;</span>
	  <span class="tok-nt">&lt;/userTask&gt;</span>

	  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;writeReportTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;verifyReportTask&quot;</span> <span class="tok-nt">/&gt;</span>

	  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;verifyReportTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Verify monthly financial report&quot;</span> <span class="tok-nt">&gt;</span>
	    <span class="tok-nt">&lt;documentation&gt;</span>
	      Verify monthly financial report composed by the accountancy department.
	      This financial report is going to be sent to all the company shareholders.
	    <span class="tok-nt">&lt;/documentation&gt;</span>
	    <span class="tok-nt">&lt;potentialOwner&gt;</span>
	      <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
	        <span class="tok-nt">&lt;formalExpression&gt;</span>management<span class="tok-nt">&lt;/formalExpression&gt;</span>
	      <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
	    <span class="tok-nt">&lt;/potentialOwner&gt;</span>
	  <span class="tok-nt">&lt;/userTask&gt;</span>

	  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;verifyReportTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

	  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

	<span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExamplStartProcess">7.3.6. Starting a process instance</h4>
<div class="paragraph">
<p>We have now created the <strong>process definition</strong> of our business process. From such a process definition, we can create <strong>process instances</strong>. In this case, one process instance would match with the creation and verification of a single financial report for a particular month. All the process instances share the same process definition.</p>
</div>
<div class="paragraph">
<p>To be able to create process instances from a given process definition, we must first <strong>deploy</strong> this process definition. Deploying a process definition means two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The process definition will be stored in the persistent datastore that is configured for your Flowable engine. So by deploying our business process, we make sure that the engine will find the process definition after an engine reboot.</p>
</li>
<li>
<p>The BPMN 2.0 process file will be parsed to an in-memory object model that can be manipulated through the Flowable API.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information on deployment can be found <a href="#chDeployment">in the dedicated section on deployment</a>.</p>
</div>
<div class="paragraph">
<p>As described in that section, deployment can happen in several ways. One way is through the API as follows. Note that all interaction with the Flowable engine happens through its <em>services</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">Deployment</span> <span class="tok-n">deployment</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;FinancialReportProcess.bpmn20.xml&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can start a new process instance using  the <code>id</code> we defined in the process definition (see process element in the XML file). Note that this <code>id</code> in Flowable terminology is called the <strong>key</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;financialReport&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a process instance that will first go through the start event. After the start event, it follows all the outgoing sequence flows (only one in this case) and the first task (<em>write monthly financial report</em>) is reached. The Flowable engine will now store a task in the persistent database. At this point, the user or group assignments attached to the task are resolved and also stored in the database. It&#8217;s important to note that the Flowable engine will continue process execution steps until it reaches a <em>wait state</em>, such as the user task. At such a wait state, the current state of the process instance is stored in the database. It remains in that state until a user decides to complete their task. At that point, the engine will continue until it reaches a new wait state or the end of the process. When the engine reboots or crashes in the meantime, the state of the process is safe and well in the database.</p>
</div>
<div class="paragraph">
<p>After the task is created, the <code>startProcessInstanceByKey</code> method will return since the user task activity is a <em>wait state</em>. In this case, the task is assigned to a group, which means that every member of the group is a <strong>candidate</strong> to perform the task.</p>
</div>
<div class="paragraph">
<p>We can now throw this all together and create a simple Java program. Create a new Eclipse project and add the Flowable JARs and dependencies to its classpath  (these can be found in the <em>libs</em> folder of the Flowable distribution). Before we can call the Flowable services, we must first construct a <code>ProcessEngine</code> that gives us access to the services. Here we use the <em>'standalone'</em> configuration, which constructs a <code>ProcessEngine</code> that uses the database also used in the demo setup.</p>
</div>
<div class="paragraph">
<p>You can download the process definition XML <a href="images/FinancialReportProcess.bpmn20.xml">here</a>. This file contains the XML as shown above, but also contains the necessary BPMN  <a href="#generatingProcessDiagram">diagram interchange information</a> to visualize the process in the Flowable tools.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>

  <span class="tok-c1">// Create Flowable process engine</span>
  <span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngineConfiguration</span>
    <span class="tok-o">.</span><span class="tok-na">createStandaloneProcessEngineConfiguration</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>

  <span class="tok-c1">// Get Flowable services</span>
  <span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRepositoryService</span><span class="tok-o">();</span>
  <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>

  <span class="tok-c1">// Deploy the process definition</span>
  <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;FinancialReportProcess.bpmn20.xml&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>

  <span class="tok-c1">// Start a process instance</span>
  <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;financialReport&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleCandidateList">7.3.7. Task lists</h4>
<div class="paragraph">
<p>We can now retrieve this task through the <code>TaskService</code> by adding the following logic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateUser</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the user we pass to this operation needs to be a member of  the <em>accountancy</em> group, since that was declared in the process definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;potentialOwner&gt;</span>
  <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
    <span class="tok-nt">&lt;formalExpression&gt;</span>accountancy<span class="tok-nt">&lt;/formalExpression&gt;</span>
  <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
<span class="tok-nt">&lt;/potentialOwner&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We could also use the task query API to get the same results using the name of the group. We can now add the following logic to our code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-n">TaskService</span> <span class="tok-n">taskService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getTaskService</span><span class="tok-o">();</span>
<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;accountancy&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since we&#8217;ve configured our <code>ProcessEngine</code> to use the same database as the demo setup is using, we can now log into the <a href="http://localhost:8080/flowable-app/">Flowable app</a>. Login as admin and create 2 new users <em>kermit</em> and <em>fozzie</em>, giving kermit admin capabilities.  Then create 2 new organization groups named <em>accountancy</em> and <em>management</em>,  and add fozzie to the new accountancy group. Now login with fozzie, and we will find  that we can start our business process after selecting the <em>Processes</em> page in the <em>Task App</em> and clicking on the <em>'Start a process'</em> link and selecting the <em>'Monthly financial report'</em> process.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.financial.report.example.start.process.png" alt="bpmn.financial.report.example.start.process">
</div>
</div>
<div class="paragraph">
<p>As explained, the process will execute up to the first user task. Since we&#8217;re logged in as kermit, we can see that there is a new candidate task available for him after we&#8217;ve started a process instance. Select the <em>Task App</em> to view this new task.  Note that even if the process was started by someone else, the task would still be visible as a candidate task to everyone in the accountancy group.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.financial.report.example.task.assigned.png" alt="bpmn.financial.report.example.task.assigned">
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleClaimTask">7.3.8. Claiming the task</h4>
<div class="paragraph">
<p>An accountant now needs to <strong>claim the task</strong>. By claiming the task, the specific user will become the <strong>assignee</strong> of the task and the task will disappear from every task list of the other members of the accountancy group. Claiming a task is programmatically done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">claim</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The task is now in the <strong>personal task list of the one that claimed the task</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the Flowable UI App, clicking the <em>claim</em> button will call the same operation. The task will now move to the personal task list of the logged on user. You also see that the assignee of the task changed to the current logged in user.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.financial.report.example.claim.task.png" alt="bpmn.financial.report.example.claim.task">
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleCompleteTask">7.3.9. Completing the task</h4>
<div class="paragraph">
<p>The accountant can now start working on the financial report. Once the report is finished, he can <strong>complete the task</strong>, which means that all work for that task is done.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For the Flowable engine, this is an external signal that the process instance execution must be continued. The task itself is removed from the runtime data. The single outgoing transition out of the task is followed, moving the execution to the second task (<em>'verification of the report'</em>).  The same mechanism as described for the first task will now be used to assign the second task, with the small difference that the task will be assigned to the <em>management</em> group.</p>
</div>
<div class="paragraph">
<p>In the demo setup, completing the task is done by clicking the <em>complete</em> button in the task list. Since Fozzie isn&#8217;t an accountant, we need to log out of the Flowable app and login in as <em>kermit</em> (who is a manager). The second task is now visible in the unassigned task lists.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleEndingProcess">7.3.10. Ending the process</h4>
<div class="paragraph">
<p>The verification task can be retrieved and claimed in exactly the same way as before. Completing this second task will move process execution to the end event, which finishes the process instance. The process instance and all related runtime execution data are removed from the datastore.</p>
</div>
<div class="paragraph">
<p>When you log into Flowable app you can verify this, since no records will be found in the table where the process executions are stored.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.financial.report.example.process.ended.png" alt="bpmn.financial.report.example.process.ended">
</div>
</div>
<div class="paragraph">
<p>Programmatically, you can also verify that the process is ended using the <code>historyService</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">HistoryService</span> <span class="tok-n">historyService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getHistoryService</span><span class="tok-o">();</span>
<span class="tok-n">HistoricProcessInstance</span> <span class="tok-n">historicProcessInstance</span> <span class="tok-o">=</span>
<span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricProcessInstanceQuery</span><span class="tok-o">().</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">procId</span><span class="tok-o">).</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
<span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Process instance end time: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">historicProcessInstance</span><span class="tok-o">.</span><span class="tok-na">getEndTime</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleCode">7.3.11. Code overview</h4>
<div class="paragraph">
<p>Combine all the snippets from previous sections, and you should have something like this (this code takes in account that you probably will have started a few process instances through the Flowable app UI. As such, it always retrieves a list of tasks instead of one task, so it always works):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">TenMinuteTutorial</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kt">void</span> <span class="tok-nf">main</span><span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">[]</span> <span class="tok-n">args</span><span class="tok-o">)</span> <span class="tok-o">{</span>

    <span class="tok-c1">// Create Flowable process engine</span>
    <span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngineConfiguration</span>
      <span class="tok-o">.</span><span class="tok-na">createStandaloneProcessEngineConfiguration</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>

    <span class="tok-c1">// Get Flowable services</span>
    <span class="tok-n">RepositoryService</span> <span class="tok-n">repositoryService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRepositoryService</span><span class="tok-o">();</span>
    <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>

    <span class="tok-c1">// Deploy the process definition</span>
    <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">addClasspathResource</span><span class="tok-o">(</span><span class="tok-s">&quot;FinancialReportProcess.bpmn20.xml&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>

    <span class="tok-c1">// Start a process instance</span>
    <span class="tok-n">String</span> <span class="tok-n">procId</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;financialReport&quot;</span><span class="tok-o">).</span><span class="tok-na">getId</span><span class="tok-o">();</span>

    <span class="tok-c1">// Get the first task</span>
    <span class="tok-n">TaskService</span> <span class="tok-n">taskService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getTaskService</span><span class="tok-o">();</span>
    <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;accountancy&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">:</span> <span class="tok-n">tasks</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Following task is available for accountancy group: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>

      <span class="tok-c1">// claim it</span>
      <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">claim</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-c1">// Verify Fozzie can now retrieve the task</span>
    <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">:</span> <span class="tok-n">tasks</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Task for fozzie: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>

      <span class="tok-c1">// Complete the task</span>
      <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-o">}</span>

    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Number of tasks for fozzie: &quot;</span>
            <span class="tok-o">+</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">).</span><span class="tok-na">count</span><span class="tok-o">());</span>

    <span class="tok-c1">// Retrieve and claim the second task</span>
    <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;management&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">:</span> <span class="tok-n">tasks</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Following task is available for management group: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
      <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">claim</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-c1">// Completing the second task ends the process</span>
    <span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">:</span> <span class="tok-n">tasks</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">complete</span><span class="tok-o">(</span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-o">}</span>

    <span class="tok-c1">// verify that the process is actually finished</span>
    <span class="tok-n">HistoryService</span> <span class="tok-n">historyService</span> <span class="tok-o">=</span> <span class="tok-n">processEngine</span><span class="tok-o">.</span><span class="tok-na">getHistoryService</span><span class="tok-o">();</span>
    <span class="tok-n">HistoricProcessInstance</span> <span class="tok-n">historicProcessInstance</span> <span class="tok-o">=</span>
      <span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricProcessInstanceQuery</span><span class="tok-o">().</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">procId</span><span class="tok-o">).</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
    <span class="tok-n">System</span><span class="tok-o">.</span><span class="tok-na">out</span><span class="tok-o">.</span><span class="tok-na">println</span><span class="tok-o">(</span><span class="tok-s">&quot;Process instance end time: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">historicProcessInstance</span><span class="tok-o">.</span><span class="tok-na">getEndTime</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnFirstExampleFutureEnhancements">7.3.12. Future enhancements</h4>
<div class="paragraph">
<p>It&#8217;s easy to see that this business process is too simple to be usable in reality. However, as you are going through the BPMN 2.0 constructs available in Flowable, you will be able to enhance the business process by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>defining <strong>gateways</strong> that act as decisions. This way, a manager could reject the financial report which would recreate the task for the accountant.</p>
</li>
<li>
<p>declaring and using <strong>variables</strong>, such that we can store or reference the report so that it can be visualized in the form.</p>
</li>
<li>
<p>defining a <strong>service task</strong> at the end of the process that will send the report to every shareholder.</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bpmnConstructs">8. BPMN 2.0 Constructs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter covers the BPMN 20 constructs supported by Flowable as well as custom extensions to the BPMN standard.</p>
</div>
<div class="sect2">
<h3 id="bpmnCustomExtensions">8.1. Custom extensions</h3>
<div class="paragraph">
<p>The BPMN 2.0 standard is a good thing for all parties involved. End-users don&#8217;t suffer from a vendor lock-in that comes by depending on a proprietary solution. Frameworks, and particularly open-source frameworks such as Flowable, can implement a solution that has the same (and often better implemented ;-) features as those of a big vendor.  Due to the BPMN 2.0 standard, the transition from such a big vendor solution towards Flowable is an easy and smooth path.</p>
</div>
<div class="paragraph">
<p>The downside of a standard however, is the fact that it is always the result of many discussions and compromises between different companies (and often visions). As a developer reading the BPMN 2.0 XML of a process definition, sometimes it feels like certain constructs or way to do things are too cumbersome. Since Flowable puts ease of development as a top-priority, we introduced something called the <strong><em>Flowable BPMN extensions</em></strong>. These <em>extensions</em> are new constructs or ways to simplify certain constructs that are not in the BPMN 2.0 specification.</p>
</div>
<div class="paragraph">
<p>Although the BPMN 2.0 specification clearly states that it was made for custom extension, we make sure that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The prerequisite of such a custom extension is that there <strong>always</strong> must be a simple transformation to the <strong>standard way of doing things</strong>. So when you decide to use a custom extension, you don&#8217;t have to be afraid  that there is no way back.</p>
</li>
<li>
<p>When using a custom extension, this is always clearly indicated by giving the new XML element, attribute, etc. the <strong>activiti:</strong> namespace prefix.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So whether you want to use a custom extension or not, is completely up to you. Several factors will influence this decision (graphical editor usage, company policy, etc.). We only provide them since we believe that some points in the standard can be done simpler or more efficient. Feel free to give us (positive and/or negative) feedback on our extensions, or to post new ideas for custom extensions. Who knows, some day your idea might pop up in the specification!</p>
</div>
</div>
<div class="sect2">
<h3 id="bpmnEvents">8.2. Events</h3>
<div class="paragraph">
<p>Events are used to model something that happens during the lifetime process. Events are always visualized as a circle. In BPMN 2.0, there exist two main event categories: <em>catching</em> or <em>throwing</em> event.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Catching:</strong> when process execution arrives in the event, it will wait for a trigger to happen. The type of trigger is defined by the inner icon or the type declaration in the XML. Catching events are visually differentiated from a throwing event by the inner icon that is not filled (i.e. it is white).</p>
</li>
<li>
<p><strong>Throwing:</strong> when process execution arrives in the event, a trigger is fired. The type of trigger is defined by the inner icon or the type declaration in the XML. Throwing events are visually differentiated from a catching event by the inner icon that is filled with black.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="eventDefinitions">8.2.1. Event Definitions</h4>
<div class="paragraph">
<p>Event definitions define the semantics of an event. Without an event definition, an event "does nothing special". For instance a start event without and event definition does not specify what exactly starts the process. If we add an event definition to the start event (like for instance a timer event definition) we declare what "type" of event starts the process (in the case of a timer event definition the fact that a certain point in time is reached).</p>
</div>
</div>
<div class="sect3">
<h4 id="timerEventDefinitions">8.2.2. Timer Event Definitions</h4>
<div class="paragraph">
<p>Timer events are events which are triggered by defined timer. They can be used as <a href="#bpmnTimerStartEvent">start event</a>, <a href="#bpmnIntermediateCatchingEvent">intermediate event</a> or <a href="#bpmnTimerBoundaryEvent">boundary event</a>. The behavior of the time event depends on the business calendar used. Every timer event has a default business calendar, but the business calendar can also be defined on the timer event definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;timerEventDefinition</span> <span class="tok-na">activiti:businessCalendarName=</span><span class="tok-s">&quot;custom&quot;</span><span class="tok-nt">&gt;</span>
    ...
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where businessCalendarName points to business calendar in process engine configuration. When business calendar is omitted default business calendars are used.</p>
</div>
<div class="paragraph">
<p>Timer definition must have exactly one element from the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>timeDate</strong>. This format specifies fixed date in <a href="http://en.wikipedia.org/wiki/ISO_8601#Dates">ISO 8601</a> format, when trigger will be fired. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDate&gt;</span>2011-03-11T12:13:14<span class="tok-nt">&lt;/timeDate&gt;</span>
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>timeDuration</strong>. To specify how long the timer should run before it is fired, a <em>timeDuration</em> can be specified as sub-element of <em>timerEventDefinition</em>. The format used is the <a href="http://en.wikipedia.org/wiki/ISO_8601#Durations">ISO 8601</a> format (as required by the BPMN 2.0 specification). Example (interval lasting 10 days):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDuration&gt;</span>P10D<span class="tok-nt">&lt;/timeDuration&gt;</span>
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>timeCycle</strong>. Specifies repeating interval, which can be useful for starting process periodically, or for sending multiple reminders for overdue user task. Time cycle element can be in two formats. First is the format of recurring time duration, as specified by <a href="http://en.wikipedia.org/wiki/ISO_8601#Repeating_intervals">ISO 8601</a> standard. Example (3 repeating intervals, each lasting 10 hours):</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is also the possibility to specify the <em>endDate</em> as an optional attribute on the <em>timeCycle</em> or either in the end of the time expression as follows: <code>R3/PT10H/${EndDate}</code>.
When the endDate is reached the application will stop creating other jobs for this task.
It accepts as value either static values <a href="http://en.wikipedia.org/wiki/ISO_8601#Dates">ISO 8601</a> standard for example <em>"2015-02-25T16:42:11+00:00"</em> or variables <em>${EndDate}</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeCycle</span> <span class="tok-na">activiti:endDate=</span><span class="tok-s">&quot;2015-02-25T16:42:11+00:00&quot;</span><span class="tok-nt">&gt;</span>R3/PT10H<span class="tok-nt">&lt;/timeCycle&gt;</span>
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeCycle&gt;</span>R3/PT10H/${EndDate}<span class="tok-nt">&lt;/timeCycle&gt;</span>
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If both are specified then the endDate specified as attribute will be used by the system.</p>
</div>
<div class="paragraph">
<p>Currently only the <em>BoundaryTimerEvents</em> and <em>CatchTimerEvent</em> supports <em>EndDate</em> functionality.</p>
</div>
<div class="paragraph">
<p>Additionally, you can specify time cycle using cron expressions, example below shows trigger firing every 5 minutes, starting at full hour:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>0 0/5 * * * ?</pre>
</div>
</div>
<div class="paragraph">
<p>Please see <a href="http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/crontrigger.html">this tutorial</a> for using cron expressions.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The first symbol denotes seconds, not minutes as in normal Unix cron.</p>
</div>
<div class="paragraph">
<p>The recurring time duration is better suited for handling relative timers, which are calculated with respect to some particular point in time (e.g. time when user task was started), while cron expressions can handle absolute timers - which is particularly useful for <a href="#timerStartEventDescription">timer start events</a>.</p>
</div>
<div class="paragraph">
<p>You can use expressions for the timer event definitions, by doing so you can influence the timer definition
based on process variables. The process variables must contain the ISO 8601 (or cron for cycle type) string for appropriate timer type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;escalationTimer&quot;</span> <span class="tok-na">cancelActivity=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;firstLineSupport&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDuration&gt;</span>${duration}<span class="tok-nt">&lt;/timeDuration&gt;</span>
  <span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> timers are only fired when the job or async executor is enabled (i.e. <em>jobExecutorActivate</em> or <em>asyncExecutorActivate</em> needs to be set to <code>true</code> in the <code>activiti.cfg.xml</code>, since the job and async executor are disabled by default).</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnErrorEventDefinition">8.2.3. Error Event Definitions</h4>
<div class="paragraph">
<p><strong>Important note:</strong> a BPMN error is NOT the same as a Java exception. In fact, the two have nothing in common. BPMN error events are a way of modeling <em>business exceptions</em>. Java exceptions are handled in <a href="#serviceTaskExceptionHandling">their own specific way</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myErrorEndEvent&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/endEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnSignalEventDefinition">8.2.4. Signal Event Definitions</h4>
<div class="paragraph">
<p>Signal events are events which reference a named signal. A signal is an event of global scope (broadcast semantics) and is delivered to all active handlers (waiting process instances/catching signal events).</p>
</div>
<div class="paragraph">
<p>A signal event definition is declared using the <code>signalEventDefinition</code> element. The attribute <code>signalRef</code> references a <code>signal</code> element declared as a child element of the <code>definitions</code> root element. The following is an excerpt of a process where a signal event is thrown and caught by intermediate events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions...</span> <span class="tok-nt">&gt;</span>
	<span class="tok-c">&lt;!-- declaration of the signal --&gt;</span>
	<span class="tok-nt">&lt;signal</span> <span class="tok-na">id=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;alert&quot;</span> <span class="tok-nt">/&gt;</span>

	<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;catchSignal&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;throwSignalEvent&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Alert&quot;</span><span class="tok-nt">&gt;</span>
			<span class="tok-c">&lt;!-- signal event definition --&gt;</span>
			<span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
		...
		<span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;catchSignalEvent&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;On Alert&quot;</span><span class="tok-nt">&gt;</span>
			<span class="tok-c">&lt;!-- signal event definition --&gt;</span>
			<span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
		...
	<span class="tok-nt">&lt;/process&gt;</span>
<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>signalEventDefinition</code>s reference the same <code>signal</code> element.</p>
</div>
<div class="sect4">
<h5 id="bpmnSignalEventDefinitionThrow">Throwing a Signal Event</h5>
<div class="paragraph">
<p>A signal can either be thrown by a process instance using a BPMN construct or programmatically using java API. The following methods on the <code>org.activiti.engine.RuntimeService</code> can be used to throw a signal programmatically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-n">RuntimeService</span><span class="tok-o">.</span><span class="tok-na">signalEventReceived</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">signalName</span><span class="tok-o">);</span>
<span class="tok-n">RuntimeService</span><span class="tok-o">.</span><span class="tok-na">signalEventReceived</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">signalName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The difference between <code>signalEventReceived(String signalName);</code> and <code>signalEventReceived(String signalName, String executionId);</code> is that the first method throws the signal globally to all subscribed handlers (broadcast semantics) and the second method delivers the signal to a specific execution only.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSignalEventDefinitionCatch">Catching a Signal Event</h5>
<div class="paragraph">
<p>A signal event can be caught by an intermediate catch signal event or a signal boundary event.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSignalEventDefinitionQuery">Querying for Signal Event subscriptions</h5>
<div class="paragraph">
<p>It is possible to query for all executions which have subscribed to a specific signal event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Execution</span><span class="tok-o">&gt;</span> <span class="tok-n">executions</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createExecutionQuery</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">signalEventSubscriptionName</span><span class="tok-o">(</span><span class="tok-s">&quot;alert&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We could then use the <code>signalEventReceived(String signalName, String executionId)</code> method to deliver the signal to these executions.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSignalEventDefinitionScope">Signal event scope</h5>
<div class="paragraph">
<p>By default, signals are <em>broadcast process engine wide</em>. This means that you can throw a signal event in a process instance, and other process instances with different process definitions can react on the occurrence of this event.</p>
</div>
<div class="paragraph">
<p>However, sometimes it is wanted to react to a signal event only within the <em>same process instance</em>. A use case for example is a synchronization mechanism in the process instance, if two or more activities are mutually exclusive.</p>
</div>
<div class="paragraph">
<p>To restrict the <em>scope</em> of the signal event, add the (non-BPMN 2.0 standard!) <em>scope attribute</em> to the signal event definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;signal</span> <span class="tok-na">id=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;alert&quot;</span> <span class="tok-na">activiti:scope=</span><span class="tok-s">&quot;processInstance&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default value for this is attribute is <em>"global"</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSignalEventDefinitionExample">Signal Event example(s)</h5>
<div class="paragraph">
<p>The following is an example of two separate processes communicating using signals. The first process is started if an insurance policy is updated or changed. After the changes have been reviewed by a human participant, a signal event is thrown, signaling that a policy has changed:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.signal.event.throw.png" alt="bpmn.signal.event.throw">
</div>
</div>
<div class="paragraph">
<p>This event can now be caught by all process instances which are interested. The following is an example of a process subscribing to the event.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.signal.event.catch.png" alt="bpmn.signal.event.catch">
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> it is important to understand that a signal event is broadcast to <strong>all</strong> active handlers. This means in the case of the example given above, that all instances of the process catching the signal would receive the event. In this case this is what we want. However, there are also situations where the broadcast behavior is unintended. Consider the following process:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.signal.event.warning.1.png" alt="bpmn.signal.event.warning.1">
</div>
</div>
<div class="paragraph">
<p>The pattern described in the process above is not supported by BPMN. The idea is that the error thrown while performing the "do something" task  is caught by the boundary error event and would be propagated to the parallel path of execution using the signal throw event and then interrupt the "do something in parallel" task. So far Flowable would perform as expected. The signal would be propagated to the catching boundary event and interrupt the task. <strong>However, due to the broadcast semantics of the signal, it would also be propagated to all other process instances which have subscribed to the signal event.</strong> In this case, this might not be what we want.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> the signal event does not perform any kind of correlation to a specific process instance. On the contrary, it is broadcast to all process instances. If you need to deliver a signal to a specific process instance only, perform correlation manually and use  <code>signalEventReceived(String signalName, String executionId)</code> and the appropriate <a href="#bpmnSignalEventDefinitionQuery">query mechanisms</a>.</p>
</div>
<div class="paragraph">
<p>Flowable does have a way to fix this, by adding the <em>scope</em> attribute to the signal event and set it to <em>processInstance</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnMessageEventDefinition">8.2.5. Message Event Definitions</h4>
<div class="paragraph">
<p>Message events are events which reference a named message. A message has a name and a payload. Unlike a signal, a message event is always directed at a single receiver.</p>
</div>
<div class="paragraph">
<p>A message event definition is declared using the <code>messageEventDefinition</code> element. The attribute <code>messageRef</code> references a <code>message</code> element declared as a child element of the <code>definitions</code> root element. The following is an excerpt of a process where two message events is declared and referenced by a start event and an intermediate catching message event.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;definitions&quot;</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;Examples&quot;</span>
  <span class="tok-na">xmlns:tns=</span><span class="tok-s">&quot;Examples&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;message</span> <span class="tok-na">id=</span><span class="tok-s">&quot;newInvoice&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;newInvoiceMessage&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;message</span> <span class="tok-na">id=</span><span class="tok-s">&quot;payment&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;paymentMessage&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;invoiceProcess&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;messageStart&quot;</span> <span class="tok-nt">&gt;</span>
    	<span class="tok-nt">&lt;messageEventDefinition</span> <span class="tok-na">messageRef=</span><span class="tok-s">&quot;newInvoice&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/startEvent&gt;</span>
    ...
    <span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;paymentEvt&quot;</span> <span class="tok-nt">&gt;</span>
    	<span class="tok-nt">&lt;messageEventDefinition</span> <span class="tok-na">messageRef=</span><span class="tok-s">&quot;payment&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
    ...
  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMessageEventDefinitionThrow">Throwing a Message Event</h5>
<div class="paragraph">
<p>As an embeddable process engine, Flowable is not concerned with actually receiving a message. This would be environment dependent and entail platform-specific activities like connecting to a JMS (Java Messaging Service) Queue/Topic or processing a Webservice or REST request. The reception of messages is therefore something you have to implement as part of the application or infrastructure into which the process engine is embedded.</p>
</div>
<div class="paragraph">
<p>After you have received a message inside your application, you must decide what to do with it. If the message should trigger the start of a new process instance, choose between the following methods offered by the runtime service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">);</span>
<span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">processVariables</span><span class="tok-o">);</span>
<span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">businessKey</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">processVariables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>These methods allow starting a process instance using the referenced message.</p>
</div>
<div class="paragraph">
<p>If the message needs to be received by an existing process instance, you first have to correlate the message to a specific process instance (see next section) and then trigger the continuation of the waiting execution. The runtime service offers the following methods for triggering an execution based on a message event subscription:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-kt">void</span> <span class="tok-nf">messageEventReceived</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">);</span>
<span class="tok-kt">void</span> <span class="tok-nf">messageEventReceived</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">executionId</span><span class="tok-o">,</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">processVariables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMessageEventDefinitionQuery">Querying for Message Event subscriptions</h5>
<div class="ulist">
<ul>
<li>
<p>In the case of a message start event, the message event subscription is associated with a particular <em>process definition</em>. Such message subscriptions can be queried using a <code>ProcessDefinitionQuery</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">ProcessDefinition</span> <span class="tok-n">processDefinition</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createProcessDefinitionQuery</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">messageEventSubscription</span><span class="tok-o">(</span><span class="tok-s">&quot;newCallCenterBooking&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since there can only be one process definition for a specific message subscription, the query always returns zero or one results. If a process definition is updated,
only the newest version of the process definition has a subscription to the message event.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the case of an intermediate catch message event, the message event subscription is associated with a
particular <em>execution</em>. Such message event subscriptions can be queried using a <code>ExecutionQuery</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">Execution</span> <span class="tok-n">execution</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createExecutionQuery</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">messageEventSubscriptionName</span><span class="tok-o">(</span><span class="tok-s">&quot;paymentReceived&quot;</span><span class="tok-o">)</span>
      <span class="tok-o">.</span><span class="tok-na">variableValueEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;orderId&quot;</span><span class="tok-o">,</span> <span class="tok-n">message</span><span class="tok-o">.</span><span class="tok-na">getOrderId</span><span class="tok-o">())</span>
      <span class="tok-o">.</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Such queries are called correlation queries and usually require knowledge about the processes (in this case that there will be at most one process instance for a given orderId).</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMessageEventDefinitionExample">Message Event example(s)</h5>
<div class="paragraph">
<p>The following is an example of a process which can be started using two different messages:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.start.message.event.example.1.png" alt="bpmn.start.message.event.example.1">
</div>
</div>
<div class="paragraph">
<p>This is useful if the process needs alternative ways to react to different start events but eventually continues in a uniform way.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnStartEvents">8.2.6. Start Events</h4>
<div class="paragraph">
<p>A start event indicates where a process starts. The type of start event (process starts on arrival of message, on specific time intervals, etc.), defining <em>how</em> the process is started is shown as a small icon in the visual representation of the event. In the XML representation, the type is given by the declaration of a sub-element.</p>
</div>
<div class="paragraph">
<p>Start events <strong>are always catching</strong>: conceptually the event is (at any time) waiting until a certain trigger happens.</p>
</div>
<div class="paragraph">
<p>In a start event, following Flowable-specific properties can be specified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>initiator</strong>: identifies the variable name in which the authenticated user id will be stored when the process is started.  Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;request&quot;</span> <span class="tok-na">activiti:initiator=</span><span class="tok-s">&quot;initiator&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The authenticated user must be set with the method <code>IdentityService.setAuthenticatedUserId(String)</code> in a try-finally block like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-k">try</span> <span class="tok-o">{</span>
  <span class="tok-n">identityService</span><span class="tok-o">.</span><span class="tok-na">setAuthenticatedUserId</span><span class="tok-o">(</span><span class="tok-s">&quot;bono&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;someProcessKey&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span> <span class="tok-k">finally</span> <span class="tok-o">{</span>
  <span class="tok-n">identityService</span><span class="tok-o">.</span><span class="tok-na">setAuthenticatedUserId</span><span class="tok-o">(</span><span class="tok-kc">null</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This code is baked into the Flowable application.  So it works in combination with <a href="#forms">Forms</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnNoneStartEvent">8.2.7. None Start Event</h4>
<div class="sect4">
<h5 id="noneStartEventDescription">Description</h5>
<div class="paragraph">
<p>A <em>none</em> start event technically means that the trigger for starting the process instance is unspecified. This means that the engine cannot anticipate when the process instance must be started. The none start event is used when the process instance is started through the API by calling one of the <em>startProcessInstanceByXXX</em> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByXXX</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Note:</em> a subprocess always has a none start event.</p>
</div>
</div>
<div class="sect4">
<h5 id="noneStartEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A none start event is visualized as a circle with no inner icon (i.e. no trigger type).</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.none.start.event.png" alt="bpmn.none.start.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="noneStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of a none start event is the normal start event declaration, without any sub-element (other start event types all have a sub-element declaring the type).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my start event&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="noneStartEventCustomExtension">Custom extensions for the none start event</h5>
<div class="paragraph">
<p><strong>formKey</strong>: references to a form template that users have to fill in when starting a new process instance.  More information can be found in <a href="#forms">the forms section</a> Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;request&quot;</span> <span class="tok-na">activiti:formKey=</span><span class="tok-s">&quot;org/activiti/examples/taskforms/request.form&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnTimerStartEvent">8.2.8. Timer Start Event</h4>
<div class="sect4">
<h5 id="timerStartEventDescription">Description</h5>
<div class="paragraph">
<p>A timer start event is used to create process instance at given time. It can be used both for processes which should start only once and for processes that should start in specific time intervals.</p>
</div>
<div class="paragraph">
<p><em>Note:</em> a subprocess cannot have a timer start event.</p>
</div>
<div class="paragraph">
<p><em>Note:</em> a start timer event is scheduled as soon as process is deployed. There is no need to call startProcessInstanceByXXX, although calling start process methods is not restricted and will cause one more starting of the process at the time of startProcessInstanceByXXX Invocation.</p>
</div>
<div class="paragraph">
<p><em>Note:</em> when a new version of a process with a start timer event is deployed, the job corresponding with the previous timer will be removed. The reasoning is that normally it is not wanted to keep automatically starting new process instances of this old version of the process.</p>
</div>
</div>
<div class="sect4">
<h5 id="timerStartEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A none start event is visualized as a circle with clock inner icon.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.clock.start.event.png" alt="bpmn.clock.start.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="timerStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of a timer start event is the normal start event declaration, with timer definition sub-element. Please refer to <a href="#timerEventDefinitions">timer definitions</a> for configuration details.</p>
</div>
<div class="paragraph">
<p>Example: process will start 4 times, in 5 minute intervals, starting on 11th march 2011, 12:13</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeCycle&gt;</span>R4/2011-03-11T12:13/PT5M<span class="tok-nt">&lt;/timeCycle&gt;</span>
<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
<span class="tok-nt">&lt;/startEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Example: process will start once, on selected date</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDate&gt;</span>2011-03-11T12:13:14<span class="tok-nt">&lt;/timeDate&gt;</span>
  <span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
<span class="tok-nt">&lt;/startEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnMessageStartEvent">8.2.9. Message Start Event</h4>
<div class="sect4">
<h5 id="messageStartEventDescription">Description</h5>
<div class="paragraph">
<p>A <a href="#bpmnMessageEventDefinition">message</a> start event can be used to start a process instance using a named message. This effectively allows us to <em>select</em> the right start event from a set of alternative start events using the message name.</p>
</div>
<div class="paragraph">
<p>When <strong>deploying</strong> a process definition with one or more message start events, the following considerations apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The name of the message start event must be unique across a given process definition. A process definition must not have multiple message start events with the same name. Flowable throws an exception upon deployment of a process definition such that two or more message start events reference the same message	of if two or more message start events reference messages with the same message name.</p>
</li>
<li>
<p>The name of the message start event must be unique across all deployed process definitions. Flowable throws an exception upon deployment of a process definition such that one or more message start events reference a message with the same name as a message start event already deployed by a different process definition.</p>
</li>
<li>
<p>Process versioning: Upon deployment of a new version of a process definition, the message subscriptions of the previous version are cancelled. This is also true for message events that are not present in the new version.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <strong>starting</strong> a process instance, a message start event can be triggered using the following methods on the <code>RuntimeService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">);</span>
<span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">processVariables</span><span class="tok-o">);</span>
<span class="tok-n">ProcessInstance</span> <span class="tok-nf">startProcessInstanceByMessage</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">messageName</span><span class="tok-o">,</span> <span class="tok-n">String</span> <span class="tok-n">businessKey</span><span class="tok-o">,</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&lt;</span> <span class="tok-n">processVariables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>messageName</code> is the name given in the <code>name</code> attribute of the <code>message</code> element referenced by the <code>messageRef</code> attribute of the <code>messageEventDefinition</code>. The following considerations apply when <strong>starting</strong> a process instance:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Message start events are only supported on top-level processes. Message start events are not supported on embedded sub processes.</p>
</li>
<li>
<p>If a process definition has multiple message start events, <code>runtimeService.startProcessInstanceByMessage(&#8230;&#8203;)</code> allows to select the appropriate start event.</p>
</li>
<li>
<p>If a process definition has multiple message start events and a single none start event, <code>runtimeService.startProcessInstanceByKey(&#8230;&#8203;)</code> and <code>runtimeService.startProcessInstanceById(&#8230;&#8203;)</code> starts a process instance using the none start event.</p>
</li>
<li>
<p>If a process definition has multiple message start events and no none start event, <code>runtimeService.startProcessInstanceByKey(&#8230;&#8203;)</code> and <code>runtimeService.startProcessInstanceById(&#8230;&#8203;)</code> throw an exception.</p>
</li>
<li>
<p>If a process definition has a single message start event, <code>runtimeService.startProcessInstanceByKey(&#8230;&#8203;)</code> and <code>runtimeService.startProcessInstanceById(&#8230;&#8203;)</code> start a new process instance using the message start event.</p>
</li>
<li>
<p>If a process is started from a call activity, message start event(s) are only supported if</p>
<div class="ulist">
<ul>
<li>
<p>in addition to the message start event(s), the process has a single none start event</p>
</li>
<li>
<p>the process has a single message start event and no other start events.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="messageStartEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A message start event is visualized as a circle with a message event symbol. The symbol is unfilled, to visualize the catching (receiving) behavior.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.start.message.event.png" alt="bpmn.start.message.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="messageStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of a message start event is the normal start event declaration with a messageEventDefinition child-element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;definitions&quot;</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;Examples&quot;</span>
  <span class="tok-na">xmlns:tns=</span><span class="tok-s">&quot;Examples&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;message</span> <span class="tok-na">id=</span><span class="tok-s">&quot;newInvoice&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;newInvoiceMessage&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;invoiceProcess&quot;</span><span class="tok-nt">&gt;</span>

    <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;messageStart&quot;</span> <span class="tok-nt">&gt;</span>
    	<span class="tok-nt">&lt;messageEventDefinition</span> <span class="tok-na">messageRef=</span><span class="tok-s">&quot;tns:newInvoice&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/startEvent&gt;</span>
    ...
  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnSignalStartEvent">8.2.10. Signal Start Event</h4>
<div class="sect4">
<h5 id="bpmnSignalStartEventDescription">Description</h5>
<div class="paragraph">
<p>A <a href="#bpmnSignalEventDefinition">signal</a> start event can be used to start a process instance using a named signal. The signal can be <em>fired</em> from within a process instance using the intermediary signal throw event or through the API (<em>runtimeService.signalEventReceivedXXX</em> methods). In both cases, all process definitions that have a signal start event with the same name will be started.</p>
</div>
<div class="paragraph">
<p>Note that in both cases, it is also possible to choose between a synchronous and asynchronous starting of the process instances.</p>
</div>
<div class="paragraph">
<p>The <code>signalName</code> that must be passed in the API is the name given in the <code>name</code> attribute of the <code>signal</code> element referenced by the <code>signalRef</code> attribute of the <code>signalEventDefinition</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="signalStartEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A signal start event is visualized as a circle with a signal event symbol. The symbol is unfilled, to visualize the catching (receiving) behavior.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.start.signal.event.png" alt="bpmn.start.signal.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="signalStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of a signal start event is the normal start event declaration with a signalEventDefinition child-element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;signal</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theSignal&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;The Signal&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processWithSignalStart1&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theSignalEventDefinition&quot;</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;theSignal&quot;</span>  <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/startEvent&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Task in process A&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
	  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnErrorStartEvent">8.2.11. Error Start Event</h4>
<div class="sect4">
<h5 id="errorStartEventDescription">Description</h5>
<div class="paragraph">
<p>An <a href="#bpmnErrorEventDefinition">error</a> start event can be used to trigger an Event Sub-Process. <strong>An error start event cannot be used for starting a process instance</strong>.</p>
</div>
<div class="paragraph">
<p>An error start event is always interrupting.</p>
</div>
</div>
<div class="sect4">
<h5 id="errorStartEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An error start event is visualized as a circle with an error event symbol. The symbol is unfilled, to visualize the catching (receiving) behavior.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.start.error.event.png" alt="bpmn.start.error.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="errorStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of an error start event is the normal start event declaration with an errorEventDefinition child-element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;messageStart&quot;</span> <span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;someError&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/startEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnEndEvent">8.2.12. End Events</h4>
<div class="paragraph">
<p>An end event signifies the end (of a path) of a (sub)process. An end event is <strong>always throwing</strong>. This means that when process execution arrives in the end event, a <em>result</em> is thrown. The type of result is depicted by the inner black icon of the event. In the XML representation, the type is given by the declaration of a sub-element.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnNoneEndEvent">8.2.13. None End Event</h4>
<div class="sect4">
<h5 id="noneEndEventDescription">Description</h5>
<div class="paragraph">
<p>A <em>none</em> end event means that the <em>result</em> thrown when the event is reached is unspecified. As such, the engine will not do anything extra besides ending the current path of execution.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnNoneEndEventDescription">Graphical notation</h5>
<div class="paragraph">
<p>A none end event is visualized as a circle with a thick border with no inner icon (no result type).</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.none.end.event.png" alt="bpmn.none.end.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnNoneStartEventXml">XML representation</h5>
<div class="paragraph">
<p>The XML representation of a none end event is the normal end event declaration, without any sub-element (other end event types all have a sub-element declaring the type).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my end event&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnErrorEndEvent">8.2.14. Error End Event</h4>
<div class="sect4">
<h5 id="bpmnErrorEndEventDescription">Description</h5>
<div class="paragraph">
<p>When process execution arrives in an <strong>error end event</strong>, the current path of execution is ended and an error is thrown. This error can <a href="#bpmnBoundaryErrorEvent">caught by a matching intermediate boundary error event</a>. In case no matching boundary error event is found, an exception will be thrown.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnErrorEndEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An error end event is visualized as a typical end event (circle with thick border), with the error icon inside. The error icon is completely black, to indicate the throwing semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.error.end.event.png" alt="bpmn.error.end.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnErrorEndEventXml">XML representation</h5>
<div class="paragraph">
<p>And error end event is represented as an end event, with an <em>errorEventDefinition</em> child element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myErrorEndEvent&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/endEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>errorRef</em> attribute can reference an <em>error</em> element that is defined outside the process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;error</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;123&quot;</span> <span class="tok-nt">/&gt;</span>
...
<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myProcess&quot;</span><span class="tok-nt">&gt;</span>
...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>errorCode</strong> of the <em>error</em> will be used to find the matching catching boundary error event. If the <em>errorRef</em> does not match any defined <em>error</em>, then the <em>errorRef</em> is used as a shortcut for the <em>errorCode</em>. This is a Flowable specific shortcut. More concretely, following snippets are equivalent in functionality.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;error</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;error123&quot;</span> <span class="tok-nt">/&gt;</span>
...
<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myProcess&quot;</span><span class="tok-nt">&gt;</span>
...
  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myErrorEndEvent&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/endEvent&gt;</span>
...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myErrorEndEvent&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;error123&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/endEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <em>errorRef</em> must comply with the BPMN 2.0 schema, and must be a valid QName.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnCancelEndEvent">8.2.15. Terminate End Event</h4>
<div class="sect4">
<h5 id="_description">Description</h5>
<div class="paragraph">
<p>When a <em>terminate end event</em> is reached, the current process instance or sub-process will be terminated. Conceptually, when an execution arrives in a terminate end event, the first <em>scope</em> (process or sub-process) will be determined and ended. Note that in BPMN 2.0, a sub-process can be an embedded sub-process, call activity, event sub-process or transaction sub-process. This rule applies in general: when for example there is a multi-instance call activity or embedded subprocess, only that instance will be ended, the other instances and the process instance are not affected.</p>
</div>
<div class="paragraph">
<p>There is an optional attribute <em>terminateAll</em> that can be added. When <em>true</em>, regardless of the placement of the terminate end event in the process definition and regardless of being in a sub-process (even nested), the (root) process instance will be terminated.</p>
</div>
</div>
<div class="sect4">
<h5 id="_graphical_notation">Graphical notation</h5>
<div class="paragraph">
<p>A cancel end event visualized as a typical end event (circle with thick outline), with a full black circle inside.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.terminate.end.event.png" alt="bpmn.terminate.end.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_xml_representation">XML representation</h5>
<div class="paragraph">
<p>A terminate end event is represented as an end event, with a <em>terminateEventDefinition</em> child element.</p>
</div>
<div class="paragraph">
<p>Note that the <em>terminateAll</em> attribute is optional (and <em>false</em> by default).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myEndEvent &gt;</span>
<span class="tok-s">  &lt;terminateEventDefinition activiti:terminateAll=&quot;</span><span class="tok-err">true&quot;</span><span class="tok-nt">&gt;&lt;/terminateEventDefinition&gt;</span>
<span class="tok-nt">&lt;/endEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cancel_end_event">8.2.16. Cancel End Event</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnCancelEndEventDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_2">Description</h5>
<div class="paragraph">
<p>The cancel end event can only be used in combination with a bpmn transaction subprocess. When the cancel end event is reached, a cancel event is thrown which must be caught by a cancel boundary event. The cancel boundary event then cancels the transaction and triggers compensation.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCancelEndEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A cancel end event visualized as a typical end event (circle with thick outline), with the cancel icon inside. The cancel icon is completely black, to indicate the throwing semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.cancel.end.event.png" alt="bpmn.cancel.end.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCancelEndEventXml">XML representation</h5>
<div class="paragraph">
<p>A cancel end event is represented as an end event, with a <em>cancelEventDefinition</em> child element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myCancelEndEvent&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;cancelEventDefinition</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/endEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundaryEvent">8.2.17. Boundary Events</h4>
<div class="paragraph">
<p>Boundary events are <em>catching</em> events that are attached to an activity (a boundary event can never be throwing). This means that while the activity is running, the event is <em>listening</em> for a certain type of trigger. When the event is <em>caught</em>, the activity is interrupted and the sequence flow going out of the event are followed.</p>
</div>
<div class="paragraph">
<p>All boundary events are defined in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myBoundaryEvent&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;theActivity&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;XXXEventDefinition/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A boundary event is defined with</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique identifier (process-wide)</p>
</li>
<li>
<p>A reference to the activity to which the event is attached through the <strong>attachedToRef</strong> attribute.
Note that a boundary event is defined on the same level as the activities to which they are attached (i.e. no inclusion of the boundary event inside the activity).</p>
</li>
<li>
<p>An XML sub-element of the form <em>XXXEventDefinition</em> (e.g. <em>TimerEventDefinition</em>, <em>ErrorEventDefinition</em>, etc.) defining the type of the boundary event. See the specific boundary event types for more details.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bpmnTimerBoundaryEvent">8.2.18. Timer Boundary Event</h4>
<div class="sect4">
<h5 id="timerBoundaryEventDescription">Description</h5>
<div class="paragraph">
<p>A timer boundary event acts as a stopwatch and alarm clock. When an execution arrives in the activity where the boundary event is attached to, a timer is started. When the timer fires (e.g. after a specified interval), the activity is interrupted boundary event are followed.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnTimerBoundaryEventGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A timer boundary event is visualized as a typical boundary event (i.e. circle on the border), with the timer icon on the inside.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.timer.event.png" alt="bpmn.boundary.timer.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnTimerBoundaryEventXml">XML Representation</h5>
<div class="paragraph">
<p>A timer boundary event is defined as a <a href="#bpmnBoundaryEvent">regular boundary event</a>. The specific type sub-element is in this case a <strong>timerEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;escalationTimer&quot;</span> <span class="tok-na">cancelActivity=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;firstLineSupport&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDuration&gt;</span>PT4H<span class="tok-nt">&lt;/timeDuration&gt;</span>
  <span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Please refer to <a href="#timerEventDefinitions">timer event definition</a> for details on timer configuration.</p>
</div>
<div class="paragraph">
<p>In the graphical representation, the line of the circle is dotted as you can see in this example above:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.non.interrupting.boundary.timer.event.png" alt="bpmn.non.interrupting.boundary.timer.event">
</div>
</div>
<div class="paragraph">
<p>A typical use case is sending an escalation email additionally but not interrupt the normal process flow.</p>
</div>
<div class="paragraph">
<p>Since BPMN 2.0 there is the difference between the interrupting and non interrupting timer event. The interrupting is the default. The non-interrupting leads to the original activity is <strong>not</strong> interrupted but the activity stays there. Instead an additional executions is created and send over the outgoing transition of the event. In the XML representation, the <em>cancelActivity</em> attribute is set to false:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;escalationTimer&quot;</span> <span class="tok-na">cancelActivity=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;firstLineSupport&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note:</strong> boundary timer events are only fired when the job or async executor is enabled (i.e. <em>jobExecutorActivate</em> or <em>asyncExecutorActivate</em> needs to be set to <code>true</code> in the <code>activiti.cfg.xml</code>, since the job and async executor are disabled by default).</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnKnownIssueBoundaryEvent">Known issue with boundary events</h5>
<div class="paragraph">
<p>There is a known issue regarding concurrency when using boundary events of any type. Currently, it is not possible to have multiple outgoing sequence flow attached to a boundary event. A solution to this problem is to use one outgoing sequence flow that goes to a parallel gateway.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.known.issue.boundary.event.png" alt="bpmn.known.issue.boundary.event">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundaryErrorEvent">8.2.19. Error Boundary Event</h4>
<div class="sect4">
<h5 id="bpmnBoundaryErrorEventDescription">Description</h5>
<div class="paragraph">
<p>An intermediate <em>catching</em> error on the boundary of an activity, or <strong>boundary error event</strong> for short, catches errors that are thrown within the scope of the activity on which it is defined.</p>
</div>
<div class="paragraph">
<p>Defining a boundary error event makes most sense on an <a href="#bpmnSubProcess">embedded subprocess</a>, or a <a href="#bpmnCallActivity">call activity</a>, as a subprocess creates a scope for all activities inside the subprocess. Errors are thrown by <a href="#bpmnErrorEndEvent">error end events</a>. Such an error will propagate its parent scopes upwards until a scope is found on which a boundary error event is defined that matches the error event definition.</p>
</div>
<div class="paragraph">
<p>When an error event is caught, the activity on which the boundary event is defined is destroyed, also destroying all current executions within (e.g. concurrent activities, nested subprocesses, etc.). Process execution continues following the outgoing sequence flow of the boundary event.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryErrorEventgraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A boundary error event is visualized as a typical intermediate event (circle with smaller circle inside) on the boundary, with the error icon inside. The error icon is white, to indicate the <em>catch</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.error.event.png" alt="bpmn.boundary.error.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryErrorEventXml">Xml representation</h5>
<div class="paragraph">
<p>A boundary error event is defined as a typical <a href="#bpmnBoundaryEvent">boundary event</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;catchError&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;mySubProcess&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;myError&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with the <a href="#bpmnErrorEndEvent">error end event</a>, the <em>errorRef</em> references an error defined outside the process element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;error</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myError&quot;</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;123&quot;</span> <span class="tok-nt">/&gt;</span>
...
<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myProcess&quot;</span><span class="tok-nt">&gt;</span>
...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>errorCode</strong> is used to match the errors that are caught:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <em>errorRef</em> is omitted, the boundary error event will catch <strong>any error event</strong>, regardless of the errorCode of the <em>error</em>.</p>
</li>
<li>
<p>In case an <em>errorRef</em> is provided and it references an existing <em>error</em>, the boundary event will <strong>only catch errors with the same error code</strong>.</p>
</li>
<li>
<p>In case an <em>errorRef</em> is provided, but no <em>error</em> is defined in the BPMN 2.0 file, then the <strong>errorRef is used as errorCode</strong> (similar for with error end events).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryErrorEventExample">Example</h5>
<div class="paragraph">
<p>Following example process shows how an error end event can be used. When the <em>'Review profitability'</em> user task is completed by stating that not enough information is provided, an error is thrown. When this error is caught on the boundary of the subprocess, all active activities within the <em>'Review sales lead'</em> subprocess are destroyed (even if <em>'Review customer rating'</em> was not yet completed), and the <em>'Provide additional details'</em> user task is created.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.error.example.png" alt="bpmn.boundary.error.example">
</div>
</div>
<div class="paragraph">
<p>This process is shipped as example in the demo setup. The process XML and unit test can be found in the <em>org.activiti.examples.bpmn.event.error</em> package.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundarySignalEvent">8.2.20. Signal Boundary Event</h4>
<div class="sect4">
<h5 id="bpmnBoundarySignalEventDescription">Description</h5>
<div class="paragraph">
<p>An attached intermediate <em>catching</em> <a href="#bpmnSignalEventDefinition">signal</a> on the boundary of an activity, or <strong>boundary signal event</strong> for short, catches signals with the same signal name as the referenced signal definition.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> contrary to other events like the boundary error event, a boundary signal event does not only catch signal events thrown from the scope it is attached to. On the contrary, a signal event has global scope (broadcast semantics) meaning that the signal can be thrown from any place, even from a different process instance.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> contrary to other events like an error event, a signal is not consumed if it is caught. If you have two active signal boundary events catching the same signal event, both boundary events are triggered, even if they are part of different process instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundarySignalEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A boundary signal event is visualized as a typical intermediate event (Circle with smaller circle inside) on the boundary, with the signal icon inside. The signal icon is white (unfilled), to indicate the <em>catch</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.signal.event.png" alt="bpmn.boundary.signal.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundarySignalEventXml">XML representation</h5>
<div class="paragraph">
<p>A boundary signal event is defined as a typical <a href="#bpmnBoundaryEvent">boundary event</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;boundary&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">cancelActivity=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;alertSignal&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundarySignalEventExample">Example</h5>
<div class="paragraph">
<p>See section on <a href="#bpmnSignalEventDefinition">signal event definitions</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundaryMessageEvent">8.2.21. Message Boundary Event</h4>
<div class="sect4">
<h5 id="bpmnBoundaryMessageEventDescription">Description</h5>
<div class="paragraph">
<p>An attached intermediate <em>catching</em> <a href="#bpmnMessageEventDefinition">message</a> on the boundary of an activity, or <strong>boundary message event</strong> for short, catches messages with the same message name as the referenced message definition.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryMessageEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A boundary message event is visualized as a typical intermediate event (Circle with smaller circle inside) on the boundary, with the message icon inside. The message icon is white (unfilled), to indicate the <em>catch</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.message.event.png" alt="bpmn.boundary.message.event">
</div>
</div>
<div class="paragraph">
<p>Note that boundary message event can be both interrupting (right hand side) and non-interrupting (left hand side).</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryMessageEventXml">XML representation</h5>
<div class="paragraph">
<p>A boundary message event is defined as a typical <a href="#bpmnBoundaryEvent">boundary event</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;boundary&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">cancelActivity=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;messageEventDefinition</span> <span class="tok-na">messageRef=</span><span class="tok-s">&quot;newCustomerMessage&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryMessageEventExample">Example</h5>
<div class="paragraph">
<p>See section on <a href="#bpmnMessageEventDefinition">message event definitions</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundaryCancelEvent">8.2.22. Cancel Boundary Event</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnBoundaryCancelEventDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_3">Description</h5>
<div class="paragraph">
<p>An attached intermediate <em>catching</em> cancel on the boundary of a transaction subprocess, or <strong>boundary cancel event</strong> for short, is triggered when a transaction is cancelled. When the cancel boundary event is triggered, it first interrupts all executions active in the current scope. Next, it starts compensation of all active compensation boundary events in the scope of the transaction. Compensation is performed synchronously, i.e. the boundary event waits before compensation is completed before leaving the transaction. When compensation is completed, the transaction subprocess is left using the sequence flow(s) running out of the cancel boundary event.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Only a single cancel boundary event is allowed for a transaction subprocess.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If the transaction subprocess hosts nested subprocesses, compensation is only triggered for subprocesses that have completed successfully.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If a cancel boundary event is placed on a transaction subprocess with multi instance characteristics, if one instance triggers cancellation, the boundary event cancels all instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryCancelEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A cancel boundary event is visualized as a typical intermediate event (Circle with smaller circle inside) on the boundary, with the cancel icon inside. The cancel icon is white (unfilled), to indicate the <em>catching</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.cancel.event.png" alt="bpmn.boundary.cancel.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundarySignalEventXml">XML representation</h5>
<div class="paragraph">
<p>A cancel boundary event is defined as a typical <a href="#bpmnBoundaryEvent">boundary event</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;boundary&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;transaction&quot;</span> <span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;cancelEventDefinition</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the cancel boundary event is always interrupting, the <code>cancelActivity</code> attribute is not required.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBoundaryCompensationEvent">8.2.23. Compensation Boundary Event</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnBoundaryCompensationEventDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_4">Description</h5>
<div class="paragraph">
<p>An attached intermediate <em>catching</em> compensation on the boundary of an activity or <strong>compensation boundary event</strong> for short, can be used to attach a compensation handler to an activity.</p>
</div>
<div class="paragraph">
<p>The compensation boundary event must reference a single compensation handler using a directed association.</p>
</div>
<div class="paragraph">
<p>A compensation boundary event has a different activation policy from other boundary events. Other boundary events like for instance the signal boundary event are activated when the activity they are attached to is started. When the activity is left, they are deactivated and the corresponding event subscription is cancelled. The compensation boundary event is different. The compensation boundary event is activated when the activity it is attached to <strong>completes successfully</strong>. At this point, the corresponding subscription to the compensation events is created. The subscription is removed either when a compensation event is triggered or when the corresponding process instance ends. From this, it follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When compensation is triggered, the compensation handler associated with the compensation boundary event is invoked the same number of times the activity it is attached to completed successfully.</p>
</li>
<li>
<p>If a compensation boundary event is attached to an activity with multiple instance characteristics, a compensation event subscription is created for each instance.</p>
</li>
<li>
<p>If a compensation boundary event is attached to an activity which is contained inside a loop, a compensation event subscription is created for each time the activity is executed.</p>
</li>
<li>
<p>If the process instance ends, the subscriptions to compensation events are cancelled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> the compensation boundary event is not supported on embedded subprocesses.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryCompensationEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A compensation boundary event is visualized as a typical intermediate event (Circle with smaller circle inside) on the boundary, with the compensation icon inside. The compensation icon is white (unfilled), to indicate the <em>catching</em> semantics. In addition to a compensation boundary event, the following figure shows a compensation handler associated with the boundary event using a unidirectional association:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.compensation.event.png" alt="bpmn.boundary.compensation.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBoundaryCompensationEventXml">XML representation</h5>
<div class="paragraph">
<p>A compensation boundary event is defined as a typical <a href="#bpmnBoundaryEvent">boundary event</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;boundaryEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;compensateBookHotelEvt&quot;</span> <span class="tok-na">attachedToRef=</span><span class="tok-s">&quot;bookHotel&quot;</span> <span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;compensateEventDefinition</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/boundaryEvent&gt;</span>

<span class="tok-nt">&lt;association</span> <span class="tok-na">associationDirection=</span><span class="tok-s">&quot;One&quot;</span> <span class="tok-na">id=</span><span class="tok-s">&quot;a1&quot;</span>  <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;compensateBookHotelEvt&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;undoBookHotel&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;undoBookHotel&quot;</span> <span class="tok-na">isForCompensation=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;...&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the compensation boundary event is activated after the activity has completed successfully, the <code>cancelActivity</code> attribute is not supported.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateCatchingEvent">8.2.24. Intermediate Catching Events</h4>
<div class="paragraph">
<p>All intermediate catching events are defined in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myIntermediateCatchEvent&quot;</span> <span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;XXXEventDefinition/&gt;</span>
<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>An intermediate catching event is defined with</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique identifier (process-wide)</p>
</li>
<li>
<p>An XML sub-element of the form <em>XXXEventDefinition</em> (e.g. <em>TimerEventDefinition</em>, etc.) defining the type of the intermediate catching event. See the specific catching event types for more details.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bpmnTimerIntermediateEvent">8.2.25. Timer Intermediate Catching Event</h4>
<div class="sect4">
<h5 id="bpmnTimerIntermediateEventDescription">Description</h5>
<div class="paragraph">
<p>A timer intermediate event acts as a stopwatch. When an execution arrives in catching event activity, a timer is started. When the timer fires (e.g. after a specified interval), the sequence flow going out of the timer intermediate event is followed.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnTimerIntermediateEventGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A timer intermediate event is visualized as an intermediate catching event, with the timer icon on the inside.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.timer.event.png" alt="bpmn.intermediate.timer.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnTimerIntermediateEventXml">XML Representation</h5>
<div class="paragraph">
<p>A timer intermediate event is defined as an <a href="#bpmnIntermediateCatchingEvent">intermediate catching event</a>. The specific type sub-element is in this case a <strong>timerEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;timer&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;timerEventDefinition&gt;</span>
    <span class="tok-nt">&lt;timeDuration&gt;</span>PT5M<span class="tok-nt">&lt;/timeDuration&gt;</span>
  <span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#timerEventDefinitions">timer event definitions</a> for configuration details.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateSignalEvent">8.2.26. Signal Intermediate Catching Event</h4>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventDescription">Description</h5>
<div class="paragraph">
<p>An intermediate <em>catching</em> <a href="#bpmnSignalEventDefinition">signal</a> event catches signals with the same signal name as the referenced signal definition.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> contrary to other events like an error event, a signal is not consumed if it is caught. If you have two active signal boundary events catching the same signal event, both boundary events are triggered, even if they are part of different process instances.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An intermediate signal catch event is visualized as a typical intermediate event (Circle with smaller circle inside), with the signal icon inside. The signal icon is white (unfilled), to indicate the <em>catch</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.signal.catch.event.png" alt="bpmn.intermediate.signal.catch.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventXml">XML representation</h5>
<div class="paragraph">
<p>A signal intermediate event is defined as an <a href="#bpmnIntermediateCatchingEvent">intermediate catching event</a>. The specific type sub-element is in this case a <strong>signalEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;signal&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;newCustomerSignal&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventExample">Example</h5>
<div class="paragraph">
<p>See section on <a href="#bpmnSignalEventDefinition">signal event definitions</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateMessageEvent">8.2.27. Message Intermediate Catching Event</h4>
<div class="sect4">
<h5 id="bpmnIntermediateMessageEventDescription">Description</h5>
<div class="paragraph">
<p>An intermediate <em>catching</em> <a href="#bpmnMessageEventDefinition">message</a> event catches messages with a specified name.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateMessageEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An intermediate catching message event is visualized as a typical intermediate event (Circle with smaller circle inside), with the message icon inside. The message icon is white (unfilled), to indicate the <em>catch</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.message.catch.event.png" alt="bpmn.intermediate.message.catch.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventXml">XML representation</h5>
<div class="paragraph">
<p>A message intermediate event is defined as an <a href="#bpmnIntermediateCatchingEvent">intermediate catching event</a>. The specific type sub-element is in this case a <strong>messageEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;message&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;messageEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;newCustomerMessage&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateMessageEventExample">Example</h5>
<div class="paragraph">
<p>See section on <a href="#bpmnMessageEventDefinition">message event definitions</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateThrowEvent">8.2.28. Intermediate Throwing Event</h4>
<div class="paragraph">
<p>All intermediate throwing events are defined in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myIntermediateThrowEvent&quot;</span> <span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;XXXEventDefinition/&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>An intermediate throwing event is defined with</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique identifier (process-wide)</p>
</li>
<li>
<p>An XML sub-element of the form <em>XXXEventDefinition</em> (e.g. <em>signalEventDefinition</em>, etc.) defining the type of the intermediate throwing event. See the specific throwing event types for more details.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateThrowNoneEvent">8.2.29. Intermediate Throwing None Event</h4>
<div class="paragraph">
<p>The following process diagram shows a simple example of an intermediate none event, which is often used to indicate some state achieved in the process.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.none.event.png" alt="bpmn.intermediate.none.event">
</div>
</div>
<div class="paragraph">
<p>This can be a good hook to monitor some KPI&#8217;s, basically by adding an <a href="#executionListeners">execution listener</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;noneEvent&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.test.bpmn.event.IntermediateNoneEventTest$MyExecutionListener&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There you can add some own code to maybe send some event to your BAM tool or DWH. The engine itself doesn&#8217;t do anything in that event, it just passes through.</p>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateThrowSignalEvent">8.2.30. Signal Intermediate Throwing Event</h4>
<div class="sect4">
<h5 id="bpmnIntermediateThrowSignalEventDescription">Description</h5>
<div class="paragraph">
<p>An intermediate <em>throwing</em> <a href="#bpmnSignalEventDefinition">signal</a> event throws a signal event for a defined signal.</p>
</div>
<div class="paragraph">
<p>In Flowable, the signal is broadcast to all active handlers (i.e. all catching signal events). Signals can be published synchronous or asynchronous.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the default configuration, the signal is delivered <strong>synchronously</strong>. This means that the throwing process instance waits until the signal is delivered to all catching process instances. The catching process instances are also notified in the same transaction as the throwing process instance, which means that if one of the notified instances produces a technical error (throws an exception), all involved instances fail.</p>
</li>
<li>
<p>A signal can also be delivered <strong>asynchronously</strong>. In that case it is determined which handlers are active at the time the throwing signal event is reached. For each active handler, an asynchronous notification message (Job) is stored and delivered by the JobExecutor.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateThrowSignalEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An intermediate signal throw event is visualized as a typical intermediate event (Circle with smaller circle inside), with the signal icon inside. The signal icon is black (filled), to indicate the <em>throw</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.signal.throw.event.png" alt="bpmn.intermediate.signal.throw.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateThrowSignalEventXml">XML representation</h5>
<div class="paragraph">
<p>A signal intermediate event is defined as an <a href="#bpmnIntermediateThrowEvent">intermediate throwing event</a>. The specific type sub-element is in this case a <strong>signalEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;signal&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;newCustomerSignal&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>An asynchronous signal event would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;signal&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;newCustomerSignal&quot;</span> <span class="tok-na">activiti:async=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateSignalEventExample">Example</h5>
<div class="paragraph">
<p>See section on <a href="#bpmnSignalEventDefinition">signal event definitions</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnIntermediateThrowCompensationEvent">8.2.31. Compensation Intermediate Throwing Event</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnIntermediateThrowCompensationEventDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_5">Description</h5>
<div class="paragraph">
<p>An intermediate <em>throwing</em> compensation event can be used to trigger compensation.</p>
</div>
<div class="paragraph">
<p><strong>Triggering compensation:</strong> Compensation can either be triggered for a designated activity or for the scope which hosts the compensation event. Compensation is performed through execution of the compensation handler associated with an activity.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When compensation is thrown for an activity, the associated compensation handler is executed the same number of times the activity competed successfully.</p>
</li>
<li>
<p>If compensation is thrown for the current scope, all activities within the current scope are compensated, which includes activities on concurrent branches.</p>
</li>
<li>
<p>Compensation is triggered hierarchically: if an activity to be compensated is a subprocess, compensation is triggered for all activities contained in the subprocess. If the subprocess has nested activities, compensation is thrown recursively. However, compensation is not propagated to the "upper levels" of the process: if compensation is triggered within a subprocess, it is not propagated to activities outside of the subprocess scope. The BPMN specification states that compensation is triggered for activities at "the same level of subprocess".</p>
</li>
<li>
<p>In Flowable compensation is performed in reverse order of execution. This means that whichever activity completed last is compensated first, etc.</p>
</li>
<li>
<p>The intermediate throwing compensation event can be used to compensate transaction subprocesses which competed successfully.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If compensation is thrown within a scope which contains a subprocess and the subprocess contains activities with compensation handlers, compensation is only propagated to the subprocess if it has completed successfully when compensation is thrown. If some of the activities nested inside the subprocess have completed and have attached compensation handlers, the compensation handlers are not executed if the subprocess containing these activities is not completed yet. Consider the following example:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.throw.compensation.example1.png" alt="bpmn.throw.compensation.example1">
</div>
</div>
<div class="paragraph">
<p>In this process we have two concurrent executions, one executing the embedded subprocess and one executing the "charge credit card" activity. Let&#8217;s assume both executions are started and the first concurrent execution is waiting for a user to complete the "review bookings" task. The second execution performs the "charge credit card" activity and an error is thrown, which causes the "cancel reservations" event to trigger compensation. At this point the parallel subprocess is not yet completed which means that the compensation event is not propagated to the subprocess and thus the "cancel hotel reservation"  compensation handler is not executed. If the user task (and thus the embedded subprocess) completes before the "cancel reservations" is performed, compensation is propagated to the embedded subprocess.</p>
</div>
<div class="paragraph">
<p><strong>Process variables:</strong> When compensating an embedded subprocess, the execution used for executing the compensation handlers has access to the local process variables of the subprocess in the state they were in when the subprocess completed execution. To achieve this, a snapshot of the process variables associated with the scope execution (execution created for executing the subprocess) is taken. Form this, a couple of implications follow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The compensation handler does not have access to variables added to concurrent executions created inside the subprocess scope.</p>
</li>
<li>
<p>Process variables associated with executions higher up in the hierarchy, (for instance process variables associated with the process instance execution are not contained in the snapshot: the compensation handler has access to these process variables in the state they are in when compensation is thrown.</p>
</li>
<li>
<p>A variable snapshot is only taken for embedded subprocesses, not for other activities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Current limitations:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>waitForCompletion="false"</code> is currently unsupported. When compensation is triggered using the intermediate throwing compensation event, the event is only left, after compensation completed successfully.</p>
</li>
<li>
<p>Compensation itself is currently performed by concurrent executions. The concurrent executions are started in reverse order in which the compensated activities completed. Future versions of activity might include an option to perform compensation sequentially.</p>
</li>
<li>
<p>Compensation is not propagated to sub process instances spawned by call activities.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateThrowCompensationEventGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>An intermediate compensation throw event is visualized as a typical intermediate event (Circle with smaller circle inside), with the compensation icon inside. The compensation icon is black (filled), to indicate the <em>throw</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.intermediate.compensation.throw.event.png" alt="bpmn.intermediate.compensation.throw.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnIntermediateThrowSignalEventXml">Xml representation</h5>
<div class="paragraph">
<p>A compensation intermediate event is defined as an <a href="#bpmnIntermediateThrowEvent">intermediate throwing event</a>. The specific type sub-element is in this case a <strong>compensateEventDefinition</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;throwCompensation&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;compensateEventDefinition</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition, the optional argument <code>activityRef</code> can be used to trigger compensation of a specific scope / activity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;intermediateThrowEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;throwCompensation&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;compensateEventDefinition</span> <span class="tok-na">activityRef=</span><span class="tok-s">&quot;bookHotel&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/intermediateThrowEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bpmnSequenceFlow">8.3. Sequence Flow</h3>
<div class="sect3">
<h4 id="sequenceFlowDescription">8.3.1. Description</h4>
<div class="paragraph">
<p>A sequence flow is the connector between two elements of a process. After an element is visited during process execution, all outgoing sequence flow will be followed. This means that the default nature of BPMN 2.0 is to be parallel: two outgoing sequence flow will create two separate, parallel paths of execution.</p>
</div>
</div>
<div class="sect3">
<h4 id="sequenceFlowGraphicalNotation">8.3.2. Graphical notation</h4>
<div class="paragraph">
<p>A sequence flow is visualized as an arrow going from the source element towards the target element. The arrow always points towards the target.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.sequence.flow.png" alt="bpmn.sequence.flow">
</div>
</div>
</div>
<div class="sect3">
<h4 id="sequenceFlowXml">8.3.3. XML representation</h4>
<div class="paragraph">
<p>Sequence flow need to have a process-unique <strong>id</strong>, and a reference to an existing <strong>source</strong> and <strong>target</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnConditionalSequenceFlow">8.3.4. Conditional sequence flow</h4>
<div class="sect4">
<h5 id="condSeqFlowDescription">Description</h5>
<div class="paragraph">
<p>A sequence flow can have a condition defined on it. When a BPMN 2.0 activity is left, the default behavior is to evaluate the conditions on the outgoing sequence flow. When a condition evaluates to <em>true</em>, that outgoing sequence flow is selected. When multiple sequence flow are selected that way, multiple <em>executions</em> will be generated and the process will be continued in a parallel way.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> the above holds for BPMN 2.0 activities (and events), but not for gateways. Gateways will handle sequence flow with conditions in specific ways, depending on the gateway type.</p>
</div>
</div>
<div class="sect4">
<h5 id="conditionalSequenceFlowGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A conditional sequence flow is visualized as a regular sequence flow, with a small diamond at the beginning. The condition expression is shown next to the sequence flow.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.conditional.sequence.flow.png" alt="bpmn.conditional.sequence.flow">
</div>
</div>
</div>
<div class="sect4">
<h5 id="conditionalSequenceFlowXml">XML representation</h5>
<div class="paragraph">
<p>A conditional sequence flow is represented in XML as a regular sequence flow, containing a <strong>conditionExpression</strong> sub-element. Note that for the moment only <em>tFormalExpressions</em> are supported, Omitting the <em>xsi:type=""</em> definition will simply default to this only supported type of expressions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-cp">&lt;![CDATA[${order.price &gt; 100 &amp;&amp; order.price &lt; 250}]]&gt;</span>
  <span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Currently conditionalExpressions can <strong>only be used with UEL</strong>, detailed info about these can be found in section <a href="#apiExpressions">Expressions</a>. The expression used should resolve to a boolean value, otherwise an exception is thrown while evaluating the condition.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The example below references data of a process variable, in the typical JavaBean style through getters.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-cp">&lt;![CDATA[${order.price &gt; 100 &amp;&amp; order.price &lt; 250}]]&gt;</span>
<span class="tok-nt">&lt;/conditionExpression&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>This example invokes a method that resolves to a boolean value.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-cp">&lt;![CDATA[${order.isStandardOrder()}]]&gt;</span>
<span class="tok-nt">&lt;/conditionExpression&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Flowable distribution contains the following example process using value and method expressions (see <em>org.activiti.examples.bpmn.expression)</em>:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.uel-expression.on.seq.flow.png" alt="bpmn.uel expression.on.seq.flow">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnDefaultSequenceFlow">8.3.5. Default sequence flow</h4>
<div class="sect4">
<h5 id="bpmnDefaultSequenceFlowDescription">Description</h5>
<div class="paragraph">
<p>All BPMN 2.0 tasks and gateways can have a <strong>default sequence flow</strong>. This sequence flow is only selected as the outgoing sequence flow for that activity if and only if none of the other sequence flow could be selected. Conditions on a default sequence flow are always ignored.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnDefaultSequenceFlowGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A default sequence flow is visualized as a regular sequence flow, with a <em>slash</em> marker at the beginning.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.default.sequence.flow.png" alt="bpmn.default.sequence.flow">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnDefaultSequenceFlowXmlRepresentation">XML representation</h5>
<div class="paragraph">
<p>A default sequence flow for a certain activity is defined by the <strong>default attribute</strong> on that activity. The following XML snippet shows for example an exclusive gateway that has as default sequence flow <em>flow 2</em>. Only when <em>conditionA</em> and <em>conditionB</em> both evaluate to false, will it be chosen as outgoing sequence flow for the gateway.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;exclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Exclusive Gateway&quot;</span> <span class="tok-na">default=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;task1&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${conditionA}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;task2&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;task3&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${conditionB}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Which corresponds with the following graphical representation:</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bpmnGateways">8.4. Gateways</h3>
<div class="paragraph">
<p>A gateway is used to control the flow of execution (or as the BPMN 2.0 describes, the <em>tokens</em> of execution). A gateway is capable of <em>consuming</em> or <em>generating</em> tokens.</p>
</div>
<div class="paragraph">
<p>A gateway is graphically visualized as a diamond shape, with an icon inside. The icon shows the type of gateway.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.gateway.png" alt="bpmn.gateway">
</div>
</div>
<div class="sect3">
<h4 id="bpmnExclusiveGateway">8.4.1. Exclusive Gateway</h4>
<div class="sect4">
<h5 id="exclusiveGatewayDescription">Description</h5>
<div class="paragraph">
<p>An exclusive gateway (also called the <em>XOR gateway</em> or more technical the <em>exclusive data-based gateway</em>), is used to model a <strong>decision</strong> in the process. When the execution arrives at this gateway, all outgoing sequence flow are evaluated in the order in which they are defined. The sequence flow which condition evaluates to true (or which doesn&#8217;t have a condition set, conceptually having a <em>'true'</em> defined on the sequence flow) is selected for continuing the process.</p>
</div>
<div class="paragraph">
<p><strong>Note that the semantics of outgoing sequence flow is different to that of the general case in BPMN 2.0. While in general all sequence flow which condition evaluates to true are selected to continue in a parallel way, only one sequence flow is selected when using the exclusive gateway. In case multiple sequence flow have a condition that evaluates to true, the first one defined in the XML (and only that one!) is selected for continuing the process. If no sequence flow can be selected, an exception will be thrown.</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="exclusiveGatewayGraphNotation">Graphical notation</h5>
<div class="paragraph">
<p>An exclusive gateway is visualized as a typical gateway (i.e. a diamond shape) with an <em>X</em> icon inside, referring to the <em>XOR</em> semantics. Note that a gateway without an icon inside defaults to an exclusive gateway. The BPMN 2.0 specification does not allow mixing the diamond with and without an X in the same process definition.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.exclusive.gateway.notation.png" alt="bpmn.exclusive.gateway.notation">
</div>
</div>
</div>
<div class="sect4">
<h5 id="exclusiveGatewayXML">XML representation</h5>
<div class="paragraph">
<p>The XML representation of an exclusive gateway is straight-forward: one line defining the gateway and condition expressions defined on the outgoing sequence flow. See the section on <a href="#bpmnConditionalSequenceFlow">conditional sequence flow</a> to see which options are available for such expressions.</p>
</div>
<div class="paragraph">
<p>Take for example the following model:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.exclusive.gateway.png" alt="bpmn.exclusive.gateway">
</div>
</div>
<div class="paragraph">
<p>Which is represented in XML as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;exclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Exclusive Gateway&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask1&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${input == 1}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>

<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask2&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${input == 2}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>

<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow4&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theTask3&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${input == 3}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnParallelGateway">8.4.2. Parallel Gateway</h4>
<div class="sect4">
<h5 id="bpmnParallelGatewayDescription">Description</h5>
<div class="paragraph">
<p>Gateways can also be used to model concurrency in a process. The most straightforward gateway to introduce concurrency in a process model, is the <strong>Parallel Gateway</strong>, which allows to <em>fork</em> into multiple paths of execution or <em>join</em> multiple incoming paths of execution.</p>
</div>
<div class="paragraph">
<p>The functionality of the parallel gateway is based on the incoming and outgoing sequence flow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>fork:</strong> all outgoing sequence flow are followed in parallel, creating one concurrent execution for each sequence flow.</p>
</li>
<li>
<p><strong>join:</strong> all concurrent executions arriving at the parallel gateway wait in the gateway until an execution has arrived for each of the incoming sequence flow. Then the process continues past the joining gateway.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that a parallel gateway can have <strong>both fork and join behavior</strong>, if there are multiple incoming and outgoing sequence flow for the same parallel gateway. In that case, the gateway will first join all incoming sequence flow, before splitting into multiple concurrent paths of executions.</p>
</div>
<div class="paragraph">
<p><strong>An important difference with other gateway types is that the parallel gateway does not evaluate conditions. If conditions are defined on the sequence flow connected with the parallel gateway, they are simply neglected.</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnParallelGatewayGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A parallel gateway is visualized as a gateway (diamond shape) with the <em>plus</em> symbol inside, referring to the <em>AND</em> semantics.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.parallel.gateway.png" alt="bpmn.parallel.gateway">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnParallelGatewayXML">XML representation</h5>
<div class="paragraph">
<p>Defining a parallel gateway needs one line of XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;parallelGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myParallelGateway&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The actual behavior (fork, join or both), is defined by the sequence flow connected to the parallel gateway.</p>
</div>
<div class="paragraph">
<p>For example, the model above comes down to the following XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;parallelGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Receive Payment&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Ship Order&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;parallelGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Archive Order&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, after the process is started, two tasks will be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">pi</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;forkJoin&quot;</span><span class="tok-o">);</span>
<span class="tok-n">TaskQuery</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">()</span>
                         <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">pi</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())</span>
                         <span class="tok-o">.</span><span class="tok-na">orderByTaskName</span><span class="tok-o">()</span>
                         <span class="tok-o">.</span><span class="tok-na">asc</span><span class="tok-o">();</span>

<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">query</span><span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">2</span><span class="tok-o">,</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">());</span>

<span class="tok-n">Task</span> <span class="tok-n">task1</span> <span class="tok-o">=</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">);</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;Receive Payment&quot;</span><span class="tok-o">,</span> <span class="tok-n">task1</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
<span class="tok-n">Task</span> <span class="tok-n">task2</span> <span class="tok-o">=</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">);</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;Ship Order&quot;</span><span class="tok-o">,</span> <span class="tok-n">task2</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When these two tasks are completed, the second parallel gateway will join the two executions and since there is only one outgoing sequence flow, no concurrent paths of execution will be created, and only the <em>Archive Order</em> task will be active.</p>
</div>
<div class="paragraph">
<p>Note that a parallel gateway does not need to be <em>balanced</em> (i.e. a matching number of incoming/outgoing sequence flow for corresponding parallel gateways). A parallel gateway will simply wait for all incoming sequence flow and create a concurrent path of execution for each outgoing sequence flow, not influenced by other constructs in the process model. So, the following process is legal in BPMN 2.0:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.unbalanced.parallel.gateway.png" alt="bpmn.unbalanced.parallel.gateway">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnInclusiveGateway">8.4.3. Inclusive Gateway</h4>
<div class="sect4">
<h5 id="bpmnInclusiveGatewayDescription">Description</h5>
<div class="paragraph">
<p>The <strong>Inclusive Gateway</strong> can be seen as a combination of an exclusive and a parallel gateway. Like an exclusive gateway you can define conditions on outgoing sequence flows and the inclusive gateway will evaluate them. But the main difference is that the inclusive gateway can take more than one sequence flow, like the parallel gateway.</p>
</div>
<div class="paragraph">
<p>The functionality of the inclusive gateway is based on the incoming and outgoing sequence flow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>fork:</strong> all outgoing sequence flow conditions are evaluated and for the sequence flow conditions that evaluate to true the flows are followed in parallel, creating one concurrent execution for each sequence flow.</p>
</li>
<li>
<p><strong>join:</strong> all concurrent executions arriving at the inclusive gateway wait in the gateway until an execution has arrived for each of the incoming sequence flows that have a process token. This is an important difference with the parallel gateway. So in other words, the inclusive gateway will only wait for the incoming sequence flows that will be executed. After the join, the process continues past the joining inclusive gateway.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that an inclusive gateway can have <strong>both fork and join behavior</strong>, if there are multiple incoming and outgoing sequence flow for the same inclusive gateway. In that case, the gateway will first join all incoming sequence flows that have a process token, before splitting into multiple concurrent paths of executions for the outgoing sequence flows that have a condition that evaluates to true.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnInclusiveGatewayGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>An inclusive gateway is visualized as a gateway (diamond shape) with the <em>circle</em> symbol inside.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.inclusive.gateway.png" alt="bpmn.inclusive.gateway">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnInclusiveGatewayXML">XML representation</h5>
<div class="paragraph">
<p>Defining an inclusive gateway needs one line of XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;inclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myInclusiveGateway&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The actual behavior (fork, join or both), is defined by the sequence flows connected to the inclusive gateway.</p>
</div>
<div class="paragraph">
<p>For example, the model above comes down to the following XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;inclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${paymentReceived == false}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;fork&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${shipOrder == true}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
<span class="tok-nt">&lt;/sequenceFlow&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Receive Payment&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;receivePayment&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Ship Order&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;shipOrder&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;inclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;join&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Archive Order&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;archiveOrder&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, after the process is started, two tasks will be created if the process variables paymentReceived == false and shipOrder == true. In case only one of these process variables equals to true only one task will be created. If no condition evaluates to true and exception is thrown. This can be prevented by specifying a default outgoing sequence flow. In the following example one task will be created, the ship order task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variableMap</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
          <span class="tok-n">variableMap</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;receivedPayment&quot;</span><span class="tok-o">,</span> <span class="tok-kc">true</span><span class="tok-o">);</span>
          <span class="tok-n">variableMap</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;shipOrder&quot;</span><span class="tok-o">,</span> <span class="tok-kc">true</span><span class="tok-o">);</span>
          <span class="tok-n">ProcessInstance</span> <span class="tok-n">pi</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;forkJoin&quot;</span><span class="tok-o">);</span>
<span class="tok-n">TaskQuery</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">()</span>
                         <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">pi</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())</span>
                         <span class="tok-o">.</span><span class="tok-na">orderByTaskName</span><span class="tok-o">()</span>
                         <span class="tok-o">.</span><span class="tok-na">asc</span><span class="tok-o">();</span>

<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">query</span><span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">());</span>

<span class="tok-n">Task</span> <span class="tok-n">task</span> <span class="tok-o">=</span> <span class="tok-n">tasks</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">);</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;Ship Order&quot;</span><span class="tok-o">,</span> <span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getName</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When this task is completed, the second inclusive gateway will join the two executions and since there is only one outgoing sequence flow, no concurrent paths of execution will be created, and only the <em>Archive Order</em> task will be active.</p>
</div>
<div class="paragraph">
<p>Note that an inclusive gateway does not need to be <em>balanced</em> (i.e. a matching number of incoming/outgoing sequence flow for corresponding inclusive gateways). An inclusive gateway will simply wait for all incoming sequence flow and create a concurrent path of execution for each outgoing sequence flow, not influenced by other constructs in the process model.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnEventbasedGateway">8.4.4. Event-based Gateway</h4>
<div class="sect4">
<h5 id="eventBasedGatewayDescription">Description</h5>
<div class="paragraph">
<p>The Event-based Gateway allows to take a decision based on events. Each outgoing sequence flow of the gateway needs to be connected to an intermediate catching event. When process execution reaches an Event-based Gateway, the gateway acts like a wait state: execution is suspended. In addition, for each outgoing sequence flow, an event subscription is created.</p>
</div>
<div class="paragraph">
<p>Note the sequence flows running out of an Event-based Gateway are different from ordinary sequence flows. These sequence flows are never actually "executed". On the contrary, they allow the process engine to determine which events an execution arriving at an Event-based Gateway needs to subscribe to. The following restrictions apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An Event-based Gateway must have two or more outgoing sequence flows.</p>
</li>
<li>
<p>An Event-based Gateway must only be connected to elements of type <code>intermediateCatchEvent</code> only. (Receive Tasks after an Event-based Gateway are not supported by Flowable.)</p>
</li>
<li>
<p>An <code>intermediateCatchEvent</code> connected to an Event-based Gateway must have a single incoming sequence flow.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="eventBasedGatewayGraphNotation">Graphical notation</h5>
<div class="paragraph">
<p>An Event-based Gateway is visualized as a diamond shape like other BPMN gateways with a special icon inside.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.event.based.gateway.notation.png" alt="bpmn.event.based.gateway.notation">
</div>
</div>
</div>
<div class="sect4">
<h5 id="eventBasedGatewayXML">XML representation</h5>
<div class="paragraph">
<p>The XML element used to define an Event-based Gateway is <code>eventBasedGateway</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="eventBasedGatewayExample">Example(s)</h5>
<div class="paragraph">
<p>The following process is an example of a process with an Event-based Gateway. When the execution arrives at the Event-based Gateway, process execution is suspended. In addition, the process instance subscribes to the alert signal event and created a timer which fires after 10 minutes. This effectively causes the process engine to wait for ten minutes for a signal event. If the signal occurs within 10 minutes, the timer is cancelled and execution continues after the signal. If the signal is not fired, execution continues after the timer and the signal subscription is cancelled.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.event.based.gateway.example.png" alt="bpmn.event.based.gateway.example">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</div></td><td class="code"><span></span><span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;definitions&quot;</span>
	<span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
	<span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
	<span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;Examples&quot;</span><span class="tok-nt">&gt;</span>

	<span class="tok-nt">&lt;signal</span> <span class="tok-na">id=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;alert&quot;</span> <span class="tok-nt">/&gt;</span>

	<span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;catchSignal&quot;</span><span class="tok-nt">&gt;</span>

		<span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;gw1&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;eventBasedGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;gw1&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;gw1&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;signalEvent&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;gw1&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;timerEvent&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;signalEvent&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Alert&quot;</span><span class="tok-nt">&gt;</span>
			<span class="tok-nt">&lt;signalEventDefinition</span> <span class="tok-na">signalRef=</span><span class="tok-s">&quot;alertSignal&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>

		<span class="tok-nt">&lt;intermediateCatchEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;timerEvent&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Alert&quot;</span><span class="tok-nt">&gt;</span>
			<span class="tok-nt">&lt;timerEventDefinition&gt;</span>
				<span class="tok-nt">&lt;timeDuration&gt;</span>PT10M<span class="tok-nt">&lt;/timeDuration&gt;</span>
			<span class="tok-nt">&lt;/timerEventDefinition&gt;</span>
		<span class="tok-nt">&lt;/intermediateCatchEvent&gt;</span>

		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;timerEvent&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;exGw1&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;signalEvent&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Handle alert&quot;</span><span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;exclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;exGw1&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;exGw1&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exGw1&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>

		<span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bpmnTask">8.5. Tasks</h3>
<div class="sect3">
<h4 id="bpmnUserTask">8.5.1. User Task</h4>
<div class="sect4">
<h5 id="bpmnUserTaskDescription">Description</h5>
<div class="paragraph">
<p>A <em>user task</em> is used to model work that needs to be done by a human actor. When the process execution arrives at such a user task, a new task is created in the task list of the user(s) or group(s) assigned to that task.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>A user task is visualized as a typical task (rounded rectangle), with a small user icon in the left upper corner.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.user.task.png" alt="bpmn.user.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskXml">XML representation</h5>
<div class="paragraph">
<p>A user task is defined in XML as follows. The <em>id</em> attribute is required, the <em>name</em> attribute is optional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Important task&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A user task can have also a description. In fact any BPMN 2.0 element can have a description. A description is defined by adding the <strong>documentation</strong> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Schedule meeting&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;documentation&gt;</span>
	  Schedule an engineering meeting for next week with the new hire.
  <span class="tok-nt">&lt;/documentation&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The description text can be retrieved from the task in the standard Java way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">task</span><span class="tok-o">.</span><span class="tok-na">getDescription</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskDueDate">Due Date</h5>
<div class="paragraph">
<p>Each task has a field, indicating the due date of that task. The Query API can be used to query for tasks that are due on, before or after a certain date.</p>
</div>
<div class="paragraph">
<p>There is an activity extension which allows you to specify an expression in your task-definition to set the initial due date of a task when it is created. The expression <strong>should always resolve to a <code>java.util.Date</code>, <code>java.util.String (ISO8601 formatted)</code>, ISO8601 time-duration (e.g. PT50M) or <code>null</code></strong>. For example, you could use a date that was entered in a previous form in the process or calculated in a previous Service Task. In case a time-duration is used, the due-date is calculated based on the current time, incremented by the given period. For example, when "PT30M" is used as dueDate, the task is due in thirty minutes from now.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Important task&quot;</span> <span class="tok-na">activiti:dueDate=</span><span class="tok-s">&quot;${dateVariable}&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The due date of a task can also be altered using the <code>TaskService</code> or in <code>TaskListener</code>s using the passed <code>DelegateTask</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskAssignment">User assignment</h5>
<div class="paragraph">
<p>A user task can be directly assigned to a user. This is done by defining a <strong>humanPerformer</strong> sub element. Such a <em>humanPerformer</em> definition needs a <strong>resourceAssignmentExpression</strong> that actually defines the user. Currently, only <strong>formalExpressions</strong> are supported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-nt">&gt;</span>

  ...

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theTask&#39;</span> <span class="tok-na">name=</span><span class="tok-s">&#39;important task&#39;</span> <span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;humanPerformer&gt;</span>
      <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
        <span class="tok-nt">&lt;formalExpression&gt;</span>kermit<span class="tok-nt">&lt;/formalExpression&gt;</span>
      <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
    <span class="tok-nt">&lt;/humanPerformer&gt;</span>
  <span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Only one</strong> user can be assigned as human performer to the task. In Flowable terminology, this user is called the <strong>assignee</strong>. Tasks that have an assignee are not visible in the task lists of other people and  can be found in the so-called <strong>personal task list</strong> of the assignee instead.</p>
</div>
<div class="paragraph">
<p>Tasks directly assigned to users can be retrieved through the TaskService as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tasks can also be put in the so-called <strong>candidate task list</strong> of people. In that case, the <strong>potentialOwner</strong> construct must be used. The usage is similar to the <em>humanPerformer</em> construct. Do note that it is required to define for each element in the formal expression to specify if it is a user or a group (the engine cannot guess this).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-nt">&gt;</span>

  ...

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theTask&#39;</span> <span class="tok-na">name=</span><span class="tok-s">&#39;important task&#39;</span> <span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;potentialOwner&gt;</span>
      <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
        <span class="tok-nt">&lt;formalExpression&gt;</span>user(kermit), group(management)<span class="tok-nt">&lt;/formalExpression&gt;</span>
      <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
    <span class="tok-nt">&lt;/potentialOwner&gt;</span>
  <span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tasks defines with the <em>potential owner</em> construct, can be retrieved as follows (or a similar <em>TaskQuery</em> usage as for the tasks with an assignee):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Task</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">().</span><span class="tok-na">taskCandidateUser</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This will retrieve all tasks where kermit is a <strong>candidate user</strong>, i.e. the formal expression contains <em>user(kermit)</em>. This will also retrieve all tasks that are <strong>assigned to a group where kermit is a member of</strong> (e.g. <em>group(management)</em>, if kermit is a member of that group and the Flowable identity component is used). The groups of a user are resolved at runtime and these can be managed through the <a href="#apiEngine">IdentityService</a>.</p>
</div>
<div class="paragraph">
<p>If no specifics are given whether the given text string is a user or group, the engine defaults to group. So the following would be the same as when <em>group(accountancy) was declared</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;formalExpression&gt;</span>accountancy<span class="tok-nt">&lt;/formalExpression&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskUserAssignmentExtension">Flowable extensions for task assignment</h5>
<div class="paragraph">
<p>It is clear that user and group assignments are quite cumbersome for use cases where the assignment is not complex. To avoid these complexities, <a href="#bpmnCustomExtensions">custom extensions</a> on the user task are possible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>assignee attribute</strong>: this custom extension allows to directly assign a user task to a given user.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my task&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;kermit&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is exactly the same as using a <strong>humanPerformer</strong> construct as defined <a href="#bpmnUserTaskAssignment">above</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>candidateUsers attribute</strong>: this custom extension allows to make a user a candidate for a task.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my task&quot;</span> <span class="tok-na">activiti:candidateUsers=</span><span class="tok-s">&quot;kermit, gonzo&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is exactly the same as using a <strong>potentialOwner</strong> construct as defined <a href="#bpmnUserTaskAssignment">above</a>. Note that it is not required to use the <em>user(kermit)</em> declaration as is the case with the <em>potential owner</em> construct, since the attribute can only be used for users.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>candidateGroups attribute</strong>: this custom extension allows to make a group a candidate for a task.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;my task&quot;</span> <span class="tok-na">activiti:candidateGroups=</span><span class="tok-s">&quot;management, accountancy&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is exactly the same as using a <strong>potentialOwner</strong> construct as defined <a href="#bpmnUserTaskAssignment">above</a>. Note that it is not required to use the <em>group(management)</em> declaration as is the case with the <em>potential owner</em> construct, since the attribute can only be used for groups.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>candidateUsers</em> and <em>candidateGroups</em> can both be defined on the same user task.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: Although Flowable provides an identity management component, which is exposed through the <a href="#apiEngine">IdentityService</a>, no check is done whether a provided user is known by the identity component. This allows Flowable to integrate with existing identity management solutions when it is embedded into an application.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskUserCustomIdentityLinkAssignmentExtension">Custom identity link types (Experimental)</h5>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a></p>
</div>
<div class="paragraph">
<p>The BPMN standard supports a single assigned user or <strong>humanPerformer</strong> or a set of users that form a potential pool of <strong>potentialOwners</strong> as defined in <a href="#bpmnUserTaskAssignment">User assignment</a>. In addition, Flowable defines <a href="#bpmnUserTaskUserAssignmentExtension">extension attribute elements</a> for the User Task that can represent the task <strong>assignee</strong> or <strong>candidate owner</strong>.</p>
</div>
<div class="paragraph">
<p>The supported Flowable identity link types are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">IdentityLinkType</span> <span class="tok-o">{</span>
  <span class="tok-cm">/* Flowable native roles */</span>
  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">ASSIGNEE</span> <span class="tok-o">=</span> <span class="tok-s">&quot;assignee&quot;</span><span class="tok-o">;</span>
  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">CANDIDATE</span> <span class="tok-o">=</span> <span class="tok-s">&quot;candidate&quot;</span><span class="tok-o">;</span>
  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">OWNER</span> <span class="tok-o">=</span> <span class="tok-s">&quot;owner&quot;</span><span class="tok-o">;</span>
  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">STARTER</span> <span class="tok-o">=</span> <span class="tok-s">&quot;starter&quot;</span><span class="tok-o">;</span>
  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">PARTICIPANT</span> <span class="tok-o">=</span> <span class="tok-s">&quot;participant&quot;</span><span class="tok-o">;</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The BPMN standard and Flowable example authorization identities are <strong>user</strong> and <strong>group</strong>. As mentioned in the previous section, the Flowable identity management implementation is not intended for production use, but should be extended depending upon the supported authorization scheme.</p>
</div>
<div class="paragraph">
<p>If additional link types are required, custom resources can be defined as extension elements with the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;make profit&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:customResource</span> <span class="tok-na">activiti:name=</span><span class="tok-s">&quot;businessAdministrator&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
        <span class="tok-nt">&lt;formalExpression&gt;</span>user(kermit), group(management)<span class="tok-nt">&lt;/formalExpression&gt;</span>
      <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
    <span class="tok-nt">&lt;/activiti:customResource&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The custom link expressions are added to the <em>TaskDefinition</em> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div></td><td class="code"><span></span><span class="tok-kd">protected</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;</span> <span class="tok-n">customUserIdentityLinkExpressions</span> <span class="tok-o">=</span>
      <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;();</span>
<span class="tok-kd">protected</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;</span> <span class="tok-n">customGroupIdentityLinkExpressions</span> <span class="tok-o">=</span>
      <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;();</span>

<span class="tok-kd">public</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span>
         <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">getCustomUserIdentityLinkExpressions</span><span class="tok-o">()</span> <span class="tok-o">{</span>
  <span class="tok-k">return</span> <span class="tok-n">customUserIdentityLinkExpressions</span><span class="tok-o">;</span>
<span class="tok-o">}</span>

<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">addCustomUserIdentityLinkExpression</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">identityLinkType</span><span class="tok-o">,</span>
      <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;</span> <span class="tok-n">idList</span><span class="tok-o">)</span>
  <span class="tok-n">customUserIdentityLinkExpressions</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-n">identityLinkType</span><span class="tok-o">,</span> <span class="tok-n">idList</span><span class="tok-o">);</span>
<span class="tok-o">}</span>

<span class="tok-kd">public</span> <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span>
       <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">getCustomGroupIdentityLinkExpressions</span><span class="tok-o">()</span> <span class="tok-o">{</span>
  <span class="tok-k">return</span> <span class="tok-n">customGroupIdentityLinkExpressions</span><span class="tok-o">;</span>
<span class="tok-o">}</span>

<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">addCustomGroupIdentityLinkExpression</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">identityLinkType</span><span class="tok-o">,</span>
       <span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">Expression</span><span class="tok-o">&gt;</span> <span class="tok-n">idList</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-n">customGroupIdentityLinkExpressions</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-n">identityLinkType</span><span class="tok-o">,</span> <span class="tok-n">idList</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>which are populated at runtime by the <em>UserTaskActivityBehavior handleAssignments</em> method.</p>
</div>
<div class="paragraph">
<p>Finally, the <em>IdentityLinkType</em> class must be extended to support the custom identity link types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.yourco.engine.task</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">IdentityLinkType</span>
    <span class="tok-kd">extends</span> <span class="tok-n">org</span><span class="tok-o">.</span><span class="tok-na">activiti</span><span class="tok-o">.</span><span class="tok-na">engine</span><span class="tok-o">.</span><span class="tok-na">task</span><span class="tok-o">.</span><span class="tok-na">IdentityLinkType</span>
<span class="tok-o">{</span>
    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">ADMINISTRATOR</span> <span class="tok-o">=</span> <span class="tok-s">&quot;administrator&quot;</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">EXCLUDED_OWNER</span> <span class="tok-o">=</span> <span class="tok-s">&quot;excludedOwner&quot;</span><span class="tok-o">;</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnUserTaskUserCustomAssignmentTaskListeners">Custom Assignment via task listeners</h5>
<div class="paragraph">
<p>In case the previous approaches are not sufficient, it is possible to delegate to custom assignment logic using a <a href="#taskListeners">task listener</a> on the create event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;task1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My task&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:taskListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;create&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyAssignmentHandler&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>DelegateTask</code> that is passed to the <code>TaskListener</code> implementation, allows to set the assignee and candidate-users/groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyAssignmentHandler</span> <span class="tok-kd">implements</span> <span class="tok-n">TaskListener</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">DelegateTask</span> <span class="tok-n">delegateTask</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-c1">// Execute custom identity lookups here</span>

    <span class="tok-c1">// and then for example call following methods:</span>
    <span class="tok-n">delegateTask</span><span class="tok-o">.</span><span class="tok-na">setAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">delegateTask</span><span class="tok-o">.</span><span class="tok-na">addCandidateUser</span><span class="tok-o">(</span><span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">delegateTask</span><span class="tok-o">.</span><span class="tok-na">addCandidateGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;management&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">...</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When using Spring it is possible to use the custom assignment attributes as described in the section above, and delegate to a Spring bean using a <a href="#taskListeners">task listener</a> with an <a href="#springExpressions">expression</a> that listens to task <em>create</em> events. In the following example, the assignee will be set by calling the <code>findManagerOfEmployee</code> on the <code>ldapService</code> Spring bean. The <em>emp</em> parameter that is passed, is a process variable&gt;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${ldapService.findManagerForEmployee(emp)}&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This also works similar for candidate users and groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;task&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task&quot;</span> <span class="tok-na">activiti:candidateUsers=</span><span class="tok-s">&quot;${ldapService.findAllSales()}&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this will only work if the return type of the invoked methods is <code>String</code> or <code>Collection&lt;String&gt;</code> (for candidate users and groups):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">FakeLdapService</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">findManagerForEmployee</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">employee</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s">&quot;Kermit The Frog&quot;</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-nf">findAllSales</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">Arrays</span><span class="tok-o">.</span><span class="tok-na">asList</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;gonzo&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;fozzie&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnScriptTask">8.5.2. Script Task</h4>
<div class="sect4">
<h5 id="bpmnScriptTaskDescription">Description</h5>
<div class="paragraph">
<p>A script task is an automatic activity. When a process execution arrives at the script task, the corresponding script is executed.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnScriptTaskGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A script task is visualized as a typical BPMN 2.0 task (rounded rectangle), with a small <em>script</em> icon in the top-left corner of the rectangle.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.scripttask.png" alt="bpmn.scripttask">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnScriptTaskXml">XML representation</h5>
<div class="paragraph">
<p>A script task is defined by specifying the <strong>script</strong> and the <strong>scriptFormat</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;scriptTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theScriptTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Execute script&quot;</span> <span class="tok-na">scriptFormat=</span><span class="tok-s">&quot;groovy&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;script&gt;</span>
    sum = 0
    for ( i in inputArray ) {
      sum += i
    }
  <span class="tok-nt">&lt;/script&gt;</span>
<span class="tok-nt">&lt;/scriptTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of the <strong>scriptFormat</strong> attribute must be a name that is compatible with the <a href="http://jcp.org/en/jsr/detail?id=223">JSR-223</a> (scripting for the Java platform). By default JavaScript is included in every JDK and as such doesn&#8217;t need any additional jars. If you want to use another (JSR-223 compatible) scripting engine, it is sufficient to add the corresponding jar to the classpath and use the appropriate name. For example, the Flowable unit tests often use Groovy because the syntax is pretty similar to that of Java.</p>
</div>
<div class="paragraph">
<p>Do note that the Groovy scripting engine is bundled with the groovy-all jar. Before version 2.0, the scripting engine was part of the regular Groovy jar. As such, one must now add following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
      <span class="tok-nt">&lt;groupId&gt;</span>org.codehaus.groovy<span class="tok-nt">&lt;/groupId&gt;</span>
      <span class="tok-nt">&lt;artifactId&gt;</span>groovy-all<span class="tok-nt">&lt;/artifactId&gt;</span>
      <span class="tok-nt">&lt;version&gt;</span>2.x.x<span class="tok-nt">&lt;version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnScriptTaskVariables">Variables in scripts</h5>
<div class="paragraph">
<p>All process variables that are accessible through the execution that arrives in the script task, can be used within the script. In the example, the script variable <em>'inputArray'</em> is in fact a process variable (an array of integers).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;script&gt;</span>
    sum = 0
    for ( i in inputArray ) {
      sum += i
    }
<span class="tok-nt">&lt;/script&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to set process variables in a script, simply by calling <em>execution.setVariable("variableName", variableValue)</em>. By default, no variables are stored automatically (<strong>Note: in some older releases this was the case!</strong>). It is possible to automatically store any variable defined in the script (e.g. <em>sum</em> in the example above) by setting the property <code>autoStoreVariables</code> on the <code>scriptTask</code> to <code>true</code>. However, <strong>the best practice is not to do this and use an explicit execution.setVariable() call</strong>, as on some recent versions of the JDK auto storing of variables does not work for some scripting languages. See <a href="http://www.jorambarrez.be/blog/2013/03/25/bug-on-jdk-1-7-0_17-when-using-scripttask-in-activiti/">this link</a> for more details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;scriptTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;script&quot;</span> <span class="tok-na">scriptFormat=</span><span class="tok-s">&quot;JavaScript&quot;</span> <span class="tok-na">activiti:autoStoreVariables=</span><span class="tok-s">&quot;false&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default of this parameter is <code>false</code>, meaning that if the parameter is omitted from the script task definition, all the declared variables will only exist during the duration of the script.</p>
</div>
<div class="paragraph">
<p>Example on how to set a variable in a script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;script&gt;</span>
    def scriptVar = &quot;test123&quot;
    execution.setVariable(&quot;myVar&quot;, scriptVar)
<span class="tok-nt">&lt;/script&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: the following names are reserved and <strong>cannot be used</strong> as variable names: <strong>out, out:print, lang:import, context, elcontext</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnScriptTaskResultValue">Script results</h5>
<div class="paragraph">
<p>The return value of a script task can be assigned to an already existing or to a new process variable by specifying the process variable name as a literal value for the <em>'activiti:resultVariable'</em> attribute of a script task definition. Any existing value for a specific process variable will be overwritten by the result value of the script execution. When not specifying a result variable name, the script result value gets ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;scriptTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theScriptTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Execute script&quot;</span> <span class="tok-na">scriptFormat=</span><span class="tok-s">&quot;juel&quot;</span> <span class="tok-na">activiti:resultVariable=</span><span class="tok-s">&quot;myVar&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;script&gt;</span>#{echo}<span class="tok-nt">&lt;/script&gt;</span>
<span class="tok-nt">&lt;/scriptTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, the result of the script execution (the value of the resolved expression <em>'#{echo}'</em>) is set to the process variable named <em>'myVar'</em> after the script completes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_security">Security</h5>
<div class="paragraph">
<p>It is also possible when using <em>javascript</em> as scripting language to use <em><em>secure scripting</em></em>. See the <a href="#advancedSecureScripting">secure scripting section</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnJavaServiceTask">8.5.3. Java Service Task</h4>
<div class="sect4">
<h5 id="bpmnJavaServiceTaskDescription">Description</h5>
<div class="paragraph">
<p>A Java service task is used to invoke an external Java class.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnJavaServiceTaskGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A service task is visualized as a rounded rectangle with a small gear icon in the top-left corner.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.java.service.task.png" alt="bpmn.java.service.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnJavaServiceTaskXML">XML representation</h5>
<div class="paragraph">
<p>There are 4 ways of declaring how to invoke Java logic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specifying a class that implements JavaDelegate or ActivityBehavior</p>
</li>
<li>
<p>Evaluating an expression that resolves to a delegation object</p>
</li>
<li>
<p>Invoking a method expression</p>
</li>
<li>
<p>Evaluating a value expression</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify a class that is called during process execution, the fully qualified classname needs to be provided by the <strong><em>activiti:class</em></strong> attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
             <span class="tok-na">name=</span><span class="tok-s">&quot;My Java Service Task&quot;</span>
             <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.MyJavaDelegate&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#bpmnJavaServiceTaskImplementation">the implementation section</a> for more details on how to use such a class.</p>
</div>
<div class="paragraph">
<p>It is also possible to use an expression that resolves to an object. This object must follow the same rules as objects that are created when the <code>activiti:class</code> attribute is used (see <a href="#bpmnJavaServiceTaskImplementation">further</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${delegateExpressionBean}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the <code>delegateExpressionBean</code> is a bean that implements the <code>JavaDelegate</code> interface, defined in for example the Spring container.</p>
</div>
<div class="paragraph">
<p>To specify a UEL method expression that should be evaluated, use attribute <strong>activiti:expression</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
             <span class="tok-na">name=</span><span class="tok-s">&quot;My Java Service Task&quot;</span>
             <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;#{printer.printMessage()}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Method <code>printMessage</code> (without parameters) will be called on the named object called <code>printer</code>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to pass parameters with an method used in the expression.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
             <span class="tok-na">name=</span><span class="tok-s">&quot;My Java Service Task&quot;</span>
             <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;#{printer.printMessage(execution, myVar)}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Method <code>printMessage</code> will be called on the object named <code>printer</code>. The first parameter passed is the <code>DelegateExecution</code>, which is available in the expression context by default available as <code>execution</code>. The second parameter passed, is the value of the variable with name <code>myVar</code> in the current execution.</p>
</div>
<div class="paragraph">
<p>To specify a UEL value expression that should be evaluated, use attribute <strong>activiti:expression</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
             <span class="tok-na">name=</span><span class="tok-s">&quot;My Java Service Task&quot;</span>
             <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;#{split.ready}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The getter method of property <code>ready</code>, <code>getReady</code> (without parameters), will be called on the named bean called <code>split</code>. The named objects are resolved in the execution&#8217;s process variables and (if applicable) in the Spring context.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnJavaServiceTaskImplementation">Implementation</h5>
<div class="paragraph">
<p>To implement a class that can be called during process execution, this class needs to implement the <em>org.activiti.engine.delegate.JavaDelegate</em> interface and provide the required logic in the <em>execute</em> method. When process execution arrives at this particular step, it will execute this logic defined in that method and leave the activity in the default BPMN 2.0 way.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s create for example a Java class that can be used to change a process variable String to uppercase. This class needs to implement the <em>org.activiti.engine.delegate.JavaDelegate</em> interface, which requires us to implement the <em>execute(DelegateExecution)</em> method. It&#8217;s this operation that will be called by the engine and which needs to contain the business logic. Process instance information such as process variables  and other can be accessed and manipulated through the <a href="http://www.flowable.org/javadocs/org/activiti/engine/delegate/DelegateExecution.html">DelegateExecution</a> interface (click on the link for a detailed Javadoc of its operations).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ToUppercase</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">var</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">)</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;input&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">var</span> <span class="tok-o">=</span> <span class="tok-n">var</span><span class="tok-o">.</span><span class="tok-na">toUpperCase</span><span class="tok-o">();</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;input&quot;</span><span class="tok-o">,</span> <span class="tok-n">var</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: there will be <strong>only one instance of that Java class created for the serviceTask it is defined on</strong>. All process-instances share the same class instance that will be used to call <em>execute(DelegateExecution)</em>. This means that the class must not use any member variables and must be thread-safe, since it can be executed simultaneously from different threads. This also influences the way <a href="#serviceTaskFieldInjection">Field injection</a> is handled.</p>
</div>
<div class="paragraph">
<p>The classes that are referenced in the process definition (i.e. by using <code>activiti:class</code>) are <strong>NOT instantiated during deployment</strong>. Only when a process execution arrives for the first time at the point in the process where the class is used, an instance of that class will be created. If the class cannot be found, an <code>ActivitiException</code> will be thrown. The reasoning for this is that the environment (and more specifically the <em>classpath</em>) when you are deploying is often different from the actual runtime environment. For example when using <em>ant</em> or the business archive upload in the Flowable app to deploy processes, the classpath does not contain the referenced classes.</p>
</div>
<div class="paragraph">
<p><a href="#internal">[INTERNAL: non-public implementation classes]</a> It is also possible to provide a class that implements the <em>org.activiti.engine.impl.pvm.delegate.ActivityBehavior</em> interface. Implementations have then access to the more powerful <em>ActivityExecution</em> that for example also allows to influence the control flow of the process. Note however that this is not a very good practice, and should be avoided as much as possible. So, it is advised to use the <em>ActivityBehavior</em> interface only for advanced use cases and if you know exactly what you&#8217;re doing.</p>
</div>
</div>
<div class="sect4">
<h5 id="serviceTaskFieldInjection">Field Injection</h5>
<div class="paragraph">
<p>It&#8217;s possible to inject values into the fields of the delegated classes. The following types of injection are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fixed string values</p>
</li>
<li>
<p>Expressions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If available, the value is injected through a public setter method on your delegated class, following the Java Bean naming conventions (e.g. field <code>firstName</code> has setter <code>setFirstName(&#8230;&#8203;)</code>). If no setter is available for that field, the value of private member will be set on the delegate. SecurityManagers in some environments don&#8217;t allow modifying private fields, so it&#8217;s safer to expose a public setter-method for the fields you want to have injected.</p>
</div>
<div class="paragraph">
<p><strong>Regardless of the type of value declared in the process-definition, the type of the setter/private field on the injection target should always be <code>org.activiti.engine.delegate.Expression</code>. When the expression is resolved it can be cast to the appropriate type.</strong></p>
</div>
<div class="paragraph">
<p>Field injection is supported when using the <em>'actviiti:class'</em> attribute. Field injection is also possible when using the <em>activiti:delegateExpression</em> attribute, however special rules with regards to thread-safety apply (see next section).</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how to inject a constant value into a field declared on the class. Note that we need to <strong>declare a <em>extensionElements</em> XML element before the actual field injection declarations</strong>, which is a requirement of the BPMN 2.0 XML Schema.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
    <span class="tok-na">name=</span><span class="tok-s">&quot;Java service invocation&quot;</span>
    <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.servicetask.ToUpperCaseFieldInjected&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
      <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;Hello World&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>ToUpperCaseFieldInjected</code> has a field <code>text</code> which is of type <code>org.activiti.engine.delegate.Expression</code>. When calling <code>text.getValue(execution)</code>, the configured string value <code>Hello World</code> will be returned:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ToUpperCaseFieldInjected</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">text</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;var&quot;</span><span class="tok-o">,</span> <span class="tok-o">((</span><span class="tok-n">String</span><span class="tok-o">)</span><span class="tok-n">text</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">)).</span><span class="tok-na">toUpperCase</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, for longs texts (e.g. an inline e-mail) the <em>'activiti:string'</em> sub element can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
    <span class="tok-na">name=</span><span class="tok-s">&quot;Java service invocation&quot;</span>
    <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.servicetask.ToUpperCaseFieldInjected&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;activiti:string&gt;</span>
          This is a long string with a lot of words and potentially way longer even!
      <span class="tok-nt">&lt;/activiti:string&gt;</span>
    <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To inject values that are dynamically resolved at runtime, expressions can be used. Those expressions can use process variables, or Spring defined beans (if Spring is used). As noted in <a href="#bpmnJavaServiceTaskImplementation">Service Task Implementation</a>, an instance of the Java class is shared among all process-instances in a service task when using the <em>activiti:class</em> attribute. To have dynamic injection of values in fields, you can inject value and method expressions in a <code>org.activiti.engine.delegate.Expression</code> which can be evaluated/invoked using the <code>DelegateExecution</code> passed in the <code>execute</code> method.</p>
</div>
<div class="paragraph">
<p>The example class below uses the injected expressions and resolves them using the current <code>DelegateExecution</code>. A <em>generBean</em> method call is used while passing the <em>gender</em> variable. Full code and test can be found in <code>org.activiti.examples.bpmn.servicetask.JavaServiceTaskTest.testExpressionFieldInjection</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Java service invocation&quot;</span>
  <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.servicetask.ReverseStringsFieldInjected&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text1&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;activiti:expression&gt;</span>${genderBean.getGenderString(gender)}<span class="tok-nt">&lt;/activiti:expression&gt;</span>
    <span class="tok-nt">&lt;/activiti:field&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text2&quot;</span><span class="tok-nt">&gt;</span>
       <span class="tok-nt">&lt;activiti:expression&gt;</span>Hello ${gender == &#39;male&#39; ? &#39;Mr.&#39; : &#39;Mrs.&#39;} ${name}<span class="tok-nt">&lt;/activiti:expression&gt;</span>
    <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;/ extensionElements&gt;</span>
<span class="tok-nt">&lt;/ serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ReverseStringsFieldInjected</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">text1</span><span class="tok-o">;</span>
  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">text2</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">value1</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">)</span> <span class="tok-n">text1</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;var1&quot;</span><span class="tok-o">,</span> <span class="tok-k">new</span> <span class="tok-n">StringBuffer</span><span class="tok-o">(</span><span class="tok-n">value1</span><span class="tok-o">).</span><span class="tok-na">reverse</span><span class="tok-o">().</span><span class="tok-na">toString</span><span class="tok-o">());</span>

    <span class="tok-n">String</span> <span class="tok-n">value2</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">)</span> <span class="tok-n">text2</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;var2&quot;</span><span class="tok-o">,</span> <span class="tok-k">new</span> <span class="tok-n">StringBuffer</span><span class="tok-o">(</span><span class="tok-n">value2</span><span class="tok-o">).</span><span class="tok-na">reverse</span><span class="tok-o">().</span><span class="tok-na">toString</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can also set the expressions as an attribute instead of a child-element, to make the XML less verbose.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text1&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${genderBean.getGenderString(gender)}&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;text1&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;Hello ${gender == &#39;male&#39; ? &#39;Mr.&#39; : &#39;Mrs.&#39;} ${name}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="serviceTaskFieldInjectionThreadSafety">Field injection and thread safety</h5>
<div class="paragraph">
<p>In general, using service tasks with Java delegates and field injections are thread-safe. However, there are a few situations where thread-safety is not guaranteed, depending on the setup or environment Flowable is running in.</p>
</div>
<div class="paragraph">
<p>When using the <em>activiti:class</em> attribute, using field injection is always thread safe. For each service task that references a certain class, a new instance will be instantiated and fields will be injected once when the instance is created. Reusing the same class in multiple times in different tasks or process definitions is no problem.</p>
</div>
<div class="paragraph">
<p>When using the <em>activiti:expression</em> attribute, using field injection is not possible. Parameters are passed via method calls and these are always thread-safe.</p>
</div>
<div class="paragraph">
<p>When using the <em>activiti:delegateExpression</em> attribute, the thread-safety of the delegate instance will depend on how the expression is resolved. If the delegate expression is reused in various tasks and/or process definitions and the expression always returns the same instance, using field injection <strong>is not thread-safe</strong>. Let&#8217;s look at a few examples to clarify.</p>
</div>
<div class="paragraph">
<p>Suppose the expression is <em>${factory.createDelegate(someVariable)}</em>, where factory is a Java bean known to the engine (for example a Spring bean when using the Spring integration) that creates a new instance each time the expression is resolved. When using field injection in this case, there is no problem with regards to thread-safety: each time the expression is resolved, the fields are injected on this new instance.</p>
</div>
<div class="paragraph">
<p>However, suppose the expression is <em>${someJavaDelegateBean}</em> that resolves to an implementation of the JavaDelegate class and we&#8217;re running in an environment that creates singleton instances of each bean (like Spring, but many others too). When using this expression in different tasks and/or process definitions, the expression will always be resolved to the same instance. In this case, using field injection is not thread-safe. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask1&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${someJavaDelegateBean}&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
        <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;someField&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${input * 2}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>

<span class="tok-c">&lt;!-- other process definition elements --&gt;</span>

<span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask2&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${someJavaDelegateBean}&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
        <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;someField&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${input * 2000}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example snippet has two service tasks that use the same delegate expression, but injects different values for the <em>Expression</em> field. <strong>If the expression resolves to the same instance, there can be race conditions in concurrent scenarios</strong> when it comes to injecting the field <em>someField</em> when the processes are executed.</p>
</div>
<div class="paragraph">
<p>The easiest solution to solve this, is to either</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rewrite the Java delegate to use an expression and passing the needed data to the delegate via a method arguments.</p>
</li>
<li>
<p>return a new instance of the delegate class each time the delegate expression is resolved. For example when using Spring, this means that the scope of the bean must be set to <strong>prototype</strong> (for example by adding the @Scope(SCOPE_PROTOTYPE) annotation to the delegate class)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As of Flowable version 5.22, the process engine configuration can be configured in a way to disable the use of field injection on delegate epxressions, by setting the value of the <em>delegateExpressionFieldInjectionMode</em> property (which takes one of the values in the <em>org.activiti.engine.imp.cfg.DelegateExpressionFieldInjectionMode</em> enum).</p>
</div>
<div class="paragraph">
<p>Following settings are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DISABLED</strong> : fully disables field injection when using delegate expressions. No field injection will be attempted. This is the safest mode, when it comes to thread-safety.</p>
</li>
<li>
<p><strong>COMPATIBILITY</strong>: in this mode, the behavior will be exactly as it was before version 5.21: field injection is possible when using delegate expressions and an exception will be thrown when the fields are not defined on the delegate class. This is of course the least safe mode with regards to thread-safety, but it can be needed for backwards compatibility or can be used safely when the delegate expression is used only on one task in a set of process definitions (and thus no concurrent race conditions can happen).</p>
</li>
<li>
<p><strong>MIXED</strong>: Allows injection when using delegateExpressions but will not throw an exception when the fields are not defined on the delegate. This allows for mixed behaviors where some delegates have injection (for example because they are not singletons) and some don&#8217;t.</p>
</li>
<li>
<p><strong>The default mode for Flowable version 5.x is COMPATIBILITY.</strong></p>
</li>
<li>
<p><strong>The default mode for Flowable version 6.x is MIXED.</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, suppose that we&#8217;re using <em>MIXED</em> mode and we&#8217;re using the Spring integration. Suppose that we have following beans in the Spring configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;singletonDelegateExpressionBean&quot;</span>
  <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.test.fieldinjection.SingletonDelegateExpressionBean&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prototypeDelegateExpressionBean&quot;</span>
  <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.test.fieldinjection.PrototypeDelegateExpressionBean&quot;</span>
  <span class="tok-na">scope=</span><span class="tok-s">&quot;prototype&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first bean is a regular Spring bean and thus a singleton. The second one has <em>prototype</em> as scope, and the Spring container will return a new instance every time the bean is requested.</p>
</div>
<div class="paragraph">
<p>Given following process definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask1&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${prototypeDelegateExpressionBean}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldA&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${input * 2}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldB&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${1 + 1}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariableName&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;resultServiceTask1&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>

<span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask2&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${prototypeDelegateExpressionBean}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldA&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${123}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldB&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${456}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariableName&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;resultServiceTask2&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>

<span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask3&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${singletonDelegateExpressionBean}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldA&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${input * 2}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldB&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${1 + 1}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariableName&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;resultServiceTask1&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>

<span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask4&quot;</span> <span class="tok-na">activiti:delegateExpression=</span><span class="tok-s">&quot;${singletonDelegateExpressionBean}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldA&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${123}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fieldB&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${456}&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariableName&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;resultServiceTask2&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We&#8217;ve got four service tasks, where the first and the second use the <em>${prototypeDelegateExpressionBean}</em> delegate expression and the third and fourth use the <em>${singletonDelegateExpressionBean}</em> delegate expression.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at the prototype bean first:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">PrototypeDelegateExpressionBean</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-n">AtomicInteger</span> <span class="tok-n">INSTANCE_COUNT</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AtomicInteger</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">);</span>

  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">fieldA</span><span class="tok-o">;</span>
  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">fieldB</span><span class="tok-o">;</span>
  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">resultVariableName</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-nf">PrototypeDelegateExpressionBean</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">INSTANCE_COUNT</span><span class="tok-o">.</span><span class="tok-na">incrementAndGet</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>

    <span class="tok-n">Number</span> <span class="tok-n">fieldAValue</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Number</span><span class="tok-o">)</span> <span class="tok-n">fieldA</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>
    <span class="tok-n">Number</span> <span class="tok-n">fieldValueB</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Number</span><span class="tok-o">)</span> <span class="tok-n">fieldB</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>

    <span class="tok-kt">int</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">fieldAValue</span><span class="tok-o">.</span><span class="tok-na">intValue</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-n">fieldValueB</span><span class="tok-o">.</span><span class="tok-na">intValue</span><span class="tok-o">();</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-n">resultVariableName</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">(),</span> <span class="tok-n">result</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When we check the <em>INSTANCE_COUNT</em> after running a process instance of the process definition above, we&#8217;ll get <em>two</em> back, as a new instance is created every time <em>${prototypeDelegateExpressionBean}</em> is resolved. Fields can be injected without any problem here and we can see the three <em>Expression</em> member fields here.</p>
</div>
<div class="paragraph">
<p>The singleton bean, however, looks slightly different:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SingletonDelegateExpressionBean</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kd">static</span> <span class="tok-n">AtomicInteger</span> <span class="tok-n">INSTANCE_COUNT</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AtomicInteger</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">);</span>

  <span class="tok-kd">public</span> <span class="tok-nf">SingletonDelegateExpressionBean</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">INSTANCE_COUNT</span><span class="tok-o">.</span><span class="tok-na">incrementAndGet</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>

    <span class="tok-n">Expression</span> <span class="tok-n">fieldAExpression</span> <span class="tok-o">=</span> <span class="tok-n">DelegateHelper</span><span class="tok-o">.</span><span class="tok-na">getFieldExpression</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">,</span> <span class="tok-s">&quot;fieldA&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">Number</span> <span class="tok-n">fieldA</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Number</span><span class="tok-o">)</span> <span class="tok-n">fieldAExpression</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>

    <span class="tok-n">Expression</span> <span class="tok-n">fieldBExpression</span> <span class="tok-o">=</span> <span class="tok-n">DelegateHelper</span><span class="tok-o">.</span><span class="tok-na">getFieldExpression</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">,</span> <span class="tok-s">&quot;fieldB&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">Number</span> <span class="tok-n">fieldB</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Number</span><span class="tok-o">)</span> <span class="tok-n">fieldBExpression</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>

    <span class="tok-kt">int</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">fieldA</span><span class="tok-o">.</span><span class="tok-na">intValue</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-n">fieldB</span><span class="tok-o">.</span><span class="tok-na">intValue</span><span class="tok-o">();</span>

    <span class="tok-n">String</span> <span class="tok-n">resultVariableName</span> <span class="tok-o">=</span> <span class="tok-n">DelegateHelper</span><span class="tok-o">.</span><span class="tok-na">getFieldExpression</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">,</span> <span class="tok-s">&quot;resultVariableName&quot;</span><span class="tok-o">).</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">();</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-n">resultVariableName</span><span class="tok-o">,</span> <span class="tok-n">result</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>INSTANCE_COUNT</em> will always be <em>one</em> here, as it is a singleton. In this delegate, there are no <em>Expression</em> member fields. This is possible since we&#8217;re running in <em>MIXED</em> mode. In <em>COMPATIBILITY</em> mode, this would throw an exception as it expects the member fields to be there. <em>DISABLED</em> mode would also work for this bean, but it would disallow the use the prototype bean above that does use field injection.</p>
</div>
<div class="paragraph">
<p>In this delegate code, the <strong>org.activiti.engine.delegate.DelegateHelper</strong> class is used, that has some useful utility methods to execute the same logic, but in a thread-safe way when the delegate is a singleton. Instead of injecting the <em>Expression</em>, it is fetched via the <em>getFieldExpression</em> method. This means that when it comes to the service task xml, the fields are defined exactly the same as for the singleton bean. If you look at the xml snippet above, you can see they are equal in definition and only the implementation logic differs.</p>
</div>
<div class="paragraph">
<p>(Technical note: the <em>getFieldExpression</em> will introspect the BpmnModel and create the Expression on the fly when the method is executed, making it thread-safe)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Flowable versions 5.x, the DelegateHelper cannot be used for an <em>ExecutionListener</em> or <em>TaskListener</em> (due to an architectural flaw). To make thread-safe instances of those listeners, use either an expression or make sure a new instance is created every time the delegate expression is resolved.</p>
</li>
<li>
<p>For Flowable version 6.x the DelegateHelper does work in <em>ExecutionListener</em> and <em>TaskListener</em> implementations. For example in version 6.x, the following code can be written, using the <strong>DelegateHelper</strong>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;extensionElements&gt;</span>
  <span class="tok-nt">&lt;activiti:executionListener</span>
      <span class="tok-na">delegateExpression=</span><span class="tok-s">&quot;${testExecutionListener}&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;input&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${startValue}&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVar&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;processStartValue&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/activiti:executionListener&gt;</span>
<span class="tok-nt">&lt;/extensionElements&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <em>testExecutionListener</em> resolves to an instance implementing the ExecutionListener interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-nd">@Component</span><span class="tok-o">(</span><span class="tok-s">&quot;testExecutionListener&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">TestExecutionListener</span> <span class="tok-kd">implements</span> <span class="tok-n">ExecutionListener</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-n">Expression</span> <span class="tok-n">inputExpression</span> <span class="tok-o">=</span> <span class="tok-n">DelegateHelper</span><span class="tok-o">.</span><span class="tok-na">getFieldExpression</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">,</span> <span class="tok-s">&quot;input&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">Number</span> <span class="tok-n">input</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">Number</span><span class="tok-o">)</span> <span class="tok-n">inputExpression</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>

    <span class="tok-kt">int</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">input</span><span class="tok-o">.</span><span class="tok-na">intValue</span><span class="tok-o">()</span> <span class="tok-o">*</span> <span class="tok-mi">100</span><span class="tok-o">;</span>

    <span class="tok-n">Expression</span> <span class="tok-n">resultVarExpression</span> <span class="tok-o">=</span> <span class="tok-n">DelegateHelper</span><span class="tok-o">.</span><span class="tok-na">getFieldExpression</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">,</span> <span class="tok-s">&quot;resultVar&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-n">resultVarExpression</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">(),</span> <span class="tok-n">result</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="serviceTaskResultValue">Service task results</h5>
<div class="paragraph">
<p>The return value of a service execution (for service task using expression only) can be assigned to an already existing or to a new process variable by specifying the process variable name as a literal value for the <em>'activiti:resultVariable'</em> attribute of a service task definition. Any existing value for a specific process variable will be overwritten by the result value of the service execution. When not specifying a result variable name, the service execution result value gets ignored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;aMethodExpressionServiceTask&quot;</span>
    <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;#{myService.doSomething()}&quot;</span>
    <span class="tok-na">activiti:resultVariable=</span><span class="tok-s">&quot;myVar&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the result of the service execution (the return value of the <em>'doSomething()'</em> method invocation on an object that is made available under the name <em>'myService'</em> either in the process variables or as a Spring bean) is set to the process variable named <em>'myVar'</em> after the service execution completes.</p>
</div>
</div>
<div class="sect4">
<h5 id="serviceTaskExceptionHandling">Handling exceptions</h5>
<div class="paragraph">
<p>When custom logic is executed, it is often required to catch certain business exceptions and handle them inside the surrounding process. Flowable provides different options to do that.</p>
</div>
<div class="sect5">
<h6 id="serviceTaskBpmnErrors">Throwing BPMN Errors</h6>
<div class="paragraph">
<p>It is possible to throw BPMN Errors from user code inside Service Tasks or Script Tasks. In order to do this, a special ActivitiException called <em>BpmnError</em> can be thrown in JavaDelegates, scripts, expressions and delegate expressions. The engine will catch this exception and forward it to an appropriate error handler, e.g., a Boundary Error Event or an Error Event Sub-Process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ThrowBpmnErrorDelegate</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-k">try</span> <span class="tok-o">{</span>
      <span class="tok-n">executeBusinessLogic</span><span class="tok-o">();</span>
    <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">BusinessException</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-n">BpmnError</span><span class="tok-o">(</span><span class="tok-s">&quot;BusinessExceptionOccurred&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The constructor argument is an error code, which will be used to determine the error handler that is responsible for the error. See <a href="#bpmnBoundaryErrorEvent">Boundary Error Event</a> for information on how to catch a BPMN Error.</p>
</div>
<div class="paragraph">
<p>This mechanism should be used <strong>only for business faults</strong> that shall be handled by a Boundary Error Event or Error Event Sub-Process modeled in the process definition. Technical errors should be represented by other exception types and are usually not handled inside a process.</p>
</div>
</div>
<div class="sect5">
<h6 id="exceptionMapping">Exception mapping</h6>
<div class="paragraph">
<p>It is also possible to directly map a java exception to business exception by using <code>mapException</code> extension. Single mapping is the simplest form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;servicetask1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Service Task&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;...&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:mapException</span>
          <span class="tok-na">errorCode=</span><span class="tok-s">&quot;myErrorCode1&quot;</span><span class="tok-nt">&gt;</span>org.activiti.SomeException<span class="tok-nt">&lt;/activiti:mapException&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In above code, if an instance of <code>org.activiti.SomeException</code> is thrown in service task, it would be caught and converted to a BPMN exception with the given errorCode. From this point on, it will be handled exactly like a normal BPMN exception.
Any other exception will be treated as if there is no mapping in place. It will be propagated to the API caller.</p>
</div>
<div class="paragraph">
<p>One can map all the child exception of a certain exception in a single line by using <code>includeChildExceptions</code> attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;servicetask1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Service Task&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;...&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:mapException</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;myErrorCode1&quot;</span>
           <span class="tok-na">includeChildExceptions=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>org.activiti.SomeException<span class="tok-nt">&lt;/activiti:mapException&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above code will cause Flowable to convert any direct or indirect descendent of <code>SomeException</code> to a BPMN error with the given error code.
<code>includeChildExceptions</code> will be considered "false" when not given.</p>
</div>
<div class="paragraph">
<p>The most generic mapping is a default map. Default map is a map with no class. It will match any java exception:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;servicetask1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Service Task&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;...&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:mapException</span> <span class="tok-na">errorCode=</span><span class="tok-s">&quot;myErrorCode1&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The mappings are checked in order, from top to bottom and the first found match will be followed, except for the default map. Default map is selected only after all maps are unsuccessfully checked.
Only the first map with no class will be considered as default map. <code>includeChildExceptions</code> is ignored for default Map.</p>
</div>
</div>
<div class="sect5">
<h6 id="serviceTaskExceptionSequenceFlow">Exception Sequence Flow</h6>
<div class="paragraph">
<p><a href="#internal">[INTERNAL: non-public implementation classes]</a></p>
</div>
<div class="paragraph">
<p>Another option is to route process execution through another path in case some exception occurs. The following example shows how this is done.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;javaService&quot;</span>
  <span class="tok-na">name=</span><span class="tok-s">&quot;Java service invocation&quot;</span>
  <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.ThrowsExceptionBehavior&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>

<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;no-exception&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;javaService&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;exception&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;javaService&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;fixException&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the service task has two outgoing sequence flow, called <code>exception</code> and <code>no-exception</code>. This sequence flow id will be used to direct process flow in case of an exception:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ThrowsExceptionBehavior</span> <span class="tok-kd">implements</span> <span class="tok-n">ActivityBehavior</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">ActivityExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">String</span> <span class="tok-n">var</span> <span class="tok-o">=</span> <span class="tok-o">(</span><span class="tok-n">String</span><span class="tok-o">)</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;var&quot;</span><span class="tok-o">);</span>

    <span class="tok-n">PvmTransition</span> <span class="tok-n">transition</span> <span class="tok-o">=</span> <span class="tok-kc">null</span><span class="tok-o">;</span>
    <span class="tok-k">try</span> <span class="tok-o">{</span>
      <span class="tok-n">executeLogic</span><span class="tok-o">(</span><span class="tok-n">var</span><span class="tok-o">);</span>
      <span class="tok-n">transition</span> <span class="tok-o">=</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getActivity</span><span class="tok-o">().</span><span class="tok-na">findOutgoingTransition</span><span class="tok-o">(</span><span class="tok-s">&quot;no-exception&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span> <span class="tok-k">catch</span> <span class="tok-o">(</span><span class="tok-n">Exception</span> <span class="tok-n">e</span><span class="tok-o">)</span> <span class="tok-o">{</span>
      <span class="tok-n">transition</span> <span class="tok-o">=</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getActivity</span><span class="tok-o">().</span><span class="tok-na">findOutgoingTransition</span><span class="tok-o">(</span><span class="tok-s">&quot;exception&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">take</span><span class="tok-o">(</span><span class="tok-n">transition</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="serviceTaskCallActivitiService">Using a Flowable service from within a JavaDelegate</h5>
<div class="paragraph">
<p>For some use cases, it might be needed to use the Flowable services from within a Java service task (e.g. starting a process instance through the RuntimeService, if the callActivity doesn&#8217;t suit your needs). The <em>org.activiti.engine.delegate.DelegateExecution</em> allows to easily use these services through the <em>org.activiti.engine.EngineServices</em> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">StartProcessInstanceTestDelegate</span> <span class="tok-kd">implements</span> <span class="tok-n">JavaDelegate</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">DelegateExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span> <span class="tok-o">=</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getEngineServices</span><span class="tok-o">().</span><span class="tok-na">getRuntimeService</span><span class="tok-o">();</span>
    <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;myProcess&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All of the Flowable service API&#8217;s are available through this interface.</p>
</div>
<div class="paragraph">
<p>All data changes that occur as an effect of using these API calls, will be part of the current transaction. This also works in environments with dependency injection like Spring and CDI with or without a JTA enabled datasource. For example, the following snippet of code will do the same as the snippet above, but now the RuntimeService is injected rather than it is being fetched through the <em>org.activiti.engine.EngineServices</em> interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nd">@Component</span><span class="tok-o">(</span><span class="tok-s">&quot;startProcessInstanceDelegate&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">StartProcessInstanceTestDelegateWithInjection</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Autowired</span>
    <span class="tok-kd">private</span> <span class="tok-n">RuntimeService</span> <span class="tok-n">runtimeService</span><span class="tok-o">;</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">startProcess</span><span class="tok-o">()</span> <span class="tok-o">{</span>
      <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;oneTaskProcess&quot;</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Important technical note:</strong> since the service call is being done as part of the current transaction any data that was produced or altered <em>before</em> the service task is executed, is not yet flushed to the database. All API calls work on the database data, which means that these uncommitted changes are not be <em>visible</em> within the api call of the service task.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnWebserviceTask">8.5.4. Web Service Task</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnWebserviceTaskDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_6">Description</h5>
<div class="paragraph">
<p>A Web Service task is used to synchronously invoke an external Web service.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnWebserviceTaskGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A Web Service task is visualized the same as a Java service task.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.web.service.task.png" alt="bpmn.web.service.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnWebserviceTaskXML">XML representation</h5>
<div class="paragraph">
<p>To use a Web service we need to import its operations and complex types. This can be done automatically by using the import tag pointing to the WSDL of the Web service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;import</span> <span class="tok-na">importType=</span><span class="tok-s">&quot;http://schemas.xmlsoap.org/wsdl/&quot;</span>
	<span class="tok-na">location=</span><span class="tok-s">&quot;http://localhost:63081/counter?wsdl&quot;</span>
	<span class="tok-na">namespace=</span><span class="tok-s">&quot;http://webservice.activiti.org/&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous declaration tells Flowable to import the definitions but it doesn&#8217;t create the item definitions and messages for you. Let&#8217;s suppose we want to invoke a specific method called <em>prettyPrint</em>, therefore we will need to create the corresponding message and item definitions for the request and response messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;message</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prettyPrintCountRequestMessage&quot;</span> <span class="tok-na">itemRef=</span><span class="tok-s">&quot;tns:prettyPrintCountRequestItem&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;message</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prettyPrintCountResponseMessage&quot;</span> <span class="tok-na">itemRef=</span><span class="tok-s">&quot;tns:prettyPrintCountResponseItem&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;itemDefinition</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prettyPrintCountRequestItem&quot;</span> <span class="tok-na">structureRef=</span><span class="tok-s">&quot;counter:prettyPrintCount&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;itemDefinition</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prettyPrintCountResponseItem&quot;</span> <span class="tok-na">structureRef=</span><span class="tok-s">&quot;counter:prettyPrintCountResponse&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Before declaring the service task, we have to define the BPMN interfaces and operations that actually reference the Web service ones. Basically, we define and <em>interface</em> and the required <em>operation&#8217;s</em>. For each operation we reuse the previous defined message for in and out. For example, the following declaration defines the <em>counter</em> interface and the <em>prettyPrintCountOperation</em> operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;interface</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Counter Interface&quot;</span> <span class="tok-na">implementationRef=</span><span class="tok-s">&quot;counter:Counter&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;operation</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prettyPrintCountOperation&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;prettyPrintCount Operation&quot;</span>
			<span class="tok-na">implementationRef=</span><span class="tok-s">&quot;counter:prettyPrintCount&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;inMessageRef&gt;</span>tns:prettyPrintCountRequestMessage<span class="tok-nt">&lt;/inMessageRef&gt;</span>
		<span class="tok-nt">&lt;outMessageRef&gt;</span>tns:prettyPrintCountResponseMessage<span class="tok-nt">&lt;/outMessageRef&gt;</span>
	<span class="tok-nt">&lt;/operation&gt;</span>
<span class="tok-nt">&lt;/interface&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we can declare a Web Service Task by using the ##WebService implementation and a reference to the Web service operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;webService&quot;</span>
	<span class="tok-na">name=</span><span class="tok-s">&quot;Web service invocation&quot;</span>
	<span class="tok-na">implementation=</span><span class="tok-s">&quot;##WebService&quot;</span>
	<span class="tok-na">operationRef=</span><span class="tok-s">&quot;tns:prettyPrintCountOperation&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnWebserviceTaskIOSpecification">Web Service Task IO Specification</h5>
<div class="paragraph">
<p>Unless we are using the simplistic approach for data input and output associations (See below), each Web Service Task needs to declare an IO Specification which states which are the inputs and outputs of the task. The approach is pretty straightforward and BPMN 2.0 complaint, for our prettyPrint example we define the input and output sets according to the previously declared item definitions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;ioSpecification&gt;</span>
	<span class="tok-nt">&lt;dataInput</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;tns:prettyPrintCountRequestItem&quot;</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dataInputOfServiceTask&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;dataOutput</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;tns:prettyPrintCountResponseItem&quot;</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dataOutputOfServiceTask&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;inputSet&gt;</span>
		<span class="tok-nt">&lt;dataInputRefs&gt;</span>dataInputOfServiceTask<span class="tok-nt">&lt;/dataInputRefs&gt;</span>
	<span class="tok-nt">&lt;/inputSet&gt;</span>
	<span class="tok-nt">&lt;outputSet&gt;</span>
		<span class="tok-nt">&lt;dataOutputRefs&gt;</span>dataOutputOfServiceTask<span class="tok-nt">&lt;/dataOutputRefs&gt;</span>
	<span class="tok-nt">&lt;/outputSet&gt;</span>
<span class="tok-nt">&lt;/ioSpecification&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnWebserviceTaskDataInputAssociation">Web Service Task data input associations</h5>
<div class="paragraph">
<p>There are 2 ways of specifying data input associations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using expressions</p>
</li>
<li>
<p>Using the simplistic approach</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify the data input association using expressions we need to define the source and target items and specify the corresponding assignments between the fields of each item. In the following example we assign prefix and suffix fields of the items:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;dataInputAssociation&gt;</span>
	<span class="tok-nt">&lt;sourceRef&gt;</span>dataInputOfProcess<span class="tok-nt">&lt;/sourceRef&gt;</span>
	<span class="tok-nt">&lt;targetRef&gt;</span>dataInputOfServiceTask<span class="tok-nt">&lt;/targetRef&gt;</span>
	<span class="tok-nt">&lt;assignment&gt;</span>
		<span class="tok-nt">&lt;from&gt;</span>${dataInputOfProcess.prefix}<span class="tok-nt">&lt;/from&gt;</span>
		<span class="tok-nt">&lt;to&gt;</span>${dataInputOfServiceTask.prefix}<span class="tok-nt">&lt;/to&gt;</span>
	<span class="tok-nt">&lt;/assignment&gt;</span>
	<span class="tok-nt">&lt;assignment&gt;</span>
		<span class="tok-nt">&lt;from&gt;</span>${dataInputOfProcess.suffix}<span class="tok-nt">&lt;/from&gt;</span>
		<span class="tok-nt">&lt;to&gt;</span>${dataInputOfServiceTask.suffix}<span class="tok-nt">&lt;/to&gt;</span>
	<span class="tok-nt">&lt;/assignment&gt;</span>
<span class="tok-nt">&lt;/dataInputAssociation&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand we can use the simplistic approach which is much more simple. The <em>sourceRef</em> element is a Flowable variable name and the <em>targetRef</em> element is a property of the item definition. In the following example we assign to the <em>prefix</em> field the value of the variable <em>PrefixVariable</em> and to the <em>suffix</em> field the value of the variable <em>SuffixVariable</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;dataInputAssociation&gt;</span>
	<span class="tok-nt">&lt;sourceRef&gt;</span>PrefixVariable<span class="tok-nt">&lt;/sourceRef&gt;</span>
	<span class="tok-nt">&lt;targetRef&gt;</span>prefix<span class="tok-nt">&lt;/targetRef&gt;</span>
<span class="tok-nt">&lt;/dataInputAssociation&gt;</span>
<span class="tok-nt">&lt;dataInputAssociation&gt;</span>
	<span class="tok-nt">&lt;sourceRef&gt;</span>SuffixVariable<span class="tok-nt">&lt;/sourceRef&gt;</span>
	<span class="tok-nt">&lt;targetRef&gt;</span>suffix<span class="tok-nt">&lt;/targetRef&gt;</span>
<span class="tok-nt">&lt;/dataInputAssociation&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnWebserviceTaskDataOutputAssociation">Web Service Task data output associations</h5>
<div class="paragraph">
<p>There are 2 ways of specifying data out associations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using expressions</p>
</li>
<li>
<p>Using the simplistic approach</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To specify the data out association using expressions we need to define the target variable and the source expression. The approach is pretty straightforward and similar data input associations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;dataOutputAssociation&gt;</span>
	<span class="tok-nt">&lt;targetRef&gt;</span>dataOutputOfProcess<span class="tok-nt">&lt;/targetRef&gt;</span>
	<span class="tok-nt">&lt;transformation&gt;</span>${dataOutputOfServiceTask.prettyPrint}<span class="tok-nt">&lt;/transformation&gt;</span>
<span class="tok-nt">&lt;/dataOutputAssociation&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand we can use the simplistic approach which is much more simple. The <em>sourceRef</em> element is a property of the item definition and the <em>targetRef</em> element is a Flowable variable name. The approach is pretty straightforward and similar data input associations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;dataOutputAssociation&gt;</span>
	<span class="tok-nt">&lt;sourceRef&gt;</span>prettyPrint<span class="tok-nt">&lt;/sourceRef&gt;</span>
	<span class="tok-nt">&lt;targetRef&gt;</span>OutputVariable<span class="tok-nt">&lt;/targetRef&gt;</span>
<span class="tok-nt">&lt;/dataOutputAssociation&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnBusinessRuleTask">8.5.5. Business Rule Task</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnBusinessRuleTaskDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_7">Description</h5>
<div class="paragraph">
<p>A Business Rule task is used to synchronously execute one or more rules. Flowable uses Drools Expert, the Drools rule engine to execute business rules. Currently, the .drl files containing the business rules have to be deployed together with the process definition that defines a business rule task to execute those rules. This means that all .drl files that are used in a process have to be packaged in the process BAR file like for example the task forms. For more information about creating business rules for Drools Expert please refer to the Drools documentation at <a href="http://www.jboss.org/drools/documentation">JBoss Drools</a></p>
</div>
<div class="paragraph">
<p>If you want to plug in your implementation of the rule task, e.g. because you want to use Drools differently or you want to use a completely different rule engine, then you can use the class or expression attribute on the BusinessRuleTask and it will behave exactly like a <a href="#bpmnJavaServiceTask">ServiceTask</a></p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBusinessRuleTaskGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A Business Rule task is visualized the with a table icon.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.business.rule.task.png" alt="bpmn.business.rule.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnBusinessRuleTaskXML">XML representation</h5>
<div class="paragraph">
<p>To execute one or more business rules that are deployed in the same BAR file as the process definition, we need to define the input and result variables. For the input variable definition a list of process variables can be defined separated by a comma. The output variable definition can only contain one variable name that will be used to store the output objects of the executed business rules in a process variable. Note that the result variable will contain a List of objects. If no result variable name is specified by default org.activiti.engine.rules.OUTPUT is used.</p>
</div>
<div class="paragraph">
<p>The following business rule task executes all business rules deployed with the process definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;simpleBusinessRuleProcess&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;businessRuleTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-na">activiti:ruleVariablesInput=</span><span class="tok-s">&quot;${order}&quot;</span>
      <span class="tok-na">activiti:resultVariable=</span><span class="tok-s">&quot;rulesOutput&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The business rule task can also be configured to execute only a defined set of rules from the deployed .drl files. A list of rule names separated by a comma must be specified for this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;businessRuleTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-na">activiti:ruleVariablesInput=</span><span class="tok-s">&quot;${order}&quot;</span>
      <span class="tok-na">activiti:rules=</span><span class="tok-s">&quot;rule1, rule2&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case only rule1 and rule2 are executed.</p>
</div>
<div class="paragraph">
<p>You can also define a list of rules that should be excluded from execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;businessRuleTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-na">activiti:ruleVariablesInput=</span><span class="tok-s">&quot;${order}&quot;</span>
      <span class="tok-na">activiti:rules=</span><span class="tok-s">&quot;rule1, rule2&quot;</span> <span class="tok-na">exclude=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case all rules deployed in the same BAR file as the process definition will be executed, except for rule1 and rule2.</p>
</div>
<div class="paragraph">
<p>As mentioned earlier another option is to hook in the implementation of the BusinessRuleTask yourself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;businessRuleTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;businessRuleTask&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;${MyRuleServiceDelegate}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now the BusinessRuleTask behaves exactly like a ServiceTask, but still keeps the BusinessRuleTask icon to visualize that we do business rule processing here.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnEmailTask">8.5.6. Email Task</h4>
<div class="paragraph">
<p>Flowable allows to enhance business processes with automatic mail service tasks that send e-mails to one or more recipients, including support for cc, bcc, HTML content, &#8230;&#8203; etc. Note that the mail task is <strong>not</strong> an <em>official</em> task of the BPMN 2.0 spec (and it does not have a dedicated icon as a consequence). Hence, in Flowable the mail task is implemented as a dedicated service task.</p>
</div>
<div class="sect4">
<h5 id="bpmnEmailTaskServerConfiguration">Mail server configuration</h5>
<div class="paragraph">
<p>The Flowable engine sends e-mails trough an external mail server with SMTP capabilities. To actually send e-mails, the engine needs to know how to reach the mail server. Following properties can be set in the <em>activiti.cfg.xml</em> configuration file:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerHost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hostname of your mail server (e.g. mail.mycorp.com). Default is <code>localhost</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes, if not on the default port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port for SMTP traffic on the mail server. The default is <em>25</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerDefaultFrom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The default e-mail address of the sender of e-mails, when none is provided by the user. By default this is <em>flowable@flowable.org</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerUsername</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if applicable for your server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some mail servers require credentials for sending e-mail. By default not set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerPassword</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if applicable for your server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some mail servers require credentials for sending e-mail. By default not set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerUseSSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if applicable for your server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some mail servers require ssl communication. By default set to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mailServerUseTLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if applicable for your server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Some mail servers (for instance gmail) require TLS communication. By default set to false.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="bpmnEmailTaskUsage">Defining an Email Task</h5>
<div class="paragraph">
<p>The Email task is implemented as a dedicated <a href="#bpmnJavaServiceTask">Service Task</a> and is defined by setting <em>'mail'</em> for the <em>type</em> of the service task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendMail&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;mail&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Email task is configured by <a href="#serviceTaskFieldInjection">field injection</a>. All the values for these properties can contain EL expression, which are resolved at runtime during process execution. Following properties can be set:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The recipients if the e-mail. Multiple recipients are defined in a comma-separated list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">from</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The sender e-mail address. If not provided, the <a href="#bpmnEmailTaskServerConfiguration">default configured</a> from address is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subject</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The subject of the e-mail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cc&#8217;s of the e-mail. Multiple recipients are defined in a comma-separated list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bcc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The bcc&#8217;s of the e-mail. Multiple recipients are defined in a comma-separated list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">charset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to change the charset of the email, which is necessary for many
                 non-English languages.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">html</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A piece of HTML that is the content of the e-mail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The content of the e-mail, in case one needs to send plain none-rich e-mails.
                   Can be used in combination with <em>html</em>, for e-mail clients
                   that don&#8217;t support rich content. The client will then fall back to this text-only alternative.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">htmlVar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a process variable that holds the HTML that is the content of the e-mail. The key difference between this and html is that this content will have expressions replaced before being sent by the mail task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">textVar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of a process variable that holds the plain text content of the e-mail. The key difference between this and html is that this content will have expressions replaced before being sent by the mail task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ignoreException</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether an failure when handling the e-mail throws an ActivitiException. By default this is set to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exceptionVariableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When email handling does not throw an exception since <em>ignoreException = true</em> a variable with the given name is used to hold a failure message</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="bpmnEmailTaskExampleUsage">Example usage</h5>
<div class="paragraph">
<p>The following XML snippet shows an example of using the Email Task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendMail&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;mail&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;from&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;order-shipping@thecompany.com&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;to&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${recipient}&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;subject&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;Your order ${orderId} has been shipped&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;html&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;activiti:expression&gt;</span>
        <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">          &lt;html&gt;</span>
<span class="tok-cp">            &lt;body&gt;</span>
<span class="tok-cp">              Hello ${male ? &#39;Mr.&#39; : &#39;Mrs.&#39; } ${recipientName},&lt;br/&gt;&lt;br/&gt;</span>

<span class="tok-cp">              As of ${now}, your order has been &lt;b&gt;processed and shipped&lt;/b&gt;.&lt;br/&gt;&lt;br/&gt;</span>

<span class="tok-cp">              Kind regards,&lt;br/&gt;</span>

<span class="tok-cp">              TheCompany.</span>
<span class="tok-cp">            &lt;/body&gt;</span>
<span class="tok-cp">          &lt;/html&gt;</span>
<span class="tok-cp">        ]]&gt;</span>
      <span class="tok-nt">&lt;/activiti:expression&gt;</span>
    <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>with the following result:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/email.task.result.png" alt="email.task.result">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnMuleTask">8.5.7. Mule Task</h4>
<div class="paragraph">
<p>The mule task allows to send messages to Mule enhancing the integration features of Flowable. Note that the mule task is <strong>not</strong> an <em>official</em> task of the BPMN 2.0 spec (and it does not have a dedicated icon as a consequence). Hence, in Flowable the mule task is implemented as a dedicated service task.</p>
</div>
<div class="sect4">
<h5 id="bpmnMuleTaskUsage">Defining an Mule Task</h5>
<div class="paragraph">
<p>The Mule task is implemented as a dedicated <a href="#bpmnJavaServiceTask">Service Task</a> and is defined by setting <em>'mule'</em> for the <em>type</em> of the service task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendMule&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;mule&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Mule task is configured by <a href="#serviceTaskFieldInjection">field injection</a>. All the values for these properties can contain EL expression, which are resolved at runtime during process execution. Following properties can be set:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required?</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">endpointUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Mule endpoint you want to invoke.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The language you want to use to evaluate the payloadExpression field.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">payloadExpression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An expression that will be the message&#8217;s payload.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resultVariable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable which will store the result of the invocation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="bpmnMuleTaskExampleUsage">Example usage</h5>
<div class="paragraph">
<p>The following XML snippet shows an example of using the Mule Task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nt">&lt;extensionElements&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;endpointUrl&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>vm://in<span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;language&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>juel<span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;payloadExpression&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>&quot;hi&quot;<span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariable&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>theVariable<span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
<span class="tok-nt">&lt;/extensionElements&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnCamelTask">8.5.8. Camel Task</h4>
<div class="paragraph">
<p>The Camel task allows to send messages to and receive messages from Camel and thereby enhances the integration features of Flowable. Note that the Camel task is <strong>not</strong> an <em>official</em> task of the BPMN 2.0 spec (and it does not have a dedicated icon as a consequence). Hence, in Flowable the Camel task is implemented as a dedicated service task. Also note to include the Flowable Camel module in your project to use the Camel task functionality.</p>
</div>
<div class="sect4">
<h5 id="bpmnCamelTaskUsage">Defining a Camel Task</h5>
<div class="paragraph">
<p>The Camel task is implemented as a dedicated <a href="#bpmnJavaServiceTask">Service Task</a> and is defined by setting <em>'camel'</em> for the <em>type</em> of the service task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendCamel&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The process definition itself needs nothing else then the camel type definition on a service task. The integration logic is all delegated to the Camel container. By default the Flowable Engine looks for a camelContext bean in the Spring container. The camelContext bean defines the Camel routes that will be loaded by the Camel container. In the following example the routes are loaded from a specific Java package, but you can also define routes directly in the Spring configuration itself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;camelContext</span> <span class="tok-na">id=</span><span class="tok-s">&quot;camelContext&quot;</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://camel.apache.org/schema/spring&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;packageScan&gt;</span>
    <span class="tok-nt">&lt;package&gt;</span>org.activiti.camel.route<span class="tok-nt">&lt;/package&gt;</span>
  <span class="tok-nt">&lt;/packageScan&gt;</span>
<span class="tok-nt">&lt;/camelContext&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more documentation about Camel routes you can look on the <a href="http://camel.apache.org/">Camel website</a>. The basic concepts are demonstrated through a few small samples here in this document. In the first sample, we will do the simplest form of Camel call from a Flowable workflow. Let&#8217;s call it SimpleCamelCall.</p>
</div>
<div class="paragraph">
<p>If you want to define multiple Camel context beans and/or want to use a different bean name, this can be overridden on the Camel task definition like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask1&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;camelContext&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;customCamelContext&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCamelTaskSimpleCamelCall">Simple Camel Call example</h5>
<div class="paragraph">
<p>All the files related to this example can be found in org.activiti.camel.examples.simpleCamelCall package of activiti-camel module. The target is simply activating a specific camel route. First of all we need an Spring context which contains the introduction to the routes as mentioned previously. This part of the file serves this purpose:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;camelContext</span> <span class="tok-na">id=</span><span class="tok-s">&quot;camelContext&quot;</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://camel.apache.org/schema/spring&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;packageScan&gt;</span>
    <span class="tok-nt">&lt;package&gt;</span>org.activiti.camel.examples.simpleCamelCall<span class="tok-nt">&lt;/package&gt;</span>
  <span class="tok-nt">&lt;/packageScan&gt;</span>
<span class="tok-nt">&lt;/camelContext&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">SimpleCamelCallRoute</span> <span class="tok-kd">extends</span> <span class="tok-n">RouteBuilder</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">configure</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:SimpleCamelCallProcess:simpleCall&quot;</span><span class="tok-o">).</span><span class="tok-na">to</span><span class="tok-o">(</span><span class="tok-s">&quot;log:org.activiti.camel.examples.SimpleCamelCall&quot;</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The route just logs the message body and nothing more. Notice the format of the from endpoint. It is consisted of three parts:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Endpoint Url Part</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activiti</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">refers to Activiti endpoint</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SimpleCamelCallProcess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name of the process</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">simpleCall</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name of the Camel service in the process</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Ok, our route is now properly configured and accessible to the Camel. Now comes the workflow part. The workflow looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;SimpleCamelCallProcess&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;simpleCall&quot;</span><span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;simpleCall&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span><span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;simpleCall&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;end&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCamelTaskPingPong">Ping Pong example</h5>
<div class="paragraph">
<p>Our example worked but nothing is really transferred between Camel and Flowable and there is not much merit in it. In this example we try to send and receive data to and from Camel. We send a string, camel concatenates something to it and returns back the result. The sender part is trivial, we send our message in form of a variable to Camel Task. Here is our caller code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nd">@Deployment</span>
<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">testPingPong</span><span class="tok-o">()</span> <span class="tok-o">{</span>
  <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>

  <span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;input&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Hello&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;</span> <span class="tok-n">outputMap</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">String</span><span class="tok-o">&gt;();</span>
  <span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;outputMap&quot;</span><span class="tok-o">,</span> <span class="tok-n">outputMap</span><span class="tok-o">);</span>

  <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;PingPongProcess&quot;</span><span class="tok-o">,</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
  <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-mi">1</span><span class="tok-o">,</span> <span class="tok-n">outputMap</span><span class="tok-o">.</span><span class="tok-na">size</span><span class="tok-o">());</span>
  <span class="tok-n">assertNotNull</span><span class="tok-o">(</span><span class="tok-n">outputMap</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-s">&quot;outputValue&quot;</span><span class="tok-o">));</span>
  <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;Hello World&quot;</span><span class="tok-o">,</span> <span class="tok-n">outputMap</span><span class="tok-o">.</span><span class="tok-na">get</span><span class="tok-o">(</span><span class="tok-s">&quot;outputValue&quot;</span><span class="tok-o">));</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The variable "input" is actually the input for the Camel route and outputMap is there to capture the result back from Camel. The process should be something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;PingPongProcess&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;ping&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;ping&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;ping&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;saveOutput&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;saveOutput&quot;</span>  <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.camel.examples.pingPong.SaveOutput&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;saveOutput&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;end&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that SaveOutput Service task, stores the value of "Output" variable from context to the previously mentioned OutputMap. Now we have to know how the variables are send to Camel and returned back. Here comes the notion of Camel behaviour into the play. The way variables are communicated to Camel is configurable via CamelBehavior. Here we use Default one in our sample, a short description of the other ones comes afterwards. With such a code you can configure the desired camel behaviour:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceTask1&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;camelBehaviorClass&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;org.activiti.camel.impl.CamelBehaviorCamelBodyImpl&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not specify and specific behaviour then, org.activiti.camel.impl.CamelBehaviorDefaultImpl will be set. This behaviour copies the variables to Camel properties of the same name. In return regardless of selected behaviour, if the camel message body is a map, then each of its elements is copied as a variable, else the whole object is copied into a specific variable with the name of "camelBody". Knowing that, this camel route concludes our second example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nd">@Override</span>
<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">configure</span><span class="tok-o">()</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
  <span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:PingPongProcess:ping&quot;</span><span class="tok-o">).</span><span class="tok-na">transform</span><span class="tok-o">().</span><span class="tok-na">simple</span><span class="tok-o">(</span><span class="tok-s">&quot;${property.input} World&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this route, the string "world" is concatenated to the end of property named "input" and the result will be in the message body. It is accessible by checking "camelBody" variable in the java service task and copied to "outputMap" and checked in test case. Now that the example on its default behaviour works, lets see what are the other possibilities. In starting every camel route, the Process Instance ID will be copied into a camel property with the specific name of "PROCESS_ID_PROPERTY". It is later used for correlating the process instance and camel route. Also it can be exploited in the Camel route.</p>
</div>
<div class="paragraph">
<p>There are three different behaviours already available out of the box in Flowable. The behaviour can be overwritten by a specific phrase in the route URL. Here is an example of overriding the already defined behaviour in URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:asyncCamelProcess:serviceTaskAsync2?copyVariablesToProperties=true&quot;</span><span class="tok-o">).</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>the following table provides an overview of three available camel behaviours:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Behaviour</th>
<th class="tableblock halign-left valign-top">In Url</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CamelBehaviorDefaultImpl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyVariablesToProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy Flowable variables as Camel properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CamelBehaviorCamelBodyImpl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyCamelBodyToBody</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy only Flowable variable named "camelBody" as camel message body</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CamelBehaviorBodyAsMapImpl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyVariablesToBodyAsMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy all the Flowable variables in a map as Camel message body</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The above table explains how Flowable variables are going to be transferred to Camel. The following table explains how the Camel variables are returned back to Flowable. This can only be configured in route URLs.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Url</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If Camel body is a map, copy each element as a Flowable variable, otherwise copy the whole Camel body as a "camelBody" Flowable variable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyVariablesFromProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy Camel properties as Flowable variables of the same name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyCamelBodyToBodyAsString</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">like default, but if camel Body is not a map, first convert it to String and then copy it in "camelBody"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">copyVariablesFromHeader</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additionally copy camel headers to Flowable variables of the same names</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_returning_back_the_variables">Returning back the variables</h5>
<div class="paragraph">
<p>What is mentioned above about passing variables, only holds for start side of the variable transfer, in both directions from Camel to Flowable and vice versa.<br>
It is important to notice that because of special non blocking behavior of Flowable, variables are not automatically returned back from Flowable to Camel.
For that to happen, a special syntax is available. There can be one or more parameters in Camel route URL in format of <code>var.return.someVariableName</code>.
All variables having a name equal to one of these parameters without <code>var.return</code> part, will be considered as output variables and will be copied back as camel properties with the same names.<br>
For example in a route like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>from("direct:start").to("activiti:process?var.return.exampleVar").to("mock:result");</pre>
</div>
</div>
<div class="paragraph">
<p>A Flowable variable with the name of <code>exampleVar</code> will be considered as output variable and will be copied back as a property in camel with the same name.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCamelTaskAsyncPingPong">Asynchronous Ping Pong example</h5>
<div class="paragraph">
<p>Previous examples were all synchronous. The workflow stops, until the camel route is concluded and returned. In some cases, we might need the Flowable workflow to continue. For such purposes the asynchronous capability of the Camel service task is useful. You can make use of this feature by setting the async property of the Camel service task to true.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;serviceAsyncPing&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;camel&quot;</span> <span class="tok-na">activiti:async=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>By setting this feature the specified Camel route is activated asynchronously by the Flowable job executor. When you define a queue in the Camel route the Flowable process will continue with the activities after the Camel service task. The Camel route will be executed fully asynchronously from the process execution. If you want to wait for a response of the Camel service task somewhere in your process definition, you can use a receive task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;receiveTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;receiveAsyncPing&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Wait State&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The process instance will wait until a signal is received, for example from Camel. In Camel you can send a signal to the process instance by sending a message to the proper Flowable endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span> <span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:asyncPingProcess:serviceAsyncPing&quot;</span><span class="tok-o">).</span><span class="tok-na">to</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:asyncPingProcess:receiveAsyncPing&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>constant string "activiti"</p>
</li>
<li>
<p>process name</p>
</li>
<li>
<p>receive task name</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCamelTaskAsyncPingPong">Instantiate workflow from Camel route</h5>
<div class="paragraph">
<p>In our all previous examples Flowable workflow started first and the Camel route was started within workflow. It is also possible from the other side. It is possible that a workflow is instantiated from an already started camel route. It is very similar to signalling receive task, except that the last part is not there. Here is a sample route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;direct:start&quot;</span><span class="tok-o">).</span><span class="tok-na">to</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:camelProcess&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>as you see the url has two parts, the first is constant string "flowable" and the second name is the name of the process. Obviously the process should already be deployed and startable by engine configuration.</p>
</div>
<div class="paragraph">
<p>It is also possible to set the initiator of the process to some authenticated user id that is provided in a Camel header. To achieve this first of all an initiator variable must be specified in the process definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">activiti:initiator=</span><span class="tok-s">&quot;initiator&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then given that the user id is contained in a Camel header named <em>CamelProcessInitiatorHeader</em> the Camel route could be defined as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-n">from</span><span class="tok-o">(</span><span class="tok-s">&quot;direct:startWithInitiatorHeader&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">setHeader</span><span class="tok-o">(</span><span class="tok-s">&quot;CamelProcessInitiatorHeader&quot;</span><span class="tok-o">,</span> <span class="tok-n">constant</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">))</span>
    <span class="tok-o">.</span><span class="tok-na">to</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti:InitiatorCamelCallProcess?processInitiatorHeaderName=CamelProcessInitiatorHeader&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnManualTask">8.5.9. Manual Task</h4>
<div class="sect4">
<h5 id="bpmnManualTaskDescription">Description</h5>
<div class="paragraph">
<p>A <em>Manual Task</em> defines a task that is external to the BPM engine. It is used to model work that is done by somebody, which the engine does not need to know of, nor is there a system or UI interface. For the engine, a manual task is handled as a <strong>pass-through activity</strong>, automatically continuing the process from the moment process execution arrives into it.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnManualTaskGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A manual task is visualized as a rounded rectangle, with a little <em>hand</em> icon in the upper left corner</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.manual.task.png" alt="bpmn.manual.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnManualTaskXml">XML representation</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;manualTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myManualTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Call client for more information&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnReceiveTask">8.5.10. Java Receive Task</h4>
<div class="sect4">
<h5 id="bpmnReceiveTaskDescription">Description</h5>
<div class="paragraph">
<p>A Receive Task is a simple task that waits for the arrival of a certain message. Currently, we have only implemented Java semantics for this task. When process execution arrives at a Receive Task, the process state is committed to the persistence store. This means that the process will stay in this wait state, until a specific message is received by the engine, which triggers the continuation of the process past the Receive Task.</p>
</div>
</div>
<div class="sect4">
<h5 id="_graphical_notation_2">Graphical notation</h5>
<div class="paragraph">
<p>A Receive Task is visualized as a task (rounded rectangle) with a message icon in the top left corner. The message is white (a black message icon would have send semantics)</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.receive.task.png" alt="bpmn.receive.task">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_xml_representation_2">XML representation</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;receiveTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;waitState&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;wait&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>To continue a process instance that is currently waiting at such a Receive Task, the <em>runtimeService.signal(executionId)</em> must be called using the id of the execution that arrived in the Receive Task. The following code snippet shows how this works in practice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-n">ProcessInstance</span> <span class="tok-n">pi</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;receiveTask&quot;</span><span class="tok-o">);</span>
<span class="tok-n">Execution</span> <span class="tok-n">execution</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createExecutionQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-n">pi</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">())</span>
  <span class="tok-o">.</span><span class="tok-na">activityId</span><span class="tok-o">(</span><span class="tok-s">&quot;waitState&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
<span class="tok-n">assertNotNull</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">);</span>

<span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">signal</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnShellTask">8.5.11. Shell Task</h4>
<div class="sect4">
<h5 id="bpmnShellTaskDescription">Description</h5>
<div class="paragraph">
<p>The shell task allows to run shell scripts and commands. Note that the Shell task is <strong>not</strong> an <em>official</em> task of BPMN 2.0 spec (and it does not have a dedicated icon as a consequence).</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnShellTaskUsage">Defining a shell task</h5>
<div class="paragraph">
<p>The shell task is implemented as a dedicated <a href="#bpmnJavaServiceTask">Service Task</a> and is defined by setting <em>'shell'</em> for the <em>type</em> of the service task.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;shellEcho&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;shell&quot;</span><span class="tok-nt">&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Shell task is configured by <a href="#serviceTaskFieldInjection">field injection</a>. All the values for these properties can contain EL expression, which are resolved at runtime during process execution. Following properties could be set:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required?</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shell command to execute.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arg0-5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter 0 to Parameter 5</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wait</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true/false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wait if necessary, until the shell process has terminated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">redirectError</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true/false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Merge standard error with the standard output.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cleanEnv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true/false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shell process does not inherit current environment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">outputVariable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of variable to contain the output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output is not recorded.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">errorCodeVariable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of variable to contain result error code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error level is not registered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default directory of shell process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current directory</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="bpmnShellTaskExampleUsage">Example usage</h5>
<div class="paragraph">
<p>The following XML snippet shows an example of using the shell Task. It runs shell script "cmd /c echo EchoTest", waits for it to be terminated and puts the result in resultVar</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;shellEcho&quot;</span> <span class="tok-na">activiti:type=</span><span class="tok-s">&quot;shell&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;command&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;cmd&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;arg1&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;/c&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;arg2&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;echo&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;arg3&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;EchoTest&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;wait&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;outputVariable&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;resultVar&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="executionListeners">8.5.12. Execution listener</h4>
<div class="paragraph">
<p><strong>Compatibility note</strong>: After releasing 5.3, we discovered that execution listeners and task listeners and expressions were still in non-public API. Those classes were in subpackages of <code>org.activiti.engine.impl&#8230;&#8203;</code>,  which has <code>impl</code> in it). <code>org.activiti.engine.impl.pvm.delegate.ExecutionListener</code>, <code>org.activiti.engine.impl.pvm.delegate.TaskListener</code> and <code>org.activiti.engine.impl.pvm.el.Expression</code> have been deprecated. From now on, you should use <code>org.activiti.engine.delegate.ExecutionListener</code>, <code>org.activiti.engine.delegate.TaskListener</code> and <code>org.activiti.engine.delegate.Expression</code>. In the new publicly available API, access to <code>ExecutionListenerExecution.getEventSource()</code> has been removed.  Apart from the deprecation compiler warning, the existing code should run fine.  But consider switching to the new public API interfaces (without .impl. in the package name).</p>
</div>
<div class="paragraph">
<p>Execution listeners allow you to execute external Java code or evaluate an expression when certain events occur during process execution. The events that can be captured are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start and ending of a process instance.</p>
</li>
<li>
<p>Taking a transition.</p>
</li>
<li>
<p>Start and ending of an activity.</p>
</li>
<li>
<p>Start and ending of a gateway.</p>
</li>
<li>
<p>Start and ending of intermediate events.</p>
</li>
<li>
<p>Ending a start event or starting an end event.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following process definition contains 3 execution listeners:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;executionListenersProcess&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.executionlistener.ExampleExecutionListenerOne&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>

  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;secondTask&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
      <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.executionListener.ExampleExecutionListenerTwo&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/extensionElements&gt;</span>
  <span class="tok-nt">&lt;/sequenceFlow&gt;</span>

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;secondTask&quot;</span> <span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
      <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${myPojo.myMethod(execution.event)}&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/extensionElements&gt;</span>
  <span class="tok-nt">&lt;/userTask&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;secondTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;thirdTask&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;thirdTask&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;thirdTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first execution listener is notified when the process starts. The listener is an external Java-class (like <code>ExampleExecutionListenerOne</code>) and should implement <code>org.activiti.engine.delegate.ExecutionListener</code> interface. When the event occurs (in this case <code>end</code> event) the method <code>notify(ExecutionListenerExecution execution)</code> is called.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ExampleExecutionListenerOne</span> <span class="tok-kd">implements</span> <span class="tok-n">ExecutionListener</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">ExecutionListenerExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;variableSetInExecutionListener&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;firstValue&quot;</span><span class="tok-o">);</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;eventReceived&quot;</span><span class="tok-o">,</span> <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">getEventName</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to use a delegation class that implements the <code>org.activiti.engine.delegate.JavaDelegate</code> interface. These delegation classes can then be reused in other constructs, such as a delegation for a serviceTask.</p>
</div>
<div class="paragraph">
<p>The second execution listener is called when the transition is taken. Note that the <code>listener</code> element doesn&#8217;t define an <code>event</code>, since only <code>take</code> events are fired on transitions. <strong>Values in the <code>event</code> attribute are ignored when a listener is defined on a transition.</strong></p>
</div>
<div class="paragraph">
<p>The last execution listener is called when activity <code>secondTask</code> ends. Instead of using the <code>class</code> on the listener declaration, a <code>expression</code> is defined instead which is evaluated/invoked when the event is fired.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${myPojo.myMethod(execution.eventName)}&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>As with other expressions, execution variables are resolved and can be used. Because the execution implementation object has a property that exposes the event name, it&#8217;s possible to pass the event-name to your methods using <code>execution.eventName</code>.</p>
</div>
<div class="paragraph">
<p>Execution listeners also support using a <code>delegateExpression</code>, <a href="#bpmnJavaServiceTaskXML">similar to a service task</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">delegateExpression=</span><span class="tok-s">&quot;${myExecutionListenerBean}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A while back, we also introduced a new type of execution listener, the org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener. This script execution listener allows you to execute a piece of script logic for an execution listener event.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;script&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>
      def bar = &quot;BAR&quot;;  // local variable
      foo = &quot;FOO&quot;; // pushes variable to execution context
      execution.setVariable(&quot;var1&quot;, &quot;test&quot;); // test access to execution instance
      bar // implicit return value
    <span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;language&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;groovy&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariable&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;myVar&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/activiti:executionListener&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="executionListenerFieldInjection">Field injection on execution listeners</h5>
<div class="paragraph">
<p>When using an execution listener that is configured with the <code>class</code> attribute, field injection can be applied. This is exactly the same mechanism as used <a href="#serviceTaskFieldInjection">Service task field injection</a>, which contains an overview of the possibilities provided by field injection.</p>
</div>
<div class="paragraph">
<p>The fragment below shows a simple example process with an execution listener with fields injected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;executionListenersProcess&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.examples.bpmn.executionListener.ExampleFieldInjectedExecutionListener&quot;</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;fixedValue&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;Yes, I am &quot;</span> <span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dynamicValue&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;${myVar}&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/activiti:executionListener&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>

  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;firstTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>

  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theEnd&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/process&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ExampleFieldInjectedExecutionListener</span> <span class="tok-kd">implements</span> <span class="tok-n">ExecutionListener</span> <span class="tok-o">{</span>

  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">fixedValue</span><span class="tok-o">;</span>

  <span class="tok-kd">private</span> <span class="tok-n">Expression</span> <span class="tok-n">dynamicValue</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">ExecutionListenerExecution</span> <span class="tok-n">execution</span><span class="tok-o">)</span> <span class="tok-kd">throws</span> <span class="tok-n">Exception</span> <span class="tok-o">{</span>
    <span class="tok-n">execution</span><span class="tok-o">.</span><span class="tok-na">setVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;var&quot;</span><span class="tok-o">,</span> <span class="tok-n">fixedValue</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-n">dynamicValue</span><span class="tok-o">.</span><span class="tok-na">getValue</span><span class="tok-o">(</span><span class="tok-n">execution</span><span class="tok-o">).</span><span class="tok-na">toString</span><span class="tok-o">());</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>ExampleFieldInjectedExecutionListener</code> concatenates the 2 injected fields (one fixed an the other dynamic) and stores this in the process variable <em><code>var</code></em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nd">@Deployment</span><span class="tok-o">(</span><span class="tok-n">resources</span> <span class="tok-o">=</span> <span class="tok-o">{</span><span class="tok-s">&quot;org/activiti/examples/bpmn/executionListener/ExecutionListenersFieldInjectionProcess.bpmn20.xml&quot;</span><span class="tok-o">})</span>
<span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">testExecutionListenerFieldInjection</span><span class="tok-o">()</span> <span class="tok-o">{</span>
  <span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
  <span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;myVar&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;listening!&quot;</span><span class="tok-o">);</span>

  <span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;executionListenersProcess&quot;</span><span class="tok-o">,</span> <span class="tok-n">variables</span><span class="tok-o">);</span>

  <span class="tok-n">Object</span> <span class="tok-n">varSetByListener</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-n">processInstance</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-s">&quot;var&quot;</span><span class="tok-o">);</span>
  <span class="tok-n">assertNotNull</span><span class="tok-o">(</span><span class="tok-n">varSetByListener</span><span class="tok-o">);</span>
  <span class="tok-n">assertTrue</span><span class="tok-o">(</span><span class="tok-n">varSetByListener</span> <span class="tok-k">instanceof</span> <span class="tok-n">String</span><span class="tok-o">);</span>

  <span class="tok-c1">// Result is a concatenation of fixed injected field and injected expression</span>
  <span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;Yes, I am listening!&quot;</span><span class="tok-o">,</span> <span class="tok-n">varSetByListener</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the same rules with regards to thread-safety apply as for service task. Please read the <a href="#serviceTaskFieldInjectionThreadSafety">relevant section</a> for more information.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="taskListeners">8.5.13. Task listener</h4>
<div class="paragraph">
<p>A <em>task listener</em> is used to execute custom Java logic or an expression upon the occurrence of a certain task-related event.</p>
</div>
<div class="paragraph">
<p>A task listener can only be added in the process definition as a child element of a <a href="#bpmnUserTask">user task</a>. Note that this also must happen as a child of the <em>BPMN 2.0 extensionElements</em> and in the <em>activiti</em> namespace, since a task listener is a Flowable-specific construct.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:taskListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;create&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyTaskCreateListener&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A <em>task listener</em> supports following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>event</strong> (required): the type of task event on which the task listener will be invoked. Possible events are</p>
<div class="ulist">
<ul>
<li>
<p><strong>create</strong>: occurs when the task has been created an <strong>all task properties are set</strong>.</p>
</li>
<li>
<p><strong>assignment</strong>: occurs when the task is assigned to somebody. Note: when process execution arrives in a userTask, first an <em>assignment</em> event will be fired, <strong>before</strong> the <em>create</em> event is fired. This might seem an unnatural order, but the reason is pragmatic: when receiving the <em>create</em> event, we usually want to inspect all properties of the task including the assignee.</p>
</li>
<li>
<p><strong>complete</strong>: occurs when the task is completed and just before the task is deleted from the runtime data.</p>
</li>
<li>
<p><strong>delete</strong>: occurs just before the task is going to be deleted. Notice that it will also be executed when task is normally finished via completeTask.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>class</strong>: the delegation class that must be called. This class must implement the <code>org.activiti.engine.delegate.TaskListener</code> interface.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyTaskCreateListener</span> <span class="tok-kd">implements</span> <span class="tok-n">TaskListener</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">DelegateTask</span> <span class="tok-n">delegateTask</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-c1">// Custom logic goes here</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to use <a href="#serviceTaskFieldInjection">field injection</a> to pass process variables or the execution to the delegation class. Note that an instance of the delegation class is created upon process deployment (as is the case with any class delegation in Flowable), which means that the instance is shared between all process instance executions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>expression</strong>: (cannot be used together with the <em>class</em> attribute): specifies an expression that will be executed when the event happens. It is possible to pass the <code>DelegateTask</code> object and the name of the event (using <code>task.eventName</code>) as parameter to the called object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-o">&lt;</span><span class="tok-n">activiti</span><span class="tok-o">:</span><span class="tok-n">taskListener</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-s">&quot;create&quot;</span> <span class="tok-n">expression</span><span class="tok-o">=</span><span class="tok-s">&quot;${myObject.callMethod(task, task.eventName)}&quot;</span> <span class="tok-o">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>delegateExpression</strong> allows to specify an expression that resolves to an object implementing the <code>TaskListener</code> interface, <a href="#bpmnJavaServiceTaskXML">similar to a service task</a>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:taskListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;create&quot;</span> <span class="tok-na">delegateExpression=</span><span class="tok-s">&quot;${myTaskListenerBean}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A while back, we also introduced a new type of task listener, the org.activiti.engine.impl.bpmn.listener.ScriptTaskListener. This script task listener allows you to execute a piece of script logic for an task listener event.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:taskListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;complete&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.bpmn.listener.ScriptTaskListener&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;script&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;activiti:string&gt;</span>
      def bar = &quot;BAR&quot;;  // local variable
      foo = &quot;FOO&quot;; // pushes variable to execution context
      task.setOwner(&quot;kermit&quot;); // test access to task instance
      bar // implicit return value
    <span class="tok-nt">&lt;/activiti:string&gt;</span>
  <span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;language&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;groovy&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resultVariable&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;myVar&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/activiti:taskListener&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnMultiInstance">8.5.14. Multi-instance (for each)</h4>
<div class="sect4">
<h5 id="bpmnMultiInstanceDescription">Description</h5>
<div class="paragraph">
<p>A <em>multi-instance activity</em> is a way of defining repetition for a certain step in a business process. In programming concepts, a multi-instance matches the <strong>for each</strong> construct: it allows to execute a certain step or even a complete subprocess for each item in a given collection, <strong>sequentially or in parallel</strong>.</p>
</div>
<div class="paragraph">
<p>A <em>multi-instance</em> is a regular activity that has extra properties defined (so-called <em>'multi-instance</em> characteristics'') which will cause the activity to be executed multiple times at runtime. Following activities can become a <em>multi-instance activity:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#bpmnUserTask">User Task</a></p>
</li>
<li>
<p><a href="#bpmnScriptTask">Script Task</a></p>
</li>
<li>
<p><a href="#bpmnJavaServiceTask">Java Service Task</a></p>
</li>
<li>
<p><a href="#bpmnWebserviceTask">Web Service Task</a></p>
</li>
<li>
<p><a href="#bpmnBusinessRuleTask">Business Rule Task</a></p>
</li>
<li>
<p><a href="#bpmnEmailTask">Email Task</a></p>
</li>
<li>
<p><a href="#bpmnManualTask">Manual Task</a></p>
</li>
<li>
<p><a href="#bpmnReceiveTask">Receive Task</a></p>
</li>
<li>
<p><a href="#bpmnSubProcess">(Embedded) Sub-Process</a></p>
</li>
<li>
<p><a href="#bpmnCallActivity">Call Activity</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <a href="#bpmnGateways">Gateway</a> or <a href="#bpmnEvents">Event</a> <strong>cannot</strong> become multi-instance.</p>
</div>
<div class="paragraph">
<p>As required by the spec, each parent execution of the created executions for each instance will have following variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>nrOfInstances</strong>: the total number of instances</p>
</li>
<li>
<p><strong>nrOfActiveInstances</strong>: the number of currently active, i.e. not yet finished, instances. For a sequential multi-instance, this will always be 1.</p>
</li>
<li>
<p><strong>nrOfCompletedInstances</strong>: the number of already completed instances.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These values can be retrieved by calling the <code>execution.getVariable(x)</code> method.</p>
</div>
<div class="paragraph">
<p>Additionally, each of the created executions will have an execution-local variable (i.e. not visible for the other executions, and not stored on process instance level) :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>loopCounter</strong>: indicates the <em>index in the for-each loop</em> of that particular instance. loopCounter variable can be renamed by a Flowable <strong>elementIndexVariable</strong> attribute.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMultiInstanceGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>If an activity is multi-instance, this is indicated by three short lines at the bottom of that activity. Three <em>vertical</em> lines indicates that the instances will be executed in parallel, while three <em>horizontal</em> lines indicate sequential execution.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.multi.instance.png" alt="bpmn.multi.instance">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMultiInstanceXml">Xml representation</h5>
<div class="paragraph">
<p>To make an activity multi-instance, the activity xml element must have a <code>multiInstanceLoopCharacteristics</code> child element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false|true&quot;</span><span class="tok-nt">&gt;</span>
 ...
<span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>isSequential</strong> attribute indicates if the instances of that activity are executed sequentially or parallel.</p>
</div>
<div class="paragraph">
<p>The number of instances are <strong>calculated once, when entering the activity</strong>. There are a few ways of configuring this. On way is directly specifying a number, by using the <strong>loopCardinality</strong> child element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false|true&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;loopCardinality&gt;</span>5<span class="tok-nt">&lt;/loopCardinality&gt;</span>
<span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Expressions that resolve to a positive number are also possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false|true&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;loopCardinality&gt;</span>${nrOfOrders-nrOfCancellations}<span class="tok-nt">&lt;/loopCardinality&gt;</span>
<span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another way to define the number of instances, is to specify the name of a process variable which is a collection using the <code>loopDataInputRef</code> child element. For each item in the collection, an instance will be created. Optionally, it is possible to set that specific item of the collection for the instance using the <code>inputDataItem</code> child element. This is shown in the following XML example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;miTasks&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task ${loopCounter}&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${assignee}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;loopDataInputRef&gt;</span>assigneeList<span class="tok-nt">&lt;/loopDataInputRef&gt;</span>
    <span class="tok-nt">&lt;inputDataItem</span> <span class="tok-na">name=</span><span class="tok-s">&quot;assignee&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Suppose the variable <code>assigneeList</code> contains the values <code>\[kermit, gonzo, fozzie\]</code>. In the snippet above, three user tasks will be created in parallel. Each of the executions will have a process variable named <code>assignee</code> containing one value of the collection, which is used to assign the user task in this example.</p>
</div>
<div class="paragraph">
<p>The downside of the <code>loopDataInputRef</code> and <code>inputDataItem</code> is that 1) the names are pretty hard to remember and 2) due to the BPMN 2.0 schema restrictions they can&#8217;t contain expressions. Flowable solves this by offering the <strong>collection</strong> and <strong>elementVariable</strong> attributes on the <code>multiInstanceCharacteristics</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;miTasks&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${assignee}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;true&quot;</span>
     <span class="tok-na">activiti:collection=</span><span class="tok-s">&quot;${myService.resolveUsersForTask()}&quot;</span> <span class="tok-na">activiti:elementVariable=</span><span class="tok-s">&quot;assignee&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A multi-instance activity ends when all instances are finished. However, it is possible to specify an expression that is evaluated every time one instance ends. When this expression evaluates to true, all remaining instances are destroyed and the multi-instance activity ends, continuing the process. Such an expression must be defined in the <strong>completionCondition</strong> child element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;miTasks&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;My Task&quot;</span> <span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;${assignee}&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false&quot;</span>
     <span class="tok-na">activiti:collection=</span><span class="tok-s">&quot;assigneeList&quot;</span> <span class="tok-na">activiti:elementVariable=</span><span class="tok-s">&quot;assignee&quot;</span> <span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;completionCondition&gt;</span>${nrOfCompletedInstances/nrOfInstances &gt;= 0.6 }<span class="tok-nt">&lt;/completionCondition&gt;</span>
  <span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, there will be parallel instances created for each element of the <code>assigneeList</code> collection. However, when 60% of the tasks are completed, the other tasks are deleted and the process continues.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnMultiInstanceBoundaryEvent">Boundary events and multi-instance</h5>
<div class="paragraph">
<p>Since a multi-instance is a regular activity, it is possible to define a <a href="#bpmnBoundaryEvent">boundary event</a> on its boundary. In case of an interrupting boundary event, when the event is caught, <strong>all instances</strong> that are still active will be destroyed. Take for example following multi-instance subprocess:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.multi.instance.boundary.event.png" alt="bpmn.multi.instance.boundary.event">
</div>
</div>
<div class="paragraph">
<p>Here, all instances of the subprocess will be destroyed when the timer fires, regardless of how many instances there are or which inner activities are currently not yet completed.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCompensationHandlers">Multi instance and execution listeners</h5>
<div class="paragraph">
<p>There is a caveat when using execution listeners in combination with multi instance. Take for example the following snippet of BPMN 2.0 xml, which is defined on the same level as the <em>multiInstanceLoopCharacteristics</em> xml element is set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyStartListener&quot;</span><span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyEndListener&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/extensionElements&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For a normal BPMN activity, there would be an invocation of these listeners when the activity is started and ended.</p>
</div>
<div class="paragraph">
<p>However, when the activity is multi instance, the behavior is different:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the multi instance activity is entered, before any of the <em>inner</em> activities is executed, a start event is thrown. The <em>loopCounter</em> variable is not yet set (is null).</p>
</li>
<li>
<p>For each of the actual activities visited, a start event is thrown. The <em>loopCounter</em> variable is set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The same reasoning applies for the end event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the actual activity is left, an end even is thrown. The <em>loopCounter</em> variable is set.</p>
</li>
<li>
<p>When the multi instance activity has finished as a whole, an end event is thrown. The <em>loopCounter</em> variable is not set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;subProcess</span> <span class="tok-na">id=</span><span class="tok-s">&quot;subprocess1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Sub Process&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyStartListener&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.MyEndListener&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
  <span class="tok-nt">&lt;multiInstanceLoopCharacteristics</span> <span class="tok-na">isSequential=</span><span class="tok-s">&quot;false&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;loopDataInputRef&gt;</span>assignees<span class="tok-nt">&lt;/loopDataInputRef&gt;</span>
    <span class="tok-nt">&lt;inputDataItem</span> <span class="tok-na">name=</span><span class="tok-s">&quot;assignee&quot;</span><span class="tok-nt">&gt;&lt;/inputDataItem&gt;</span>
  <span class="tok-nt">&lt;/multiInstanceLoopCharacteristics&gt;</span>
  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;startevent2&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Start&quot;</span><span class="tok-nt">&gt;&lt;/startEvent&gt;</span>
  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;endevent2&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;End&quot;</span><span class="tok-nt">&gt;&lt;/endEvent&gt;</span>
  <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;startevent2&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;endevent2&quot;</span><span class="tok-nt">&gt;&lt;/sequenceFlow&gt;</span>
<span class="tok-nt">&lt;/subProcess&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, suppose the <em>assignees</em> list has three items. The following happens at runtime:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A start event is thrown for the multi instance as a whole. The <em>start</em> execution listener is invoked. The <em>loopCounter</em> nor the <em>assignee</em> variable will not be set (i.e. they will be null).</p>
</li>
<li>
<p>A start event is thrown for each activity instance. The <em>start</em> execution listener is invoked three times. The <em>loopCounter</em> nor the <em>assignee</em> variable will be set (i.e. different from null).</p>
</li>
<li>
<p>So in total, the start execution listener is invoked four times.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the same applies when the <em>multiInstanceLoopCharacteristics</em> are defined on something else than a subprocess too. For example in case the example above would be a simple userTask, the same reasoning still applies.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_compensation_handlers">8.5.15. Compensation Handlers</h4>
<div class="sect4">
<h5 id="bpmnCompensationHandlerDescription">Description</h5>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a></p>
</div>
<div class="paragraph">
<p>If an activity is used for compensating the effects of another activity, it can be declared to be a compensation handler. Compensation handlers are not contained in normal flow and are only executed when a compensation event is thrown.</p>
</div>
<div class="paragraph">
<p>Compensation handlers must not have incoming or outgoing sequence flows.</p>
</div>
<div class="paragraph">
<p>A compensation handler must be associated with a compensation boundary event using a directed association.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCompensationHandlerGraphicalNotation">Graphical notation</h5>
<div class="paragraph">
<p>If an activity is a compensation handler, the compensation event icon is displayed in the center bottom area. The following excerpt from a process diagram shows a service task with an attached compensation boundary event which is associated to a compensation handler. Notice the compensation handler icon in the bottom canter area of the "cancel hotel reservation" service task.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.boundary.compensation.event.png" alt="bpmn.boundary.compensation.event">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCompensationHandlerXml">XML representation</h5>
<div class="paragraph">
<p>In order to declare an activity to be a compensation handler, we need to set the attribute isForCompensation to true:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;undoBookHotel&quot;</span> <span class="tok-na">isForCompensation=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;...&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bpmnSubprocessAndCallActivity">8.6. Sub-Processes and Call Activities</h3>
<div class="sect3">
<h4 id="bpmnSubProcess">8.6.1. Sub-Process</h4>
<div class="sect4">
<h5 id="bpmnSubProcessDescription">Description</h5>
<div class="paragraph">
<p>A <em>Sub-Process</em> is an activity that contains other activities, gateways, events, etc. which on itself form a process that is part of the bigger process. A <em>Sub-Process</em> is completely defined inside a parent process (that&#8217;s why it&#8217;s often called an <em>embedded</em> Sub-Process).</p>
</div>
<div class="paragraph">
<p>Sub-Processes have two major use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sub-Processes allow <strong>hierarchical modeling</strong>. Many modeling tools allow that Sub-Processes can be <em>collapsed</em>, hiding all the details of the Sub-Process and displaying a high-level end-to-end overview of the business process.</p>
</li>
<li>
<p>A Sub-Process creates a new <strong>scope for events</strong>. Events that are thrown during execution of the Sub-Process, can be caught by <a href="#bpmnBoundaryEvent">a boundary event</a> on the boundary of the Sub-Process, thus creating a scope for that event limited to the Sub-Process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using a Sub-Process does impose some constraints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Sub-Process can only have <strong>one none start event</strong>, no other start event types are allowed. A Sub-Process must <strong>at least have one end event</strong>. Note that the BPMN 2.0 specification allows to omit the start and end events in a Sub-Process, but the current Flowable implementation does not support this.</p>
</li>
<li>
<p><strong>Sequence flow cannot cross Sub-Process boundaries.</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSubProcessGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A Sub-Process is visualized as a typical activity, i.e. a rounded rectangle. In case the Sub-Process is <em>collapsed</em>, only the name and a plus-sign are displayed, giving a high-level overview of the process:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.collapsed.subprocess.png" alt="bpmn.collapsed.subprocess">
</div>
</div>
<div class="paragraph">
<p>In case the Sub-Process is <em>expanded</em>, the steps of the Sub-Process are displayed within the Sub-Process boundaries:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.expanded.subprocess.png" alt="bpmn.expanded.subprocess">
</div>
</div>
<div class="paragraph">
<p>One of the main reasons to use a Sub-Process, is to define a scope for a certain event. The following process model shows this: both the <em>investigate software/investigate hardware</em> tasks need to be done in parallel, but both tasks need to be done within a certain time, before <em>Level 2 support</em> is consulted. Here, the scope of the timer (i.e. which activities must be done in time) is constrained by the Sub-Process.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.subprocess.with.boundary.timer.png" alt="bpmn.subprocess.with.boundary.timer">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnSubProcessXML">XML representation</h5>
<div class="paragraph">
<p>A Sub-Process is defined by the <em>subprocess</em> element. All activities, gateways, events, etc. that are part of the Sub-Process, need to be enclosed within this element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-nt">&lt;subProcess</span> <span class="tok-na">id=</span><span class="tok-s">&quot;subProcess&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;subProcessStart&quot;</span> <span class="tok-nt">/&gt;</span>

  ... other Sub-Process elements ...

  <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;subProcessEnd&quot;</span> <span class="tok-nt">/&gt;</span>

 <span class="tok-nt">&lt;/subProcess&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnEventSubprocess">8.6.2. Event Sub-Process</h4>
<div class="sect4">
<h5 id="bpmnEventSubprocessDescription">Description</h5>
<div class="paragraph">
<p>The Event Sub-Process is new in BPMN 2.0. An Event Sub-Process is a subprocess that is triggered by an event. An Event Sub-Process can be added at the process level or at any subprocess level. The event used to trigger an event subprocess is configured using a start event. From this, it follows that none start events are not supported for Event Sub-Processes. An Event Sub-Process might be triggered using events like message events, error events, signal events, timer events, or compensation events. The subscription to the start event is created when the scope (process instance or subprocess) hosting the Event Sub-Process is created. The subscription is removed when the scope is destroyed.</p>
</div>
<div class="paragraph">
<p>An Event Sub-Process may be interrupting or non-interrupting. An interrupting subprocess cancels any executions in the current scope. A non-interrupting Event Sub-Process spawns a new concurrent execution. While an interrupting Event Sub-Process can only be triggered once for each activation of the scope hosting it, a non-interrupting Event Sub-Process can be triggered multiple times. The fact whether the subprocess is interrupting is configured using the start event triggering the Event Sub-Process.</p>
</div>
<div class="paragraph">
<p>An Event Sub-Process must not have any incoming or outgoing sequence flows. Since an Event Sub-Process is triggered by an event, an incoming sequence flow makes no sense. When an Event Sub-Process is ended, either the current scope is ended (in case of an interrupting Event Sub-Process), or the concurrent execution spawned for the non-interrupting subprocess is ended.</p>
</div>
<div class="paragraph">
<p><strong>Current limitations:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Flowable only supports interrupting Event Sub-Processes.</p>
</li>
<li>
<p>Flowable only supports Event Sub-Process triggered using an Error Start Event or Message Start Event.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>An Event Sub-Process might be visualized as a an <a href="#bpmnSubProcessGraphicalNotation">embedded subprocess</a> with a dotted outline.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.subprocess.eventSubprocess.png" alt="bpmn.subprocess.eventSubprocess">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessXMLRepresentation">XML representation</h5>
<div class="paragraph">
<p>An Event Sub-Process is represented using XML in the same way as a an embedded subprocess. In addition the attribute <code>triggeredByEvent</code> must have the value <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;subProcess</span> <span class="tok-na">id=</span><span class="tok-s">&quot;eventSubProcess&quot;</span> <span class="tok-na">triggeredByEvent=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
	...
<span class="tok-nt">&lt;/subProcess&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessExample">Example</h5>
<div class="paragraph">
<p>The following is an example of an Event Sub-Process triggered using an Error Start Event. The Event Sub-Process is located at the "process level", i.e. is scoped to the process instance:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.subprocess.eventSubprocess.example.1.png" alt="bpmn.subprocess.eventSubprocess.example.1">
</div>
</div>
<div class="paragraph">
<p>This is how the Event Sub-Process would look like in XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;subProcess</span> <span class="tok-na">id=</span><span class="tok-s">&quot;eventSubProcess&quot;</span> <span class="tok-na">triggeredByEvent=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;catchError&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;errorEventDefinition</span> <span class="tok-na">errorRef=</span><span class="tok-s">&quot;error&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/startEvent&gt;</span>
	<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;catchError&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;taskAfterErrorCatch&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;taskAfterErrorCatch&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Provide additional data&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/subProcess&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>As already stated, an Event Sub-Process can also be added to an embedded subprocess. If it is added to an embedded subprocess, it becomes an alternative to a boundary event. Consider the two following process diagrams. In both cases the embedded subprocess throws an error event. Both times the error is caught and handled using a user task.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.subprocess.eventSubprocess.example.2a.png" alt="bpmn.subprocess.eventSubprocess.example.2a">
</div>
</div>
<div class="paragraph">
<p>as opposed to:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.subprocess.eventSubprocess.example.2b.png" alt="bpmn.subprocess.eventSubprocess.example.2b">
</div>
</div>
<div class="paragraph">
<p>In both cases the same tasks are executed. However, there are differences between both modelling alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The embedded subprocess is executed using the same execution which executed the scope it is hosted in. This means that an embedded subprocess has access to the variables local to it&#8217;s scope. When using a boundary event, the execution created for executing the embedded subprocess is deleted by the sequence flow leaving the boundary event. This means that the variables created by the embedded subprocess are not available anymore.</p>
</li>
<li>
<p>When using an Event Sub-Process, the event is completely handled by the subprocess it is added to. When using a boundary event, the event is handled by the parent process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two differences can help you decide whether a boundary event or an embedded subprocess is better suited for solving a particular process modeling / implementation problem.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnTransactionSubprocess">8.6.3. Transaction subprocess</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a><a id="bpmnTransactionSubprocessDescription"></a></p>
</div>
<div class="sect4">
<h5 id="_description_8">Description</h5>
<div class="paragraph">
<p>A transaction subprocess is an embedded subprocess, which can be used to group multiple activities to a transaction. A transaction is a logical unit of work which allows to group a set of individual activities, such that they either succeed or fail collectively.</p>
</div>
<div class="paragraph">
<p><strong>Possible outcomes of a transaction:</strong> A transaction can have three different outcomes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A transaction is <em>successful</em>, if it is neither cancelled not terminated by a hazard. If a transaction subprocess is successful, it is left using the outgoing sequenceflow(s). A successful transaction might be compensated if a compensation event is thrown later in the process. <em>Note:</em> just as "ordinary" embedded subprocesses, a transaction may be compensated after successful completion using an intermediary throwing compensation event.</p>
</li>
<li>
<p>A transaction is <em>cancelled</em>, if an execution reaches the cancel end event. In that case, all executions are terminated and removed. A single remaining execution is then set to the cancel boundary event, which triggers compensation. After compensation is completed, the transaction subprocess is left using the outgoing sequence flow(s) of the cancel boundary event.</p>
</li>
<li>
<p>A transaction is ended by a <em>hazard</em>, if an error event is thrown, that is not caught within the scope of the transaction subprocess. (This also applies if the error is caught on the boundary of the transaction subprocess.) In this case, compensation is not performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following diagram illustrates the three different outcomes:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.transaction.subprocess.example.1.png" alt="bpmn.transaction.subprocess.example.1">
</div>
</div>
<div class="paragraph">
<p><strong>Relation to ACID transactions:</strong> it is important not to confuse the bpmn transaction subprocess with technical (ACID) transactions. The bpmn transaction subprocess is not a way to scope technical transactions. In order to understand transaction management in Flowable, read the section on <a href="#bpmnConcurrencyAndTransactions">concurrency and transactions</a>. A bpmn transaction is different from a technical transaction in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>While an ACID transaction is typically short lived, a bpmn transaction may take hours, days or even months to complete. (Consider the case where one of the activities grouped by a transaction is a usertask, typically people have longer response times than applications. Or, in another situation, a bpmn transaction might wait for some business event to occur, like the fact that a particular order has been fulfilled.) Such operations usually take considerably longer to complete than updating a record in a database, or storing a message using a transactional queue.</p>
</li>
<li>
<p>Because it is impossible to scope a technical transaction to the duration of a business activity, a bpmn transaction typically spans multiple ACID transactions.</p>
</li>
<li>
<p>Since a bpmn transaction spans multiple ACID transactions, we loose ACID properties. For example, consider the example given above. Let&#8217;s assume the "book hotel" and the "charge credit card" operations are performed in separate ACID transactions. Let&#8217;s also assume that the "book hotel" activity is successful. Now we have an intermediary inconsistent state, because we have performed an hotel booking but have not yet charged the credit card. Now, in an ACID transaction, we would also perform different operations sequentially and thus also have an intermediary inconsistent state. What is different here, is that the inconsistent state is visible outside of the scope of the transaction. For example, if the reservations are made using an external booking service, other parties using the same booking service might already see that the hotel is booked. This means, that when implementing business transactions, we completely loose the isolation property (Granted: we usually also relax isolation when working with ACID transactions to allow for higher levels of concurrency, but there we have fine grained control and intermediary inconsistencies are only present for very short periods of times).</p>
</li>
<li>
<p>A bpmn business transaction can also not be rolled back in the traditional sense. Since it spans multiple ACID transactions, some of these ACID transactions might already be committed at the time the bpmn transaction is cancelled. At this point, they cannot be rolled back anymore.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since bpmn transactions are long-running in nature, the lack of isolation and a rollback mechanism need to be dealt with differently. In practice, there is usually no better solution than to deal with these problems in a domain specific way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The rollback is performed using compensation. If a cancel event is thrown in the scope of a transaction, the effects of all activities that executed successfully and have a compensation handler are compensated.</p>
</li>
<li>
<p>The lack of isolation is also often dealt with using domain specific solutions. For instance, in the example above, an hotel room might appear to be booked to a second customer, before we have actually made sure that the first customer can pay for it. Since this might be undesirable from a business perspective, a booking service might choose to allow for a certain amount of overbooking.</p>
</li>
<li>
<p>In addition, since the transaction can be aborted in case of a hazard, the booking service has to deal with the situation where a hotel room is booked but payment is never attempted (since the transaction was aborted). In that case the booking service might choose a strategy where a hotel room is reserved for a maximum period of time and if payment is not received until then, the booking is cancelled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To sum it up: while ACID transactions offer a generic solution to such problems (rollback, isolation levels and heuristic outcomes), we need to find domain specific solutions to these problems when implementing business transactions.</p>
</div>
<div class="paragraph">
<p><strong>Current limitations:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The BPMN specification requires that the process engine reacts to events issued by the underlying transaction protocol and for instance that a transaction is cancelled, if a cancel event occurs in the underlying protocol. As an embeddable engine, Flowable does currently not support this. (For some ramifications of this, see paragraph on consistency below.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consistency on top of ACID transactions and optimistic concurrency:</strong> A bpmn transaction guarantees consistency in the sense that either all activities compete successfully, or if some activity cannot be performed, the effects of all other successful activities are compensated. So either way we end up in a consistent state. However, it is important to recognize that in Flowable, the consistency model for bpmn transactions is superposed on top of the consistency model for process execution. Flowable executes processes in a transactional way. Concurrency is addressed using optimistic locking. In Flowable, bpmn error, cancel and compensation events are built on top of the same acid transactions and optimistic locking. For example, a cancel end event can only trigger compensation if it is actually reached. It is not reached if some undeclared exception is thrown by a service task before. Or, the effects of a compensation handler cannot be committed if some other participant in the underlying ACID transaction sets the transaction to the state rollback-only. Or, when two concurrent executions reach a cancel end event, compensation might be triggered twice and fail with an optimistic locking exception. All of this is to say that when implementing bpmn transactions in Flowable, the same set of rules apply as when implementing "ordinary" processes and subprocesses. So to effectively guarantee consistency, it is important to implement processes in a way that does take the optimistic, transactional execution model into consideration.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>An transaction subprocess might be visualized as a an <a href="#bpmnSubProcessGraphicalNotation">embedded subprocess</a> with a double outline.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.transaction.subprocess.png" alt="bpmn.transaction.subprocess">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessXMLRepresentation">XML representation</h5>
<div class="paragraph">
<p>A transaction subprocess is represented using xml using the  <code>transaction</code> tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;transaction</span> <span class="tok-na">id=</span><span class="tok-s">&quot;myTransaction&quot;</span> <span class="tok-nt">&gt;</span>
	...
<span class="tok-nt">&lt;/transaction&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnEventSubprocessExample">Example</h5>
<div class="paragraph">
<p>The following is an example of a transaction subprocess:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.transaction.subprocess.example.2.png" alt="bpmn.transaction.subprocess.example.2">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="bpmnCallActivity">8.6.4. Call activity (subprocess)</h4>
<div class="sect4">
<h5 id="bpmnCallActivityDescription">Description</h5>
<div class="paragraph">
<p>BPMN 2.0 makes a distinction between a regular <em><a href="#bpmnSubProcess">subprocess</a></em>, often also called <em>embedded subprocess</em>, and the call activity, which looks very similar. From a conceptual point of view, both will call a subprocess when process execution arrives at the activity.</p>
</div>
<div class="paragraph">
<p>The difference is that the call activity references a process that is external to the process definition, whereas the <em><a href="#bpmnSubProcess">subprocess</a></em> is embedded within the original process definition. The main use case for the call activity is to have a reusable process definition that can be called from multiple other process definitions.</p>
</div>
<div class="paragraph">
<p>When process execution arrives in the <em>call activity</em>, a new execution is created that is a sub-execution of the execution that arrives in the call activity. This sub-execution is then used to execute the subprocess, potentially creating parallel child execution as within a regular process. The super-execution waits until the subprocess is completely ended, and continues the original process afterwards.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCallActivityGraphicalNotation">Graphical Notation</h5>
<div class="paragraph">
<p>A call activity is visualized the same as a <a href="#bpmnSubProcessGraphicalNotation">subprocess</a>, however with a thick border (collapsed and expanded). Depending on the modeling tool, a call activity can also be expanded, but the default visualization is the collapsed subprocess representation.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.collapsed.call.activity.png" alt="bpmn.collapsed.call.activity">
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCallActivityXMLRepresentation">XML representation</h5>
<div class="paragraph">
<p>A call activity is a regular activity, that requires a <em>calledElement</em> that references a process definition by its <strong>key</strong>. In practice, this means that the <strong>id of the process</strong> is used in the <em>calledElement</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;callActivity</span> <span class="tok-na">id=</span><span class="tok-s">&quot;callCheckCreditProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Check credit&quot;</span> <span class="tok-na">calledElement=</span><span class="tok-s">&quot;checkCreditProcess&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the process definition of the subprocess is <strong>resolved at runtime</strong>. This means that the subprocess can be deployed independently from the calling process, if needed.</p>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCallActivityPassVariables">Passing variables</h5>
<div class="paragraph">
<p>You can pass process variables to the sub process and vice versa. The data is copied into the subprocess when it is started and copied back into the main process when it ends.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;callActivity</span> <span class="tok-na">id=</span><span class="tok-s">&quot;callSubProcess&quot;</span> <span class="tok-na">calledElement=</span><span class="tok-s">&quot;checkCreditProcess&quot;</span> <span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
	  <span class="tok-nt">&lt;activiti:in</span> <span class="tok-na">source=</span><span class="tok-s">&quot;someVariableInMainProcess&quot;</span> <span class="tok-na">target=</span><span class="tok-s">&quot;nameOfVariableInSubProcess&quot;</span> <span class="tok-nt">/&gt;</span>
	  <span class="tok-nt">&lt;activiti:out</span> <span class="tok-na">source=</span><span class="tok-s">&quot;someVariableInSubProcess&quot;</span> <span class="tok-na">target=</span><span class="tok-s">&quot;nameOfVariableInMainProcess&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/callActivity&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We use a Flowable Extension as a shortcut for the BPMN standard elements called <em>dataInputAssociation</em> and <em>dataOutputAssociation</em>, which only work if you declare process variables in the BPMN 2.0 standard way.</p>
</div>
<div class="paragraph">
<p>It is possible to use expressions here as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;callActivity</span> <span class="tok-na">id=</span><span class="tok-s">&quot;callSubProcess&quot;</span> <span class="tok-na">calledElement=</span><span class="tok-s">&quot;checkCreditProcess&quot;</span> <span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;extensionElements&gt;</span>
	  <span class="tok-nt">&lt;activiti:in</span> <span class="tok-na">sourceExpression=</span><span class="tok-s">&quot;${x+5}&quot;</span> <span class="tok-na">target=</span><span class="tok-s">&quot;y&quot;</span> <span class="tok-nt">/&gt;</span>
	  <span class="tok-nt">&lt;activiti:out</span> <span class="tok-na">source=</span><span class="tok-s">&quot;${y+5}&quot;</span> <span class="tok-na">target=</span><span class="tok-s">&quot;z&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/callActivity&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>So in the end z = y+5 = x+5+5</p>
</div>
<div class="paragraph">
<p>The callActivity element also supports setting the business key on the started subprocess instance using a custom flowable attribute extension. The <em>businessKey</em> attribute can be used to set a custom business key value on the subprocess instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;callActivity id="callSubProcess" calledElement="checkCreditProcess" activiti:businessKey="${myVariable}"&gt;
...
&lt;/callActivity&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Defining the <em>inheritBusinessKey</em> attribute with a value of true will set the business key value on the subprocess to the value of the business key as defined in the calling process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;callActivity id="callSubProcess" calledElement="checkCreditProcess" activiti:inheritBusinessKey="true"&gt;
...
&lt;/callActivity&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bpmnCallActivityExample">Example</h5>
<div class="paragraph">
<p>The following process diagram shows a simple handling of an order. Since the checking of the customer&#8217;s credit could be common to many other processes, the <em>check credit step</em> is modeled here as a call activity.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.call.activity.super.process.png" alt="bpmn.call.activity.super.process">
</div>
</div>
<div class="paragraph">
<p>The process looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;theStart&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;receiveOrder&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;manualTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;receiveOrder&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Receive Order&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;receiveOrder&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;callCheckCreditProcess&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;callActivity</span> <span class="tok-na">id=</span><span class="tok-s">&quot;callCheckCreditProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Check credit&quot;</span> <span class="tok-na">calledElement=</span><span class="tok-s">&quot;checkCreditProcess&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow3&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;callCheckCreditProcess&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;prepareAndShipTask&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;prepareAndShipTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Prepare and Ship&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;flow4&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;prepareAndShipTask&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;end&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The subprocess looks as follows:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.call.activity.sub.process.png" alt="bpmn.call.activity.sub.process">
</div>
</div>
<div class="paragraph">
<p>There is nothing special to the process definition of the subprocess. It could as well be used without being called from another process.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="bpmnConcurrencyAndTransactions">8.7. Transactions and Concurrency</h3>
<div class="sect3">
<h4 id="asyncContinuations">8.7.1. Asynchronous Continuations</h4>
<div class="paragraph">
<p>Flowable executes processes in a transactional way which can be configured to suite your needs. Lets start by looking at how Flowable scopes transactions normally. If you trigger Flowable (i.e. start a process, complete a task, signal an execution), Flowable is going to advance in the process, until it reaches wait states on each active path of execution. More concretely speaking it performs a depth-first search through the process graph and returns if it has reached wait states on every branch of execution. A wait state is a task which is performed "later" which means that Flowable persists the current execution and waits to be triggered again. The trigger can either come from an external source for example if we have a user task or a receive message task, or from Flowable itself, if we have a timer event. This is illustrated in the following picture:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/activiti.async.example.no.async.PNG" alt="activiti.async.example.no.async">
</div>
</div>
<div class="paragraph">
<p>We see a segment of a BPMN processes with a usertask, a service task and a timer event. Completing the usertask and validating the address is part of the same unit of work, so it should succeed or fail atomically. That means that if the service task throws an exception we want to rollback the current transaction, such that the execution tracks back to the user task and the user task is still present in the database. This is also the default behavior of Flowable. In (1) an application or client thread completes the task. In that same thread Flowable is now executing the service and advances until it reaches a wait state, in this case the timer event (2). Then it returns the control to the caller (3) potentially committing the transaction (if it was started by Flowable).</p>
</div>
<div class="paragraph">
<p>In some cases this is not what we want. Sometimes we need custom control over transaction boundaries in a process, in order to be able to scope logical units of work. This is where asynchronous continuations come into play. Consider the following process (fragment):</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/activiti.async.example.async.PNG" alt="activiti.async.example.async">
</div>
</div>
<div class="paragraph">
<p>This time we are completing the user task, generating an invoice and then send that invoice to the customer. This time the generation of the invoice is not part of the same unit of work so we do not want to rollback the completion of the usertask if generating an invoice fails. So what we want Flowable to do is complete the user task (1), commit the transaction and return the control to the calling application. Then we want to generate the invoice asynchronously, in a background thread. This background thread is the Flowable job executor (actually a thread pool) which periodically polls the database for jobs. So behind the scenes, when we reach the "generate invoice" task, we are creating a job "message" for Flowable to continue the process later and persisting it into the database. This job is then picked up by the job executor and executed. We are also giving the local job executor a little hint that there is a new job, to improve performance.</p>
</div>
<div class="paragraph">
<p>In order to use this feature, we can use the <em>activiti:async="true"</em> extension. So for example, the service task would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;service1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Generate Invoice&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;my.custom.Delegate&quot;</span> <span class="tok-na">activiti:async=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>activiti:async</em> can be specified on the following BPMN task types: task, serviceTask, scriptTask, businessRuleTask, sendTask, receiveTask, userTask, subProcess, callActivity</p>
</div>
<div class="paragraph">
<p>On a userTask, receiveTask or other wait states, the async continuation allows us to execute the start execution listeners in a separate  thread/transaction.</p>
</div>
</div>
<div class="sect3">
<h4 id="failRetry">8.7.2. Fail Retry</h4>
<div class="paragraph">
<p>Flowable, in its default configuration, reruns a job 3 times in case of any exception in execution of a job. This holds also for asynchronous task jobs. In some cases more flexibility is required. There are two parameters to be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Number of retries</p>
</li>
<li>
<p>Delay between retries These parameters can be configured by <code>activiti:failedJobRetryTimeCycle</code> element. Here is a sample usage:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;failingServiceTask&quot;</span> <span class="tok-na">activiti:async=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">activiti:class=</span><span class="tok-s">&quot;org.activiti.engine.test.jobexecutor.RetryFailingDelegate&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;extensionElements&gt;</span>
		<span class="tok-nt">&lt;activiti:failedJobRetryTimeCycle&gt;</span>R5/PT7M<span class="tok-nt">&lt;/activiti:failedJobRetryTimeCycle&gt;</span>
	<span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/serviceTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Time cycle expression follows ISO 8601 standard, just like timer event expressions. The above example, makes the job executor to retry the job 5 times and wait 7 minutes between before each retry.</p>
</div>
</div>
<div class="sect3">
<h4 id="exclusiveJobs">8.7.3. Exclusive Jobs</h4>
<div class="paragraph">
<p>In recent releases, the JobExecutor makes sure that jobs from a single process instance are never executed concurrently. Why is this?</p>
</div>
<div class="sect4">
<h5 id="_why_exclusive_jobs">Why exclusive Jobs?</h5>
<div class="paragraph">
<p>Consider the following process definition:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/bpmn.why.exclusive.jobs.png" alt="bpmn.why.exclusive.jobs">
</div>
</div>
<div class="paragraph">
<p>We have a parallel gateway followed by three service tasks which all perform an asynchronous continuation. As a result of this, three jobs are added to the database. Once such a job is present in the database it can be processes by the JobExecutor. The JobExecutor acquires the jobs and delegates them to a thread pool of worker threads which actually process the jobs. This means that using an asynchronous continuation, you can distribute the work to this thread pool (and in a clustered scenario even across multiple thread pools in the cluster). This is usually a good thing. However it also bears an inherent problem: consistency. Consider the parallel join after the service tasks. When execution of a service tasks is completed, we arrive at the parallel join and need to decide whether to wait for the other executions or whether we can move forward. That means, for each branch arriving at the parallel join, we need to take a decision whether we can continue or whether we need to wait for one or more other executions on the other branches.</p>
</div>
<div class="paragraph">
<p>Why is this a problem? Since the service tasks are configured using an asynchronous continuation, it is possible that the corresponding jobs are all acquired at the same time and delegated to different worker threads by the JobExecutor. The consequence is that the transactions in which the services are executed and in which the 3 individual executions arrive at the parallel join can overlap. And if they do so, each individual transaction will not "see", that another transaction is arriving at the same parallel join concurrently and thus assume that it has to wait for the others. However, if each transaction assumes that it has to wait for the other ones, none will continue the process after the parallel join and the process instance will remain in that state forever.</p>
</div>
<div class="paragraph">
<p>How does Flowable address this problem? Flowable performs optimistic locking. Whenever we take a decision based on data that might not be current (because another transaction might modify it before we commit, we make sure to increment the version of the same database row in both transactions). This way, whichever transaction commits first wins and the other ones fail with an optimistic locking exception. This solves the problem in the case of the process discussed above: if multiple executions arrive at the parallel join concurrently, they all assume that they have to wait, increment the version of their parent execution (the process instance) and then try to commit. Whichever execution is first will be able to commit and the other ones will fail with an optimistic locking exception. Since the executions are triggered by a job, Flowable will retry to perform the same job after waiting for a certain amount of time and hopefully this time pass the synchronizing gateway.</p>
</div>
<div class="paragraph">
<p>Is this a good solution? As we have seen, optimistic locking allows Flowable to prevent inconsistencies. It makes sure that we do not "keep stuck at the joining gateway", meaning: either all executions have passed the gateway or, there are jobs in the database making sure that we retry passing it. However, while this is a perfectly fine solution from the point of view of persistence and consistency, this might not always be desirable behavior at an higher level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Flowable will retry the same job for a fixed maximum number of times only (<em>3</em> in the default configuration). After that, the job will still be present in the database but not be retried actively anymore. That means that an operator would need to trigger the job manually.</p>
</li>
<li>
<p>If a job has non-transactional side effects, those will not be rolled back by the failing transaction. For instance, if the "book concert tickets" service does not share the same transaction as Flowable, we might book multiple tickets if we retry the job.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_what_are_exclusive_jobs">What are exclusive jobs?</h5>
<div class="paragraph">
<p>An exclusive job cannot be performed at the same time as another exclusive job from the same process instance. Consider the process shown above: if we declare the service tasks to be exclusive, the JobExecutor will make sure that the corresponding jobs are not executed concurrently. Instead, it will make sure that whenever it acquires an exclusive job from a certain process instance, it acquires all other exclusive jobs from the same process instance and delegates them to the same worker thread. This ensures sequential execution execution of the jobs.</p>
</div>
<div class="paragraph">
<p>How can I enable this feature? In recent releases, exclusive jobs are the default configuration. All asynchronous continuations and timer events are thus exclusive by default. In addition, if you want a job to be non-exclusive, you can configure it as such using <code>activiti:exclusive="false"</code>. For example, the following servicetask would be asynchronous but non-exclusive.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;service&quot;</span> <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;${myService.performBooking(hotel, dates)}&quot;</span> <span class="tok-na">activiti:async=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-na">activiti:exclusive=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Is this a good solution? We had some people asking whether this was a good solution. Their concern was that this would to prevent you from "doing things" in parallel and would thus be a performance problem. Again, two things have to be taken into consideration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It can be turned off if you are an expert and know what you are doing (and have understood the section named "Why exclusive Jobs?"). Other than that, it is more intuitive for most users if things like asynchronous continuations and timers just work.</p>
</li>
<li>
<p>It is actually not a performance issue. Performance is an issue under heavy load. Heavy load means that all worker threads of the job executor are busy all the time. With exclusive jobs, Flowable will simply distribute the load differently. Exclusive jobs means that jobs from a single process instance are performed by the same thread sequentially. But consider: you have more than one single process instance. And jobs from other process instances are delegated to other threads and executed concurrently. This means that with exclusive jobs Flowable will not execute jobs from the same process instance concurrently, but it will still execute multiple instances concurrently. From an overall throughput perspective this is desirable in most scenarios as it usually leads to individual instances being done more quickly. Furthermore, data that is required for executing subsequent jobs of the same process instance will already be in the cache of the executing cluster node. If the jobs do not have this node affinity, that data might need to be fetched from the database again.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security">8.8. Process Initiation Authorization</h3>
<div class="paragraph">
<p>By default everyone is allowed to start a new process instance of deployed process definitions. The process initiation authorization functionality allows to define users and groups so that web clients can optionally restrict users to start a new process instance. NOTE that the authorization definition is NOT validated by the Flowable Engine in any way. This functionality is only meant for developers to ease the implementation of authorization rules in a web client. The syntax is similar to the syntax of user assignment for a user task. A user or group can be assigned as potential initiator of a process using &lt;activiti:potentialStarter&gt; tag. Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;potentialStarter&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:potentialStarter&gt;</span>
       <span class="tok-nt">&lt;resourceAssignmentExpression&gt;</span>
         <span class="tok-nt">&lt;formalExpression&gt;</span>group2, group(group3), user(user3)<span class="tok-nt">&lt;/formalExpression&gt;</span>
       <span class="tok-nt">&lt;/resourceAssignmentExpression&gt;</span>
    <span class="tok-nt">&lt;/activiti:potentialStarter&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>

  <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;theStart&quot;</span><span class="tok-nt">/&gt;</span>
  ...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above xml excerpt user(user3) refers directly to user user3 and group(group3) to group group3. No indicator will default to a group type. It is also possible to use attributes of the &lt;process&gt; tag, namely &lt;activiti:candidateStarterUsers&gt; and &lt;activiti:candidateStarterGroups&gt;. Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;potentialStarter&quot;</span> <span class="tok-na">activiti:candidateStarterUsers=</span><span class="tok-s">&quot;user1, user2&quot;</span>
                               <span class="tok-na">activiti:candidateStarterGroups=</span><span class="tok-s">&quot;group1&quot;</span><span class="tok-nt">&gt;</span>
      ...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to use both attributes simultaneously.</p>
</div>
<div class="paragraph">
<p>After the process initiation authorizations are defined, a developer can retrieve the authorization definition using the following methods.
This code retrieves the list of process definitions which can be initiated by the given user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">processDefinitions</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createProcessDefinitionQuery</span><span class="tok-o">().</span><span class="tok-na">startableByUser</span><span class="tok-o">(</span><span class="tok-s">&quot;userxxx&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to retrieve all identity links that are defined as potential starter for a specific process definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">identityLinks</span> <span class="tok-o">=</span> <span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">getIdentityLinksForProcessDefinition</span><span class="tok-o">(</span><span class="tok-s">&quot;processDefinitionId&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows how to get list of users who can initiate the given process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">User</span><span class="tok-o">&gt;</span> <span class="tok-n">authorizedUsers</span> <span class="tok-o">=</span>  <span class="tok-n">identityService</span><span class="tok-o">().</span><span class="tok-na">createUserQuery</span><span class="tok-o">().</span><span class="tok-na">potentialStarter</span><span class="tok-o">(</span><span class="tok-s">&quot;processDefinitionId&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Exactly the same way, the list of groups that is configured as a potential starter to a given process definition can be retrieved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Group</span><span class="tok-o">&gt;</span> <span class="tok-n">authorizedGroups</span> <span class="tok-o">=</span>  <span class="tok-n">identityService</span><span class="tok-o">().</span><span class="tok-na">createGroupQuery</span><span class="tok-o">().</span><span class="tok-na">potentialStarter</span><span class="tok-o">(</span><span class="tok-s">&quot;processDefinitionId&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dataobjects">8.9. Data objects</h3>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a></p>
</div>
<div class="paragraph">
<p>BPMN provides the possibility to define data objects as part of a process or sub process element. According to the BPMN specification it&#8217;s possible to include complex XML structures that might be imported from XSD definitions. As a first start to support data objects in Flowable the following XSD types are supported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj1&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;StringTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:string&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj2&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;BooleanTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:boolean&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj3&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;DateTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:datetime&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj4&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;DoubleTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:double&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj5&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;IntegerTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:int&quot;</span><span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj6&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;LongTest&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:long&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The data object definitions will be automatically converted to process variables using the <em>name</em> attribute value as the name for the new variable. In addition to the definition of the data object Flowable also provides an extension element to assign a default value to the variable. The following BPMN snippet provides an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dataObjectScope&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Data Object Scope&quot;</span> <span class="tok-na">isExecutable=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;dataObject</span> <span class="tok-na">id=</span><span class="tok-s">&quot;dObj123&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;StringTest123&quot;</span> <span class="tok-na">itemSubjectRef=</span><span class="tok-s">&quot;xsd:string&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;extensionElements&gt;</span>
      <span class="tok-nt">&lt;activiti:value&gt;</span>Testing123<span class="tok-nt">&lt;/activiti:value&gt;</span>
    <span class="tok-nt">&lt;/extensionElements&gt;</span>
  <span class="tok-nt">&lt;/dataObject&gt;</span>
  ...
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="forms">9. Forms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Flowable provides a convenient and flexible way to add forms for the manual steps of your business processes.  We support two strategies to work with forms: Build-in form rendering with form properties and external form rendering.</p>
</div>
<div class="sect2">
<h3 id="formProperties">9.1. Form properties</h3>
<div class="paragraph">
<p>All information relevant to a business process is either included in the process  variables themselves or referenced through the process variables.  Flowable supports complex Java objects to be stored as process variables like <code>Serializable</code> objects, JPA entities or whole XML documents as <code>String</code>s.</p>
</div>
<div class="paragraph">
<p>Starting a process and completing user tasks is where people are involved into a process. Communicating with people requires forms to be rendered in some UI technology.  In order to facilitate multiple UI technologies easy, the process definition can include the logic of transforming of the complex Java typed objects in the process variables to a <code>Map&lt;String,String&gt;</code> of <strong><em>properties</em></strong>.</p>
</div>
<div class="paragraph">
<p>Any UI technology can then build a form on top of those properties, using the Flowable API methods that expose the property information. The properties can provide a dedicated (and more limited) view on the process variables. The properties needed to display a form are available in the <strong>FormData</strong> return values of for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">StartFormData</span> <span class="tok-n">FormService</span><span class="tok-o">.</span><span class="tok-na">getStartFormData</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">processDefinitionId</span><span class="tok-o">)</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">TaskFormdata</span> <span class="tok-n">FormService</span><span class="tok-o">.</span><span class="tok-na">getTaskFormData</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">taskId</span><span class="tok-o">)</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the build-in form engines, <em>sees</em> the properties as well as the process variables.  So there is no need to declare task form properties if they match 1-1 with the process variables.  For example, with the following declaration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All process variables are available when execution arrives in the startEvent, but</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">formService</span><span class="tok-o">.</span><span class="tok-na">getStartFormData</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">processDefinitionId</span><span class="tok-o">).</span><span class="tok-na">getFormProperties</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>will be empty since no specific mapping was defined.</p>
</div>
<div class="paragraph">
<p>In the above case, all the submitted properties will be stored as process variables. This means that by simply adding a new input field in the form, a new variable can be stored.</p>
</div>
<div class="paragraph">
<p>Properties are derived from process variables, but they don&#8217;t have to be stored as process variables.  For example, a process variable could be a JPA entity of class Address.  And a form property <code>StreetName</code> used by the UI technology could be linked with an expression <code>#{address.street}</code></p>
</div>
<div class="paragraph">
<p>Analogue, the properties that a user is supposed to submit in a form can be stored as a process variable or as a nested property in one of the process variables with a UEL value expression like e.g. <code>#{address.street}</code> .</p>
</div>
<div class="paragraph">
<p>Analogue the default behavior of properties that are submitted is that they will be stored as process variables unless a <code>formProperty</code> declaration specifies otherwise.</p>
</div>
<div class="paragraph">
<p>Also type conversions can be applied as part of the processing between form properties and process variables.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;task&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;room&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;duration&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;long&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;speaker&quot;</span> <span class="tok-na">variable=</span><span class="tok-s">&quot;SpeakerName&quot;</span> <span class="tok-na">writable=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;street&quot;</span> <span class="tok-na">expression=</span><span class="tok-s">&quot;#{address.street}&quot;</span> <span class="tok-na">required=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Form property <code>room</code> will be mapped to process variable <code>room</code> as a String</p>
</li>
<li>
<p>Form property <code>duration</code> will be mapped to process variable <code>duration</code> as a java.lang.Long</p>
</li>
<li>
<p>Form property <code>speaker</code> will be mapped to process variable <code>SpeakerName</code>.  It will only be available in the TaskFormData object.  If property speaker is submitted, an ActivitiException will be thrown. Analogue, with attribute <code>readable="false"</code>, a property can be excluded from the FormData, but still be processed in the submit.</p>
</li>
<li>
<p>Form property <code>street</code> will be mapped to Java bean property <code>street</code> in process variable <code>address</code> as a String.  And required="true" will throw an exception during the submit if the property is not provided.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to provide type metadata as part of the FormData that is returned from methods <code>StartFormData FormService.getStartFormData(String processDefinitionId)</code> and <code>TaskFormdata FormService.getTaskFormData(String taskId)</code></p>
</div>
<div class="paragraph">
<p>We support the following form property types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>string</code> (org.activiti.engine.impl.form.StringFormType</p>
</li>
<li>
<p><code>long</code> (org.activiti.engine.impl.form.LongFormType)</p>
</li>
<li>
<p><code>enum</code> (org.activiti.engine.impl.form.EnumFormType)</p>
</li>
<li>
<p><code>date</code> (org.activiti.engine.impl.form.DateFormType)</p>
</li>
<li>
<p><code>boolean</code> (org.activiti.engine.impl.form.BooleanFormType)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each form property declared, the following <code>FormProperty</code> information will be made available through <code>List&lt;FormProperty&gt; formService.getStartFormData(String processDefinitionId).getFormProperties()</code> and <code>List&lt;FormProperty&gt; formService.getTaskFormData(String taskId).getFormProperties()</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">FormProperty</span> <span class="tok-o">{</span>
  <span class="tok-cm">/** the key used to submit the property in {@link FormService#submitStartFormData(String, java.util.Map)}</span>
<span class="tok-cm">   * or {@link FormService#submitTaskFormData(String, java.util.Map)} */</span>
  <span class="tok-n">String</span> <span class="tok-nf">getId</span><span class="tok-o">();</span>
  <span class="tok-cm">/** the display label */</span>
  <span class="tok-n">String</span> <span class="tok-nf">getName</span><span class="tok-o">();</span>
  <span class="tok-cm">/** one of the types defined in this interface like e.g. {@link #TYPE_STRING} */</span>
  <span class="tok-n">FormType</span> <span class="tok-nf">getType</span><span class="tok-o">();</span>
  <span class="tok-cm">/** optional value that should be used to display in this property */</span>
  <span class="tok-n">String</span> <span class="tok-nf">getValue</span><span class="tok-o">();</span>
  <span class="tok-cm">/** is this property read to be displayed in the form and made accessible with the methods</span>
<span class="tok-cm">   * {@link FormService#getStartFormData(String)} and {@link FormService#getTaskFormData(String)}. */</span>
  <span class="tok-kt">boolean</span> <span class="tok-nf">isReadable</span><span class="tok-o">();</span>
  <span class="tok-cm">/** is this property expected when a user submits the form? */</span>
  <span class="tok-kt">boolean</span> <span class="tok-nf">isWritable</span><span class="tok-o">();</span>
  <span class="tok-cm">/** is this property a required input field */</span>
  <span class="tok-kt">boolean</span> <span class="tok-nf">isRequired</span><span class="tok-o">();</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;speaker&quot;</span>
      <span class="tok-na">name=</span><span class="tok-s">&quot;Speaker&quot;</span>
      <span class="tok-na">variable=</span><span class="tok-s">&quot;SpeakerName&quot;</span>
      <span class="tok-na">type=</span><span class="tok-s">&quot;string&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;start&quot;</span>
      <span class="tok-na">type=</span><span class="tok-s">&quot;date&quot;</span>
      <span class="tok-na">datePattern=</span><span class="tok-s">&quot;dd-MMM-yyyy&quot;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;direction&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;enum&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;activiti:value</span> <span class="tok-na">id=</span><span class="tok-s">&quot;left&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Go Left&quot;</span> <span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;activiti:value</span> <span class="tok-na">id=</span><span class="tok-s">&quot;right&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Go Right&quot;</span> <span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;activiti:value</span> <span class="tok-na">id=</span><span class="tok-s">&quot;up&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Go Up&quot;</span> <span class="tok-nt">/&gt;</span>
      <span class="tok-nt">&lt;activiti:value</span> <span class="tok-na">id=</span><span class="tok-s">&quot;down&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Go Down&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/activiti:formProperty&gt;</span>

  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/startEvent&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All that information is accessible through the API. The type names can be obtained with  <code>formProperty.getType().getName()</code>.  And even the date pattern is available with <code>formProperty.getType().getInformation("datePattern")</code> and the enumeration values are accessible with <code>formProperty.getType().getInformation("values")</code></p>
</div>
<div class="paragraph">
<p>The following XML snippet</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-nt">&lt;startEvent&gt;</span>
  <span class="tok-nt">&lt;extensionElements&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;numberOfDays&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Number of days&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${numberOfDays}&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;long&quot;</span> <span class="tok-na">required=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;startDate&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;First day of holiday (dd-MM-yyy)&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${startDate}&quot;</span> <span class="tok-na">datePattern=</span><span class="tok-s">&quot;dd-MM-yyyy hh:mm&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;date&quot;</span> <span class="tok-na">required=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;activiti:formProperty</span> <span class="tok-na">id=</span><span class="tok-s">&quot;vacationMotivation&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Motivation&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;${vacationMotivation}&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;string&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/extensionElements&gt;</span>
<span class="tok-nt">&lt;/userTask&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>could be used to render to a process start form in a custom app.</p>
</div>
</div>
<div class="sect2">
<h3 id="externalFormRendering">9.2. External form rendering</h3>
<div class="paragraph">
<p>The API also allows for you to perform your own task form rendering outside of the Flowable Engine. These steps explain the hooks that you can use to render your task forms yourself.</p>
</div>
<div class="paragraph">
<p>Essentially, all the data that&#8217;s needed to render a form is assembled in one of these two service methods: <code>StartFormData FormService.getStartFormData(String processDefinitionId)</code> and <code>TaskFormdata FormService.getTaskFormData(String taskId)</code>.</p>
</div>
<div class="paragraph">
<p>Submitting form properties can be done with <code>ProcessInstance FormService.submitStartFormData(String processDefinitionId, Map&lt;String,String&gt; properties)</code> and <code>void FormService.submitTaskFormData(String taskId, Map&lt;String,String&gt; properties)</code></p>
</div>
<div class="paragraph">
<p>To learn about how form properties map to process variables, see <a href="#formProperties">Form properties</a></p>
</div>
<div class="paragraph">
<p>You can place any form template resource inside the business archives that you deploy (in case you want to store them versioned with the process).  It will be available as a resource in the deployment, which you can retrieve using: <code>String ProcessDefinition.getDeploymentId()</code> and <code>InputStream RepositoryService.getResourceAsStream(String deploymentId, String resourceName);</code> This could be your template definition file, which you can use to render/show the form in your own application.</p>
</div>
<div class="paragraph">
<p>You can use this capability of accessing the deployment resources beyond task forms for any other purposes as well.</p>
</div>
<div class="paragraph">
<p>The attribute <code>&lt;userTask activiti:formKey="&#8230;&#8203;"</code> is exposed by the API through <code>String FormService.getStartFormData(String processDefinitionId).getFormKey()</code> and <code>String FormService.getTaskFormData(String taskId).getFormKey()</code>. You could use this to store the full name of the template within your deployment (e.g. <code>org/activiti/example/form/my-custom-form.xml</code>), but this is not required at all. For instance, you could also store a generic key in the form attribute and apply an algorithm or transformation to get to the actual template that needs to be used. This might be handy when you want to render different forms for different UI technologies like e.g. one form for usage in a web app of normal screen size, one form for mobile phone&#8217;s small screens and maybe even a template for an IM form or an email form.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jpa">10. JPA</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use JPA-Entities as process variables, allowing you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updating existing JPA-entities based on process variables that can be filled in on a form in a userTask or generated in a serviceTask.</p>
</li>
<li>
<p>Reusing existing domain model without having to write explicit services to fetch the entities and update the values</p>
</li>
<li>
<p>Make decisions (gateways) based on properties of existing entities.</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_requirements">10.1. Requirements</h3>
<div class="paragraph">
<p>Only entities that comply with the following are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Entities should be configured using JPA-annotations, we support both field and property-access. Mapped super classes can also be used.</p>
</li>
<li>
<p>Entity should have a primary key annotated with <code>@Id</code>, compound primary keys are not supported (<code>@EmbeddedId</code> and <code>@IdClass</code>). The Id field/property can be of any type supported in the JPA-spec: Primitive types and their wrappers (excluding boolean), <code>String</code>, <code>BigInteger</code>, <code>BigDecimal</code>, <code>java.util.Date</code> and <code>java.sql.Date</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="jpaconfiguration">10.2. Configuration</h3>
<div class="paragraph">
<p>To be able to use JPA-entities, the engine must have a reference to an <code>EntityManagerFactory</code>. This can be done by configuring a reference or by supplying a persistence-unit name. JPA-entities used as variables will be detected automatically and will be handled accordingly.</p>
</div>
<div class="paragraph">
<p>The example configuration below uses the jpaPersistenceUnitName:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span>
  <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneInMemProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>

<span class="tok-c">&lt;!-- Database configurations --&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jdbcUrl&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc:h2:mem:JpaVariableTest;DB_CLOSE_DELAY=1000&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaPersistenceUnitName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;activiti-jpa-pu&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaHandleTransaction&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaCloseEntityManager&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-c">&lt;!-- job executor configurations --&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jobExecutorActivate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>

<span class="tok-c">&lt;!-- mail server configurations --&gt;</span>
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;mailServerPort&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;5025&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The next example configuration below provides a <code>EntityManagerFactory</code> which we define ourselves (in this case, an open-jpa entity manager). Note that the snippet only contains the beans that are relevant for the example, the others are omitted. Full working example with open-jpa entity manager can be found in the flowable-spring-examples (<code>/flowable-spring/src/test/java/org/activiti/spring/test/jpa/JPASpringTest.java</code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;entityManagerFactory&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;persistenceUnitManager&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;pum&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaVendorAdapter&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.orm.jpa.vendor.OpenJpaVendorAdapter&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databasePlatform&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;org.apache.openjpa.jdbc.sql.H2Dictionary&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;/bean&gt;</span>
  <span class="tok-nt">&lt;/property&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>

<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.spring.SpringProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;dataSource&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaEntityManagerFactory&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;entityManagerFactory&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaHandleTransaction&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jpaCloseEntityManager&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jobExecutorActivate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The same configurations can also be done when building an engine programmatically, example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngineConfiguration</span>
<span class="tok-o">.</span><span class="tok-na">createProcessEngineConfigurationFromResourceDefault</span><span class="tok-o">()</span>
<span class="tok-o">.</span><span class="tok-na">setJpaPersistenceUnitName</span><span class="tok-o">(</span><span class="tok-s">&quot;activiti-pu&quot;</span><span class="tok-o">)</span>
<span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Configuration properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>jpaPersistenceUnitName</code>: The name of the persistence-unit to use. (Make sure the persistence-unit is available on the classpath. According to the spec, the default location is <code>/META-INF/persistence.xml</code>). Use either <code>jpaEntityManagerFactory</code> or <code>jpaPersistenceUnitName</code>.</p>
</li>
<li>
<p><code>jpaEntityManagerFactory</code>: An reference to a bean implementing <code>javax.persistence.EntityManagerFactory</code> that will be used to load the Entities and flushing the updates. Use either <em>jpaEntityManagerFactory</em> or <em>jpaPersistenceUnitName</em>.</p>
</li>
<li>
<p><code>jpaHandleTransaction</code>: Flag indicating that the engine should begin and commit/rollback the transaction on the used <em>EntityManager</em> instances. Set to false when <em>Java Transaction API (JTA)</em> is used.</p>
</li>
<li>
<p><code>jpaCloseEntityManager</code>: Flag indicating that the engine should close the <code>EntityManager</code> instance that was obtained from the <code>EntityManagerFactory</code>. Set to false when the <em>EntityManager</em> is container-managed (e.g. when using an Extended Persistence Context which isn&#8217;t scoped to a single transaction').</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_usage">10.3. Usage</h3>
<div class="sect3">
<h4 id="_simple_example">10.3.1. Simple Example</h4>
<div class="paragraph">
<p>Examples for using JPA variables can be found in JPAVariableTest in the Flowable source code. We&#8217;ll explain <code>JPAVariableTest.testUpdateJPAEntityValues</code> step by step.</p>
</div>
<div class="paragraph">
<p>First of all, we create an <em>EntityManagerFactory</em> for our persistence-unit, which is based on <code>META-INF/persistence.xml</code>. This contains classes which should be included in the persistence unit and some vendor-specific configuration.</p>
</div>
<div class="paragraph">
<p>We are using a simple entity in the test, having an id and <code>String</code> value property, which is also persisted. Before running the test, we create an entity and save this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</div></td><td class="code"><span></span><span class="tok-nd">@Entity</span><span class="tok-o">(</span><span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-s">&quot;JPA_ENTITY_FIELD&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">FieldAccessJPAEntity</span> <span class="tok-o">{</span>

  <span class="tok-nd">@Id</span>
  <span class="tok-nd">@Column</span><span class="tok-o">(</span><span class="tok-n">name</span> <span class="tok-o">=</span> <span class="tok-s">&quot;ID_&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">private</span> <span class="tok-n">Long</span> <span class="tok-n">id</span><span class="tok-o">;</span>

  <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">value</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-nf">FieldAccessJPAEntity</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-c1">// Empty constructor needed for JPA</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">Long</span> <span class="tok-nf">getId</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">id</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setId</span><span class="tok-o">(</span><span class="tok-n">Long</span> <span class="tok-n">id</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">id</span> <span class="tok-o">=</span> <span class="tok-n">id</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getValue</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">value</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">setValue</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">value</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">value</span> <span class="tok-o">=</span> <span class="tok-n">value</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We start a new process instance, adding the entity as a variable. As with other variables, they are stored in the persistent storage of the engine. When the variable is requested the next time, it will be loaded from the <code>EntityManager</code> based on the class and Id stored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;</span> <span class="tok-n">variables</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">HashMap</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;();</span>
<span class="tok-n">variables</span><span class="tok-o">.</span><span class="tok-na">put</span><span class="tok-o">(</span><span class="tok-s">&quot;entityToUpdate&quot;</span><span class="tok-o">,</span> <span class="tok-n">entityToUpdate</span><span class="tok-o">);</span>

<span class="tok-n">ProcessInstance</span> <span class="tok-n">processInstance</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">startProcessInstanceByKey</span><span class="tok-o">(</span><span class="tok-s">&quot;UpdateJPAValuesProcess&quot;</span><span class="tok-o">,</span> <span class="tok-n">variables</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first node in our process definition contains a <code>serviceTask</code> that will invoke the method <code>setValue</code> on <code>entityToUpdate</code>, which resolves to the JPA variable we set earlier when starting the process instance and will be loaded from the <code>EntityManager</code> associated with the current engine&#8217;s context'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theTask&#39;</span> <span class="tok-na">name=</span><span class="tok-s">&#39;updateJPAEntityTask&#39;</span>
  <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;${entityToUpdate.setValue(&#39;updatedValue&#39;)}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the service-task is finished, the process instance waits in a userTask defined in the process definition, which allows us to inspect the process instance. At this point, the <code>EntityManager</code> has been flushed and the changes to the entity have been pushed to the database. When we get the value of the variable <code>entityToUpdate</code>, it&#8217;s loaded again and we get the entity with its <code>value</code> property set to <code>updatedValue</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-c1">// Servicetask in process &#39;UpdateJPAValuesProcess&#39; should have set value on entityToUpdate.</span>
<span class="tok-n">Object</span> <span class="tok-n">updatedEntity</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">getVariable</span><span class="tok-o">(</span><span class="tok-n">processInstance</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">(),</span> <span class="tok-s">&quot;entityToUpdate&quot;</span><span class="tok-o">);</span>
<span class="tok-n">assertTrue</span><span class="tok-o">(</span><span class="tok-n">updatedEntity</span> <span class="tok-k">instanceof</span> <span class="tok-n">FieldAccessJPAEntity</span><span class="tok-o">);</span>
<span class="tok-n">assertEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;updatedValue&quot;</span><span class="tok-o">,</span> <span class="tok-o">((</span><span class="tok-n">FieldAccessJPAEntity</span><span class="tok-o">)</span><span class="tok-n">updatedEntity</span><span class="tok-o">).</span><span class="tok-na">getValue</span><span class="tok-o">());</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_jpa_process_variables">10.3.2. Query JPA process variables</h4>
<div class="paragraph">
<p>You can query for <code>ProcessInstance</code>s and <code>Execution</code>s that have a certain JPA-entity as variable value. <strong>Note that only <code>variableValueEquals(name, entity)</code> is supported for JPA-Entities on <code>ProcessInstanceQuery</code> and <code>ExecutionQuery</code></strong>. Methods <code>variableValueNotEquals</code>, <code>variableValueGreaterThan</code>, <code>variableValueGreaterThanOrEqual</code>, <code>variableValueLessThan</code> and <code>variableValueLessThanOrEqual</code> are unsupported and will throw an <code>ActivitiException</code> when a JPA-Entity is passed as value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span> <span class="tok-n">ProcessInstance</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceQuery</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">variableValueEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;entityToQuery&quot;</span><span class="tok-o">,</span> <span class="tok-n">entityToQuery</span><span class="tok-o">).</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_advanced_example_using_spring_beans_and_jpa">10.3.3. Advanced example using Spring beans and JPA</h4>
<div class="paragraph">
<p>A more advanced example, <code>JPASpringTest</code>, can be found in <code>flowable-spring-examples</code>. It describes the following simple use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An existing Spring-bean which uses JPA entities already exists which allows for Loan Requests to be stored.</p>
</li>
<li>
<p>Using Flowable, we can use the existing entities, obtained through the existing bean, and use them as variable in our process. Process is defined in the following steps:</p>
<div class="ulist">
<ul>
<li>
<p>Service task that creates a new LoanRequest, using the existing <code>LoanRequestBean</code> using variables received when starting the process (e.g. could come from a start form). The created entity is stored as a variable, using <code>activiti:resultVariable</code> which stores the expression result as a variable.</p>
</li>
<li>
<p>UserTask that allows a manager to review the request and approve/disapprove, which is stored as a boolean variable <code>approvedByManager</code></p>
</li>
<li>
<p>ServiceTask that updates the loan request entity so the entity is in sync with the process.</p>
</li>
<li>
<p>Depending on the value of the entity property <code>approved</code>, an exclusive gateway is used to make a decision about what path to take next: When the request is approved, process ends, otherwise, an extra task will become available (Send rejection letter), so the customer can be notified manually by a rejection letter.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note that the process doesn&#8217;t contain any forms, since it is only used in a unit test.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/jpa.spring.example.process.png" alt="jpa.spring.example.process">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;definitions</span> <span class="tok-na">id=</span><span class="tok-s">&quot;taskAssigneeExample&quot;</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.omg.org/spec/BPMN/20100524/MODEL&quot;</span>
  <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="tok-na">xmlns:activiti=</span><span class="tok-s">&quot;http://activiti.org/bpmn&quot;</span>
  <span class="tok-na">targetNamespace=</span><span class="tok-s">&quot;org.activiti.examples&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;process</span> <span class="tok-na">id=</span><span class="tok-s">&quot;LoanRequestProcess&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Process creating and handling loan request&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;startEvent</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theStart&#39;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&#39;flow1&#39;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&#39;theStart&#39;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&#39;createLoanRequest&#39;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&#39;createLoanRequest&#39;</span> <span class="tok-na">name=</span><span class="tok-s">&#39;Create loan request&#39;</span>
      <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;${loanRequestBean.newLoanRequest(customerName, amount)}&quot;</span>
      <span class="tok-na">activiti:resultVariable=</span><span class="tok-s">&quot;loanRequest&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&#39;flow2&#39;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&#39;createLoanRequest&#39;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&#39;approveTask&#39;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;approveTask&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Approve request&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&#39;flow3&#39;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&#39;approveTask&#39;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&#39;approveOrDissaprove&#39;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;serviceTask</span> <span class="tok-na">id=</span><span class="tok-s">&#39;approveOrDissaprove&#39;</span> <span class="tok-na">name=</span><span class="tok-s">&#39;Store decision&#39;</span>
      <span class="tok-na">activiti:expression=</span><span class="tok-s">&quot;${loanRequest.setApproved(approvedByManager)}&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&#39;flow4&#39;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&#39;approveOrDissaprove&#39;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&#39;exclusiveGw&#39;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;exclusiveGateway</span> <span class="tok-na">id=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Exclusive Gateway approval&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;endFlow1&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;theEnd&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${loanRequest.approved}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
    <span class="tok-nt">&lt;/sequenceFlow&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&quot;endFlow2&quot;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&quot;exclusiveGw&quot;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&quot;sendRejectionLetter&quot;</span><span class="tok-nt">&gt;</span>
      <span class="tok-nt">&lt;conditionExpression</span> <span class="tok-na">xsi:type=</span><span class="tok-s">&quot;tFormalExpression&quot;</span><span class="tok-nt">&gt;</span>${!loanRequest.approved}<span class="tok-nt">&lt;/conditionExpression&gt;</span>
    <span class="tok-nt">&lt;/sequenceFlow&gt;</span>

    <span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;sendRejectionLetter&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Send rejection letter&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;sequenceFlow</span> <span class="tok-na">id=</span><span class="tok-s">&#39;flow5&#39;</span> <span class="tok-na">sourceRef=</span><span class="tok-s">&#39;sendRejectionLetter&#39;</span> <span class="tok-na">targetRef=</span><span class="tok-s">&#39;theOtherEnd&#39;</span> <span class="tok-nt">/&gt;</span>

    <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theEnd&#39;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;endEvent</span> <span class="tok-na">id=</span><span class="tok-s">&#39;theOtherEnd&#39;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/process&gt;</span>

<span class="tok-nt">&lt;/definitions&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although the example above is quite simple, it shows the power of using JPA combined with Spring and parametrized method-expressions. The process requires no custom java-code at all (except for the Spring-bean off course) and speeds up development drastically.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="history">11. History</h2>
<div class="sectionbody">
<div class="paragraph">
<p>History is the component that captures what happened during process execution and stores it permanently.  In contrast to the runtime data,  the history data will remain present in the DB also after process instances have completed.</p>
</div>
<div class="paragraph">
<p>There are 5 history entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>HistoricProcessInstance</code>s containing information about current and past process instances.</p>
</li>
<li>
<p><code>HistoricVariableInstance</code>s containing the latest value of a process variable or task variable.</p>
</li>
<li>
<p><code>HistoricActivityInstance</code>s containing information about a single execution of an activity (node in the process).</p>
</li>
<li>
<p><code>HistoricTaskInstance</code>s containing information about current and past (completed and deleted) task instances.</p>
</li>
<li>
<p><code>HistoricDetail</code>s containing various kinds of information related to either a historic process instances, an activity instance or a task instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since the DB contains historic entities for past as well as ongoing instances, you might want to consider  querying these tables in order to minimize access to the runtime process instance data  and that way keeping the runtime execution performant.</p>
</div>
<div class="paragraph">
<p>Later on, this information will be exposed in the Flowable app. Also, it will be the information from which the reports will be generated.</p>
</div>
<div class="sect2">
<h3 id="historyQuery">11.1. Querying history</h3>
<div class="paragraph">
<p>In the API, it&#8217;s possible to query all 5 of the History entities. The HistoryService exposes the methods <code>createHistoricProcessInstanceQuery()</code>, <code>createHistoricVariableInstanceQuery()</code>, <code>createHistoricActivityInstanceQuery()</code>,  <code>createHistoricDetailQuery()</code> and <code>createHistoricTaskInstanceQuery()</code>.</p>
</div>
<div class="paragraph">
<p>Below are a couple of examples that show some of the possibilities of the query API for history. Full description of the possibilities can be found in the <a href="http://www.flowable.org/javadocs/index.html">javadocs</a>, in the <code>org.activiti.engine.history</code> package.</p>
</div>
<div class="sect3">
<h4 id="historyQueryProcessInstance">11.1.1. HistoricProcessInstanceQuery</h4>
<div class="paragraph">
<p>Get 10 <code>HistoricProcessInstances</code> that are finished and which took the most time to complete (the longest duration) of all finished processes with definition <em>XXX</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricProcessInstanceQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">finished</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processDefinitionId</span><span class="tok-o">(</span><span class="tok-s">&quot;XXX&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">orderByProcessInstanceDuration</span><span class="tok-o">().</span><span class="tok-na">desc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">listPage</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">10</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="historyQueryVariableInstance">11.1.2. HistoricVariableInstanceQuery</h4>
<div class="paragraph">
<p>Get all <code>HistoricVariableInstances</code> from a finished process instance with id <em>xxx</em> ordered by variable name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricVariableInstanceQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-s">&quot;XXX&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">orderByVariableName</span><span class="tok-o">.</span><span class="tok-na">desc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="historyQueryActivityInstance">11.1.3. HistoricActivityInstanceQuery</h4>
<div class="paragraph">
<p>Get the last <code>HistoricActivityInstance</code> of type <em>serviceTask</em> that has been finished in any process that uses the processDefinition with id XXX.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricActivityInstanceQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">activityType</span><span class="tok-o">(</span><span class="tok-s">&quot;serviceTask&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">processDefinitionId</span><span class="tok-o">(</span><span class="tok-s">&quot;XXX&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">finished</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">orderByHistoricActivityInstanceEndTime</span><span class="tok-o">().</span><span class="tok-na">desc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">listPage</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">1</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="historyQueryDetail">11.1.4. HistoricDetailQuery</h4>
<div class="paragraph">
<p>The next example, gets all variable-updates that have been done in process with id 123. Only <code>HistoricVariableUpdate</code>s will be returned by this query. Note that it&#8217;s possible that a certain variable name has multiple <code>HistoricVariableUpdate</code> entries, for each time the variable was updated in the process. You can use <code>orderByTime</code> (the time the variable update was done) or <code>orderByVariableRevision</code> (revision of runtime variable at the time of updating) to find out in what order they occurred.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricDetailQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">variableUpdates</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-s">&quot;123&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">orderByVariableName</span><span class="tok-o">().</span><span class="tok-na">asc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example gets all <a href="#formProperties">form-properties</a> that were submitted in any task or when starting the process with id "123". Only <code>HistoricFormProperties</code>s will be returned by this query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricDetailQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">formProperties</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">processInstanceId</span><span class="tok-o">(</span><span class="tok-s">&quot;123&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">orderByVariableName</span><span class="tok-o">().</span><span class="tok-na">asc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The last example gets all variable updates that were performed on the task with id "123". This returns all <code>HistoricVariableUpdates</code> for variables that were set on the task (task local variables), and NOT on the process instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricDetailQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">variableUpdates</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">taskId</span><span class="tok-o">(</span><span class="tok-s">&quot;123&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">orderByVariableName</span><span class="tok-o">().</span><span class="tok-na">asc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Task local variables can be set using the <code>TaskService</code> or on a <code>DelegateTask</code>, inside <code>TaskListener</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">setVariableLocal</span><span class="tok-o">(</span><span class="tok-s">&quot;123&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;myVariable&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Variable value&quot;</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">notify</span><span class="tok-o">(</span><span class="tok-n">DelegateTask</span> <span class="tok-n">delegateTask</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-n">delegateTask</span><span class="tok-o">.</span><span class="tok-na">setVariableLocal</span><span class="tok-o">(</span><span class="tok-s">&quot;myVariable&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;Variable value&quot;</span><span class="tok-o">);</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="historyQueryTaskInstance">11.1.5. HistoricTaskInstanceQuery</h4>
<div class="paragraph">
<p>Get 10 <code>HistoricTaskInstance</code>s that are finished and which took the most time to complete (the longest duration) of all tasks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricTaskInstanceQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">finished</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">orderByHistoricTaskInstanceDuration</span><span class="tok-o">().</span><span class="tok-na">desc</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">listPage</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">10</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Get <code>HistoricTaskInstance</code>s that are deleted with a delete reason that contains "invalid", which were last assigned to user <em>kermit</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricTaskInstanceQuery</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">finished</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">taskDeleteReasonLike</span><span class="tok-o">(</span><span class="tok-s">&quot;%invalid%&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">taskAssignee</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">listPage</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">10</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="historyConfig">11.2. History configuration</h3>
<div class="paragraph">
<p>The history level can be configured programmatically, using the enum org.activiti.engine.impl.history.HistoryLevel (or <em>HISTORY</em> constants defined on <code>ProcessEngineConfiguration</code> for versions prior to 5.11):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">ProcessEngine</span> <span class="tok-n">processEngine</span> <span class="tok-o">=</span> <span class="tok-n">ProcessEngineConfiguration</span>
  <span class="tok-o">.</span><span class="tok-na">createProcessEngineConfigurationFromResourceDefault</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">setHistory</span><span class="tok-o">(</span><span class="tok-n">HistoryLevel</span><span class="tok-o">.</span><span class="tok-na">AUDIT</span><span class="tok-o">.</span><span class="tok-na">getKey</span><span class="tok-o">())</span>
  <span class="tok-o">.</span><span class="tok-na">buildProcessEngine</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The level can also be configured in activiti.cfg.xml or in a spring-context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.cfg.StandaloneInMemProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;history&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;audit&quot;</span> <span class="tok-nt">/&gt;</span>
  ...
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Following history levels can be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>none</code>: skips all history archiving.  This is the most performant for runtime  process execution, but no historical information will be available.</p>
</li>
<li>
<p><code>activity</code>: archives all process instances and activity instances.  At the end of the process instance, the latest values of the top level process instance variables  will be copied to historic variable instances.  No details will be archived.</p>
</li>
<li>
<p><code>audit</code>: This is the default. It archives all process instances,  activity instances, keeps variable values continuously in sync and all form properties that are submitted  so that all user interaction through forms is traceable and can be audited.</p>
</li>
<li>
<p><code>full</code>: This is the highest level of history archiving and hence the  slowest.  This level stores all information as in the <code>audit</code> level  plus all other possible details, mostly this are process variable updates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>In older releases, the history level was stored in the database (table <code>ACT_GE_PROPERTY</code>, property with name <code>historyLevel</code>). Starting from 5.11, this value is not used anymore and is ignored/deleted from the database. The history can now be changed between 2 boots of the engine, without an exception being thrown in case the level changed from the previous engine-boot.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="historyFormAuditPurposes">11.3. History for audit purposes</h3>
<div class="paragraph">
<p>When <a href="#historyConfig">configuring</a> at least <code>audit</code> level for configuration. Then all properties submitted through methods  <code>FormService.submitStartFormData(String processDefinitionId, Map&lt;String, String&gt; properties)</code> and <code>FormService.submitTaskFormData(String taskId, Map&lt;String, String&gt; properties)</code> are recorded.</p>
</div>
<div class="paragraph">
<p>Form properties can be retrieved with the query API like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">historyService</span>
      <span class="tok-o">.</span><span class="tok-na">createHistoricDetailQuery</span><span class="tok-o">()</span>
      <span class="tok-o">.</span><span class="tok-na">formProperties</span><span class="tok-o">()</span>
      <span class="tok-o">...</span>
      <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In that case only historic details of type <code>HistoricFormProperty</code> are returned.</p>
</div>
<div class="paragraph">
<p>If you&#8217;ve set the authenticated user before calling the submit methods with <code>IdentityService.setAuthenticatedUserId(String)</code> then that authenticated user who submitted the form will be accessible in the history as well with <code>HistoricProcessInstance.getStartUserId()</code> for start forms and  <code>HistoricActivityInstance.getAssignee()</code> for task forms.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="flowableDesigner">12. Eclipse Designer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Flowable comes with an Eclipse plugin, the Flowable Eclipse Designer, that can be used to graphically model, test and deploy BPMN 2.0 processes.</p>
</div>
<div class="sect2">
<h3 id="eclipseDesignerInstallation">12.1. Installation</h3>
<div class="paragraph">
<p>The following installation instructions are verified on <a href="http://www.eclipse.org/downloads/">Eclipse Kepler and Indigo</a>. Note that Eclipse Helios is <strong>NOT</strong> supported.</p>
</div>
<div class="paragraph">
<p>Go to <strong>Help &#8594; Install New Software</strong>. In the following panel, click on <em>Add</em> button and fill in the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>*Name:*Flowable BPMN 2.0 designer</p>
</li>
<li>
<p>*Location:*http://www.flowable.org/designer/update/</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.add.update.site.png" alt="designer.add.update.site">
</div>
</div>
<div class="paragraph">
<p>Make sure the <strong>"Contact all updates sites.."</strong> checkbox is <strong>checked</strong>, because all the necessary plugins will then be downloaded by Eclipse.</p>
</div>
</div>
<div class="sect2">
<h3 id="eclipseDesignerEditorFeatures">12.2. Flowable Designer editor features</h3>
<div class="ulist">
<ul>
<li>
<p>Create Flowable projects and diagrams.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.create.activiti.project.png" alt="designer.create.activiti.project">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The Flowable Designer creates a .bpmn file when creating a new Flowable diagram. When opened with the Flowable Diagram Editor view this will provide a graphical modeling canvas and palette. The same file can however be opened with an XML editor and it then shows the BPMN 2.0 XML elements of the process definition. So the Flowable Designer works with only one file for both the graphical diagram as well as the BPMN 2.0 XML. Note that in old releases, the .bpmn extension is not yet supported as deployment artifact for a process definition. Therefore the "create deployment artifacts" feature of the Flowable Designer generates a BAR file with a .bpmn20.xml file that contains the content of the .bpmn file. You can also do a quick file rename yourself. Also note that you can open a .bpmn20.xml file with the Flowable Diagram Editor view as well.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.bpmn.file.png" alt="designer.bpmn.file">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>BPMN 2.0 XML files can be imported into the Flowable Designer and a diagram will be created. Just copy the BPMN 2.0 XML file to your project and open the file with the Flowable Diagram Editor view. The Flowable Designer uses the BPMN DI information of the file to create the diagram. If you have a BPMN 2.0 XML file without BPMN DI information, no diagram can be created.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.open.importedfile.png" alt="designer.open.importedfile">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For deployment a BAR file and optionally a JAR file is created by the Flowable Designer by right-clicking on a Flowable project in the package explorer and choosing the <em>Create deployment artifacts</em> option at the bottom of the popup menu. For more information about the deployment functionality of the Designer look at the <a href="#eclipseDesignerDeployment">deployment</a> section.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.create.deployment.png" alt="designer.create.deployment">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Generate a unit test (right click on a BPMN 2.0 XML file in the package explorer and select <em>generate unit test</em>) A unit test is generated with a Flowable configuration that runs on an embedded H2 database. You can now run the unit test to test your process definition.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.unittest.generate.png" alt="designer.unittest.generate">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The Flowable project is generated as a Maven project. To configure the dependencies you need to run <em>mvn eclipse:eclipse</em> and the Maven dependencies will be configured as expected. Note that for process design Maven dependencies are not needed. They are only needed to run unit tests.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.project.maven.png" alt="designer.project.maven">
</div>
</div>
</div>
<div class="sect2">
<h3 id="eclipseDesignerBPMNFeatures">12.3. Flowable Designer BPMN features</h3>
<div class="ulist">
<ul>
<li>
<p>Support for start none event, start error event, timer start event, end none event, end error event, sequence flow,  parallel gateway, exclusive gateway, inclusive gateway, event gateway, embedded subprocess, event sub process, call activity, pool, lane,  script task, user task, service task, mail task, manual task, business rule task, receive task, timer boundary event, error boundary event, signal boundary event, timer catching event, signal catching event, signal throwing event, none throwing event and four Flowable specific elements (user, script, mail tasks and start event).</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.process.png" alt="designer.model.process">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can quickly change the type of a task by hovering over the element and choosing the new task type.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.quick.change.png" alt="designer.model.quick.change">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can quickly add new elements hovering over an element and choosing a new element type.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.quick.new.png" alt="designer.model.quick.new">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Java class, expression or delegate expression configuration is supported for the Java service task. In addition field extensions can be configured.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.servicetask.property.png" alt="designer.servicetask.property">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for pools and lanes. Because Flowable reads different pools as different process definition, it makes the most sense to use only one pool. If you use multiple pools, be aware that drawing sequence flows between the pools will result in problems when deploying the process in the Flowable Engine. You can add as much lanes to a pool as you want.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.poolandlanes.png" alt="designer.model.poolandlanes">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can add labels to sequence flows by filling the name property. You can position the labels yourself as the position is saved as part of the BPMN 2.0 XML DI information.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.labels.png" alt="designer.model.labels">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for event sub processes.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.model.eventsubprocess.png" alt="designer.model.eventsubprocess">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for expanded embedded sub processes. You can also add an embedded sub process in another embedded sub process.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.embeddedprocess.canvas.png" alt="designer.embeddedprocess.canvas">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for timer boundary events on tasks and embedded sub processes. Although, the timer boundary event makes the most sense when using it on a user task or an embedded sub process in the Flowable Designer.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.timerboundary.canvas.png" alt="designer.timerboundary.canvas">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for additional Flowable extensions like the Mail task, the candidate configuration of User tasks and Script task configuration.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.mailtask.property.png" alt="designer.mailtask.property">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for the Flowable execution and task listeners. You can also add field extensions for execution listeners.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.listener.configuration.png" alt="designer.listener.configuration">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for conditions on sequence flows.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.sequence.condition.png" alt="designer.sequence.condition">
</div>
</div>
</div>
<div class="sect2">
<h3 id="eclipseDesignerDeployment">12.4. Flowable Designer deployment features</h3>
<div class="paragraph">
<p>Deploying process definitions and task forms on the Flowable Engine is not hard. You need a BAR file containing the process definition BPMN 2.0 XML file and optionally task forms and an image of the process that can be viewed in the Flowable app. In the Flowable Designer it&#8217;s made very easy to create a BAR file. When you&#8217;ve finished your process implementation just right-click on your Flowable project in the package explorer and choose for the <strong>Create deployment artifacts</strong> option at the bottom of the popup menu.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.create.deployment.png" alt="designer.create.deployment">
</div>
</div>
<div class="paragraph">
<p>Then a deployment directory is created containing the BAR file and optionally a JAR file with the Java classes of your Flowable project.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.deployment.dir.png" alt="designer.deployment.dir">
</div>
</div>
<div class="paragraph">
<p>This file can now be uploaded to the Flowable Engine using the deployments tab in Flowable app, and you are ready to go.</p>
</div>
<div class="paragraph">
<p>When your project contains Java classes, the deployment is a bit more work. In that case the <strong>Create deployment artifacts</strong> step in the Flowable Designer will also generate a JAR file containing the compiled classes. This JAR file must be deployed to the flowable-XXX/WEB-INF/lib directory in your Flowable Tomcat installation directory. This makes the classes available on the classpath of the Flowable Engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="eclipseDesignerExtending">12.5. Extending Flowable Designer</h3>
<div class="paragraph">
<p>You can extend the default functionality offered by Flowable Designer. This section documents which extensions are available, how they can be used and provides some usage examples. Extending Flowable Designer is useful in cases where the default functionality doesn&#8217;t suit your needs, you require additional capabilities or have domain specific requirements when modeling business processes. Extension of Flowable Designer falls into two distinct categories, extending the palette and extending output formats. Each of these extension ways requires a specific approach and different technical expertise.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Extending Flowable Designer requires technical knowledge and more specifically, knowledge of programming in Java. Depending on the type of extension you want to create, you might also need to be familiar with Maven, Eclipse, OSGi, Eclipse extensions and SWT.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="eclipseDesignerCustomizingPalette">12.5.1. Customizing the palette</h4>
<div class="paragraph">
<p>You can customize the palette that is offered to users when modeling processes. The palette is the collection of shapes that can be dragged onto the canvas in a process diagram and is displayed to the right hand side of the canvas. As you can see in the default palette, the default shapes are grouped into compartments (these are called "drawers") for Events, Gateways and so on. There are two options built-in to Flowable Designer to customize the drawers and shapes in the palette:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding your own shapes / nodes to existing or new drawers</p>
</li>
<li>
<p>Disabling any or all of the default BPMN 2.0 shapes offered by Flowable Designer, with the exception of the connection and selection tools</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to customize the palette, you create a JAR file that is added to a specific installation of Flowable Designer (more on <a href="#eclipseDesignerApplyingExtension">how to do that</a> later). Such a JAR file is called an <em>extension</em>. By writing classes that are included in your extension, Flowable Designer understands which customizations you wish to make. In order for this to work, your classes should implement certain interfaces. There is an integration library available with those interfaces and base classes to extend which you should add to your project&#8217;s classpath.</p>
</div>
<div class="paragraph">
<p>You can find the code examples listed below in source control with Flowable Designer. Take a look in the <code>examples/money-tasks</code> directory in the <code>projects/designer</code> directory of Flowable&#8217;s source code.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can setup your project in whichever tool you prefer and build the JAR with your build tool of choice. For the instructions below, a setup is assumed with Eclipse Kepler or Indigo, using Maven (3.x) as build tool, but any setup should enable you to create the same results.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_extension_setup_eclipse_maven">Extension setup (Eclipse/Maven)</h5>
<div class="paragraph">
<p>Download and extract <a href="http://www.eclipse.org/downloads">Eclipse</a> (most recent versions should work) and a recent version (3.x) of <a href="http://maven.apache.org/download.html">Apache Maven</a>. If you use a 2.x version of Maven, you will run into problems when building your project, so make sure your version is up to date. We assume you are familiar with using basic features and the Java editor in Eclipse. It&#8217;s up to you whether you prefer to use Eclipse&#8217;s features for Maven or run Maven commands from a command prompt.</p>
</div>
<div class="paragraph">
<p>Create a new project in Eclipse. This can be a general project type. Create a <code>pom.xml</code> file at the root of the project to contain the Maven project setup. Also create folders for the <code>src/main/java</code> and <code>src/main/resources</code> folders, which are Maven conventions for your Java source files and resources respectively. Open the <code>pom.xml</code> file and add the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nt">&lt;project</span>
  <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span>
  <span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;modelVersion&gt;</span>4.0.0<span class="tok-nt">&lt;/modelVersion&gt;</span>

  <span class="tok-nt">&lt;groupId&gt;</span>org.acme<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>money-tasks<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>1.0.0<span class="tok-nt">&lt;/version&gt;</span>
  <span class="tok-nt">&lt;packaging&gt;</span>jar<span class="tok-nt">&lt;/packaging&gt;</span>
  <span class="tok-nt">&lt;name&gt;</span>Acme Corporation Money Tasks<span class="tok-nt">&lt;/name&gt;</span>
...
<span class="tok-nt">&lt;/project&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, this is just a basic pom.xml file that defines a <code>groupId</code>, <code>artifactId</code> and <code>version</code> for the project. We will create a customization that includes a single custom node for our money business.</p>
</div>
<div class="paragraph">
<p>Add the integration library to your project&#8217;s dependencies by including this dependency in your <code>pom.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependencies&gt;</span>
  <span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.flowable.designer<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>org.flowable.designer.integration<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>5.12.0<span class="tok-nt">&lt;/version&gt;</span> <span class="tok-c">&lt;!-- Use the current Flowable Designer version --&gt;</span>
    <span class="tok-nt">&lt;scope&gt;</span>compile<span class="tok-nt">&lt;/scope&gt;</span>
  <span class="tok-nt">&lt;/dependency&gt;</span>
<span class="tok-nt">&lt;/dependencies&gt;</span>
...
<span class="tok-nt">&lt;repositories&gt;</span>
  <span class="tok-nt">&lt;repository&gt;</span>
      <span class="tok-nt">&lt;id&gt;</span>Flowable<span class="tok-nt">&lt;/id&gt;</span>
   <span class="tok-nt">&lt;/repository&gt;</span>
<span class="tok-nt">&lt;/repositories&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, in the<code> pom.xml</code> file, add the configuration for the <code>maven-compiler-plugin</code> so the Java source level is at least 1.5 (see snippet below). You will need this in order to use annotations. You can also include instructions for Maven to generate the JAR&#8217;s <code>MANIFEST.MF</code> file. This is not required, but you can use a specific property in the manifest to provide a name for your extension (this name may be shown at certain places in the designer and is primarily intended for future use if you have several extensions in the designer). If you wish to do so, include the following snippet in <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span></span><span class="tok-nt">&lt;build&gt;</span>
  <span class="tok-nt">&lt;plugins&gt;</span>
        <span class="tok-nt">&lt;plugin&gt;</span>
      <span class="tok-nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="tok-nt">&lt;/artifactId&gt;</span>
      <span class="tok-nt">&lt;configuration&gt;</span>
        <span class="tok-nt">&lt;source&gt;</span>1.5<span class="tok-nt">&lt;/source&gt;</span>
        <span class="tok-nt">&lt;target&gt;</span>1.5<span class="tok-nt">&lt;/target&gt;</span>
        <span class="tok-nt">&lt;showDeprecation&gt;</span>true<span class="tok-nt">&lt;/showDeprecation&gt;</span>
        <span class="tok-nt">&lt;showWarnings&gt;</span>true<span class="tok-nt">&lt;/showWarnings&gt;</span>
        <span class="tok-nt">&lt;optimize&gt;</span>true<span class="tok-nt">&lt;/optimize&gt;</span>
      <span class="tok-nt">&lt;/configuration&gt;</span>
    <span class="tok-nt">&lt;/plugin&gt;</span>
    <span class="tok-nt">&lt;plugin&gt;</span>
      <span class="tok-nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tok-nt">&lt;/groupId&gt;</span>
      <span class="tok-nt">&lt;artifactId&gt;</span>maven-jar-plugin<span class="tok-nt">&lt;/artifactId&gt;</span>
      <span class="tok-nt">&lt;version&gt;</span>2.3.1<span class="tok-nt">&lt;/version&gt;</span>
      <span class="tok-nt">&lt;configuration&gt;</span>
        <span class="tok-nt">&lt;archive&gt;</span>
          <span class="tok-nt">&lt;index&gt;</span>true<span class="tok-nt">&lt;/index&gt;</span>
          <span class="tok-nt">&lt;manifest&gt;</span>
            <span class="tok-nt">&lt;addClasspath&gt;</span>false<span class="tok-nt">&lt;/addClasspath&gt;</span>
            <span class="tok-nt">&lt;addDefaultImplementationEntries&gt;</span>true<span class="tok-nt">&lt;/addDefaultImplementationEntries&gt;</span>
          <span class="tok-nt">&lt;/manifest&gt;</span>
          <span class="tok-nt">&lt;manifestEntries&gt;</span>
            <span class="tok-nt">&lt;FlowableDesigner-Extension-Name&gt;</span>Acme Money<span class="tok-nt">&lt;/FlowableDesigner-Extension-Name&gt;</span>
          <span class="tok-nt">&lt;/manifestEntries&gt;</span>
        <span class="tok-nt">&lt;/archive&gt;</span>
      <span class="tok-nt">&lt;/configuration&gt;</span>
    <span class="tok-nt">&lt;/plugin&gt;</span>
  <span class="tok-nt">&lt;/plugins&gt;</span>
<span class="tok-nt">&lt;/build&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The name for the extension is described by the <code>FlowableDesigner-Extension-Name</code> property. The only thing left to do now is tell Eclipse to setup the project according to the instructions in <code>pom.xml</code>. So open up a command shell and go to the root folder of your project in the Eclipse workspace. Then execute the following Maven command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn eclipse:eclipse</pre>
</div>
</div>
<div class="paragraph">
<p>Wait until the build is successful. Refresh the project (use the project&#8217;s context menu (right-click) and select <code>Refresh</code>). You should now have the <code>src/main/java</code> and <code>src/main/resources</code> folders as source folders in the Eclipse project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can of course also use the <a href="http://www.eclipse.org/m2e">m2eclipse</a> plugin and simply enable Maven dependency management from the context menu (right-click) of the project. Then choose <code>Maven</code> &gt; <code>Update project configuration</code> from the project&#8217;s context menu. That should setup the source folders as well.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s it for the setup. Now you&#8217;re ready to start creating customizations to Flowable Designer!</p>
</div>
</div>
<div class="sect4">
<h5 id="eclipseDesignerApplyingExtension">Applying your extension to Flowable Designer</h5>
<div class="paragraph">
<p>You might be wondering how you can add your extension to Flowable Designer so your customizations are applied. These are the steps to do just that:
* Once you&#8217;ve created your extension JAR (for instance, by performing a mvn install in your project to build it with Maven), you need to transfer the extension to the computer where Flowable Designer is installed;
* Store the extension somewhere on the hard drive where it will be able to remain and remember the location. <em>Note:</em> the location must be outside the Eclipse workspace of Flowable Designer - storing the extension inside the workspace will lead to the user getting a popup error message and the extensions being unavailable;
* Start Flowable Designer and from the menu, select <code>Window</code> &gt; <code>Preferences</code>
* In the preferences screen, type <code>user</code> as keyword. You should see an option to access the <code>User Libraries</code> in Eclipse in the <code>Java</code> section.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.preferences.userlibraries.png" alt="designer.preferences.userlibraries">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the User Libraries item and a tree view shows up to the right where you can add libraries. You should see the default group where you can add extensions to Flowable Designer (depending on your Eclipse installation, you might see several others as well).</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.preferences.userlibraries.activiti.empty.png" alt="designer.preferences.userlibraries.activiti.empty">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <code>Flowable Designer Extensions</code> group and click the <code>Add JARs&#8230;&#8203;</code> button. Navigate to the folder where your extension is stored and select the extension file you want to add. After completing this, your preferences screen should show the extension as part of the <code>Flowable Designer Extensions</code> group, as shown below.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.preferences.userlibraries.activiti.moneytasks.png" alt="designer.preferences.userlibraries.activiti.moneytasks">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the <code>OK</code> button to save and close the preferences dialog. The <code>Flowable Designer Extensions</code> group is automatically added to new Flowable projects you create. You can see the user library as entry in the project&#8217;s tree in the Navigator or Package Explorer. If you already had Flowable projects in the workspace, you should also see the new extensions show up in the group. An example is shown below.</p>
</li>
</ul>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.userlibraries.project.png" alt="designer.userlibraries.project">
</div>
</div>
<div class="paragraph">
<p>Diagrams you open will now have the shapes from the new extension in their palette (or shapes disabled, depending on the customizations in your extension). If you already had a diagram opened, close and reopen it to see the changes in the palette.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_shapes_to_the_palette">Adding shapes to the palette</h5>
<div class="paragraph">
<p>With your project set up, you can now easily add shapes to the palette. Each shape you wish to add is represented by a class in your JAR. Take note that these classes are not the classes that will be used by the Flowable engine during runtime. In your extension you describe the properties that can be set in Flowable Designer for each shape. From these shapes, you can also define the runtime characteristics that should be used by the engine when a process instance reaches the node in the process. The runtime characteristics can use any of the options that Flowable supports for regular <code>ServiceTask</code>s. See <a href="#eclipseDesignerConfiguringRuntime">this section</a> for more details.</p>
</div>
<div class="paragraph">
<p>A shape&#8217;s class is a simple Java class, to which a number of annotations are added. The class should implement the <code>CustomServiceTask</code> interface, but you shouldn&#8217;t implement this interface yourself. Extend the <code>AbstractCustomServiceTask</code> base class instead (at the moment you MUST extend this class directly, so no abstract classes in between). In the Javadoc for that class you can find instructions on the defaults it provides and when you should override any of the methods it already implements. Overrides allow you to do things such as providing icons for the palette and in the shape on the canvas (these can be different) and specifying the base shape you want the node to have (activity, event, gateway).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * @author John Doe</span>
<span class="tok-cm"> * @version 1</span>
<span class="tok-cm"> * @since 1.0.0</span>
<span class="tok-cm"> */</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AcmeMoneyTask</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractCustomServiceTask</span> <span class="tok-o">{</span>
<span class="tok-o">...</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to implement the <code>getName()</code> method to determine the name the node will have in the palette. You can also put the nodes in their own drawer and provide an icon. Override the appropriate methods from <code>AbstractCustomServiceTask</code>. If you want to provide an icon, make sure it&#8217;s in the <code>src/main/resources</code> package in your JAR and is about 16x16 pixels and a JPEG or PNG format. The path you supply is relative to that folder.</p>
</div>
<div class="paragraph">
<p>You can add properties to the shape by adding members to the class and annotating them with the <code>@Property</code> annotation like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">TEXT</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Account Number&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Provide an account number&quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-n">HELP_ACCOUNT_NUMBER_LONG</span><span class="tok-o">)</span>
<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">accountNumber</span><span class="tok-o">;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are several <code>PropertyType</code> values you can use, which are described in more detail in <a href="#eclipseDesignerPropertyTypes">this section</a>. You can make a field required by setting the required attribute to true. A message and red background will appear if the user doesn&#8217;t fill out the field.</p>
</div>
<div class="paragraph">
<p>If you want to ensure the order of the various properties in your class as they appear in the property screen, you should specify the order attribute of the <code>@Property</code> annotation.</p>
</div>
<div class="paragraph">
<p>As you can see, there&#8217;s also a <code>@Help</code> annotation that&#8217;s used to provide the user some guidance when filling out the field. You can also use the <code>@Help</code> annotation on the class itself - this information is shown at the top of the property sheet presented to the user.</p>
</div>
<div class="paragraph">
<p>Below is the listing for a further elaboration of the <code>MoneyTask</code>. A comment field has been added and you can see an icon is included for the node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</div></td><td class="code"><span></span><span class="tok-cm">/**</span>
<span class="tok-cm"> * @author John Doe</span>
<span class="tok-cm"> * @version 1</span>
<span class="tok-cm"> * @since 1.0.0</span>
<span class="tok-cm"> */</span>
<span class="tok-nd">@Runtime</span><span class="tok-o">(</span><span class="tok-n">javaDelegateClass</span> <span class="tok-o">=</span> <span class="tok-s">&quot;org.acme.runtime.AcmeMoneyJavaDelegation&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Creates a new account&quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Creates a new account using the account number specified&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AcmeMoneyTask</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractCustomServiceTask</span> <span class="tok-o">{</span>

  <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-n">String</span> <span class="tok-n">HELP_ACCOUNT_NUMBER_LONG</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Provide a number that is suitable as an account number.&quot;</span><span class="tok-o">;</span>

  <span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">TEXT</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Account Number&quot;</span><span class="tok-o">,</span> <span class="tok-n">required</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">)</span>
  <span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Provide an account number&quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-n">HELP_ACCOUNT_NUMBER_LONG</span><span class="tok-o">)</span>
  <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">accountNumber</span><span class="tok-o">;</span>

  <span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">MULTILINE_TEXT</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Comments&quot;</span><span class="tok-o">)</span>
  <span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Provide comments&quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-s">&quot;You can add comments to the node to provide a brief description.&quot;</span><span class="tok-o">)</span>
  <span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">comments</span><span class="tok-o">;</span>

  <span class="tok-cm">/*</span>
<span class="tok-cm">   * (non-Javadoc)</span>
<span class="tok-cm">   *</span>
<span class="tok-cm">   * @see org.activiti.designer.integration.servicetask.AbstractCustomServiceTask #contributeToPaletteDrawer()</span>
<span class="tok-cm">   */</span>
  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">contributeToPaletteDrawer</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s">&quot;Acme Corporation&quot;</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s">&quot;Money node&quot;</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-cm">/*</span>
<span class="tok-cm">   * (non-Javadoc)</span>
<span class="tok-cm">   *</span>
<span class="tok-cm">   * @see org.activiti.designer.integration.servicetask.AbstractCustomServiceTask #getSmallIconPath()</span>
<span class="tok-cm">   */</span>
  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getSmallIconPath</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-s">&quot;icons/coins.png&quot;</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you extend Flowable Designer with this shape, The palette and corresponding node will look like this:</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.palette.add.money.png" alt="designer.palette.add.money">
</div>
</div>
<div class="paragraph">
<p>The properties screen for the money task is shown below. Note the required message for the <code>accountNumber</code> field.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.palette.add.money.properties.required.png" alt="designer.palette.add.money.properties.required">
</div>
</div>
<div class="paragraph">
<p>Users can enter static text or use expressions that use process variables in the property fields when creating diagrams (e.g. "This little piggy went to ${piggyLocation}"). Generally, this applies to text fields where users are free to enter any text. If you expect users to want to use expressions and you apply runtime behavior to your <code>CustomServiceTask</code> (using <code>@Runtime</code>), make sure to use <code>Expression</code> fields in the delegate class so the expressions are correctly resolved at runtime. More information on runtime behavior can be found in <a href="#eclipseDesignerConfiguringRuntime">this section</a>.</p>
</div>
<div class="paragraph">
<p>The help for fields is offered by the buttons to the right of each property. Clicking on the button shows a popup as displayed below.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.palette.add.money.help.png" alt="designer.palette.add.money.help">
</div>
</div>
<div class="sect5">
<h6 id="eclipseDesignerConfiguringRuntime">Configuring runtime execution of Custom Service Tasks</h6>
<div class="paragraph">
<p>With your fields setup and your extension applied to Designer, users can configure the properties of the service task when modelling a process. In most cases, you will want to use these user-configured properties when the process is executed by Flowable. To do this, you must instruct Flowable which class to instantiate when the process reaches your <code>CustomServiceTask</code>.</p>
</div>
<div class="paragraph">
<p>There is a special annotation for specifying the runtime characteristics of your <code>CustomServiceTask</code>, the <code>@Runtime</code> annotation. Here&#8217;s an example of how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nd">@Runtime</span><span class="tok-o">(</span><span class="tok-n">javaDelegateClass</span> <span class="tok-o">=</span> <span class="tok-s">&quot;org.acme.runtime.AcmeMoneyJavaDelegation&quot;</span><span class="tok-o">)</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Your <code>CustomServiceTask</code> will result in a normal <code>ServiceTask</code> in the BPMN output of processes modelled with it. Flowable enables <a href="#bpmnJavaServiceTask">several ways</a> to define the runtime characteristics of <code>ServiceTask</code>s. Therefore, the <code>@Runtime</code> annotation can take one of three attributes, which match directly to the options Flowable provides, like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javaDelegateClass</code> maps to <code>activiti:class</code> in the BPMN output. Specify the fully qualified classname of a class that implements <code>JavaDelegate</code>.</p>
</li>
<li>
<p><code>expression</code> maps to <code>activiti:expression</code> in the BPMN output. Specify an expression to a method to be executed, such as a method in a Spring Bean. You should <em>not</em> specify any <code>@Property</code> annotations on fields when using this option. For more information, see below.</p>
</li>
<li>
<p><code>javaDelegateExpression</code> maps to <code>activiti:delegateExpression</code> in the BPMN output. Specify an expression to  a class that implements <code>JavaDelegate</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The user&#8217;s property values will be injected into the runtime class if you provide members in the class for Flowable to inject into. The names should match the names of the members in your <code>CustomServiceTask</code>. For more information, consult <a href="#serviceTaskFieldInjection">this part</a> of the userguide. Note that since version 5.11.0 of the Designer you can use the <code>Expression</code> interface for dynamic field values. This means that the value of the property in the Flowable Designer must contain an expression and this expression will then be injected into an <code>Expression</code> property in the <code>JavaDelegate</code> implementation class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can use <code>@Property</code> annotations on members of your <code>CustomServiceTask</code>, but this will not work if you use <code>@Runtime</code><em>s <code>expression</code> attribute. The reason for this is that the expression you specify will be attempted to be resolved to a <em>method</em> by Flowable, not to a class. Therefore, no injection into a class will be performed. Any members marked with <code>@Property</code> will be ignored by Designer if you use <code>expression</code> in your <code>@Runtime</code> annotation. Designer will not render them as editable fields in the node&#8217;s property pane and will produce no output for the properties in the process</em> BPMN.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that the runtime class shouldn&#8217;t be in your extension JAR, as it&#8217;s dependent on the Flowable libraries. Flowable needs to be able to find it at runtime, so it needs to be on the Flowable engine&#8217;s classpath.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The examples project in Designer&#8217;s source tree contains examples of the different options for configuring <code>@Runtime</code>. Take a look in the money-tasks project for some starting points. The examples refer to delegate class examples that are in the money-delegates project.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="eclipseDesignerPropertyTypes">Property types</h5>
<div class="paragraph">
<p>This section describes the property types you can use for a <code>CustomServiceTask</code> by setting its type to a <code>PropertyType</code> value.</p>
</div>
<div class="sect5">
<h6 id="_propertytype_text">PropertyType.TEXT</h6>
<div class="paragraph">
<p>Creates a single line text field as shown below. Can be a required field and shows validation messages as a tooltip. Validation failures are displayed by changing the background of the field to a light red color.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.text.invalid.png" alt="designer.property.text.invalid">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_multiline_text">PropertyType.MULTILINE_TEXT</h6>
<div class="paragraph">
<p>Creates a multiline text field as shown below (height is fixed at 80 pixels). Can be a required field and shows validation messages as a tooltip. Validation failures are displayed by changing the background of the field to a light red color.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.multiline.text.invalid.png" alt="designer.property.multiline.text.invalid">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_period">PropertyType.PERIOD</h6>
<div class="paragraph">
<p>Creates a structured editor for specifying a period of time by editing amounts of each unit with a spinner control. The result is shown below. Can be a required field (which is interpreted such that not all values may be 0, so at least 1 part of the period must have a non-zero value) and shows validation messages as a tooltip. Validation failures are displayed by changing the background of the entire field to a light red color. The value of the field is stored as a string of the form 1y 2mo 3w 4d 5h 6m 7s, which represents 1 year, 2 months, 3 weeks, 4 days, 6 minutes and 7 seconds. The entire string is always stored, even if parts are 0.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.period.png" alt="designer.property.period">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_boolean_choice">PropertyType.BOOLEAN_CHOICE</h6>
<div class="paragraph">
<p>Creates a single checkbox control for boolean or toggle choices. Note that you can specify the <code>required</code> attribute on the <code>Property</code> annotation, but it will not be evaluated because that would leave the user without a choice whether to check the box or not. The value stored in the diagram is java.lang.Boolean.toString(boolean), which results in "true" or "false".</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.boolean.choice.png" alt="designer.property.boolean.choice">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_radio_choice">PropertyType.RADIO_CHOICE</h6>
<div class="paragraph">
<p>Creates a group of radio buttons as shown below. Selection of any of the radio buttons is mutually exclusive with selection of any of the others (i.e., only one selection allowed). Can be a required field and shows validation messages as a tooltip. Validation failures are displayed by changing the background of the group to a light red color.</p>
</div>
<div class="paragraph">
<p>This property type expects the class member you have annotated to also have an accompanying <code>@PropertyItems</code> annotation (for an example, see below). Using this additional annotation, you can specify the list of items that should be offered in an array of Strings. Specify the items by adding two array entries for each item: first, the label to be shown; second, the value to be stored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">RADIO_CHOICE</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Withdrawl limit&quot;</span><span class="tok-o">,</span> <span class="tok-n">required</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">)</span>
<span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;The maximum daily withdrawl amount &quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Choose the maximum daily amount that can be withdrawn from the account.&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@PropertyItems</span><span class="tok-o">({</span> <span class="tok-n">LIMIT_LOW_LABEL</span><span class="tok-o">,</span> <span class="tok-n">LIMIT_LOW_VALUE</span><span class="tok-o">,</span> <span class="tok-n">LIMIT_MEDIUM_LABEL</span><span class="tok-o">,</span> <span class="tok-n">LIMIT_MEDIUM_VALUE</span><span class="tok-o">,</span> <span class="tok-n">LIMIT_HIGH_LABEL</span><span class="tok-o">,</span> <span class="tok-n">LIMIT_HIGH_VALUE</span> <span class="tok-o">})</span>
<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">withdrawlLimit</span><span class="tok-o">;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.radio.choice.png" alt="designer.property.radio.choice">
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.radio.choice.invalid.png" alt="designer.property.radio.choice.invalid">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_combobox_choice">PropertyType.COMBOBOX_CHOICE</h6>
<div class="paragraph">
<p>Creates a combobox with fixed options as shown below. Can be a required field and shows validation messages as a tooltip. Validation failures are displayed by changing the background of the combobox to a light red color.</p>
</div>
<div class="paragraph">
<p>This property type expects the class member you have annotated to also have an accompanying <code>@PropertyItems</code> annotation (for an example, see below). Using this additional annotation, you can specify the list of items that should be offered in an array of Strings. Specify the items by adding two array entries for each item: first, the label to be shown; second, the value to be stored.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">COMBOBOX_CHOICE</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Account type&quot;</span><span class="tok-o">,</span> <span class="tok-n">required</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">)</span>
<span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;The type of account&quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Choose a type of account from the list of options&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@PropertyItems</span><span class="tok-o">({</span> <span class="tok-n">ACCOUNT_TYPE_SAVINGS_LABEL</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_SAVINGS_VALUE</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_JUNIOR_LABEL</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_JUNIOR_VALUE</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_JOINT_LABEL</span><span class="tok-o">,</span>
  <span class="tok-n">ACCOUNT_TYPE_JOINT_VALUE</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_TRANSACTIONAL_LABEL</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_TRANSACTIONAL_VALUE</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_STUDENT_LABEL</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_STUDENT_VALUE</span><span class="tok-o">,</span>
  <span class="tok-n">ACCOUNT_TYPE_SENIOR_LABEL</span><span class="tok-o">,</span> <span class="tok-n">ACCOUNT_TYPE_SENIOR_VALUE</span> <span class="tok-o">})</span>
<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">accountType</span><span class="tok-o">;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.combobox.choice.png" alt="designer.property.combobox.choice">
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.combobox.choice.invalid.png" alt="designer.property.combobox.choice.invalid">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_date_picker">PropertyType.DATE_PICKER</h6>
<div class="paragraph">
<p>Creates a date selection control as shown below. Can be a required field and shows validation messages as a tooltip (note, that the control used will auto-set the selection to the date on the system, so the value is seldom empty). Validation failures are displayed by changing the background of the control to a light red color.</p>
</div>
<div class="paragraph">
<p>This property type expects the class member you have annotated to also have an accompanying <code>@DatePickerProperty</code> annotation (for an example, see below). Using this additional annotation, you can specify the date time pattern to be used to store dates in the diagram and the type of datepicker you would like to be shown. Both attributes are optional and have default values that will be used if you don&#8217;t specify them (these are static variables in the <code>DatePickerProperty</code> annotation). The <code>dateTimePattern</code> attribute should be used to supply a pattern to the <code>SimpleDateFormat</code> class. When using the <code>swtStyle</code> attribute, you should specify an integer value that is supported by <code>SWT</code>'s <code>DateTime</code> control, because this is the control that is used to render this type of property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">DATE_PICKER</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Expiry date&quot;</span><span class="tok-o">,</span> <span class="tok-n">required</span> <span class="tok-o">=</span> <span class="tok-kc">true</span><span class="tok-o">)</span>
<span class="tok-nd">@Help</span><span class="tok-o">(</span><span class="tok-n">displayHelpShort</span> <span class="tok-o">=</span> <span class="tok-s">&quot;The date the account expires &quot;</span><span class="tok-o">,</span> <span class="tok-n">displayHelpLong</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Choose the date when the account will expire if no extended before the date.&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@DatePickerProperty</span><span class="tok-o">(</span><span class="tok-n">dateTimePattern</span> <span class="tok-o">=</span> <span class="tok-s">&quot;MM-dd-yyyy&quot;</span><span class="tok-o">,</span> <span class="tok-n">swtStyle</span> <span class="tok-o">=</span> <span class="tok-mi">32</span><span class="tok-o">)</span>
<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">expiryDate</span><span class="tok-o">;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.date.picker.png" alt="designer.property.date.picker">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_propertytype_data_grid">PropertyType.DATA_GRID</h6>
<div class="paragraph">
<p>Creates a data grid control as shown below. A data grid can be used to allow the user to enter an arbitrary amount of rows of data and enter values for a fixed set of columns in each of those rows (each individual combination of row and column is referred to as a cell). Rows can be added and removed as the user sees fit.</p>
</div>
<div class="paragraph">
<p>This property type expects the class member you have annotated to also have an accompanying <code>@DataGridProperty</code> annotation (for an example, see below). Using this additional annotation, you can specify some specific attributes of the data grid. You are required to reference a different class to determine which columns go into the grid with the <code>itemClass</code> attribute. Flowable Designer expects the member type to be a <code>List</code>. By convention, you can use the class of the <code>itemClass</code> attribute as its generic type. If, for example, you have a grocery list that you edit in the grid, you would define the columns of the grid in the <code>GroceryListItem</code> class. From your <code>CustomServiceTask</code>, you would refer to it like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nd">@Property</span><span class="tok-o">(</span><span class="tok-n">type</span> <span class="tok-o">=</span> <span class="tok-n">PropertyType</span><span class="tok-o">.</span><span class="tok-na">DATA_GRID</span><span class="tok-o">,</span> <span class="tok-n">displayName</span> <span class="tok-o">=</span> <span class="tok-s">&quot;Grocery List&quot;</span><span class="tok-o">)</span>
<span class="tok-nd">@DataGridProperty</span><span class="tok-o">(</span><span class="tok-n">itemClass</span> <span class="tok-o">=</span> <span class="tok-n">GroceryListItem</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span>
<span class="tok-kd">private</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">GroceryListItem</span><span class="tok-o">&gt;</span> <span class="tok-n">groceryList</span><span class="tok-o">;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The "itemClass" class uses the same annotations you would otherwise use to specify fields of a <code>CustomServiceTask</code>, with the exception of using a data grid. Specifically, <code>TEXT</code>, <code>MULTILINE_TEXT</code> and <code>PERIOD</code> are currently supported. You&#8217;ll notice the grid will create single line text controls for each field, regardless of the <code>PropertyType</code>. This is done on purpose to keep the grid graphically appealing and readable. If you consider the regular display mode for a <code>PERIOD</code> <code>PropertyType</code> for instance, you can imagine it would never properly fit in a grid cell without cluttering the screen. For <code>MULTILINE_TEXT</code> and <code>PERIOD</code>, a double-click mechanism is added to each field which pops up a larger editor for the <code>PropertyType</code>. The value is stored to the field after the user clicks OK and is therefore readable within the grid.</p>
</div>
<div class="paragraph">
<p>Required attributes are handled in a similar manner to regular fields of type <code>TEXT</code> and the entire grid is validated as soon as any field loses focus. The background color of the text control in a specific cell of the data grid is changed to light red if there are validation failures.</p>
</div>
<div class="paragraph">
<p>By default, the component allows the user to add rows, but not to determine the order of those rows. If you wish to allow this, you should set the <code>orderable</code> attribute to true, which enables buttons at the end of each row to move it up or down in the grid.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>At the moment, this property type is not correctly injected into your runtime class.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.property.datagrid.png" alt="designer.property.datagrid">
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_disabling_default_shapes_in_the_palette">Disabling default shapes in the palette</h5>
<div class="paragraph">
<p>This customization requires you to include a class in your extension that implements the <code>DefaultPaletteCustomizer</code> interface. You should not implement this interface directly, but subclass the <code>AbstractDefaultPaletteCustomizer</code> base class. Currently, this class provides no functionality, but future versions of the <code>DefaultPaletteCustomizer</code> interface will offer more capabilities for which this base class will provide some sensible defaults so it&#8217;s best to subclass so your extension will be compatible with future releases.</p>
</div>
<div class="paragraph">
<p>Extending the <code>AbstractDefaultPaletteCustomizer</code> class requires you to implement one method, <code>disablePaletteEntries()</code>, from which you must return a list of <code>PaletteEntry</code> values. For each of the default shapes, you can disable it by adding its corresponding <code>PaletteEntry</code> value to your list. Note that if you remove shapes from the default set and there are no remaining shapes in a particular drawer, that drawer will be removed from the palette in its entirety. If you wish to disable all of the default shapes, you only need to add <code>PaletteEntry.ALL</code> to your result. As an example, the code below disables the Manual task and Script task shapes in the palette.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyPaletteCustomizer</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractDefaultPaletteCustomizer</span> <span class="tok-o">{</span>

  <span class="tok-cm">/*</span>
<span class="tok-cm">   * (non-Javadoc)</span>
<span class="tok-cm">   *</span>
<span class="tok-cm">   * @see org.activiti.designer.integration.palette.DefaultPaletteCustomizer#disablePaletteEntries()</span>
<span class="tok-cm">   */</span>
  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;</span> <span class="tok-nf">disablePaletteEntries</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ArrayList</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;();</span>
    <span class="tok-n">result</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">PaletteEntry</span><span class="tok-o">.</span><span class="tok-na">MANUAL_TASK</span><span class="tok-o">);</span>
    <span class="tok-n">result</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">PaletteEntry</span><span class="tok-o">.</span><span class="tok-na">SCRIPT_TASK</span><span class="tok-o">);</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of applying this extension is shown in the picture below. As you can see, the manual task and script task shapes are no longer available in the <code>Tasks</code> drawer.</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.palette.disable.manual.and.script.png" alt="designer.palette.disable.manual.and.script">
</div>
</div>
<div class="paragraph">
<p>To disable all of the default shapes, you could use something similar to the code below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyPaletteCustomizer</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractDefaultPaletteCustomizer</span> <span class="tok-o">{</span>

  <span class="tok-cm">/*</span>
<span class="tok-cm">   * (non-Javadoc)</span>
<span class="tok-cm">   *</span>
<span class="tok-cm">   * @see org.activiti.designer.integration.palette.DefaultPaletteCustomizer#disablePaletteEntries()</span>
<span class="tok-cm">   */</span>
  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;</span> <span class="tok-nf">disablePaletteEntries</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;</span> <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">ArrayList</span><span class="tok-o">&lt;</span><span class="tok-n">PaletteEntry</span><span class="tok-o">&gt;();</span>
    <span class="tok-n">result</span><span class="tok-o">.</span><span class="tok-na">add</span><span class="tok-o">(</span><span class="tok-n">PaletteEntry</span><span class="tok-o">.</span><span class="tok-na">ALL</span><span class="tok-o">);</span>
    <span class="tok-k">return</span> <span class="tok-n">result</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The result will look like this (notice that the drawers the default shapes were in are no longer in the palette):</p>
</div>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="images/designer.palette.disable.all.png" alt="designer.palette.disable.all">
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_validating_diagrams_and_exporting_to_custom_output_formats">12.5.2. Validating diagrams and exporting to custom output formats</h4>
<div class="paragraph">
<p>Besides customizing the palette, you can also create extensions to Flowable Designer that can perform validations and save information from the diagram to custom resources in the Eclipse workspace. There are built-in extension points for doing this and this section explains how to use them.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The ExportMarshaller functions were reintroduced recently. We are still working on the validation functionality. The documentation below details the old situation and will be updated when the new functionality is available.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Flowable Designer allows you to write extensions that validate diagrams. There are already validations of BPMN constructs in the tool by default, but you can add your own if you want to validate additional items such as modeling conventions or the values in properties of <code>CustomServiceTask</code>s. These extensions are known as <code>Process Validators</code>.</p>
</div>
<div class="paragraph">
<p>You can also Flowable Designer to publish to additional formats when saving diagrams. These extensions are called <code>Export Marshallers</code> and are invoked automatically by Flowable Designer on each save action by the user. This behavior can be enabled or disabled by setting a preference in Eclipse&#8217;s preferences dialog for each format for which there is an extension detected. Designer will make sure your <code>ExportMarshaller</code> is invoked when saving the diagram, depending on the user&#8217;s preference.</p>
</div>
<div class="paragraph">
<p>Often, you will want to combine a <code>ProcessValidator</code> and an <code>ExportMarshaller</code>. Let&#8217;s say you have a number of <code>CustomServiceTask</code>s in use that have properties you would like to use in the process that gets generated. However, before the process is generated, you want to validate some of those values first. Combining a <code>ProcessValidator</code> and <code>ExportMarshaller</code> is the best way to accomplish this and Flowable Designer enables you to plug your extensions into the tool seamlessly.</p>
</div>
<div class="paragraph">
<p>To create a <code>ProcessValidator</code> or an <code>ExportMarshaller</code>, you need to create a different kind of extension than for extending the palette. The reason for this is simple: from your code you will need access to more APIs than those that are offered by the integration library. In particular, you will need classes that are available in Eclipse itself. So to get started, you should create an Eclipse plugin (which you can do by using Eclipse&#8217;s PDE support) and package it in a custom Eclipse product or feature. It&#8217;s beyond the scope of this user guide to explain all the details involved in developing Eclipse plugins, so the instructions below are limited to the functionality for extending Flowable Designer.</p>
</div>
<div class="paragraph">
<p>Your bundle should be dependent on the following libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>org.eclipse.core.runtime</p>
</li>
<li>
<p>org.eclipse.core.resources</p>
</li>
<li>
<p>org.flowable.designer.eclipse</p>
</li>
<li>
<p>org.flowable.designer.libs</p>
</li>
<li>
<p>org.flowable.designer.util</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optionally, the org.apache.commons.lang bundle is available through Designer if you&#8217;d like to use that in your extension.</p>
</div>
<div class="paragraph">
<p>Both <code>ProcessValidator</code>s and <code>ExportMarshaller</code>s are created by extending a base class. These base classes inherit some useful methods from their superclass, the <code>AbstractDiagramWorker</code> class. Using these methods you can create information, warning and error markers that show up in Eclipse&#8217;s problems view for the user to figure out what&#8217;s wrong or important. You can get to information about the diagram in the form of <code>Resources</code> and <code>InputStreams</code>. This information is provided from the <code>DiagramWorkerContext</code>, which is available from the <code>AbstractDiagramWorker</code> class.</p>
</div>
<div class="paragraph">
<p>It&#8217;s probably a good idea to invoke <code>clearMarkers()</code> as one of the first things you do in either a <code>ProcessValidator</code> or an <code>ExportMarshaller</code>; this will clear any previous markers for your worker (markers are automatically linked to the worker and clearing markers for one worker leaves other markers untouched). For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-c1">// Clear markers for this diagram first</span>
<span class="tok-n">clearMarkersForDiagram</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>You should also use the progress monitor provided (in the <code>DiagramWorkerContext</code>) to report your progress back to the user because validations and/or marshalling actions can take up some time during which the user is forced to wait. Reporting progress requires some knowledge of how you should use Eclipse&#8217;s features. Take a look at <a href="http://www.eclipse.org/articles/Article-Progress-Monitors/article.html">this article</a> for a thorough explanation of the concepts and usage.</p>
</div>
<div class="sect4">
<h5 id="_creating_a_processvalidator_extension">Creating a ProcessValidator extension</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Under review!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create an extension to the <code>org.activiti.designer.eclipse.extension.validation.ProcessValidator</code> extension point in your <code>plugin.xml</code> file. For this extension point, you are required to subclass the <code>AbstractProcessValidator</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-cp">&lt;?eclipse version=&quot;3.6&quot;?&gt;</span>
<span class="tok-nt">&lt;plugin&gt;</span>
  <span class="tok-nt">&lt;extension</span>
    <span class="tok-na">point=</span><span class="tok-s">&quot;org.activiti.designer.eclipse.extension.validation.ProcessValidator&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;ProcessValidator</span>
      <span class="tok-na">class=</span><span class="tok-s">&quot;org.acme.validation.AcmeProcessValidator&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;/ProcessValidator&gt;</span>
  <span class="tok-nt">&lt;/extension&gt;</span>
<span class="tok-nt">&lt;/plugin&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AcmeProcessValidator</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractProcessValidator</span> <span class="tok-o">{</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>You have to implement a number of methods. Most importantly, implement <code>getValidatorId()</code> so you return a globally unique ID for your validator. This will enable you to invoke it from and <code>ExportMarshaller</code>, or event let someone <em>else</em> invoke your validator from their <code>ExportMarshaller</code>. Implement <code>getValidatorName()</code> and return a logical name for your validator. This name is shown to the user in dialogs. In <code>getFormatName()</code>, you can return the type of diagram the validator typically validates.</p>
</div>
<div class="paragraph">
<p>The validation work itself is done in the <code>validateDiagram()</code> method. From this point on, it&#8217;s up to your specific functionality what you code here. Typically, however, you will want to start by getting hold of the nodes in the diagram&#8217;s process, so you can iterate through them, collect, compare and validate data. This snippet shows you how to do this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-kd">final</span> <span class="tok-n">EList</span><span class="tok-o">&lt;</span><span class="tok-n">EObject</span><span class="tok-o">&gt;</span> <span class="tok-n">contents</span> <span class="tok-o">=</span> <span class="tok-n">getResourceForDiagram</span><span class="tok-o">(</span><span class="tok-n">diagram</span><span class="tok-o">).</span><span class="tok-na">getContents</span><span class="tok-o">();</span>
<span class="tok-k">for</span> <span class="tok-o">(</span><span class="tok-kd">final</span> <span class="tok-n">EObject</span> <span class="tok-n">object</span> <span class="tok-o">:</span> <span class="tok-n">contents</span><span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">object</span> <span class="tok-k">instanceof</span> <span class="tok-n">StartEvent</span> <span class="tok-o">)</span> <span class="tok-o">{</span>
  <span class="tok-c1">// Perform some validations for StartEvents</span>
  <span class="tok-o">}</span>
  <span class="tok-c1">// Other node types and validations</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to invoke <code>addProblemToDiagram()</code> and/or <code>addWarningToDiagram()</code>, etc as you go through your validations. Make sure you return a correct boolean result at the end to indicate whether you consider the validation as succeeded or failed. This can be used by and invoking <code>ExportMarshaller</code> to determine the next course of action.</p>
</div>
</div>
<div class="sect4">
<h5 id="_creating_an_exportmarshaller_extension">Creating an ExportMarshaller extension</h5>
<div class="paragraph">
<p>Create an extension to the <code>org.activiti.designer.eclipse.extension.ExportMarshaller</code> extension point in your <code>plugin.xml</code> file. For this extension point, you are required to subclass the <code>AbstractExportMarshaller</code> class. This abstract base class provides you with a number of useful methods when marshalling to your own format, but most importantly it allows you to save resources to the workspace and to invoke validators.</p>
</div>
<div class="paragraph">
<p>An example implementation is available in Designer&#8217;s examples folder. This example shows how to use the methods in the base class to get the basics done, such as accessing the diagram&#8217;s <code>InputStream</code>, using its <code>BpmnModel</code> and saving resources to the workspace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-cp">&lt;?eclipse version=&quot;3.6&quot;?&gt;</span>
<span class="tok-nt">&lt;plugin&gt;</span>
  <span class="tok-nt">&lt;extension</span>
    <span class="tok-na">point=</span><span class="tok-s">&quot;org.activiti.designer.eclipse.extension.ExportMarshaller&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;ExportMarshaller</span>
      <span class="tok-na">class=</span><span class="tok-s">&quot;org.acme.export.AcmeExportMarshaller&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;/ExportMarshaller&gt;</span>
  <span class="tok-nt">&lt;/extension&gt;</span>
  <span class="tok-nt">&lt;/plugin&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AcmeExportMarshaller</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractExportMarshaller</span> <span class="tok-o">{</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>You are required to implement some methods, such as <code>getMarshallerName()</code> and <code>getFormatName()</code>. These methods are used to display options to the user and to show information in progress dialogs, so make sure the descriptions you return reflect the functionality you are implementing.</p>
</div>
<div class="paragraph">
<p>The bulk of your work is performed in the <code>doMarshallDiagram()</code> method.</p>
</div>
<div class="paragraph">
<p>If you want to perform a certain validation first, you can invoke the validator directly from your marshaller. You receive a boolean result from the validator, so you know whether validation succeeded. In most cases you won&#8217;t want to proceed with marshalling the diagram if it&#8217;s not valid, but you might choose to go ahead anyway or even create a different resource if validation fails.</p>
</div>
<div class="paragraph">
<p>Once you have all the data you need, you should invoke the <code>saveResource()</code> method to create a file containing your data. You can invoke <code>saveResource()</code> as many times as you wish from a single ExportMarshaller; a marshaller can therefore be used to create more than one output file.</p>
</div>
<div class="paragraph">
<p>You can construct a filename for your output resource(s) by using the <code>saveResource()</code> method in the <code>AbstractDiagramWorker</code> class. There are a couple of useful variables you can have parsed, allowing you to create filenames such as _original-filename__my-format-name.xml. These variables are described in the Javadocs and defined by the <code>ExportMarshaller</code> interface. You can also use <code>resolvePlaceholders()</code> on a string (e.g. a path) if you want to parse the placeholders yourself. <code>getURIRelativeToDiagram()</code> will invoke this for you.</p>
</div>
<div class="paragraph">
<p>You should use the progress monitor provided to report your progress back to the user. How to do this is described in <a href="http://www.eclipse.org/articles/Article-Progress-Monitors/article.html">this article</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="restApiChapter">13. REST API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general_flowable_rest_principles">13.1. General Flowable REST principles</h3>
<div class="sect3">
<h4 id="_installation_and_authentication">13.1.1. Installation and Authentication</h4>
<div class="paragraph">
<p>Flowable includes a REST API to the Flowable Engine that can be installed by deploying the flowable-rest.war file to a servlet container like Apache Tomcat. However, it can also be used in another web-application by including the servlet and it&#8217;s mapping in your application and add all flowable-rest dependencies to the classpath.</p>
</div>
<div class="paragraph">
<p>By default the Flowable Engine will connect to an in-memory H2 database. You can change the database settings in the db.properties file in the WEB-INF/classes folder. The REST API uses JSON format (<a href="http://www.json.org" class="bare">http://www.json.org</a>) and is built upon the Spring MVC (<a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html" class="bare">http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html</a>).</p>
</div>
<div class="paragraph">
<p>All REST-resources require a valid Flowable-user to be authenticated by default. Basic HTTP access authentication is used, so you should always include a <em>Authorization: Basic &#8230;&#8203;==</em> HTTP-header when performing requests or include the username and password in the request-url (e.g. <em><a href="http://username:password@localhost:8080/xyz" class="bare">http://username:password@localhost:8080/xyz</a></em>).</p>
</div>
<div class="paragraph">
<p><strong>It&#8217;s recommended to use Basic Authentication in combination with HTTPS.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_2">13.1.2. Configuration</h4>
<div class="paragraph">
<p>The Flowable REST web application is using Spring Java Configuration for starting the Flowable Engine, defining the basic authentication security using Spring security and to define the variable converters for specific variable handling.
A small amount of properties can be defined by changing the engine.properties file you can find in the WEB-INF/classes folder.
If you need more advanced configuration options there&#8217;s the possibility to override the default Spring beans in XML in the activiti-custom-context.xml file you can also find in the WEB-INF/classes folder.
An example configuration is already in comments in this file. This is also the place to override the default RestResponseFactory by defining a new Spring bean with the name restResponsefactory and use your custom implementation class for it.</p>
</div>
</div>
<div class="sect3">
<h4 id="restUsageInTomcat">13.1.3. Usage in Tomcat</h4>
<div class="paragraph">
<p>Due to <a href="http://tomcat.apache.org/tomcat-7.0-doc/security-howto.html"> default security properties on Tomcat</a>, <strong>escaped forward slashes (<code>%2F</code> and <code>%5C</code>) are not allowed by default (400-result is returned).</strong> This may have an impact on the deployment resources and their data-URL, as the URL can potentially contain escaped forward slashes.</p>
</div>
<div class="paragraph">
<p>When issues are experienced with unexpected 400-results, set the following system-property:</p>
</div>
<div class="paragraph">
<p><em>-Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=true</em></p>
</div>
<div class="paragraph">
<p>It&#8217;s a best practice to always set the <strong>Accept</strong> and <strong>Content-Type</strong> (in case of posting/putting JSON) headers to <strong>application/json</strong> on the HTTP requests described below.</p>
</div>
</div>
<div class="sect3">
<h4 id="_methods_and_return_codes">13.1.4. Methods and return-codes</h4>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. HTTP-methods and corresponding operations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Operations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get a single resource or get a collection of resources.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create a new resource. Also used for executing resource-queries which have a too complex request-structure to fit in the query-URL of a GET-request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update properties of an existing resource. Also used for invoking actions on an existing resource.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete an existing resource.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. HTTP-methods response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>200 - Ok</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation was successful and a response has been returned (<code>GET</code> and <code>PUT</code> requests).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>201 - Created</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation was successful and the entity has been created and is returned in the response-body (<code>POST</code> request).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>204 - No content</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation was successful and entity has been deleted and therefore there is no response-body returned (<code>DELETE</code> request).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>401 - Unauthorized</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed. The operation requires an Authentication header to be set. If this was present in the request, the supplied credentials are not valid or the user is not authorized to perform this operation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>403 - Forbidden</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation is forbidden and should not be re-attempted. This does not imply an issue with authentication not authorization, it&#8217;s an operation that is not allowed. Example: deleting a task that is part of a running process is not allowed and will never be allowed, regardless of the user or process/task state.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>404 - Not found</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed.The requested resource was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>405 - Method not allowed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed. The used method is not allowed for this resource. E.g. trying to update (PUT) a deployment-resource will result in a <code>405</code> status.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>409 - Conflict</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed. The operation causes an update of a resource that has been updated by another operation, which makes the update no longer valid. Can also indicate a resource that is being created in a collection where a resource with that identifier already exists.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>415 - Unsupported Media Type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed. The request body contains an unsupported media type. Also occurs when the request-body JSON contains an unknown attribute or value that doesn&#8217;t have the right format/type to be accepted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>500 - Internal server error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operation failed. An unexpected exception occurred while executing the operation. The response-body contains details about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The media-type of the HTTP-responses is always <code>application/json</code> unless binary content is requested (e.g. deployment resource data), the media-type of the content is used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_error_response_body">13.1.5. Error response body</h4>
<div class="paragraph">
<p>When an error occurs (both client and server, 4XX and 5XX status-codes) the response body contains an object describing the error that occurred. An example for a 404-status when a task is not found:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;statusCode&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">404</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;errorMessage&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Could not find a task with id &#39;444&#39;.&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_request_parameters">13.1.6. Request parameters</h4>
<div class="sect4">
<h5 id="_url_fragments">URL fragments</h5>
<div class="paragraph">
<p>Parameters that are part of the url (e.g. the deploymentId parameter in <code><a href="http://host/actviti-rest/service/repository/deployments/{deploymentId}" class="bare">http://host/actviti-rest/service/repository/deployments/{deploymentId}</a></code>)
 need to be properly escaped (see <a href="https://en.wikipedia.org/wiki/Percent-encoding">URL-encoding or Percent-encoding</a>) in case the segment contains special characters. Most frameworks have this functionality built in, but it should be taken into account. Especially for segments that can contains forward-slashes (e.g. deployment resource), this is required.</p>
</div>
</div>
<div class="sect4">
<h5 id="_rest_url_query_parameters">Rest URL query parameters</h5>
<div class="paragraph">
<p>Parameters added as query-string in the URL (e.g. the name parameter used in <code><a href="http://host/flowable-rest/service/deployments?name=Deployment" class="bare">http://host/flowable-rest/service/deployments?name=Deployment</a></code>) can have the following types and are mentioned in the corresponding REST-API documentation:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. URL query parameter types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plain text parameters. Can contain any valid characters that are allowed in URL&#8217;s. In case of a <code>XXXLike</code> parameter, the string should contain the wildcard character <code>%</code> (properly url-encoded). This allows to specify the intent of the like-search. E.g. <em><code>Tas%</code></em> matches all values, starting with <em>Tas</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing an integer value. Can only contain numeric non-decimal values, between -2.147.483.648 and 2.147.483.647.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing a long value. Can only contain numeric non-decimal values, between -9.223.372.036.854.775.808 and 9.223.372.036.854.775.807.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing a boolean value. Can be either <code>true</code> or <code>false</code>. All other values other than these two, will cause a <em><code>405 - Bad request</code></em> response.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing a date value. Use the ISO-8601 date-format (see <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO-8601 on wikipedia</a>) using both time and date-components (e.g. <code>2013-04-03T23:45Z</code>).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="restJsonBody">JSON body parameters</h5>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. JSON parameter types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Format</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plain text parameters. In case of a <code>XXXLike</code> parameter, the string should contain the wildcard character <code>%</code>. This allows to specify the intent of the like-search. E.g. <em><code>Tas%</code></em> matches all values, starting with <em>Tas</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing an integer value, using a JSON number. Can only contain numeric non-decimal values, between -2.147.483.648 and 2.147.483.647.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing a long value, using a JSON number. Can only contain numeric non-decimal values, between -9.223.372.036.854.775.808 and 9.223.372.036.854.775.807.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter representing a date value, using a JSON text. Use the ISO-8601 date-format (see <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO-8601 on wikipedia</a>) using both time and date-components (e.g. <code>2013-04-03T23:45Z</code>).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="restPagingAndSort">Paging and sorting</h5>
<div class="paragraph">
<p>Paging and order parameters can be added as query-string in the URL (e.g. the name parameter used in <code><a href="http://host/flowable-rest/service/deployments?sort=name" class="bare">http://host/flowable-rest/service/deployments?sort=name</a></code>).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Variable query JSON parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">different per query implementation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the sort key, for which the default value and the allowed values are different per query implementation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sorting order which can be <em>asc</em> or <em>desc</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter to allow for paging of the result. By default the result will start at 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter to allow for paging of the result. By default the size will be 10.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="restQueryVariable">JSON query variable format</h5>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableName&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableValue&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Variable query JSON parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable to include in a query. Can be empty in case <em><code>equals</code></em> is used in some queries to query for resources that have <strong>any variable name</strong> with the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of the variable included in the query, should include a correct format for the given type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">operator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator to use in query, can have the following values: <code>equals, notEquals, equalsIgnoreCase, notEqualsIgnoreCase, lessThan, greaterThan, lessThanOrEquals, greaterThanOrEquals</code> and <code>like</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of variable to use. When omitted, the type will be deducted from the <code>value</code> parameter. Any JSON text-values will be considered of type <code>string</code>, JSON booleans of type <code>boolean</code>, JSON numbers of type <code>long</code> or <code>integer</code> depending on the size of the number. It&#8217;s recommended to include an explicit type when in doubt. Types supported out of the box are listed below.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Default query JSON types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.String</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.Integer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.Integer</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.Long</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.Double</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as and converted to a <code>java.lang.Boolean</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is treated as and converted to a <code>java.util.Date</code>. The JSON string will be converted using ISO-8601 date format.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="restVariables">Variable representation</h5>
<div class="paragraph">
<p>When working with variables (execution/process and task), the REST-api uses some common principles and JSON-format for both reading and writing. The JSON representation of a variable looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableName&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableValue&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://...&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Variable JSON attributes</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of the variable. When writing a variable and <code>value</code> is omitted, <code>null</code> will be used as value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">valueUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When reading a variable of type <code>binary</code> or <code>serializable</code>, this attribute will point to the URL where the raw binary data can be fetched from.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope of the variable. If <em><code>local</code></em>, the variable is explicitly defined on the resource it&#8217;s requested from. When <em><code>global</code></em>, the variable is defined on the parent (or any parent in the parent-tree) of the resource it&#8217;s requested from. When writing a variable and the scope is omitted, <code>global</code> is assumed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of the variable. See table below for additional information on types. When writing a variable and this value is omitted, the type will be deducted from the raw JSON-attribute request type and is limited to either <code>string</code>, <code>double</code>, <code>integer</code> and <code>boolean</code>. It&#8217;s advised to always include a type to make sure no wrong assumption about the type can be done.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Variable Types</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.String</code>. Raw JSON-text value is used when writing a variable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.Integer</code>. When writing, JSON number value is used as base for conversion, falls back to JSON text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.Short</code>. When writing, JSON number value is used as base for conversion, falls back to JSON text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.Long</code>. When writing, JSON number value is used as base for conversion, falls back to JSON text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.Double</code>. When writing, JSON number value is used as base for conversion, falls back to JSON text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is threaded as a <code>java.lang.Boolean</code>. When writing, JSON boolean value is used for conversion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value is treated as a <code>java.util.Date</code>. When writing, the JSON text will be converted using ISO-8601 date format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary variable, treated as an array of bytes. The <code>value</code> attribute is null, the <code>valueUrl</code> contains an URL pointing to the raw binary stream.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">serializable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serialized representation of a Serializable Java-object. As with the <code>binary</code> type, the <code>value</code> attribute is null, the <code>valueUrl</code> contains an URL pointing to the raw binary stream. All serializable variables (which are not of any of the above types) will be exposed as a variable of this type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It&#8217;s possible to support additional variable-types with a custom JSON representation (either simple value or complex/nested JSON object). By extending the <code>initializeVariableConverters()</code> method on <code>org.activiti.rest.service.api.RestResponseFactory</code>, you can add additional <code>org.activiti.rest.service.api.engine.variable.RestVariableConverter</code> classes to support converting your POJO&#8217;s to a format suitable for transferring through REST and converting the REST-value back to your POJO. The actual transformation to JSON is done by Jackson.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deployment">13.2. Deployment</h3>
<div class="paragraph">
<p><strong>When using Tomcat, please read <a href="#restUsageInTomcat">Usage in Tomcat</a>.</strong></p>
</div>
<div class="sect3">
<h4 id="_list_of_deployments">13.2.1. List of Deployments</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/deployments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments with a name like the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments with the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">categoryNotEquals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments which don&#8217;t have the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return deployments with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns deployments without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>id</em> (default), <em>name</em>, <em>deploytime</em> or <em>tenantId</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to sort on, to be used together with the <em>order</em>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. REST Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request was successful.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;10&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;flowable-examples.bar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deploymentTime&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2010-10-13T14:54:26.750+02:00&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;examples&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/service/repository/deployments/10&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_deployment">13.2.2. Get a deployment</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/deployments/{deploymentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 13. Get a deployment - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the deployment to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 14. Get a deployment - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the deployment was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested deployment was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;10&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;flowable-examples.bar&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;deploymentTime&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2010-10-13T14:54:26.750+02:00&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;examples&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/service/repository/deployments/10&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_deployment">13.2.3. Create a new deployment</h4>
<div class="listingblock">
<div class="content">
<pre>POST repository/deployments</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request body should contain data of type <em>multipart/form-data</em>. There should be exactly one file in the request, any additional files will be ignored. The deployment name is the name of the file-field passed in. If multiple resources need to be deployed in a single deployment, compress the resources in a zip and make sure the file-name ends with <code>.bar</code> or <code>.zip</code>.</p>
</div>
<div class="paragraph">
<p>An additional parameter (form-field) can be passed in the request body with name <code>tenantId</code>. The value of this field will be used as the id of the tenant this deployment is done in.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 15. Create a new deployment - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the deployment was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates there was no content present in the request body or the content mime-type is not supported for deployment. The status-description contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;10&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;flowable-examples.bar&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;deploymentTime&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;2010-10-13T14:54:26.750+02:00&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/service/repository/deployments/10&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTenant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_deployment">13.2.4. Delete a deployment</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE repository/deployments/{deploymentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 16. Delete a deployment - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the deployment to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 17. Delete a deployment - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the deployment was found and has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested deployment was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_list_resources_in_a_deployment">13.2.5. List resources in a deployment</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/deployments/{deploymentId}/resources</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 18. List resources in a deployment - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the deployment to get the resources for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 19. List resources in a deployment - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the deployment was found and the resource list has been returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested deployment was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;diagrams/my-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resources/diagrams%2Fmy-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;dataUrl&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resourcedata/diagrams%2Fmy-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;mediaType&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;text/xml&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;processDefinition&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;image.png&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resources/image.png&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;dataUrl&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resourcedata/image.png&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;mediaType&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;image/png&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;resource&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mediaType</code>: Contains the media-type the resource has. This is resolved using a (pluggable) <code>MediaTypeResolver</code> and contains, by default, a limited number of mime-type mappings.</p>
</li>
<li>
<p><code>type</code>: Type of resource, possible values:</p>
</li>
<li>
<p><code>resource</code>: Plain old resource.</p>
</li>
<li>
<p><code>processDefinition</code>: Resource that contains one or more process-definitions. This resource is picked up by the deployer.</p>
</li>
<li>
<p><code>processImage</code>: Resource that represents a deployed process definition&#8217;s graphical layout.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>The dataUrl property in the resulting JSON for a single resource contains the actual URL to use for retrieving the binary resource.</em></p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_deployment_resource">13.2.6. Get a deployment resource</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/deployments/{deploymentId}/resources/{resourceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 20. Get a deployment resource - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the deployment the requested resource is part of.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resourceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the resource to get. <strong>Make sure you URL-encode the resourceId in case it contains forward slashes. Eg: use <em>diagrams%2Fmy-process.bpmn20.xml</em> instead of <em>diagrams/Fmy-process.bpmn20.xml</em>.</strong></p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 21. Get a deployment resource - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both deployment and resource have been found and the resource has been returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested deployment was not found or there is no resource with the given id present in the deployment. The status-description contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;diagrams/my-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resources/diagrams%2Fmy-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;dataUrl&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/repository/deployments/10/resourcedata/diagrams%2Fmy-process.bpmn20.xml&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;mediaType&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;text/xml&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;processDefinition&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mediaType</code>: Contains the media-type the resource has. This is resolved using a (pluggable) <code>MediaTypeResolver</code> and contains, by default, a limited number of mime-type mappings.</p>
</li>
<li>
<p><code>type</code>: Type of resource, possible values:</p>
</li>
<li>
<p><code>resource</code>: Plain old resource.</p>
</li>
<li>
<p><code>processDefinition</code>: Resource that contains one or more process-definitions. This resource is picked up by the deployer.</p>
</li>
<li>
<p><code>processImage</code>: Resource that represents a deployed process definition&#8217;s graphical layout.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_deployment_resource_content">13.2.7. Get a deployment resource content</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/deployments/{deploymentId}/resourcedata/{resourceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 22. Get a deployment resource content - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the deployment the requested resource is part of.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resourceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the resource to get the data for. <strong>Make sure you URL-encode the resourceId in case it contains forward slashes. Eg: use <em>diagrams%2Fmy-process.bpmn20.xml</em> instead of <em>diagrams/Fmy-process.bpmn20.xml</em>.</strong></p></td>
</tr>
</tbody>
</table>
<div class="literalblock">
<div class="content">
<pre>.Get a deployment resource content - Response codes</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both deployment and resource have been found and the resource data has been returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested deployment was not found or there is no resource with the given id present in the deployment. The status-description contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body will contain the binary resource-content for the requested resource. The response content-type will be the same as the type returned in the resources <em>mimeType</em> property. Also, a content-disposition header is set, allowing browsers to download the file instead of displaying it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_definitions">13.3. Process Definitions</h3>
<div class="sect3">
<h4 id="_list_of_process_definitions">13.3.1. List of process definitions</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 23. List of process definitions - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with the given version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with a name like the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with the given key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with a name like the given key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resourceName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with the given resource name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">resourceNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with a name like the given resource name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">categoryLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions with a category like the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">categoryNotEquals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions which don&#8217;t have the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions which are part of a deployment with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startableByUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process definitions which can be started by the given user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return the latest process definition versions. Can only be used together with <em>key</em> and <em>keyLike</em> parameters, using any other parameter will result in a 400-response.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspended</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns process definitions which are suspended. If <code>false</code>, only active process definitions (which are not suspended) are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>name</em> (default), <em>id</em>, <em>key</em>, <em>category</em>, <em>deploymentId</em> and <em>version</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to sort on, to be used together with the <em>order</em>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 24. List of process definitions - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the process-definitions are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format or that <em>latest</em> is used with other parameters other than <em>key</em> and <em>keyLike</em>. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess:1:4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;version&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;key&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;category&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Examples&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;suspended&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;The One Task Process&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a process for testing purposes&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deploymentId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deploymentUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/repository/deployments/2&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;graphicalNotationDefined&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;resource&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2/resources/testProcess.xml&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;diagramResource&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2/resources/testProcess.png&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startFormDefined&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>graphicalNotationDefined</code>: Indicates the process definition contains graphical information (BPMN DI).</p>
</li>
<li>
<p><code>resource</code>: Contains the actual deployed BPMN 2.0 xml.</p>
</li>
<li>
<p><code>diagramResource</code>: Contains a graphical representation of the process, null when no diagram is available.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_process_definition">13.3.2. Get a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions/{processDefinitionId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 25. Get a process definition - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 26. Get a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess:1:4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;version&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;key&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;category&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Examples&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;suspended&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;The One Task Process&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a process for testing purposes&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;deploymentId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;deploymentUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/repository/deployments/2&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;graphicalNotationDefined&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;resource&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2/resources/testProcess.xml&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;diagramResource&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2/resources/testProcess.png&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;startFormDefined&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>graphicalNotationDefined</code>: Indicates the process definition contains graphical information (BPMN DI).</p>
</li>
<li>
<p><code>resource</code>: Contains the actual deployed BPMN 2.0 xml.</p>
</li>
<li>
<p><code>diagramResource</code>: Contains a graphical representation of the process, null when no diagram is available.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_update_category_for_a_process_definition">13.3.3. Update category for a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/process-definitions/{processDefinitionId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;category&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;updatedcategory&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 27. Update category for a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process was category was altered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates no category was defined in the request body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>repository/process-definitions/{processDefinitionId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_process_definition_resource_content">13.3.4. Get a process definition resource content</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions/{processDefinitionId}/resourcedata</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 28. Get a process definition resource content - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition to get the resource data for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response:</strong></p>
</div>
<div class="paragraph">
<p>Exactly the same response codes/boy as <code>GET repository/deployment/{deploymentId}/resourcedata/{resourceId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_process_definition_bpmn_model">13.3.5. Get a process definition BPMN model</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions/{processDefinitionId}/model</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 29. Get a process definition BPMN model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition to get the model for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 30. Get a process definition BPMN model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and the model is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response body:</strong>
The response body is a JSON representation of the <code>org.activiti.bpmn.model.BpmnModel</code> and contains the full process definition model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;processes&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;xmlRowNumber&quot;</span><span class="tok-p">:</span><span class="tok-mi">7</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;xmlColumnNumber&quot;</span><span class="tok-p">:</span><span class="tok-mi">60</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;extensionElements&quot;</span><span class="tok-p">:{</span>

         <span class="tok-p">},</span>
         <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;The One Task Process&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;executable&quot;</span><span class="tok-p">:</span><span class="tok-kc">true</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;documentation&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;One task process description&quot;</span><span class="tok-p">,</span>

    <span class="tok-err">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_suspend_a_process_definition">13.3.6. Suspend a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/process-definitions/{processDefinitionId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;suspend&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;includeProcessInstances&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;false&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;date&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-15T00:42:12Z&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table id="processDefinitionActionBodyParameters" class="tableblock frame-all grid-all spread">
<caption class="title">Table 31. Suspend a process definition - JSON Body parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action to perform. Either <code>activate</code> or <code>suspend</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeProcessInstances</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to suspend/activate running process-instances for this process-definition. If omitted, the process-instances are left in the state they are.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date (ISO-8601) when the suspension/activation should be executed. If omitted, the suspend/activation is effective immediately.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 32. Suspend a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process was suspended.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition is already suspended.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>repository/process-definitions/{processDefinitionId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_activate_a_process_definition">13.3.7. Activate a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/process-definitions/{processDefinitionId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;activate&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;includeProcessInstances&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;true&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;date&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-15T00:42:12Z&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>See suspend process definition <a href="#processDefinitionActionBodyParameters">JSON Body parameters</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 33. Activate a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process was activated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition is already active.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>repository/process-definitions/{processDefinitionId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_all_candidate_starters_for_a_process_definition">13.3.8. Get all candidate starters for a process-definition</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions/{processDefinitionId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 34. Get all candidate starters for a process-definition - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition to get the identity links for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 35. Get all candidate starters for a process-definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and the requested identity links are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4/identitylinks/groups/admin&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;admin&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4/identitylinks/users/kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
   <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_a_candidate_starter_to_a_process_definition">13.3.9. Add a candidate starter to a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>POST repository/process-definitions/{processDefinitionId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 36. Add a candidate starter to a process definition - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body (user):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;user&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (group):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;sales&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 37. Add a candidate starter to a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and the identity link was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4/identitylinks/users/kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_candidate_starter_from_a_process_definition">13.3.10. Delete a candidate starter from a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE repository/process-definitions/{processDefinitionId}/identitylinks/{family}/{identityId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 38. Delete a candidate starter from a process definition - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">family</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>users</code> or <code>groups</code>, depending on the type of identity link.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either the userId or groupId of the identity to remove as candidate starter.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 39. Delete a candidate starter from a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and the identity link was removed. The response body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found or the process definition doesn&#8217;t have an identity-link that matches the url.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4/identitylinks/users/kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_candidate_starter_from_a_process_definition">13.3.11. Get a candidate starter from a process definition</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/process-definitions/{processDefinitionId}/identitylinks/{family}/{identityId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 40. Get a candidate starter from a process definition - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process definition.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">family</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>users</code> or <code>groups</code>, depending on the type of identity link.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either the userId or groupId of the identity to get as candidate starter.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 41. Get a candidate starter from a process definition - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process definition was found and the identity link was returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process definition was not found or the process definition doesn&#8217;t have an identity-link that matches the url.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4/identitylinks/users/kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_models">13.4. Models</h3>
<div class="sect3">
<h4 id="_get_a_list_of_models">13.4.1. Get a list of models</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/models</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 42. Get a list of models - URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">categoryLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with a category like the given value. Use the <code>%</code> character as wildcard.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">categoryNotEquals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models without the given category.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with a name like the given value. Use the <code>%</code> character as wildcard.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deploymentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models which are deployed in the given deployment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given version.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">latestVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return models which are the latest version. Best used in combination with <code>key</code>. If <code>false</code> is passed in as value, this is ignored and all versions are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only deployed models are returned. If <code>false</code>, only undeployed models are returned (deploymentId is null).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return models with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns models without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>id</em> (default), <em>category</em>, <em>createTime</em>, <em>key</em>, <em>lastUpdateTime</em>, <em>name</em>, <em>version</em> or <em>tenantId</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property to sort on, to be used together with the <em>order</em>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 43. Get a list of models - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the models are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;10&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/models/10&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;createTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T14:31:08.612+0000&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;lastUpdateTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T14:31:08.612+0000&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;deploymentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/deployments/7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">},</span>

      <span class="tok-err">...</span>

   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_model">13.4.2. Get a model</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/models/{modelId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 44. Get a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 45. Get a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/models/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;createTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;lastUpdateTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_a_model">13.4.3. Update a model</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/models/{modelId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;updatedTenant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All request values are optional. For example, you can only include the <em>name</em> attribute in the request body JSON-object, only updating the name of the model, leaving all other fields unaffected. When an attribute is explicitly included and is set to null, the model-value will be updated to null. Example: <code>{"metaInfo" : null}</code> will clear the metaInfo of the model).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 46. Update a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/models/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;createTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;lastUpdateTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;&quot;</span><span class="tok-err">updatedTenant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_model">13.4.4. Create a model</h4>
<div class="listingblock">
<div class="content">
<pre>POST repository/models</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">1</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;tenant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All request values are optional. For example, you can only include the <em>name</em> attribute in the request body JSON-object, only setting the name of the model, leaving all other fields null.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 47. Create a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/models/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model name&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model key&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;category&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model category&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-mi">1</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;metaInfo&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Model metainfo&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;deploymentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/deployments/2&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;createTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;lastUpdateTime&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-12T12:31:19.861+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;tenant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_model">13.4.5. Delete a model</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE repository/models/{modelId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 48. Delete a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 49. Delete a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_the_editor_source_for_a_model">13.4.6. Get the editor source for a model</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/models/{modelId}/source</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 50. Get the editor source for a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 51. Get the editor source for a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and source is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>Response body contains the model&#8217;s raw editor source. The response&#8217;s content-type is set to <code>application/octet-stream</code>, regardless of the content of the source.</p>
</div>
</div>
<div class="sect3">
<h4 id="_set_the_editor_source_for_a_model">13.4.7. Set the editor source for a model</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/models/{modelId}/source</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 52. Set the editor source for a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the source.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 53. Set the editor source for a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and the source has been updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>Response body contains the model&#8217;s raw editor source. The response&#8217;s content-type is set to <code>application/octet-stream</code>, regardless of the content of the source.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_extra_editor_source_for_a_model">13.4.8. Get the extra editor source for a model</h4>
<div class="listingblock">
<div class="content">
<pre>GET repository/models/{modelId}/source-extra</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 54. Get the extra editor source for a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 55. Get the extra editor source for a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and source is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>Response body contains the model&#8217;s raw extra editor source. The response&#8217;s content-type is set to <code>application/octet-stream</code>, regardless of the content of the extra source.</p>
</div>
</div>
<div class="sect3">
<h4 id="_set_the_extra_editor_source_for_a_model">13.4.9. Set the extra editor source for a model</h4>
<div class="listingblock">
<div class="content">
<pre>PUT repository/models/{modelId}/source-extra</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 56. Set the extra editor source for a model - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modelId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the model.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the extra source.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 57. Set the extra editor source for a model - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the model was found and the extra source has been updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested model was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>Response body contains the model&#8217;s raw editor source. The response&#8217;s content-type is set to <code>application/octet-stream</code>, regardless of the content of the source.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_instances">13.5. Process Instances</h3>
<div class="sect3">
<h4 id="_get_a_process_instance">13.5.1. Get a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances/{processInstanceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 58. Get a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 59. Get a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/processOne%3A1%3A4&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_process_instance">13.5.2. Delete a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/process-instances/{processInstanceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 60. Delete a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 61. Delete a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_activate_or_suspend_a_process_instance">13.5.3. Activate or suspend a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/process-instances/{processInstanceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 62. Activate or suspend a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to activate/suspend.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request response body (suspend):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;suspend&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request response body (activate):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;activate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 63. Activate or suspend a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and action was executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an invalid action was supplied.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance action cannot be executed since the process-instance is already activated/suspended.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_start_a_process_instance_2">13.5.4. Start a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/process-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (start by process definition id):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;processDefinitionId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;oneTaskProcess:1:158&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myVar&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;This is a variable&quot;</span><span class="tok-p">,</span>
      <span class="tok-p">}</span>
   <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (start by process definition key):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;processDefinitionKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;tenant1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myVar&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;This is a variable&quot;</span><span class="tok-p">,</span>
      <span class="tok-p">}</span>
   <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (start by message):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;message&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;newOrderMessage&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;tenant1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myVar&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;This is a variable&quot;</span><span class="tok-p">,</span>
      <span class="tok-p">}</span>
   <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that also a <em>transientVariables</em> property is accepted as part of this json, that follows the same structure as the <em>variables</em> property.</p>
</div>
<div class="paragraph">
<p>Only one of <code>processDefinitionId</code>, <code>processDefinitionKey</code> or <code>message</code> can be used in the request body. Parameters <code>businessKey</code>, <code>variables</code> and <code>tenantId</code> are optional. If <code>tenantId</code> is omitted, the default tenant will be used. More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>. Note that the variable-scope that is supplied is ignored, process-variables are always <code>local</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 64. Start a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates either the process-definition was not found (based on id or key), no process is started by sending the given message or an invalid variable has been passed. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/processOne%3A1%3A4&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restProcessInstancesGet">13.5.5. List of process instances</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 65. List of process instances - URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instance with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances with the given process definition key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances with the given process definition id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">businessKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances with the given businessKey.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">involvedUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances in which the given user is involved.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspended</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return process instance which are suspended. If <code>false</code>, only return process instances which are not suspended (active).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">superProcessInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances which have the given super process-instance id (for processes that have a call-activities).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subProcessInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances which have the given sub process-instance id (for processes started as a call-activity).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeSubprocesses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only process instances which aren&#8217;t sub processes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeProcessVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to include process variables in the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return process instances with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns process instances without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort field, should be either one of <code>id</code> (default), <code>processDefinitionId</code>, <code>tenantId</code> or <code>processDefinitionKey</code>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 66. List of process instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the process-instances are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format . The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/processOne%3A1%3A4&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
      <span class="tok-p">}</span>


   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_process_instances">13.5.6. Query process instances</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/process-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span>
  <span class="tok-p">[</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The request body can contain all possible filters that can be used in the <a href="#restProcessInstancesGet">List process instances</a> URL query. On top of these, it&#8217;s possible to provide an array of variables
to include in the query, with their format <a href="#restQueryVariable">described here</a>.</p>
</div>
<div class="paragraph">
<p>The general <a href="#restPagingAndSort">paging and sorting query-parameters</a> can be used for this URL.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 67. Query process instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the process-instances are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format . The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/processOne%3A1%3A4&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
      <span class="tok-p">}</span>


   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_diagram_for_a_process_instance">13.5.7. Get diagram for a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances/{processInstanceId}/diagram</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 68. Get diagram for a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to get the diagram for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 69. Get diagram for a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and the diagram was returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found but the process doesn&#8217;t contain any graphical information (BPMN:DI) and no diagram can be created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;businessKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myBusinessKey&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/processOne%3A1%3A4&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_involved_people_for_process_instance">13.5.8. Get involved people for process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances/{processInstanceId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 70. Get involved people for process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the links for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 71. Get involved people for process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and links are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/identitylinks/users/john/customType&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;john&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;customType&quot;</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/identitylinks/users/paul/candidate&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;paul&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;candidate&quot;</span>
   <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>groupId</code> will always be null, as it&#8217;s only possible to involve users with a process-instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_an_involved_user_to_a_process_instance">13.5.9. Add an involved user to a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/process-instances/{processInstanceId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 72. Add an involved user to a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the links for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;userId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;participant&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>userId</code> and <code>type</code> are required.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 73. Add an involved user to a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and the link is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested body did not contain a userId or a type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/identitylinks/users/john/customType&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;john&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;customType&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>groupId</code> will always be null, as it&#8217;s only possible to involve users with a process-instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_remove_an_involved_user_to_from_process_instance">13.5.10. Remove an involved user to from process instance</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/process-instances/{processInstanceId}/identitylinks/users/{userId}/{type}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 74. Remove an involved user to from process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to delete link for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of link to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 75. Remove an involved user to from process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and the link has been deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the link to delete doesn&#8217;t exist. The response status contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/identitylinks/users/john/customType&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;user&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;john&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;group&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;customType&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>groupId</code> will always be null, as it&#8217;s only possible to involve users with a process-instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_list_of_variables_for_a_process_instance">13.5.11. List of variables for a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances/{processInstanceId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 76. List of variables for a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the variables for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 77. List of variables for a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and variables are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;byteArrayProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;valueUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/variables/byteArrayProcVar/data&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response.
Note that only <code>local</code> scoped variables are returned, as there is no <code>global</code> scope for process-instance variables.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_variable_for_a_process_instance">13.5.12. Get a variable for a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/process-instances/{processInstanceId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 78. Get a variable for a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 79. Get a variable for a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both the process instance and variable were found and variable is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request body is incomplete or contains illegal values. The status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the process instance does not have a variable with the given name. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span>   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response.  Note that only <code>local</code> scoped variables are returned, as there is no <code>global</code> scope for process-instance variables.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_or_update_variables_on_a_process_instance">13.5.13. Create (or update) variables on a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/process-instances/{processInstanceId}/variables</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/process-instances/{processInstanceId}/variables</pre>
</div>
</div>
<div class="paragraph">
<p>When using <code>POST</code>, all variables that are passed are created. In case one of the variables already exists on the process instance, the request results in an error (409 - CONFLICT). When <code>PUT</code> is used, nonexistent variables are created on the process-instance and existing ones are overridden without any error.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 80. Create (or update) variables on a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the variables for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
   {
      "name":"intProcVar"
      "type":"integer"
      "value":123
   },

   ...
]</pre>
</div>
</div>
<div class="paragraph">
<p>Any number of variables can be passed into the request body array. More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>. Note that scope is ignored, only <code>local</code> variables can be set in a process instance.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 81. Create (or update) variables on a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and variable is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request body is incomplete or contains illegal values. The status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found but already contains a variable with the given name (only thrown when POST method is used). Use the update-method instead.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>[
   {
      "name":"intProcVar",
      "type":"integer",
      "value":123,
      "scope":"local"
   },

   ...

]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_a_single_variable_on_a_process_instance">13.5.14. Update a single variable on a process instance</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/process-instances/{processInstanceId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 82. Update a single variable on a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to the variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span>
    <span class="tok-s2">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span>
    <span class="tok-s2">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span>
 <span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>. Note that scope is ignored, only <code>local</code> variables can be set in a process instance.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 83. Update a single variable on a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both the process instance and variable were found and variable is updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the process instance does not have a variable with the given name. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response. Note that only <code>local</code> scoped variables are returned, as there is no <code>global</code> scope for process-instance variables.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_binary_variable_on_a_process_instance">13.5.15. Create a new binary variable on a process-instance</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/process-instances/{processInstanceId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 84. Create a new binary variable on a process-instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to create the new variable for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/process-instances/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 85. Create a new binary variable on a process-instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to create was missing. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance already has a variable with the given name. Use the PUT method to update the task variable instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_an_existing_binary_variable_on_a_process_instance">13.5.16. Update an existing binary variable on a process-instance</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/process-instances/{processInstanceId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 86. Update an existing binary variable on a process-instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to create the new variable for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong>
The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/process-instances/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 87. Update an existing binary variable on a process-instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was updated and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to update was missing. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the process instance does not have a variable with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_executions">13.6. Executions</h3>
<div class="sect3">
<h4 id="_get_an_execution">13.6.1. Get an execution</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/executions/{executionId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 88. Get an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 89. Get an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_execute_an_action_on_an_execution">13.6.2. Execute an action on an execution</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/executions/{executionId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 90. Execute an action on an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to execute action on.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body (signal an execution):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;signal&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Both a <em>variables</em> and <em>transientVariables</em> property is accepted with following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;signal&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;someValue&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (signal event received for execution):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;signalEventReceived&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;signalName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;mySignal&quot;</span>
  <span class="tok-s2">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notifies the execution that a signal event has been received, requires a <code>signalName</code> parameter. Optional <code>variables</code> can be passed that are set on the execution before the action is executed.</p>
</div>
<div class="paragraph">
<p><strong>Request body (signal event received for execution):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;messageEventReceived&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;messageName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;myMessage&quot;</span>
  <span class="tok-s2">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notifies the execution that a message event has been received, requires a <code>messageName</code> parameter. Optional <code>variables</code> can be passed that are set on the execution before the action is executed.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 91. Execute an action on an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found and the action is performed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found, the action was performed and the action caused the execution to end.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an illegal action was requested, required parameters are missing in the request body or illegal variables are passed in. Status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body (in case execution is not ended due to action):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_active_activities_in_an_execution">13.6.3. Get active activities in an execution</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/executions/{executionId}/activities</pre>
</div>
</div>
<div class="paragraph">
<p>Returns all activities which are active in the execution and in all child-executions (and their children, recursively), if any.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 92. Get active activities in an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to get activities for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 93. Get active activities in an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found and activities are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-s2">&quot;userTaskForManager&quot;</span><span class="tok-p">,</span>
  <span class="tok-s2">&quot;receiveTask&quot;</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restExecutionsGet">13.6.4. List of executions</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/executions</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 94. List of executions - URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with the given activity id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with the given process definition key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with the given process definition id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions which are part of the process instance with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">messageEventSubscriptionName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions which are subscribed to a message with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">signalEventSubscriptionName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions which are subscribed to a signal with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions which are a direct child of the given execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return executions with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns executions without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort field, should be either one of <code>processInstanceId</code> (default), <code>processDefinitionId</code>, <code>processDefinitionKey</code> or <code>tenantId</code>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 95. List of executions - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the executions are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format . The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">}</span>
   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processInstanceId&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_executions">13.6.5. Query executions</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/executions</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionKey&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;oneTaskProcess&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span>
  <span class="tok-p">[</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;processInstanceVariables&quot;</span><span class="tok-p">:</span>
  <span class="tok-p">[</span>
    <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;processVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;some string&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The request body can contain all possible filters that can be used in the <a href="#restExecutionsGet">List executions</a> URL query. On top of these, it&#8217;s possible to provide an array of <code>variables</code> and <code>processInstanceVariables</code>
to include in the query, with their format <a href="#restQueryVariable">described here</a>.</p>
</div>
<div class="paragraph">
<p>The general <a href="#restPagingAndSort">paging and sorting query-parameters</a> can be used for this URL.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 96. Query executions - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the executions are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format . The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/7&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;parentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span><span class="tok-kc">false</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;activityId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processTask&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">}</span>
   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;processInstanceId&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_list_of_variables_for_an_execution">13.6.6. List of variables for an execution</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/executions/{executionId}/variables?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 97. List of variables for an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to the variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>local</code> or <code>global</code>. If omitted, both local and global scoped variables are returned.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 98. List of variables for an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found and variables are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested execution was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;global&quot;</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;byteArrayProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;valueUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5/variables/byteArrayProcVar/data&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>


<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_variable_for_an_execution">13.6.7. Get a variable for an execution</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/executions/{executionId}/variables/{variableName}?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 99. Get a variable for an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to the variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable to get.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>local</code> or <code>global</code>. If omitted, local variable is returned (if exists). If not, a global variable is returned (if exists).</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 100. Get a variable for an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both the execution and variable were found and variable is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request body is incomplete or contains illegal values. The status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested execution was not found or the execution does not have a variable with the given name in the requested scope (in case scope-query parameter was omitted, variable doesn&#8217;t exist in local and global scope). Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span>   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_or_update_variables_on_an_execution">13.6.8. Create (or update) variables on an execution</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/executions/{executionId}/variables</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/executions/{executionId}/variables</pre>
</div>
</div>
<div class="paragraph">
<p>When using <code>POST</code>, all variables that are passed are created. In case one of the variables already exists on the execution in the requested scope, the request results in an error (409 - CONFLICT). When <code>PUT</code> is used, nonexistent variables are created on the execution and existing ones are overridden without any error.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 101. Create (or update) variables on an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to the variables for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span>
      <span class="tok-s2">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span>
      <span class="tok-s2">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>



<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>*Note that you can only provide variables that have the same scope. If the request-body array contains variables from mixed scopes, the request results in an error (400 - BAD REQUEST).*Any number of variables can be passed into the request body array. More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>. Note that scope is ignored, only <code>local</code> variables can be set in a process instance.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 102. Create (or update) variables on an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found and variable is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request body is incomplete or contains illegal values. The status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested execution was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution was found but already contains a variable with the given name (only thrown when POST method is used). Use the update-method instead.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;local&quot;</span>
   <span class="tok-p">}</span>



<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_a_variable_on_an_execution">13.6.9. Update a variable on an execution</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/executions/{executionId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 103. Update a variable on an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to update the variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the variable to update.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span> <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span>
    <span class="tok-s2">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span>
    <span class="tok-s2">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;global&quot;</span>
 <span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 104. Update a variable on an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates both the process instance and variable were found and variable is updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the process instance does not have a variable with the given name. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span>   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;intProcVar&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;scope&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;global&quot;</span>
   <span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the variable is a binary variable or serializable, the <code>valueUrl</code> points to an URL to fetch the raw value. If it&#8217;s a plain variable, the value is present in the response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_binary_variable_on_an_execution">13.6.10. Create a new binary variable on an execution</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/executions/{executionId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 105. Create a new binary variable on an execution - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to create the new variable for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is created. If omitted, <code>local</code> is assumed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/executions/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 106. Create a new binary variable on an execution - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to create was missing. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested execution was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the execution already has a variable with the given name. Use the PUT method to update the task variable instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_an_existing_binary_variable_on_a_process_instance_2">13.6.11. Update an existing binary variable on a process-instance</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/executions/{executionId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 107. Update an existing binary variable on a process-instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the execution to create the new variable for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to update.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong>
The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is created. If omitted, <code>local</code> is assumed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/executions/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 108. Update an existing binary variable on a process-instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was updated and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to update was missing. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested execution was not found or the execution does not have a variable with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_tasks">13.7. Tasks</h3>
<div class="sect3">
<h4 id="_get_a_task">13.7.1. Get a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 109. Get a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 110. Get a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;createTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;delegationState&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;pending&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Task description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;execution&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;8&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;owner&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;parentTask&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/9&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processDefinition&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstance&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;suspended&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;theTask&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/8&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>delegationState</code>: Delegation-state of the task, can be <code>null</code>, <code>"pending"</code> or <code>"resolved".</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="restTasksGet">13.7.2. List of tasks</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 111. List of tasks - URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with a name like the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with the given description.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">priority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with the given priority.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimumPriority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with a priority greater than the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maximumPriority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with a priority lower than the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assignee</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks assigned to the given user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assigneeLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks assigned with an assignee like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">owner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks owned by the given user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ownerLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks assigned with an owner like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unassigned</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that are not assigned to anyone. If <code>false</code> is passed, the value is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delegationState</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that have the given delegation state. Possible values are <code>pending</code> and <code>resolved</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">candidateUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that can be claimed by the given user. This includes both tasks where the user is an explicit candidate for and task that are claimable by a group that the user is a member of.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">candidateGroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that can be claimed by a user in the given group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">candidateGroups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that can be claimed by a user in the given groups. Values split by comma.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">involvedUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks in which the given user is involved.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with the given task definition id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDefinitionKeyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with a given task definition id like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of the process instance with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceBusinessKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of the process instance with the given business key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceBusinessKeyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of the process instance which has a business key like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of a process instance which has a process definition with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of a process instance which has a process definition with the given key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKeyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of a process instance which has a process definition with a key like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of a process instance which has a process definition with the given name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of a process instance which has a process definition with a name like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are part of the execution with the given id.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">createdOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are created on the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">createdBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are created before the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">createdAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are created after the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are due on the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are due before the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which are due after the given date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutDueDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which don&#8217;t have a due date. The property is ignored if the value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutDueDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which don&#8217;t have a due date. The property is ignored if the value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutDueDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks which don&#8217;t have a due date. The property is ignored if the value is <code>false</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeSubTasks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks that are not a subtask of another task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">active</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return tasks that are not suspended (either part of a process that is not suspended or not part of a process at all). If false, only tasks that are part of suspended process instances are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeTaskLocalVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to include task local variables in the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeProcessVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to include process variables in the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return tasks with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns tasks without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">candidateOrAssigned</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select tasks that has been claimed or assigned to user or waiting to claim by user (candidate user or groups).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select tasks with the given category. Note that this is the task category, not the category of the process definition (namespace within the BPMN Xml).</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 112. List of tasks - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the tasks are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format or that <em>delegationState</em> has an invalid value (other than <em>pending</em> and <em>resolved</em>). The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;createTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;delegationState&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;pending&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Task description&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;execution&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;8&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;owner&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;parentTask&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/9&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinition&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstance&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;suspended&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;theTask&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/8&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_tasks">13.7.3. Query for tasks</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/tasks</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;The task description&quot;</span><span class="tok-p">,</span>

  <span class="tok-err">...</span>

  <span class="tok-nt">&quot;taskVariables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>

    <span class="tok-nt">&quot;processInstanceVariables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span>
         <span class="tok-err">...</span>
      <span class="tok-p">}</span>
    <span class="tok-p">]</span>
  <span class="tok-err">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restTasksGet">getting a collection of tasks</a> (except for candidateGroupIn which is only available in this POST task query REST service), but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long. On top of that, the query allows for filtering based on task and process variables. The <code>taskVariables</code> and <code>processInstanceVariables</code> are both JSON-arrays containing objects with the format <a href="#restQueryVariable">as described here.</a></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 113. Query for tasks - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the tasks are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates a parameter was passed in the wrong format or that <em>delegationState</em> has an invalid value (other than <em>pending</em> and <em>resolved</em>). The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;createTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;delegationState&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;pending&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Task description&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;execution&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/executions/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;8&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;owner&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;parentTask&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/9&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinition&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstance&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;suspended&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;theTask&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/8&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_a_task">13.7.4. Update a task</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/tasks/{taskId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;assignee&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;delegationState&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;resolved&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;New task description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T13:06:02.438+02:00&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;New task name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;owner&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;parentTaskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">20</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All request values are optional. For example, you can only include the <em>assignee</em> attribute in the request body JSON-object, only updating the assignee of the task, leaving all other fields unaffected. When an attribute is explicitly included and is set to null, the task-value will be updated to null. Example: <code>{"dueDate" : null}</code> will clear the duedate of the task).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 114. Update a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was updated simultaneously.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>runtime/tasks/{taskId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_actions">13.7.5. Task actions</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Complete a task - Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;complete&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Completes the task. Optional variable array can be passed in using the <code>variables</code> property. More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>. Note that the variable-scope that is supplied is ignored and the variables are set on the parent-scope unless a variable exists in a local scope, which is overridden in this case. This is the same behavior as the <code>TaskService.completeTask(taskId, variables)</code> invocation.</p>
</div>
<div class="paragraph">
<p>Note that also a <em>transientVariables</em> property is accepted as part of this json, that follows the same structure as the <em>variables</em> property.</p>
</div>
<div class="paragraph">
<p><strong>Claim a task - Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;claim&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;userWhoClaims&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Claims the task by the given assignee. If the assignee is <code>null</code>, the task is assigned to no-one, claimable again.</p>
</div>
<div class="paragraph">
<p><strong>Delegate a task - Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;delegate&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;userToDelegateTo&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Delegates the task to the given assignee. The assignee is required.</p>
</div>
<div class="paragraph">
<p><strong>Resolve a task - Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;resolve&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Resolves the task delegation. The task is assigned back to the task owner (if any).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 115. Task actions - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the action was executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the body contains an invalid value or when the assignee is missing when the action requires it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the action cannot be performed due to a conflict. Either the task was updates simultaneously or the task was claimed by another user, in case of the <em><code>claim</code></em> action.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>runtime/tasks/{taskId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_task">13.7.6. Delete a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}?cascadeHistory={cascadeHistory}&amp;deleteReason={deleteReason}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 116. &gt;Delete a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to delete.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cascadeHistory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether or not to delete the HistoricTask instance when deleting the task (if applicable). If not provided, this value defaults to false.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleteReason</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reason why the task is deleted. This value is ignored when <code>cascadeHistory</code> is true.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 117. &gt;Delete a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">403</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task cannot be deleted because it&#8217;s part of a workflow.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_variables_for_a_task">13.7.7. Get all variables for a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/variables?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 118. Get all variables for a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get variables for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope of variables to be returned. When <em><code>local</code></em>, only task-local variables are returned. When <em><code>global</code></em>, only variables from the task&#8217;s parent execution-hierarchy are returned. When the parameter is omitted, both local and global variables are returned.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 119. Get all variables for a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the requested variables are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;doubleTaskVar&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;double&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mf">99.99</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;stringProcVar&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;global&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a ProcVariable&quot;</span>
  <span class="tok-p">}</span>



<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables are returned as a JSON array. Full response description can be found in the general <a href="#restVariables">REST-variables section</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_variable_from_a_task">13.7.8. Get a variable from a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/variables/{variableName}?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 120. Get a variable from a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get a variable for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to get.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope of variable to be returned. When <em><code>local</code></em>, only task-local variable value is returned. When <em><code>global</code></em>, only variable value from the task&#8217;s parent execution-hierarchy are returned. When the parameter is omitted, a local variable will be returned if it exists, otherwise a global variable.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 121. Get a variable from a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the requested variables are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have a variable with the given name (in the given scope). Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTaskVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Hello my friend&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Full response body description can be found in the general <a href="#restVariables">REST-variables section</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_binary_data_for_a_variable">13.7.9. Get the binary data for a variable</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/variables/{variableName}/data?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 122. Get the binary data for a variable - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get a variable data for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to get data for. Only variables of type <code>binary</code> and <code>serializable</code> can be used. If any other type of variable is used, a <code>404</code> is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope of variable to be returned. When <em><code>local</code></em>, only task-local variable value is returned. When <em><code>global</code></em>, only variable value from the task&#8217;s parent execution-hierarchy are returned. When the parameter is omitted, a local variable will be returned if it exists, otherwise a global variable.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 123. Get the binary data for a variable - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the requested variables are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have a variable with the given name (in the given scope) or the variable doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary value of the variable. When the variable is of type <code>binary</code>, the content-type of the response is set to <code>application/octet-stream</code>, regardless of the content of the variable or the request accept-type header. In case of <code>serializable</code>, <code>application/x-java-serialized-object</code> is used as content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_new_variables_on_a_task">13.7.10. Create new variables on a task</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 124. Create new variables on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to create the new variable for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body for creating simple (non-binary) variables:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTaskVariable&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Hello my friend&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>

  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The request body should be an array containing one or more JSON-objects representing the variables that should be created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is created. If omitted, <code>local</code> is assumed.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, reverts to raw JSON-value type (string, boolean, integer or double).</p>
</li>
<li>
<p><code>value</code>: Variable value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTaskVariable&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Hello my friend&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>

  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 125. Create new variables on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variables were created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of a variable to create was missing or that an attempt is done to create a variable on a standalone task (without a process associated) with scope <code>global</code> or an empty array of variables was included in the request or request did not contain an array of variables. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task already has a variable with the given name. Use the PUT method to update the task variable instead.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_binary_variable_on_a_task">13.7.11. Create a new binary variable on a task</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 126. Create a new binary variable on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to create the new variable for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is created. If omitted, <code>local</code> is assumed.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is created. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/tasks/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 127. Create a new binary variable on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to create was missing or that an attempt is done to create a variable on a standalone task (without a process associated) with scope <code>global</code>. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task already has a variable with the given name. Use the PUT method to update the task variable instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_an_existing_variable_on_a_task">13.7.12. Update an existing variable on a task</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/tasks/{taskId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 128. Update an existing variable on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to update the variable for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to update.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body for updating simple (non-binary) variables:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTaskVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Hello my friend&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is updated. If omitted, <code>local</code> is assumed.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is updated. If omitted, reverts to raw JSON-value type (string, boolean, integer or double).</p>
</li>
<li>
<p><code>value</code>: Variable value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information about the variable format can be found in <a href="#restVariables">the REST variables section</a>.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTaskVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Hello my friend&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 129. Update an existing variable on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variables was updated and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of a variable to update was missing or that an attempt is done to update a variable on a standalone task (without a process associated) with scope <code>global</code>. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have a variable with the given name in the given scope. Status message contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_updating_a_binary_variable_on_a_task">13.7.13. Updating a binary variable on a task</h4>
<div class="listingblock">
<div class="content">
<pre>PUT runtime/tasks/{taskId}/variables/{variableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 130. Updating a binary variable on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to update the variable for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to update.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>scope</code>: Scope of variable that is updated. If omitted, <code>local</code> is assumed.</p>
</li>
<li>
<p><code>type</code>: Type of variable that is updated. If omitted, <code>binary</code> is assumed and the binary data in the request will be stored as an array of bytes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binaryVariable&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;scope&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;binary&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;valueUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://.../runtime/tasks/123/variables/binaryVariable/data&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 131. Updating a binary variable on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable was updated and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the name of the variable to update was missing or that an attempt is done to update a variable on a standalone task (without a process associated) with scope <code>global</code>. Status message provides additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the variable to update doesn&#8217;t exist for the given task in the given scope.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">415</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the serializable data contains an object for which no class is present in the JVM running the Flowable engine and therefore cannot be deserialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_a_variable_on_a_task">13.7.14. Delete a variable on a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}/variables/{variableName}?scope={scope}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 132. Delete a variable on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task the variable to delete belongs to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the variable to delete.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope of variable to delete in. Can be either <code>local</code> or <code>global</code>. If omitted, <code>local</code> is assumed.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 133. Delete a variable on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task variable was found and has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have a variable with the given name. Status message contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_all_local_variables_on_a_task">13.7.15. Delete all local variables on a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}/variables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 134. Delete all local variables on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task the variable to delete belongs to.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 135. Delete all local variables on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates all local task variables have been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_identity_links_for_a_task">13.7.16. Get all identity links for a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 136. Get all identity links for a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the identity links for.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 137. Get all identity links for a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the requested identity links are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/100/identitylinks/users/kermit/candidate&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/100/identitylinks/groups/sales/candidate&quot;</span>
  <span class="tok-p">},</span>

  <span class="tok-err">...</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_all_identitylinks_for_a_task_for_either_groups_or_users">13.7.17. Get all identitylinks for a task for either groups or users</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/identitylinks/users
GET runtime/tasks/{taskId}/identitylinks/groups</pre>
</div>
</div>
<div class="paragraph">
<p>Returns only identity links targetting either users or groups. Response body and status-codes are exactly the same as when getting the full list of identity links for a task.</p>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_single_identity_link_on_a_task">13.7.18. Get a single identity link on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/identitylinks/{family}/{identityId}/{type}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 138. Get all identitylinks for a task for either groups or users - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">family</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>groups</code> or <code>users</code>, depending on what kind of identity is targeted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the identity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of identity link.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 139. Get all identitylinks for a task for either groups or users - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and identity link was found and returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have the requested identityLink. The status contains additional information about this error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/100/identitylinks/groups/sales/candidate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_an_identity_link_on_a_task">13.7.19. Create an identity link on a task</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 140. Create an identity link on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task .</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body (user):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body (group):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 141. Create an identity link on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the identity link was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have the requested identityLink. The status contains additional information about this error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;candidate&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/100/identitylinks/groups/sales/candidate&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_an_identity_link_on_a_task">13.7.20. Delete an identity link on a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}/identitylinks/{family}/{identityId}/{type}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 142. Delete an identity link on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">family</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either <code>groups</code> or <code>users</code>, depending on what kind of identity is targeted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">identityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the identity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of identity link.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 143. Delete an identity link on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and identity link were found and the link has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have the requested identityLink. The status contains additional information about this error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_comment_on_a_task">13.7.21. Create a new comment on a task</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/comments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 144. Create a new comment on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to create the comment for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;saveProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Parameter <code>saveProcessInstanceId</code> is optional, if <code>true</code> save process instance id of task with comment.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/101/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span>
  <span class="tok-s2">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 145. Create a new comment on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the comment was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the comment is missing from the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_comments_on_a_task">13.7.22. Get all comments on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/comments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 146. Get all comments on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the comments for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/101/comments/123&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/123&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span>
    <span class="tok-s2">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span>
    <span class="tok-s2">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;456&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/101/comments/456&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/456&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is another comment on the task.&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;gonzo&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span>
    <span class="tok-s2">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 147. Get all comments on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the comments are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_comment_on_a_task">13.7.23. Get a comment on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/comments/{commentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 148. Get a comment on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the comment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the comment.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/101/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span>
  <span class="tok-s2">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 149. Get a comment on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and comment were found and the comment is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the tasks doesn&#8217;t have a comment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_a_comment_on_a_task">13.7.24. Delete a comment on a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}/comments/{commentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 150. Delete a comment on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to delete the comment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the comment.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 151. Delete a comment on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and comment were found and the comment is deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the tasks doesn&#8217;t have a comment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_events_for_a_task">13.7.25. Get all events for a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/events</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 152. Get all events for a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the events for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;AddUserLink&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span> <span class="tok-s2">&quot;gonzo&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;contributor&quot;</span> <span class="tok-p">],</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-05-17T11:50:50.000+0000&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/events/4&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
  <span class="tok-p">}</span>

<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 153. Get all events for a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the events are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_an_event_on_a_task">13.7.26. Get an event on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/events/{eventId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 154. Get an event on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the event for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eventId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the event.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;AddUserLink&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span> <span class="tok-s2">&quot;gonzo&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;contributor&quot;</span> <span class="tok-p">],</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-05-17T11:50:50.000+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/events/4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 155. Get an event on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and event were found and the event is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the tasks doesn&#8217;t have an event with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_attachment_on_a_task_containing_a_link_to_an_external_resource">13.7.27. Create a new attachment on a task, containing a link to an external resource</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/attachments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 156. Create a new attachment on a task, containing a link to an external resource - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to create the attachment for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;simpleType&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://flowable.org&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the attachment name is required to create a new attachment.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;simpleType&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://flowable.org&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;contentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 157. Create a new attachment on a task, containing a link to an external resource - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the attachment was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the attachment name is missing from the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_attachment_on_a_task_with_an_attached_file">13.7.28. Create a new attachment on a task, with an attached file</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/tasks/{taskId}/attachments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 158. Create a new attachment on a task, with an attached file - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to create the attachment for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the variable. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: Required name of the variable.</p>
</li>
<li>
<p><code>description</code>: Description of the attachment, optional.</p>
</li>
<li>
<p><code>type</code>: Type of attachment, optional. Supports any arbitrary string or a valid HTTP content-type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
	<span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
	<span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment description&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;binaryType&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;contentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5/content&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 159. Create a new attachment on a task, with an attached file - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the attachment was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the attachment name is missing from the request or no file was present in the request. The error-message contains additional information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_attachments_on_a_task">13.7.29. Get all attachments on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/attachments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 160. Get all attachments on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the attachments for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/3&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Simple attachment description&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;simpleType&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://flowable.org&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;contentUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment description&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;binaryType&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;taskUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;contentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5/content&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 161. Get all attachments on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task was found and the attachments are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_an_attachment_on_a_task">13.7.30. Get an attachment on a task</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/attachments/{attachmentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 162. Get an attachment on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get the attachment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attachmentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the attachment.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Binary attachment description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;binaryType&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;externalUrl&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;contentUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/tasks/2/attachments/5/content&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>externalUrl - contentUrl:</code>In case the attachment is a link to an external resource, the <code>externalUrl</code> contains the URL to the external content. If the attachment content is present in the Flowable engine, the <code>contentUrl</code> will contain an URL where the binary content can be streamed from.</p>
</li>
<li>
<p><code>type:</code>Can be any arbitrary value. When a valid formatted media-type (e.g. application/xml, text/plain) is included, the binary content HTTP response content-type will be set the the given value.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 163. Get an attachment on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and attachment were found and the attachment is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the tasks doesn&#8217;t have a attachment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_the_content_for_an_attachment">13.7.31. Get the content for an attachment</h4>
<div class="listingblock">
<div class="content">
<pre>GET runtime/tasks/{taskId}/attachment/{attachmentId}/content</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 164. Get the content for an attachment - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to get a variable data for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attachmentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the attachment, a <code>404</code> is returned when the attachment points to an external URL rather than content attached in Flowable.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 165. Get the content for an attachment - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and attachment was found and the requested content is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the task doesn&#8217;t have an attachment with the given id or the attachment doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary content. By default, the content-type of the response is set to <code>application/octet-stream</code> unless the attachment type contains a valid Content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_delete_an_attachment_on_a_task">13.7.32. Delete an attachment on a task</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE runtime/tasks/{taskId}/attachments/{attachmentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 166. Delete an attachment on a task - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the task to delete the attachment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attachmentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the attachment.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 167. Delete an attachment on a task - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task and attachment were found and the attachment is deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the tasks doesn&#8217;t have a attachment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_history">13.8. History</h3>
<div class="sect3">
<h4 id="_get_a_historic_process_instance">13.8.1. Get a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instances/{processInstanceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 168. Get a historic process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic process instances could be found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic process instances could not be found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;businessKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myKey&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startUserId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;startEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;endEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;superProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restHistoricProcessInstancesGet">13.8.2. List of historic process instances</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instances</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 169. List of historic process instances - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An id of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition key of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition id of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">businessKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The business key of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">involvedUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An involved user of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">finished</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication if the historic process instance is finished.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">superProcessInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional parent process id of the historic process instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeSubprocesses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances which aren&#8217;t sub processes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">finishedAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances that were finished after this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">finishedBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances that were finished before this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startedAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances that were started after this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startedBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances that were started before this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">startedBy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic process instances that were started by this user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeProcessVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An indication if the historic process instance variables should be returned as well.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return instances with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return instances with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns instances without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 170. List of historic process instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that historic process instances could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;businessKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myKey&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startUserId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;startEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;endEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;superProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_historic_process_instances">13.8.3. Query for historic process instances</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/historic-process-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>


  <span class="tok-nt">&quot;variables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restHistoricProcessInstancesGet">getting a collection of historic process instances</a>, but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long. On top of that, the query allows for filtering based on process variables. The <code>variables</code> property is a JSON-array containing objects with the format <a href="#restQueryVariable">as described here.</a></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 171. Query for historic process instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the tasks are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;businessKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myKey&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startUserId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;startEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endActivityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;endEvent&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;superProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_historic_process_instance">13.8.4. Delete a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE history/historic-process-instances/{processInstanceId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 172. Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic process instance was deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic process instance could not be found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_the_identity_links_of_a_historic_process_instance">13.8.5. Get the identity links of a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instance/{processInstanceId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 173. Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the identity links are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance could not be found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
 <span class="tok-p">{</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;participant&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span>
 <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_binary_data_for_a_historic_process_instance_variable">13.8.6. Get the binary data for a historic process instance variable</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instances/{processInstanceId}/variables/{variableName}/data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 174. Get the binary data for a historic process instance variable - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and the requested variable data is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested process instance was not found or the process instance doesn&#8217;t have a variable with the given name or the variable doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary value of the variable. When the variable is of type <code>binary</code>, the content-type of the response is set to <code>application/octet-stream</code>, regardless of the content of the variable or the request accept-type header. In case of <code>serializable</code>, <code>application/x-java-serialized-object</code> is used as content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_new_comment_on_a_historic_process_instance">13.8.7. Create a new comment on a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>POST history/historic-process-instances/{processInstanceId}/comments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 175. Create a new comment on a historic process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to create the comment for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;saveProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Parameter <code>saveProcessInstanceId</code> is optional, if <code>true</code> save process instance id of task with comment.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/runtime/tasks/101/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 176. Create a new comment on a historic process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the comment was created and the result is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the comment is missing from the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested historic process instance was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_all_comments_on_a_historic_process_instance">13.8.8. Get all comments on a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instances/{processInstanceId}/comments</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 177. Get all comments on a process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the process instance to get the comments for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span></span><span class="tok-p">[</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/123&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is a comment on the task.&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-13T13:13:52.232+08:00&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
  <span class="tok-p">},</span>
  <span class="tok-p">{</span>
    <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;456&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/456&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is another comment.&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;gonzo&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-14T15:16:52.232+08:00&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
  <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 178. Get all comments on a process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the process instance was found and the comments are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_comment_on_a_historic_process_instance">13.8.9. Get a comment on a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-process-instances/{processInstanceId}/comments/{commentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 179. Get a comment on a historic process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the historic process instance to get the comment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the comment.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8081/flowable-rest/service/history/historic-process-instances/100/comments/456&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;message&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;This is another comment.&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;author&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;gonzo&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2014-07-14T15:16:52.232+08:00&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;100&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 180. Get a comment on a historic process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the historic process instance and comment were found and the comment is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested historic process instance was not found or the historic process instance doesn&#8217;t have a comment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_a_comment_on_a_historic_process_instance">13.8.10. Delete a comment on a historic process instance</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE history/historic-process-instances/{processInstanceId}/comments/{commentId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 181. Delete a comment on a historic process instance - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the historic process instance to delete the comment for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commentId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the comment.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 182. Delete a comment on a historic process instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the historic process instance and comment were found and the comment is deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task was not found or the historic process instance doesn&#8217;t have a comment with the given ID.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_single_historic_task_instance">13.8.11. Get a single historic task instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-task-instances/{taskId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 183. Get a single historic task instance - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic task instances could be found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic task instances could not be found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task description&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;fozzie&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;workTimeInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">234890</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;claimTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T11:01:54.715+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;taskKey&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;formKey&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-20T12:11:13.134+0000&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;parentTaskId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restHistoricTaskInstancesGet">13.8.12. Get historic task instances</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-task-instances</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 184. Get historic task instances - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An id of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance id of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition key of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionKeyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition key of the historic task instance, which matches the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition id of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition name of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition name of the historic task instance, which matches the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processBusinessKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance business key of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processBusinessKeyLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance business key of the historic task instance that matches the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The execution id of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task definition key for tasks part of a process</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task name of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task name with <em>like</em> operator for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDescription</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task description of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDescriptionLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task description with <em>like</em> operator for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDefinitionKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task identifier from the process definition for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCategory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select tasks with the given category. Note that this is the task category, not the category of the process definition (namespace within the BPMN Xml).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDeleteReason</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task delete reason of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskDeleteReasonLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task delete reason with <em>like</em> operator for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskAssignee</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assignee of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskAssigneeLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assignee with <em>like</em> operator for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskOwner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The owner of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskOwnerLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The owner with <em>like</em> operator for the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskInvolvedUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An involved user of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskPriority</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The priority of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">finished</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication if the historic task instance is finished.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processFinished</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication if the process instance of the historic task instance is finished.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parentTaskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An optional parent task id of the historic task instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have a due date equal this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueDateAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have a due date after this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueDateBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have a due date before this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutDueDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have no due-date. When <code>false</code> is provided as value, this parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCompletedOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have been completed on this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCompletedAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have been completed after this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCompletedBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that have been completed before this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCreatedOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that were created on this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCreatedBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that were created before this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskCreatedAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return only historic task instances that were created after this date.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeTaskLocalVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An indication if the historic task instance local variables should be returned as well.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeProcessVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An indication if the historic task instance global variables should be returned as well.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return historic task instances with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return historic task instances with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns historic task instances without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 185. Get historic task instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that historic process instances could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task name&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task description&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;fozzie&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;workTimeInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">234890</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;claimTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T11:01:54.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;taskKey&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;formKey&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-20T12:11:13.134+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;parentTaskId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskVariables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;processVariables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;processTest&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;global&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myProcessTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_historic_task_instances">13.8.13. Query for historic task instances</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/historic-task-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Query for historic task instances - Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-err">...</span>

  <span class="tok-nt">&quot;variables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restHistoricTaskInstancesGet">getting a collection of historic task instances</a>, but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long. On top of that, the query allows for filtering based on process variables. The <code>taskVariables</code> and <code>processVariables</code> properties are JSON-arrays containing objects with the format <a href="#restQueryVariable">as described here.</a></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 186. Query for historic task instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the tasks are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task name&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;description&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My task description&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deleteReason&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;owner&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;fozzie&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;workTimeInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">234890</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;claimTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T11:01:54.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskDefinitionKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;taskKey&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;formKey&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;priority&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">50</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;dueDate&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-20T12:11:13.134+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;parentTaskId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskVariables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;local&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;processVariables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;processTest&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;global&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;myProcessTest&quot;</span>
        <span class="tok-p">}</span>
      <span class="tok-p">],</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_historic_task_instance">13.8.14. Delete a historic task instance</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE history/historic-task-instances/{taskId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 187. Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic task instance was deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that the historic task instance could not be found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_the_identity_links_of_a_historic_task_instance">13.8.15. Get the identity links of a historic task instance</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-task-instance/{taskId}/identitylinks</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 188. Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the identity links are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task instance could not be found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-p">[</span>
 <span class="tok-p">{</span>
  <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;assignee&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;userId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;groupId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
 <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_binary_data_for_a_historic_task_instance_variable">13.8.16. Get the binary data for a historic task instance variable</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-task-instances/{taskId}/variables/{variableName}/data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 189. Get the binary data for a historic task instance variable - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the task instance was found and the requested variable data is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested task instance was not found or the process instance doesn&#8217;t have a variable with the given name or the variable doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary value of the variable. When the variable is of type <code>binary</code>, the content-type of the response is set to <code>application/octet-stream</code>, regardless of the content of the variable or the request accept-type header. In case of <code>serializable</code>, <code>application/x-java-serialized-object</code> is used as content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="restHistoricActivityInstancesGet">13.8.17. Get historic activity instances</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-activity-instances</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 190. Get historic activity instances - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An id of the activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An id of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The element type of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The execution id of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">finished</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication if the historic activity instance is finished.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskAssignee</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The assignee of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance id of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition id of the historic activity instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return instances with the given tenantId.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return instances with a tenantId like the given value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns instances without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 191. Get historic activity instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that historic activity instances could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityName&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My user task&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityType&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;userTask&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;calledProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;fozzie&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_historic_activity_instances">13.8.18. Query for historic activity instances</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/historic-activity-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restHistoricTaskInstancesGet">getting a collection of historic task instances</a>, but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 192. Query for historic activity instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the activities are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityName&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;My user task&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityType&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;userTask&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;4&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;calledProcessInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;assignee&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;fozzie&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;startTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;endTime&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-18T14:06:32.715+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;durationInMillis&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">86400056</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="restHistoricVariableInstancesGet">13.8.19. List of historic variable instances</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-variable-instances</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 193. List of historic variable instances - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance id of the historic variable instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task id of the historic variable instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">excludeTaskVariables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to exclude the task variables from the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The variable name of the historic variable instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variableNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The variable name using the <em>like</em> operator for the historic variable instance.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 194. List of historic variable instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that historic variable instances could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;14&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variable&quot;</span> <span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;global&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_historic_variable_instances">13.8.20. Query for historic variable instances</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/historic-variable-instances</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;oneTaskProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
  <span class="tok-err">...</span>

  <span class="tok-nt">&quot;variables&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">1234</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;operation&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;equals&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;long&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restHistoricVariableInstancesGet">getting a collection of historic process instances</a>, but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long. On top of that, the query allows for filtering based on process variables. The <code>variables</code> property is a JSON-array containing objects with the format <a href="#restQueryVariable">as described here.</a></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 195. Query for historic variable instances - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the tasks are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;14&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variable&quot;</span> <span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;global&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span>
      <span class="tok-p">}</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>====Get the binary data for a historic task instance variable</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-variable-instances/{varInstanceId}/data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 196. Get the binary data for a historic task instance variable - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the variable instance was found and the requested variable data is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested variable instance was not found or the variable instance doesn&#8217;t have a variable with the given name or the variable doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary value of the variable. When the variable is of type <code>binary</code>, the content-type of the response is set to <code>application/octet-stream</code>, regardless of the content of the variable or the request accept-type header. In case of <code>serializable</code>, <code>application/x-java-serialized-object</code> is used as content-type.</p>
</div>
</div>
<div class="sect3">
<h4 id="restHistoricDetailGet">13.8.21. Get historic detail</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-detail</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 197. Get historic detail - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the historic detail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process instance id of the historic detail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The execution id of the historic detail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">activityInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The activity instance id of the historic detail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task id of the historic detail.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">selectOnlyFormProperties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to only return form properties in the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">selectOnlyVariableUpdates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indication to only return variable updates in the result.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 198. Get historic detail - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that historic detail could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;26&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityInstanceId&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;10&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;detailType&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableUpdate&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;revision&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">2</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variable&quot;</span> <span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;global&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span>
      <span class="tok-p">},</span>
      <span class="tok-nt">&quot;propertyId&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;propertyValue&quot;</span><span class="tok-p">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_for_historic_details">13.8.22. Query for historic details</h4>
<div class="listingblock">
<div class="content">
<pre>POST query/historic-detail</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "processInstanceId" : "5",
}</pre>
</div>
</div>
<div class="paragraph">
<p>All supported JSON parameter fields allowed are exactly the same as the parameters found for <a href="#restHistoricDetailGet">getting a collection of historic process instances</a>, but passed in as JSON-body arguments rather than URL-parameters to allow for more advanced querying and preventing errors with request-uri&#8217;s that are too long.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 199. Query for historic details - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the historic details are returned</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;26&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processInstanceUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;executionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;activityInstanceId&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;10&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-task-instances/6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;time&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2013-04-17T10:17:43.902+0000&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;detailType&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;variableUpdate&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;revision&quot;</span> <span class="tok-p">:</span> <span class="tok-mi">2</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;variable&quot;</span> <span class="tok-p">:</span> <span class="tok-p">{</span>
        <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myVariable&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;variableScope&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;global&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;test&quot;</span>
      <span class="tok-p">},</span>
      <span class="tok-nt">&quot;propertyId&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;propertyValue&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_the_binary_data_for_a_historic_detail_variable">13.8.23. Get the binary data for a historic detail variable</h4>
<div class="listingblock">
<div class="content">
<pre>GET history/historic-detail/{detailId}/data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 200. Get the binary data for a historic detail variable - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the historic detail instance was found and the requested variable data is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested historic detail instance was not found or the historic detail instance doesn&#8217;t have a variable with the given name or the variable doesn&#8217;t have a binary stream available. Status message provides additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the binary value of the variable. When the variable is of type <code>binary</code>, the content-type of the response is set to <code>application/octet-stream</code>, regardless of the content of the variable or the request accept-type header. In case of <code>serializable</code>, <code>application/x-java-serialized-object</code> is used as content-type.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_forms">13.9. Forms</h3>
<div class="sect3">
<h4 id="_get_form_data">13.9.1. Get form data</h4>
<div class="listingblock">
<div class="content">
<pre>GET form/form-data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 201. Get form data - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">taskId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (if no processDefinitionId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The task id corresponding to the form data that needs to be retrieved.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes (if no taskId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The process definition id corresponding to the start event form data that needs to be retrieved.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 202. Get form data - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that form data could be queried.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that form data could not be found.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;formKey&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;deploymentId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definition/3&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;taskUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/runtime/task/6&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;formProperties&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
        <span class="tok-p">{</span>
          <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;room&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Room&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;type&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;string&quot;</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;readable&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;writable&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;required&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;datePattern&quot;</span> <span class="tok-p">:</span> <span class="tok-kc">null</span><span class="tok-p">,</span>
          <span class="tok-nt">&quot;enumValues&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
            <span class="tok-p">{</span>
              <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;normal&quot;</span><span class="tok-p">,</span>
              <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Normal bed&quot;</span>
            <span class="tok-p">},</span>
            <span class="tok-p">{</span>
              <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;kingsize&quot;</span><span class="tok-p">,</span>
              <span class="tok-nt">&quot;name&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;Kingsize bed&quot;</span>
            <span class="tok-p">},</span>
          <span class="tok-p">]</span>
        <span class="tok-p">}</span>
      <span class="tok-p">]</span>
    <span class="tok-p">}</span>
  <span class="tok-p">],</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span> <span class="tok-mi">0</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;name&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span> <span class="tok-mi">1</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_submit_task_form_data">13.9.2. Submit task form data</h4>
<div class="listingblock">
<div class="content">
<pre>POST form/form-data</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body for task form:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;taskId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;properties&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;room&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;normal&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Request body for start event form:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;businessKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myKey&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;properties&quot;</span> <span class="tok-p">:</span> <span class="tok-p">[</span>
    <span class="tok-p">{</span>
      <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;room&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;value&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;normal&quot;</span>
    <span class="tok-p">}</span>
  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 203. Submit task form data - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates request was successful and the form data was submitted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an parameter was passed in the wrong format. The status-message contains additional information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body for start event form data (no response for task form data):</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;id&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;url&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/history/historic-process-instances/5&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;businessKey&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myKey&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;suspended&quot;</span><span class="tok-p">:</span> <span class="tok-kc">false</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processDefinitionId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;processDefinitionUrl&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;http://localhost:8182/repository/process-definition/3&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;activityId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;myTask&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_database_tables">13.10. Database tables</h3>
<div class="sect3">
<h4 id="_list_of_tables">13.10.1. List of tables</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/tables</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 204. List of tables - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the request was successful.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;ACT_RU_VARIABLE&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/management/tables/ACT_RU_VARIABLE&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;count&quot;</span><span class="tok-p">:</span><span class="tok-mi">4528</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;ACT_RU_EVENT_SUBSCR&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/management/tables/ACT_RU_EVENT_SUBSCR&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;count&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span>
   <span class="tok-p">}</span>

<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_get_a_single_table">13.10.2. Get a single table</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/tables/{tableName}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 205. Get a single table - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the table to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
      <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;ACT_RE_PROCDEF&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/management/tables/ACT_RE_PROCDEF&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;count&quot;</span><span class="tok-p">:</span><span class="tok-mi">60</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 206. Get a single table - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the table exists and the table count is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested table does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_column_info_for_a_single_table">13.10.3. Get column info for a single table</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/tables/{tableName}/columns</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 207. Get column info for a single table - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the table to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;tableName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;ACT_RU_VARIABLE&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;columnNames&quot;</span><span class="tok-p">:[</span>
      <span class="tok-s2">&quot;ID_&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;REV_&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;TYPE_&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;NAME_&quot;</span>


   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;columnTypes&quot;</span><span class="tok-p">:[</span>
      <span class="tok-s2">&quot;VARCHAR&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;INTEGER&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;VARCHAR&quot;</span><span class="tok-p">,</span>
      <span class="tok-s2">&quot;VARCHAR&quot;</span>


   <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 208. Get column info for a single table - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the table exists and the table column info is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested table does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_row_data_for_a_single_table">13.10.4. Get row data for a single table</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/tables/{tableName}/data</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 209. Get row data for a single table - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tableName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the table to get.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 210. Get row data for a single table - URL query parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index of the first row to fetch. Defaults to 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of rows to fetch, starting from <code>start</code>. Defaults to 10.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">orderAscendingColumn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the column to sort the resulting rows on, ascending.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">orderDescendingColumn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the column to sort the resulting rows on, descending.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span><span class="tok-p">,</span>

   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;TASK_ID_&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;NAME_&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;var1&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;REV_&quot;</span><span class="tok-p">:</span><span class="tok-mi">1</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;TEXT_&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;123&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;LONG_&quot;</span><span class="tok-p">:</span><span class="tok-mi">123</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;ID_&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;3&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;TYPE_&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;integer&quot;</span>
      <span class="tok-p">}</span>



   <span class="tok-p">]</span>

<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 211. Get row data for a single table - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the table exists and the table row data is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested table does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_engine">13.11. Engine</h3>
<div class="sect3">
<h4 id="_get_engine_properties">13.11.1. Get engine properties</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/properties</pre>
</div>
</div>
<div class="paragraph">
<p>Returns a read-only view of the properties used internally in the engine.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;next.dbid&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;101&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;schema.history&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;create(5.15)&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;schema.version&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5.15&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 212. Get engine properties - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the properties are returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_engine_info">13.11.2. Get engine info</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/engine</pre>
</div>
</div>
<div class="paragraph">
<p>Returns a read-only view of the engine that is used in this REST-service.</p>
</div>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;default&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;version&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5.15&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;resourceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;file://activiti/activiti.cfg.xml&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;exception&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 213. Get engine info - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the engine info is returned.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_runtime">13.12. Runtime</h3>
<div class="sect3">
<h4 id="_signal_event_received">13.12.1. Signal event received</h4>
<div class="listingblock">
<div class="content">
<pre>POST runtime/signals</pre>
</div>
</div>
<div class="paragraph">
<p>Notifies the engine that a signal event has been received, not explicitly related to a specific execution.</p>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8
9</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;signalName&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;My Signal&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;tenantId&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;execute&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;async&quot;</span><span class="tok-p">:</span> <span class="tok-kc">true</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;variables&quot;</span><span class="tok-p">:</span> <span class="tok-p">[</span>
      <span class="tok-p">{</span><span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;testVar&quot;</span><span class="tok-p">,</span> <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span> <span class="tok-s2">&quot;This is a string&quot;</span><span class="tok-p">}</span>

  <span class="tok-p">]</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 214. Signal event received - JSON Body parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">signalName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the signal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID of the tenant that the signal event should be processed in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">async</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, handling of the signal will happen asynchronously. Return code will be <code>202 - Accepted</code> to indicate the request is accepted but not yet executed. If <code>false</code>,
                    handling the signal will be done immediately and result (<code>200 - OK</code>) will only return after this completed successfully. Defaults to <code>false</code> if omitted.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array of variables (in the general variables format) to use as payload to pass along with the signal. Cannot be used in case <code>async</code> is set to <code>true</code>, this will result in an error.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 215. Signal event received - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicated signal has been processed and no errors occurred.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">202</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicated signal processing is queued as a job, ready to be executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Signal not processed. The signal name is missing or variables are used together with async, which is not allowed. Response body contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_jobs">13.13. Jobs</h3>
<div class="sect3">
<h4 id="_get_a_single_job">13.13.1. Get a single job</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/jobs/{jobId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 216. Get a single job - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jobId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the job to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;8&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/management/jobs/8&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processDefinitionId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;timerProcess:1:4&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/timerProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;executionId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;executionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/7&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;retries&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;exceptionMessage&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;dueDate&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-04T22:05:05.474+0000&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 217. Get a single job - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the job exists and is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested job does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_a_job">13.13.2. Delete a job</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE management/jobs/{jobId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 218. Delete a job - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jobId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the job to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 219. Delete a job - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the job was found and has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested job was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_execute_a_single_job">13.13.3. Execute a single job</h4>
<div class="listingblock">
<div class="content">
<pre>POST management/jobs/{jobId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;action&quot;</span> <span class="tok-p">:</span> <span class="tok-s2">&quot;execute&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 220. Execute a single job - JSON Body parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action to perform. Only <code>execute</code> is supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 221. Execute a single job - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the job was executed. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested job was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the an exception occurred while executing the job. The status-description contains additional detail about the error. The full error-stacktrace can be fetched later on if needed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_the_exception_stacktrace_for_a_job">13.13.4. Get the exception stacktrace for a job</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/jobs/{jobId}/exception-stacktrace</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 222. Get the exception stacktrace for a job - URL parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jobId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Id of the job to get the stacktrace for.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 223. Get the exception stacktrace for a job - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested job was not found and the stacktrace has been returned. The response contains the raw stacktrace and always has a Content-type of <code>text/plain</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested job was not found or the job doesn&#8217;t have an exception stacktrace. Status-description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_list_of_jobs">13.13.5. Get a list of jobs</h4>
<div class="listingblock">
<div class="content">
<pre>GET management/jobs</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 224. Get a list of jobs - URL query parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return job with the given id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processInstanceId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs part of a process with the given id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs part of an execution with the given id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs with the given process definition id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withRetriesLeft</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return jobs with retries left. If false, this parameter is ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return jobs which are executable. If false, this parameter is ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timersOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return jobs which are timers. If false, this parameter is ignored. Cannot be used together with <code>'messagesOnly'</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">messagesOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return jobs which are messages. If false, this parameter is ignored. Cannot be used together with <code>'timersOnly'</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">withException</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only return jobs for which an exception occurred while executing it. If false, this parameter is ignored.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueBefore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs which are due to be executed before the given date. Jobs without duedate are never returned using this parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dueAfter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs which are due to be executed after the given date. Jobs without duedate are never returned using this parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exceptionMessage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs with the given exception message</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs with the given tenantId.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tenantIdLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return jobs with a tenantId like the given value.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">withoutTenantId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>true</code>, only returns jobs without a tenantId set. If <code>false</code>, the <code>withoutTenantId</code> parameter is ignored.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field to sort results on, should be one of <code>id</code>, <code>dueDate</code>, <code>executionId</code>, <code>processInstanceId</code>, <code>retries</code> or <code>tenantId</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;13&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/management/jobs/13&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processInstanceUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/process-instances/5&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processDefinitionId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;timerProcess:1:4&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;processDefinitionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/repository/process-definitions/timerProcess%3A1%3A4&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;executionId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;12&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;executionUrl&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/runtime/executions/12&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;retries&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;exceptionMessage&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Can&#39;t find scripting engine for &#39;unexistinglanguage&#39;&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;dueDate&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;2013-06-07T10:00:24.653+0000&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;tenantId&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">}</span>



   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">2</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 225. Get a list of jobs - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested jobs were returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates an illegal value has been used in a url query parameter or the both <code>'messagesOnly'</code> and <code>'timersOnly'</code> are used as parameters. Status description contains additional details about the error.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_users">13.14. Users</h3>
<div class="sect3">
<h4 id="_get_a_single_user">13.14.1. Get a single user</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/users/{userId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 226. Get a single user - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;testuser&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Fred&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;McDonald&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;email&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;no-reply@flowable.org&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 227. Get a single user - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user exists and is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_list_of_users">13.14.2. Get a list of users</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/users</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 228. Get a list of users - URL query parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return user with the given id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users with the given firstname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users with the given lastname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users with the given email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return userswith a firstname like the given value. Use <code>%</code> as wildcard-character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lastNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users with a lastname like the given value. Use <code>%</code> as wildcard-character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">emailLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users with an email like the given value. Use <code>%</code> as wildcard-character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">memberOfGroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users which are a member of the given group.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">potentialStarter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return users which are potential starters for a process-definition with the given id.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field to sort results on, should be one of <code>id</code>, <code>firstName</code>, <code>lastname</code> or <code>email</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;anotherUser&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Tijs&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Barrez&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/anotherUser&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;email&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;no-reply@flowable.org&quot;</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Kermit&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;the Frog&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/kermit&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;email&quot;</span><span class="tok-p">:</span><span class="tok-kc">null</span>
      <span class="tok-p">},</span>
      <span class="tok-p">{</span>
         <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;testuser&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Fred&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;McDonald&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser&quot;</span><span class="tok-p">,</span>
         <span class="tok-nt">&quot;email&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;no-reply@flowable.org&quot;</span>
      <span class="tok-p">}</span>
   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 229. Get a list of users - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested users were returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_a_user">13.14.3. Update a user</h4>
<div class="listingblock">
<div class="content">
<pre>PUT identity/users/{userId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
  <span class="tok-nt">&quot;firstName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Tijs&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;lastName&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Barrez&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;email&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;no-reply@flowable.org&quot;</span><span class="tok-p">,</span>
  <span class="tok-nt">&quot;password&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;pass123&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All request values are optional. For example, you can only include the <em>firstName</em> attribute in the request body JSON-object, only updating the firstName of the user, leaving all other fields unaffected. When an attribute is explicitly included and is set to null, the user-value will be updated to null. Example: <code>{"firstName" : null}</code> will clear the firstName of the user).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 230. Update a user - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was updated simultaneously.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>identity/users/{userId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_user">13.14.4. Create a user</h4>
<div class="listingblock">
<div class="content">
<pre>POST identity/users</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "id":"tijs",
  "firstName":"Tijs",
  "lastName":"Barrez",
  "email":"no-reply@flowable.org",
  "password":"pass123"
}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 231. Create a user - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the id of the user was missing.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>identity/users/{userId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_user">13.14.5. Delete a user</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE identity/users/{userId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 232. Delete a user - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 233. Delete a user - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and  has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_user_s_picture">13.14.6. Get a user&#8217;s picture</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/users/{userId}/picture</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 234. Get a user&#8217;s picture - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to get the picture for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="paragraph">
<p>The response body contains the raw picture data, representing the user&#8217;s picture. The Content-type of the response corresponds to the mimeType that was set when creating the picture.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 235. Get a user&#8217;s picture - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and has a picture, which is returned in the body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found or the user does not have a profile picture. Status-description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_updating_a_user_s_picture">13.14.7. Updating a user&#8217;s picture</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/users/{userId}/picture</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 236. Updating a user&#8217;s picture - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to get the picture for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request body:</strong></p>
</div>
<div class="paragraph">
<p>The request should be of type <code>multipart/form-data</code>. There should be a single file-part included with the binary value of the picture. On top of that, the following additional form-fields can be present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mimeType</code>: Optional mime-type for the uploaded picture. If omitted, the default of <code>image/jpeg</code> is used as a mime-type for the picture.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 237. Updating a user&#8217;s picture - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and the picture has been updated. The response-body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_list_a_user_s_info">13.14.8. List a user&#8217;s info</h4>
<div class="listingblock">
<div class="content">
<pre>PUT identity/users/{userId}/info</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 238. List a user&#8217;s info - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to get the info for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-p">[</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key1&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser/info/key1&quot;</span>
   <span class="tok-p">},</span>
   <span class="tok-p">{</span>
      <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key2&quot;</span><span class="tok-p">,</span>
      <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser/info/key2&quot;</span>
   <span class="tok-p">}</span>
<span class="tok-p">]</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 239. List a user&#8217;s info - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and list of info (key and url) is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_user_s_info">13.14.9. Get a user&#8217;s info</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/users/{userId}/info/{key}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 240. Get a user&#8217;s info - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to get the info for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The key of the user info to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Value 1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser/info/key1&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 241. Get a user&#8217;s info - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and the user has info for the given key..</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found or the user doesn&#8217;t have info for the given key. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_a_user_s_info">13.14.10. Update a user&#8217;s info</h4>
<div class="listingblock">
<div class="content">
<pre>PUT identity/users/{userId}/info/{key}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 242. Update a user&#8217;s info - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to update the info for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The key of the user info to update.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;The updated value&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;The updated value&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser/info/key1&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 243. Update a user&#8217;s info - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and the info has been updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the value was missing from the request body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found or the user doesn&#8217;t have info for the given key. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_create_a_new_user_s_info_entry">13.14.11. Create a new user&#8217;s info entry</h4>
<div class="listingblock">
<div class="content">
<pre>POST identity/users/{userId}/info</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 244. Create a new user&#8217;s info entry - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to create the info for.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Request Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;The value&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;key&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;key1&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;value&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;The value&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/users/testuser/info/key1&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 245. Create a new user&#8217;s info entry - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and the info has been created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the key or value was missing from the request body. Status description contains additional information about the error.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates there is already an info-entry with the given key for the user, update the resource instance (<code>PUT</code>).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_delete_a_user_s_info">13.14.12. Delete a user&#8217;s info</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE identity/users/{userId}/info/{key}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 246. Delete a user&#8217;s info - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to delete the info for.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The key of the user info to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 247. Delete a user&#8217;s info - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the user was found and the info for the given key has been deleted. Response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user was not found or the user doesn&#8217;t have info for the given key. Status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_groups">13.15. Groups</h3>
<div class="sect3">
<h4 id="_get_a_single_group">13.15.1. Get a single group</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/groups/{groupId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 248. Get a single group - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the group to get.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;testgroup&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/groups/testgroup&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test group&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test type&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 249. Get a single group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group exists and is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group does not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_a_list_of_groups">13.15.2. Get a list of groups</h4>
<div class="listingblock">
<div class="content">
<pre>GET identity/groups</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 250. Get a list of groups - URL query parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return group with the given id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return groups with the given name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return groups with the given type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return groups with a name like the given value. Use <code>%</code> as wildcard-character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">member</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return groups which have a member with the given username.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">potentialStarter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only return groups which members are potential starters for a process-definition with the given id.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field to sort results on, should be one of <code>id</code>, <code>name</code> or <code>type</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;data&quot;</span><span class="tok-p">:[</span>
     <span class="tok-p">{</span>
        <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;testgroup&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/groups/testgroup&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test group&quot;</span><span class="tok-p">,</span>
        <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test type&quot;</span>
     <span class="tok-p">}</span>
   <span class="tok-p">],</span>
   <span class="tok-nt">&quot;total&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;start&quot;</span><span class="tok-p">:</span><span class="tok-mi">0</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;sort&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;id&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;order&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;asc&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;size&quot;</span><span class="tok-p">:</span><span class="tok-mi">3</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 251. Get a list of groups - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested groups were returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_update_a_group">13.15.3. Update a group</h4>
<div class="listingblock">
<div class="content">
<pre>PUT identity/groups/{groupId}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test group&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test type&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>All request values are optional. For example, you can only include the <em>name</em> attribute in the request body JSON-object, only updating the name of the group, leaving all other fields unaffected. When an attribute is explicitly included and is set to null, the group-value will be updated to null.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 252. Update a group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group was updated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group was updated simultaneously.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>identity/groups/{groupId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_group">13.15.4. Create a group</h4>
<div class="listingblock">
<div class="content">
<pre>POST identity/groups</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;id&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;testgroup&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;name&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test group&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;type&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;Test type&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 253. Create a group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the id of the group was missing.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Success response body:</strong> see response for <code>identity/groups/{groupId}</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_group">13.15.5. Delete a group</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE identity/groups/{groupId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 254. Delete a group - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the group to delete.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 255. Delete a group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group was found and  has been deleted. Response-body is intentionally empty.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group was not found.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_get_members_in_a_group">13.15.6. Get members in a group</h4>
<div class="paragraph">
<p>There is no GET allowed on <code>identity/groups/members</code>. Use the <code>identity/users?memberOfGroup=sales</code> URL to get all users that are part of a particular group.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_a_member_to_a_group">13.15.7. Add a member to a group</h4>
<div class="listingblock">
<div class="content">
<pre>POST identity/groups/{groupId}/members</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 256. Add a member to a group - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the group to add a member to.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Body JSON:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;userId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 257. Add a member to a group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group was found and the member has been added.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the userId was not included in the request body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group was not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested user is already a member of the group.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;userId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;groupId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/groups/sales/members/kermit&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delete_a_member_from_a_group">13.15.8. Delete a member from a group</h4>
<div class="listingblock">
<div class="content">
<pre>DELETE identity/groups/{groupId}/members/{userId}</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 258. Delete a member from a group - URL parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the group to remove a member from.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The id of the user to remove.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 259. Delete a member from a group - Response codes</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Response code</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the group was found and the member has been deleted. The response body is left empty intentionally.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the requested group was not found or that the user is not a member of the group. The status description contains additional information about the error.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Response Body:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="json"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-p">{</span>
   <span class="tok-nt">&quot;userId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;kermit&quot;</span><span class="tok-p">,</span>
   <span class="tok-nt">&quot;groupId&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;sales&quot;</span><span class="tok-p">,</span>
    <span class="tok-nt">&quot;url&quot;</span><span class="tok-p">:</span><span class="tok-s2">&quot;http://localhost:8182/identity/groups/sales/members/kermit&quot;</span>
<span class="tok-p">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cdiintegration">14. CDI integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The flowable-cdi modules leverages both the configurability of Flowable and the extensibility of cdi. The most prominent features of flowable-cdi are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for @BusinessProcessScoped beans (Cdi beans the lifecycle of which is bound to a process instance),</p>
</li>
<li>
<p>A custom El-Resolver for resolving Cdi beans (including EJBs) from the process,</p>
</li>
<li>
<p>Declarative control over a process instance using annotations,</p>
</li>
<li>
<p>Flowable is hooked-up to the cdi event bus,</p>
</li>
<li>
<p>Works with both Java EE and Java SE, works with Spring,</p>
</li>
<li>
<p>Support for unit testing.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>flowable-cdi<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>5.x<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_flowable_cdi">14.1. Setting up flowable-cdi</h3>
<div class="paragraph">
<p>Flowable cdi can be setup in different environments. In this section we briefly walk through the configuration options.</p>
</div>
<div class="sect3">
<h4 id="_looking_up_a_process_engine">14.1.1. Looking up a Process Engine</h4>
<div class="paragraph">
<p>The cdi extension needs to get access to a ProcessEngine. To achieve this, an implementation of the interface <code>org.activiti.cdi.spi.ProcessEngineLookup</code> is looked up at runtime. The cdi module ships with a default implementation named <code>org.activiti.cdi.impl.LocalProcessEngineLookup</code>, which uses  the <code>ProcessEngines</code>-Utility class for looking up the ProcessEngine. In the default configuration <code>ProcessEngines#NAME_DEFAULT</code> is used to lookup the ProcessEngine. This class might be subclassed to set a custom name. NOTE: needs an <code>activiti.cfg.xml</code> configuration on the classpath.</p>
</div>
<div class="paragraph">
<p>Flowable cdi uses a java.util.ServiceLoader SPI for resolving an instance of <code>org.activiti.cdi.spi.ProcessEngineLookup</code>. In order to provide a custom implementation of the interface, we need to add a plain text file named  <code>META-INF/services/org.activiti.cdi.spi.ProcessEngineLookup</code> to our deployment, in which we specify the fully qualified classname of the implementation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not provide a custom <code>org.activiti.cdi.spi.ProcessEngineLookup</code> implementation, Flowable will use the default <code>LocalProcessEngineLookup</code> implementation. In that case, all you need to do is providing a activiti.cfg.xml file on the classpath (see next section).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_the_process_engine">14.1.2. Configuring the Process Engine</h4>
<div class="paragraph">
<p>Configuration depends on the selected ProcessEngineLookup-Strategy (cf. previous section). Here, we focus on the configuration options available in combination with the LocalProcessEngineLookup, which requires us to provide  a Spring activiti.cfg.xml file on the classpath.</p>
</div>
<div class="paragraph">
<p>Flowable offers different ProcessEngineConfiguration implementations mostly dependent on the underlying transaction management strategy. The flowable-cdi module is not concerned with transactions, which means that potentially any transaction management strategy  can be used (even the Spring transaction abstraction). As a convenience, the cdi-module provides two custom ProcessEngineConfiguration implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.activiti.cdi.CdiJtaProcessEngineConfiguration</code>: a subclass of the Flowable JtaProcessEngineConfiguration,  can be used if JTA-managed transactions should be used for Flowable</p>
</li>
<li>
<p><code>org.activiti.cdi.CdiStandaloneProcessEngineConfiguration</code>: a subclass of the Flowable StandaloneProcessEngineConfiguration,  can be used if plain JDBC transactions should be used for Flowable. The following is an example activiti.cfg.xml file for JBoss 7:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;beans</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans&quot;</span>
	<span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
	<span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="tok-nt">&gt;</span>

	<span class="tok-c">&lt;!-- lookup the JTA-Transaction manager --&gt;</span>
	<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.jndi.JndiObjectFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jndiName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;java:jboss/TransactionManager&quot;</span><span class="tok-nt">&gt;&lt;/property&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resourceRef&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/bean&gt;</span>

	<span class="tok-c">&lt;!-- process engine configuration --&gt;</span>
	<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span>
		<span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.cdi.CdiJtaProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-c">&lt;!-- lookup the default Jboss datasource --&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSourceJndiName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;java:jboss/datasources/ExampleDS&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseType&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;h2&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-c">&lt;!-- using externally managed transactions --&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionsExternallyManaged&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/bean&gt;</span>
<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>And this is how it would look like for Glassfish 3.1.1 (assuming a datasource named jdbc/activiti is properly configured):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tok-nt">&lt;beans</span> <span class="tok-na">xmlns=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans&quot;</span>
	<span class="tok-na">xmlns:xsi=</span><span class="tok-s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
	<span class="tok-na">xsi:schemaLocation=</span><span class="tok-s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="tok-nt">&gt;</span>

	<span class="tok-c">&lt;!-- lookup the JTA-Transaction manager --&gt;</span>
	<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.springframework.jndi.JndiObjectFactoryBean&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;jndiName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;java:appserver/TransactionManager&quot;</span><span class="tok-nt">&gt;&lt;/property&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;resourceRef&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/bean&gt;</span>

	<span class="tok-c">&lt;!-- process engine configuration --&gt;</span>
	<span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span>
		<span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.cdi.CdiJtaProcessEngineConfiguration&quot;</span><span class="tok-nt">&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;dataSourceJndiName&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;jdbc/activiti&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;transactionManager&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-c">&lt;!-- using externally managed transactions --&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;transactionsExternallyManaged&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
		<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;databaseSchemaUpdate&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/bean&gt;</span>
<span class="tok-nt">&lt;/beans&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the above configuration requires the "spring-context" module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
	<span class="tok-nt">&lt;groupId&gt;</span>org.springframework<span class="tok-nt">&lt;/groupId&gt;</span>
	<span class="tok-nt">&lt;artifactId&gt;</span>spring-context<span class="tok-nt">&lt;/artifactId&gt;</span>
	<span class="tok-nt">&lt;version&gt;</span>3.0.3.RELEASE<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration in a Java SE environment looks exactly  like the examples provided in section <a href="#configuration">Creating a ProcessEngine</a>, substitute "CdiStandaloneProcessEngineConfiguration" for "StandaloneProcessEngineConfiguration".</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploying_processes">14.1.3. Deploying Processes</h4>
<div class="paragraph">
<p>Processes can be deployed using standard flowable-api (<code>RepositoryService</code>). In addition, flowable-cdi offers the possibility to  auto-deploy processes listed in a file named <code>processes.xml</code> located top-level in the classpath. This is an example  processes.xml file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="tok-c">&lt;!-- list the processes to be deployed --&gt;</span>
<span class="tok-nt">&lt;processes&gt;</span>
	<span class="tok-nt">&lt;process</span> <span class="tok-na">resource=</span><span class="tok-s">&quot;diagrams/myProcess.bpmn20.xml&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;process</span> <span class="tok-na">resource=</span><span class="tok-s">&quot;diagrams/myOtherProcess.bpmn20.xml&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/processes&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>===Contextual Process Execution with CDI</p>
</div>
<div class="paragraph">
<p>In this section we briefly look at the contextual process execution model used by the Flowable cdi extension. A BPMN business process is typically a long-running interaction, comprised of both user and system tasks. At runtime, a process is split-up into a set of individual units of work, performed by users and/or  application logic. In flowable-cdi, a process instance can be associated with a cdi scope, the association representing a  unit of work. This is particularly useful, if a unit of work is complex, for instance if the implementation of  a UserTask is a complex sequence of different forms and "non-process-scoped" state needs to be kept during this interaction.</p>
</div>
<div class="paragraph">
<p>In the default configuration, process instances are associated with the "broadest" active scope, starting with  the conversation and falling back to the request if the conversation context is not active.</p>
</div>
</div>
<div class="sect3">
<h4 id="_associating_a_conversation_with_a_process_instance">14.1.4. Associating a Conversation with a Process Instance</h4>
<div class="paragraph">
<p>When resolving @BusinessProcessScoped beans, or injecting process variables, we rely on an existing association  between an active cdi scope and a process instance. Flowable-cdi provides the <code>org.activiti.cdi.BusinessProcess</code> bean  for controlling the association, most prominently:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <em>startProcessBy(&#8230;&#8203;)</em> methods, mirroring the respective methods exposed by the Flowable <code>RuntimeService</code> allowing to start and subsequently associating a business process,</p>
</li>
<li>
<p><code>resumeProcessById(String processInstanceId)</code>, allowing to associate the process instance with the provided id,</p>
</li>
<li>
<p><code>resumeTaskById(String taskId)</code>, allowing to associate the task with the provided id (and by extension, the corresponding process instance),</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once a unit of work (for example a UserTask) is completed, the <code>completeTask()</code> method can be called to disassociate the  conversation/request from the process instance. This signals Flowable that the current task is completed and makes  the process instance proceed.</p>
</div>
<div class="paragraph">
<p>Note that the <code>BusinessProcess</code>-bean is a <code>@Named</code> bean, which means that the exposed methods can  be invoked using expression language, for example from a JSF page. The following JSF2 snippet begins a new conversation and associates it  with a user task instance, the id of which is passed as a request parameter (e.g. <code>pageName.jsf?taskId=XX</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-nt">&lt;f:metadata&gt;</span>
<span class="tok-nt">&lt;f:viewParam</span> <span class="tok-na">name=</span><span class="tok-s">&quot;taskId&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;f:event</span> <span class="tok-na">type=</span><span class="tok-s">&quot;preRenderView&quot;</span> <span class="tok-na">listener=</span><span class="tok-s">&quot;#{businessProcess.startTask(taskId, true)}&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/f:metadata&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_declaratively_controlling_the_process">14.1.5. Declaratively controlling the Process</h4>
<div class="paragraph">
<p>Flowable-cdi allows declaratively starting process instances and completing tasks using annotations. The  <code>@org.activiti.cdi.annotation.StartProcess</code> annotation allows to start a process instance  either by "key" or by "name".  Note that the process instance is started <em>after</em> the annotated method returns. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nd">@StartProcess</span><span class="tok-o">(</span><span class="tok-s">&quot;authorizeBusinessTripRequest&quot;</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">submitRequest</span><span class="tok-o">(</span><span class="tok-n">BusinessTripRequest</span> <span class="tok-n">request</span><span class="tok-o">)</span> <span class="tok-o">{</span>
	<span class="tok-c1">// do some work</span>
	<span class="tok-k">return</span> <span class="tok-s">&quot;success&quot;</span><span class="tok-o">;</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the configuration of Flowable, the code of the annotated method and the starting of the  process instance will be combined in the same transaction. The <code>@org.activiti.cdi.annotation.CompleteTask</code>-annotation works in the same way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nd">@CompleteTask</span><span class="tok-o">(</span><span class="tok-n">endConversation</span><span class="tok-o">=</span><span class="tok-kc">false</span><span class="tok-o">)</span>
<span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">authorizeBusinessTrip</span><span class="tok-o">()</span> <span class="tok-o">{</span>
	<span class="tok-c1">// do some work</span>
	<span class="tok-k">return</span> <span class="tok-s">&quot;success&quot;</span><span class="tok-o">;</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@CompleteTask</code> annotation offers the possibility to end the current conversation. The  default behavior is to end the conversation after the call to Flowable returns. Ending the conversation can be disabled,  as shown in the example above.</p>
</div>
</div>
<div class="sect3">
<h4 id="_referencing_beans_from_the_process">14.1.6. Referencing Beans from the Process</h4>
<div class="paragraph">
<p>Flowable-cdi exposes CDI beans to Flowable El, using a custom resolver. This makes it possible to reference beans from the process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nt">&lt;userTask</span> <span class="tok-na">id=</span><span class="tok-s">&quot;authorizeBusinessTrip&quot;</span> <span class="tok-na">name=</span><span class="tok-s">&quot;Authorize Business Trip&quot;</span>
			<span class="tok-na">activiti:assignee=</span><span class="tok-s">&quot;#{authorizingManager.account.username}&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where "authorizingManager" could be a bean provided by a producer method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nd">@Inject</span>	<span class="tok-nd">@ProcessVariable</span> <span class="tok-n">Object</span> <span class="tok-n">businessTripRequesterUsername</span><span class="tok-o">;</span>

<span class="tok-nd">@Produces</span>
<span class="tok-nd">@Named</span>
<span class="tok-kd">public</span> <span class="tok-n">Employee</span> <span class="tok-nf">authorizingManager</span><span class="tok-o">()</span> <span class="tok-o">{</span>
	<span class="tok-n">TypedQuery</span><span class="tok-o">&lt;</span><span class="tok-n">Employee</span><span class="tok-o">&gt;</span> <span class="tok-n">query</span> <span class="tok-o">=</span> <span class="tok-n">entityManager</span><span class="tok-o">.</span><span class="tok-na">createQuery</span><span class="tok-o">(</span><span class="tok-s">&quot;SELECT e FROM Employee e WHERE e.account.username=&#39;&quot;</span>
		<span class="tok-o">+</span> <span class="tok-n">businessTripRequesterUsername</span> <span class="tok-o">+</span> <span class="tok-s">&quot;&#39;&quot;</span><span class="tok-o">,</span> <span class="tok-n">Employee</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>
	<span class="tok-n">Employee</span> <span class="tok-n">employee</span> <span class="tok-o">=</span> <span class="tok-n">query</span><span class="tok-o">.</span><span class="tok-na">getSingleResult</span><span class="tok-o">();</span>
	<span class="tok-k">return</span> <span class="tok-n">employee</span><span class="tok-o">.</span><span class="tok-na">getManager</span><span class="tok-o">();</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can use the same feature to call a business method of an EJB in a service task, using the <code>activiti:expression="myEjb.method()"</code>-extension. Note that this requires a <code>@Named</code>-annotation on the <code>MyEjb</code>-class.</p>
</div>
</div>
<div class="sect3">
<h4 id="_working_with_businessprocessscoped_beans">14.1.7. Working with @BusinessProcessScoped beans</h4>
<div class="paragraph">
<p>Using flowable-cdi, the lifecycle of a bean can be bound to a process instance. To this extend, a custom context implementation is provided, namely the BusinessProcessContext. Instances of BusinessProcessScoped beans are stored as process variables in the current process instance. BusinessProcessScoped beans need to be PassivationCapable (for example Serializable). The following is an example of a process scoped bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-nd">@Named</span>
<span class="tok-nd">@BusinessProcessScoped</span>
<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">BusinessTripRequest</span> <span class="tok-kd">implements</span> <span class="tok-n">Serializable</span> <span class="tok-o">{</span>
	<span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-kd">final</span> <span class="tok-kt">long</span> <span class="tok-n">serialVersionUID</span> <span class="tok-o">=</span> <span class="tok-mi">1L</span><span class="tok-o">;</span>
	<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">startDate</span><span class="tok-o">;</span>
	<span class="tok-kd">private</span> <span class="tok-n">String</span> <span class="tok-n">endDate</span><span class="tok-o">;</span>
	<span class="tok-c1">// ...</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes, we want to work with process scoped beans, in the absence of an association with a process instance, for example before starting a process. If no process instance is currently active, instances of BusinessProcessScoped beans are temporarily stored in a local scope (I.e. the Conversation or the Request, depending on the context. If this scope is later associated with a business process instance, the bean instances are flushed to the process instance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_injecting_process_variables">14.1.8. Injecting Process Variables</h4>
<div class="paragraph">
<p>Process variables are available for injection. Flowable-CDI supports</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type-safe injection of <code>@BusinessProcessScoped</code> beans using <code>@Inject \[additional qualifiers\] Type fieldName</code></p>
</li>
<li>
<p>unsafe injection of other process variables using the <code>@ProcessVariable(name?)</code> qualifier:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span><span class="tok-nd">@Inject</span> <span class="tok-nd">@ProcessVariable</span> <span class="tok-n">Object</span> <span class="tok-n">accountNumber</span><span class="tok-o">;</span>
<span class="tok-nd">@Inject</span> <span class="tok-nd">@ProcessVariable</span><span class="tok-o">(</span><span class="tok-s">&quot;accountNumber&quot;</span><span class="tok-o">)</span> <span class="tok-n">Object</span> <span class="tok-n">account</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to reference process variables using EL, we have similar options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Named @BusinessProcessScoped</code> beans can be referenced directly,</p>
</li>
<li>
<p>other process variables can be referenced using the <code>ProcessVariables</code>-bean:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>#{processVariables['accountNumber']}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_receiving_process_events">14.1.9. Receiving Process Events</h4>
<div class="paragraph">
<p><a href="#experimental">[EXPERIMENTAL]</a></p>
</div>
<div class="paragraph">
<p>Flowable can be hooked-up to the CDI event-bus. This allows us to be notified of process events using standard CDI event mechanisms.  In order to enable CDI event support for Flowable, enable the corresponding parse listener in the configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;postBpmnParseHandlers&quot;</span><span class="tok-nt">&gt;</span>
	<span class="tok-nt">&lt;list&gt;</span>
		<span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.cdi.impl.event.CdiEventSupportBpmnParseHandler&quot;</span> <span class="tok-nt">/&gt;</span>
	<span class="tok-nt">&lt;/list&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now Flowable is configured for publishing events using the CDI event bus. The following gives an overview of how process events can be received in CDI beans. In CDI, we can declaratively specify event observers using the <code>@Observes</code>-annotation. Event notification is type-safe. The type of
process events is <code>org.activiti.cdi.BusinessProcessEvent</code>.
The following is an example of a simple event observer method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">onProcessEvent</span><span class="tok-o">(</span><span class="tok-nd">@Observes</span> <span class="tok-n">BusinessProcessEvent</span> <span class="tok-n">businessProcessEvent</span><span class="tok-o">)</span> <span class="tok-o">{</span>
	<span class="tok-c1">// handle event</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This observer would be notified of all events. If we want to restrict the set of events the observer receives, we can add qualifier annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@BusinessProcess</code>: restricts the set of events to a certain  process definition. Example: <code>@Observes @BusinessProcess("billingProcess") BusinessProcessEvent evt</code></p>
</li>
<li>
<p><code>@StartActivity</code>: restricts the set of events by a certain activity. For example:  <code>@Observes @StartActivity("shipGoods") BusinessProcessEvent evt</code> is invoke whenever an activity with the  id "shipGoods" is entered.</p>
</li>
<li>
<p><code>@EndActivity</code>: restricts the set of events by a certain activity. For example:  <code>@Observes @EndActivity("shipGoods") BusinessProcessEvent evt</code> is invoke whenever an activity with the  id "shipGoods" is left.</p>
</li>
<li>
<p><code>@TakeTransition</code>: restricts the set of events by a certain transition.</p>
</li>
<li>
<p><code>@CreateTask</code>: restricts the set of events by a certain task&#8217;s creation.</p>
</li>
<li>
<p><code>@DeleteTask</code>: restricts the set of events by a certain task&#8217;s deletion.</p>
</li>
<li>
<p><code>@AssignTask</code>: restricts the set of events by a certain task&#8217;s assignment.</p>
</li>
<li>
<p><code>@CompleteTask</code>: restricts the set of events by a certain task&#8217;s completion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The qualifiers named above can be combined freely. For example, in order to receive all events generated when  leaving the "shipGoods" activity in the "shipmentProcess", we could write the following observer method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">beforeShippingGoods</span><span class="tok-o">(</span><span class="tok-nd">@Observes</span> <span class="tok-nd">@BusinessProcess</span><span class="tok-o">(</span><span class="tok-s">&quot;shippingProcess&quot;</span><span class="tok-o">)</span> <span class="tok-nd">@EndActivity</span><span class="tok-o">(</span><span class="tok-s">&quot;shipGoods&quot;</span><span class="tok-o">)</span> <span class="tok-n">BusinessProcessEvent</span> <span class="tok-n">evt</span><span class="tok-o">)</span> <span class="tok-o">{</span>
	<span class="tok-c1">// handle event</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the default configuration, event listeners are invoked synchronously and in the context of the same transaction. CDI transactional observers (only available in combination with JavaEE / EJB), allow to control  when the event is handed to the observer method. Using transactional observers, we can for example assure that an observer is only  notified if the transaction in which the event is fired succeeds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">onShipmentSuceeded</span><span class="tok-o">(</span><span class="tok-nd">@Observes</span><span class="tok-o">(</span><span class="tok-n">during</span><span class="tok-o">=</span><span class="tok-n">TransactionPhase</span><span class="tok-o">.</span><span class="tok-na">AFTER_SUCCESS</span><span class="tok-o">)</span> <span class="tok-nd">@BusinessProcess</span><span class="tok-o">(</span><span class="tok-s">&quot;shippingProcess&quot;</span><span class="tok-o">)</span> <span class="tok-nd">@EndActivity</span><span class="tok-o">(</span><span class="tok-s">&quot;shipGoods&quot;</span><span class="tok-o">)</span> <span class="tok-n">BusinessProcessEvent</span> <span class="tok-n">evt</span><span class="tok-o">)</span> <span class="tok-o">{</span>
	<span class="tok-c1">// send email to customer.</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_additional_features">14.1.10. Additional Features</h4>
<div class="ulist">
<ul>
<li>
<p>The ProcessEngine as well as the services are available for injection: <code>@Inject ProcessEngine, RepositoryService, TaskService</code>, &#8230;&#8203;</p>
</li>
<li>
<p>The current process instance and task can be injected: <code>@Inject ProcessInstance, Task</code>,</p>
</li>
<li>
<p>The current business key can be injected:  <code>@Inject @BusinessKey String businessKey</code>,</p>
</li>
<li>
<p>The current process instance id be injected:  <code>@Inject @ProcessInstanceId String pid</code>,</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_known_limitations">14.2. Known Limitations</h3>
<div class="paragraph">
<p>Although flowable-cdi is implemented against the SPI and designed to be a "portable-extension" it is only tested using Weld.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chapter_ldap">15. LDAP integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Companies often already have a user and group store in the form of an LDAP system. Flowable offers an out-of-the-box solution for easily configuring how Flowable should connect with an LDAP system.</p>
</div>
<div class="paragraph">
<p>In earlier versions, it was already possible to integrate LDAP, but since then, the configuration has been simplified a lot. However, the <em>old</em> way of configuring LDAP still works. More specifically, the simplified configuration is just a wrapper on top of the <em>old</em> infrastructure.</p>
</div>
<div class="sect2">
<h3 id="ldap_usage">15.1. Usage</h3>
<div class="paragraph">
<p>To add the LDAP integration code to your project, simply add the following dependency to your pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>flowable-ldap<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>latest.version<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ldap_usecases">15.2. Use cases</h3>
<div class="paragraph">
<p>The LDAP integration has currently two main use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allow for authentication through the IdentityService. This could be useful when doing everything through the IdentityService.</p>
</li>
<li>
<p>Fetching the groups of a user. This is important when for example querying tasks to see which tasks a certain user can see (i.e. tasks with a candidate group).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="ldap_configuration">15.3. Configuration</h3>
<div class="paragraph">
<p>Integrating the LDAP system with Flowable is done by injecting an instance of <code>org.activiti.ldap.LDAPConfigurator</code> in the <code>configurators</code> section of the process engine configuration. This class is highly extensible: methods can be easily overridden and many dependent beans are pluggable if the default implementation would not fit the use case.</p>
</div>
<div class="paragraph">
<p>This is an example configuration (note: of course, when creating the engine programmatically this is completely similar). Don&#8217;t worry about all the properties for now, we&#8217;ll look at them in detail in a next section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</div></td><td class="code"><span></span>    <span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;...SomeProcessEngineConfigurationClass&quot;</span><span class="tok-nt">&gt;</span>
        ...
        <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;configurators&quot;</span><span class="tok-nt">&gt;</span>
          <span class="tok-nt">&lt;list&gt;</span>
              <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.ldap.LDAPConfigurator&quot;</span><span class="tok-nt">&gt;</span>

                <span class="tok-c">&lt;!-- Server connection params --&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;server&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;ldap://localhost&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;port&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;33389&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;user&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;uid=admin, ou=users, o=flowable&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;password&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;pass&quot;</span> <span class="tok-nt">/&gt;</span>

                <span class="tok-c">&lt;!-- Query params --&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;baseDn&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;o=flowable&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;queryUserByUserId&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;(&amp;(objectClass=inetOrgPerson)(uid={0}))&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;queryUserByFullNameLike&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;(&amp;(objectClass=inetOrgPerson)(|({0}=*{1}*)({2}=*{3}*)))&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;queryGroupsForUser&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;(&amp;(objectClass=groupOfUniqueNames)(uniqueMember={0}))&quot;</span> <span class="tok-nt">/&gt;</span>

                <span class="tok-c">&lt;!-- Attribute config --&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;userIdAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;uid&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;userFirstNameAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;cn&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;userLastNameAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;sn&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;userEmailAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;mail&quot;</span> <span class="tok-nt">/&gt;</span>


                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;groupIdAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;cn&quot;</span> <span class="tok-nt">/&gt;</span>
                <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;groupNameAttribute&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;cn&quot;</span> <span class="tok-nt">/&gt;</span>

              <span class="tok-nt">&lt;/bean&gt;</span>
          <span class="tok-nt">&lt;/list&gt;</span>
        <span class="tok-nt">&lt;/property&gt;</span>
    <span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ldap_properties">15.4. Properties</h3>
<div class="paragraph">
<p>Following properties can be set on <code>org.activiti.ldap.LDAPConfigurator</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.LDAP configuration properties</pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The server on which the LDAP system can be reached. For example <em>ldap://localhost:33389</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port on which the LDAP system is running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The user id that is used to connect to the LDAP system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password that is used to connect to the LDAP system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialContextFactory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The InitialContextFactory name used to connect to the LDAP system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.sun.jndi.ldap.LdapCtxFactory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">securityAuthentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The value that is used for the <em>java.naming.security.authentication</em> property used to connect to the LDAP system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">simple</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">customConnectionParameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to set all LDAP connection parameters which do not have a dedicated setter.
                            See for example <a href="http://docs.oracle.com/javase/tutorial/jndi/ldap/jndi.html" class="bare">http://docs.oracle.com/javase/tutorial/jndi/ldap/jndi.html</a> for custom
                            properties. Such properties are for example to configure connection pooling, specific
                            security settings, etc. All the provided parameters will be provided when creating a
                            connection to the LDAP system.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, String&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">baseDn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base <em>distinguished name</em> (DN) from which the searches for users and groups are started</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userBaseDn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base <em>distinguished name</em> (DN) from which the searches for users are started. If not provided, baseDn (see above) will be used</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupBaseDn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The base <em>distinguished name</em> (DN) from which the searches for groups are started. If not provided, baseDn (see above) will be used</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">searchTimeLimit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timeout that is used when doing a search in LDAP in milliseconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">one hour</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryUserByUserId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The query that is executed when searching for a user by userId.
                            For example: (&amp;(objectClass=inetOrgPerson)(uid={0}))
                            Here, all the objects in LDAP with the class <em>inetOrgPerson</em>
                            and who have the matching <em>uid</em> attribute value will be returned.
                            As shown in the example, the user id is injected by using
                            {0}. If setting the query alone is insufficient for your specific
                            LDAP setup, you can alternatively plug in a different
                            LDAPQueryBuilder, which allows for more customization than only the  query.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryUserByFullNameLike</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The query that is executed when searching for a user by full name.
                            For example: (&amp; (objectClass=inetOrgPerson) (</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">({0}=<strong>{1}</strong>)({2}=<strong>{3}</strong>)) )
                            Here, all the objects in LDAP with the class <em>inetOrgPerson</em>
                            and who have the matching first name and last name values will be returned.
                            Note that {0} injects the firstNameAttribute (as defined above), {1} and {3} the search text
                            and {2} the lastNameAttribute. If setting the query alone is insufficient for your specific
                            LDAP setup, you can alternatively plug in a different
                            LDAPQueryBuilder, which allows for more customization than only the  query.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryGroupsForUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The query that is executed when searching for the groups of a specific user.
                            For example: (&amp;(objectClass=groupOfUniqueNames)(uniqueMember={0}))
                            Here, all the objects in LDAP with the class <em>groupOfUniqueNames</em>
                            and where the provided DN (matching a DN for a user) is a <em>uniqueMember</em> are returned.
                            As shown in the example, the user id is injected by using {0}
                            If setting the query alone is insufficient for your specific
                            LDAP setup, you can alternatively plug in a different
                            LDAPQueryBuilder, which allows for more customization than only the  query.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">userIdAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the user id.
                            This property is used when looking for a User object
                            and the mapping between the LDAP object and the Flowable User object
                            is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">userFirstNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the user first name.
                            This property is used when looking for a User object
                            and the mapping between the LDAP object and the Flowable User object is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">userLastNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the user last name.
                            This property is used when looking for a User object
                            and the mapping between the LDAP object and the Flowable User object is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupIdAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the group id.
                            This property is used when looking for a Group object
                            and the mapping between the LDAP object and the Flowable Group object is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the group name.
                            This property is used when looking for a Group object
                            and the mapping between the LDAP object and the Flowable Group object is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupTypeAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the attribute that matches the group type.
                            This property is used when looking for a Group object
                            and the mapping between the LDAP object and the Flowable Group object
                            is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Following properties are when one wants to customize default behavior or introduced group caching:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 260. Advanced properties</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapUserManagerFactory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set a custom implementation of the LDAPUserManagerFactory if the default implementation is not suitable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance of LDAPUserManagerFactory</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapGroupManagerFactory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set a custom implementation of the LDAPGroupManagerFactory if the default implementation is not suitable.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">instance of LDAPGroupManagerFactory</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapMemberShipManagerFactory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set a custom implementation of the LDAPMembershipManagerFactory if the default implementation is not suitable.
                            Note that this is very unlikely, as membership are managed in the LDAP system itself normally.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An instance of LDAPMembershipManagerFactory</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapQueryBuilder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set a custom query builder if the default implementation is not suitable.
                            The LDAPQueryBuilder instance is used when the LDAPUserManager or
                            LDAPGroupManage} does an actual query against the LDAP system.
                            The default implementation uses the properties as set on this instance
                            such as queryGroupsForUser and queryUserById</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An instance of org.activiti.ldap.LDAPQueryBuilder</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupCacheSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to set the size of the group cache.
                            This is an LRU cache that caches groups for users and thus
                            avoids hitting the LDAP system each time the groups of
                            a user needs to be known.
</p><p class="tableblock">                            The cache will not be instantiated if the value is less than zero.
                            By default set to -1, so no caching is done.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupCacheExpirationTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the expiration time of the group cache in milliseconds.
                            When groups for a specific user are fetched, and if the group cache exists,
                            the groups will be stored in this cache for the time set in this property.
                            I.e. when the groups were fetched at 00:00 and the expiration time is 30 minutes,
                            any fetch of the groups for that user after 00:30 will not come from the cache, but do
                            a fetch again from the LDAP system. Likewise, everything group fetch for that user done
                            between 00:00 - 00:30 will come from the cache.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">one hour</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note when using Active Directory: people have reported that for Active Directory, the <em>InitialDirContext</em> needs to be set to Context.REFERRAL. This can be passed through the customConnectionParameters map as described above.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_advanced">16. Advanced</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections cover advanced use cases of Flowable, that go beyond typical execution of BPMN 2.0 processes. As such, a certain proficiency and experience with Flowable is advised to understand the topics described here.</p>
</div>
<div class="sect2">
<h3 id="_async_and_job_executor">16.1. Async and job executor</h3>
<div class="paragraph">
<p>Starting from version 5.17.0 Flowable provides the Async executor in addition to the existing job executor. Both executors deal with timers and asynchronous jobs in the Flowable Engine, so only one executor can be enabled.
This section will explain the difference between the Async executor and the job executor and why we recommend to use the Async executor. Note that by default Flowable uses the existing job executor because we don&#8217;t want to enable the Async executor without making an explicit configuration for it.</p>
</div>
<div class="sect3">
<h4 id="_async_executor_design">16.1.1. Async executor design</h4>
<div class="paragraph">
<p>The Async executor contains a thread pool to execute timer and asynchronous jobs. When enabled, the Engine will call the Async executor with a persisted asynchronous job entity and the thread pool will asynchronously execute the job.
This is major difference with the old Job executor, because in that case the asynchronous job is persisted and the job executor will poll the database for new jobs.
In case a job is found it will lock the job and execute it, which means a lot of additional database traffic. The Async executor will execute the asynchronous job directly without first polling the database.
In case the asynchronous job is an exclusive job, the Async executor will first lock the process instance execution and if that succeeds execute the job and unlock the process instance execution again.
If the process instance lock fails, it will retry.</p>
</div>
<div class="paragraph">
<p>In the case of timer jobs the logic is different from asynchronous jobs and the implementation is similar between the Async and the Job executor.
The Async executor will poll the database for timer jobs which are due to be executed. The job will then be locked and executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_job_executor_design">16.1.2. Job executor design</h4>
<div class="paragraph">
<p>The job executor also contains a thread pool to execute timer and asynchronous jobs. When activated, the Job executor will poll the database for asynchronous jobs and timer jobs due.
In case a job is found it will lock the job and execute it, which means a lot of additional database traffic. On the other side, the Async executor will execute the asynchronous job directly without first polling the database.</p>
</div>
</div>
<div class="sect3">
<h4 id="_advantages_of_the_async_executor">16.1.3. Advantages of the Async executor</h4>
<div class="ulist">
<ul>
<li>
<p>Less database queries because asynchronous jobs are executed without polling the database</p>
</li>
<li>
<p>For non-exclusive jobs there&#8217;s no chance to run into OptimisticLockingExceptions anymore</p>
</li>
<li>
<p>Exclusive jobs are now locked at process instance level instead of the cumbersome logic of queuing exclusive jobs in the Job Executor</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_async_executor_configuration">16.1.4. Async executor configuration</h4>
<div class="paragraph">
<p>It&#8217;s possible to define thread pool sizes and other configurations for the Async executor.
It&#8217;s always advised to look into the default settings of the Async executor and validate if they match the requirements of your process instances.</p>
</div>
<div class="paragraph">
<p>To override the default settings of the job executor a new bean needs to be injected into the process engine configuration, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;asyncExecutor&quot;</span> <span class="tok-na">ref=</span><span class="tok-s">&quot;asyncExecutor&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default Async executor can be used to override the default settings, but you can of course also extend from the DefaultAsyncJobExecutor class.
In the following configuration listing, the DefaultAsyncJobExecutor is used with new values for its properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;asyncExecutor&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.asyncexecutor.DefaultAsyncJobExecutor&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;corePoolSize&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;10&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;maxPoolSize&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;50&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;keepAliveTime&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;3000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;queueSize&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;200&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;maxTimerJobsPerAcquisition&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;2&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;maxAsyncJobsDuePerAcquisition&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;2&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;defaultAsyncJobAcquireWaitTimeInMillis&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;1000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;defaultTimerJobAcquireWaitTimeInMillis&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;1000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;timerLockTimeInMillis&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;60000&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;asyncJobLockTimeInMillis&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;60000&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 261. Async executor configuration options</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">corePoolSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimal number of threads that are kept alive in the thread pool for job execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxPoolSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of threads that are kept alive in the thread pool for job execution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">keepAliveTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time (in milliseconds) a thread used for job execution must be kept alive before it is destroyed. Default setting is 0. Having a non-default setting of 0 takes resources, but in the case of many job executions it avoids creating new threads all the time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queueSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The size of the queue on which jobs to be executed are placed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxTimerJobsPerAcquisition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of timer jobs that are fetched from the database in one query.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxAsyncJobsDuePerAcquisition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of asynchronous jobs due that are fetched from the database in one query.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultAsyncJobAcquireWaitTimeInMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time in milliseconds between asynchronous job due queries being executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultTimerJobAcquireWaitTimeInMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time in milliseconds between timer job queries being executed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timerLockTimeInMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time in milliseconds that a timer job is locked before being retried again. The Flowable Engine considers the timer job to have failed after this period of time and will retry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">asyncJobLockTimeInMillis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time in milliseconds that an asynchronous job is locked before being retried again. The Flowable Engine considers the asynchronous job to have failed after this period of time and will retry.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="advanced_parseHandlers">16.2. Hooking into process parsing</h3>
<div class="paragraph">
<p>A BPMN 2.0 xml needs to be parsed to the Flowable internal model to be executed on the Flowable engine. This parsing happens during a deployment of the process or when a process is not found in memory, and the xml is fetched from the database.</p>
</div>
<div class="paragraph">
<p>For each of these processes, the <code>BpmnParser</code> class creates a new <code>BpmnParse</code> instance. This instance will be used as container for all things that are done during parsing. The parsing on itself is very simple: for each BPMN 2.0 element, there is a matching instance of the <code>org.activiti.engine.parse.BpmnParseHandler</code> available in the engine. As such, the parser has a map which basically maps a BPMN 2.0 element class to an instance of <code>BpmnParseHandler</code>. By default, Flowable has <code>BpmnParseHandler</code> instances to handle all supported elements and also uses it to attach execution listeners to steps of the process for creating the history.</p>
</div>
<div class="paragraph">
<p>It is possible to add custom instances of <code>org.activiti.engine.parse.BpmnParseHandler</code> to the Flowable engine. An often seen use case is for example to add execution listeners to certain steps that fire events to some queue for event processing. The history handling is done in such a way internally in Flowable. To add such custom handlers, the Flowable configuration needs to be tweaked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;preBpmnParseHandlers&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;list&gt;</span>
    <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.parsing.MyFirstBpmnParseHandler&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/list&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>

<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;postBpmnParseHandlers&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;list&gt;</span>
    <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.parsing.MySecondBpmnParseHandler&quot;</span> <span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.parsing.MyThirdBpmnParseHandler&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/list&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The list of <code>BpmnParseHandler</code> instances that is configured in the <code>preBpmnParseHandlers</code> property are added before any of the default handlers. Likewise, the <code>postBpmnParseHandlers</code> are added after those. This can be important if the order of things matter for the logic contained in the custom parse handlers.</p>
</div>
<div class="paragraph">
<p><code>org.activiti.engine.parse.BpmnParseHandler</code> is a simple interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">BpmnParseHandler</span> <span class="tok-o">{</span>

  <span class="tok-n">Collection</span><span class="tok-o">&lt;</span><span class="tok-n">Class</span><span class="tok-o">&gt;?</span> <span class="tok-kd">extends</span> <span class="tok-n">BaseElement</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">getHandledTypes</span><span class="tok-o">();</span>

  <span class="tok-kt">void</span> <span class="tok-nf">parse</span><span class="tok-o">(</span><span class="tok-n">BpmnParse</span> <span class="tok-n">bpmnParse</span><span class="tok-o">,</span> <span class="tok-n">BaseElement</span> <span class="tok-n">element</span><span class="tok-o">);</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>getHandledTypes()</code> method returns a collection of all the types handled by this parser.  The possible types are a subclass of <code>BaseElement</code>, as directed by the generic type of the collection. You can also extend the <code>AbstractBpmnParseHandler</code> class and override the <code>getHandledType()</code> method, which only returns one Class and not a collection. This class contains also some helper methods shared by many of the default parse handlers.  The <code>BpmnParseHandler</code> instance will be called when the parser encounters any of the returned types by this method. In the following example, whenever a process contained in a BPMN 2.0 xml is encountered, it  will execute the logic in the <code>executeParse</code> method (which is a typecasted method that replaces the regular <code>parse</code> method on the <code>BpmnParseHandler</code> interface).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">TestBPMNParseHandler</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractBpmnParseHandler</span><span class="tok-o">&lt;</span><span class="tok-n">Process</span><span class="tok-o">&gt;</span> <span class="tok-o">{</span>

  <span class="tok-kd">protected</span> <span class="tok-n">Class</span><span class="tok-o">&lt;?</span> <span class="tok-kd">extends</span> <span class="tok-n">BaseElement</span><span class="tok-o">&gt;</span> <span class="tok-nf">getHandledType</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">Process</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">protected</span> <span class="tok-kt">void</span> <span class="tok-nf">executeParse</span><span class="tok-o">(</span><span class="tok-n">BpmnParse</span> <span class="tok-n">bpmnParse</span><span class="tok-o">,</span> <span class="tok-n">Process</span> <span class="tok-n">element</span><span class="tok-o">)</span> <span class="tok-o">{</span>
     <span class="tok-o">..</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Important note:</strong> when writing custom parse handler, do not use any of the internal  classes that are used to parse the BPMN 2.0 constructs. This will cause difficult to find bugs. The safe way to implement a custom handler is to implement the <em>BpmnParseHandler</em> interface or extends the internal abstract class <em>org.activiti.engine.impl.bpmn.parser.handler.AbstractBpmnParseHandler</em>.</p>
</div>
<div class="paragraph">
<p>It is possible (but less common) to replace the default <code>BpmnParseHandler</code> instances that are responsible for the parsing of the BPMN 2.0 elements to the internal Flowable model. This can be done by following snippet of logic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;customDefaultBpmnParseHandlers&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;list&gt;</span>
    ...
  <span class="tok-nt">&lt;/list&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>A simple example could for example be to force all of the service tasks to be asynchronous:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CustomUserTaskBpmnParseHandler</span> <span class="tok-kd">extends</span> <span class="tok-n">ServiceTaskParseHandler</span> <span class="tok-o">{</span>

  <span class="tok-kd">protected</span> <span class="tok-kt">void</span> <span class="tok-nf">executeParse</span><span class="tok-o">(</span><span class="tok-n">BpmnParse</span> <span class="tok-n">bpmnParse</span><span class="tok-o">,</span> <span class="tok-n">ServiceTask</span> <span class="tok-n">serviceTask</span><span class="tok-o">)</span> <span class="tok-o">{</span>

    <span class="tok-c1">// Do the regular stuff</span>
    <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">executeParse</span><span class="tok-o">(</span><span class="tok-n">bpmnParse</span><span class="tok-o">,</span> <span class="tok-n">serviceTask</span><span class="tok-o">);</span>

    <span class="tok-c1">// Make always async</span>
    <span class="tok-n">ActivityImpl</span> <span class="tok-n">activity</span> <span class="tok-o">=</span> <span class="tok-n">findActivity</span><span class="tok-o">(</span><span class="tok-n">bpmnParse</span><span class="tok-o">,</span> <span class="tok-n">serviceTask</span><span class="tok-o">.</span><span class="tok-na">getId</span><span class="tok-o">());</span>
    <span class="tok-n">activity</span><span class="tok-o">.</span><span class="tok-na">setAsync</span><span class="tok-o">(</span><span class="tok-kc">true</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced.uuid.generator">16.3. UUID id generator for high concurrency</h3>
<div class="paragraph">
<p>In some (very) high concurrency load cases, the default id generator may cause exceptions due to not being able to fetch new id blocks quickly enough. Every process engine has one id generator. The default id generator reserves a block of ids in the database, such that no other engine will be able to use id&#8217;s from the same block. During  engine operations, when the default id generator notices that the id block is used up, a new transaction is started to fetch a new block. In (very) limited use cases this can cause problems when there is a real high load. For most use cases the default id generator is more than sufficient. The default <code>org.activiti.engine.impl.db.DbIdGenerator</code> also has a property <code>idBlockSize</code> which can be configured to set the size of the reserved block of ids and to tweak the behavior of the id fetching.</p>
</div>
<div class="paragraph">
<p>The alternative to the default id generator is the <code>org.activiti.engine.impl.persistence.StrongUuidGenerator</code>, which generates a unique <a href="http://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a> locally and uses that as identifier for all entities. Since the UUID is generated without the need for database access, it copes better with very high concurrency use cases. Do note that performance may differ from the default id generator (both positive and negative) depending on the machine.</p>
</div>
<div class="paragraph">
<p>The UUID generator can be configured in the Flowable configuration as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;idGenerator&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.engine.impl.persistence.StrongUuidGenerator&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The use of the UUID id generator depends on the following extra dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span> <span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>com.fasterxml.uuid<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>java-uuid-generator<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>3.1.3<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced.tenancy">16.4. Multitenancy</h3>
<div class="paragraph">
<p>Multitenancy in general is a concept where the software is capable of serving multiple different organizations. Key is that the data is partitioned and no organization can see the data of other ones. In this context, such an organization (or a department, or a team or &#8230;&#8203;) is called a <em>tenant</em>.</p>
</div>
<div class="paragraph">
<p>Note that this is fundamentally different from a multi-instance setup, where a Flowable Process Engine instance is running for each organization separately (and with a different database schema). Although Flowable is lightweight, and running a Process Engine instance doesn&#8217;t take much resources, it does add complexity and more maintenance. But, for some use cases it might be the right solution.</p>
</div>
<div class="paragraph">
<p>Multitenancy in Flowable is mainly implemented around partitioning the data. It is important to  note that <em>Flowable does not enforce multi tenancy rules</em>. This means it will not verify when querying and using data whether the user doing the operation is belonging to the correct tenant. This should be done in the layer calling the Flowable engine. Flowable does make sure that tenant information can be stored and used when retrieving process data.</p>
</div>
<div class="paragraph">
<p>When deploying process definition to the Flowable Process Engine it is possible to pass a <em>tenant identifier</em>. This is a string (e.g. a UUID, department id, etc.), limited to 256 characters which is uniquely identifies the tenant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4</div></td><td class="code"><span></span><span class="tok-n">repositoryService</span><span class="tok-o">.</span><span class="tok-na">createDeployment</span><span class="tok-o">()</span>
            <span class="tok-o">.</span><span class="tok-na">addClassPathResource</span><span class="tok-o">(...)</span>
            <span class="tok-o">.</span><span class="tok-na">tenantId</span><span class="tok-o">(</span><span class="tok-s">&quot;myTenantId&quot;</span><span class="tok-o">)</span>
            <span class="tok-o">.</span><span class="tok-na">deploy</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Passing a tenant id during a deployment has following implications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All the process definitions contained in the deployment inherit the tenant identifier from this deployment.</p>
</li>
<li>
<p>All process instances started from those process definitions inherit this tenant identifier from the process definition.</p>
</li>
<li>
<p>All tasks created at runtime when executing the process instance inherit this tenant identifier from the process instance. Standalone tasks can have a tenant identifier too.</p>
</li>
<li>
<p>All executions created during process instance execution inherit this tenant identifier from the process instance.</p>
</li>
<li>
<p>Firing a signal throw event (in the process itself or through the API) can be done whilst providing a tenant identifier. The signal will only be executed in the tenant context: i.e. if there are multiple signal catch events with the same name, only the one with the correct tenant identifier will actually be called.</p>
</li>
<li>
<p>All jobs (timers and async continuations) inherit the tenant identifier from either the process definition (e.g. timer start event) or the process instance (when a job is created at runtime, e.g. an async continuation). This could potentially be used for giving priority to some tenants in a custom job executor.</p>
</li>
<li>
<p>All the historic entities (historic process instance, task and activities) inherit the tenant identifier from their runtime counterparts.</p>
</li>
<li>
<p>As a side note, models can have a tenant identifier too (models are used e.g. by the Flowable modeler to store BPMN 2.0 models).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To actually make use of the tenant identifier on the process data, all the query API&#8217;s have the capability to filter on tenant. For example (and can be replaced by the relevant query implementation of the other entities):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-n">runtimeService</span><span class="tok-o">.</span><span class="tok-na">createProcessInstanceQuery</span><span class="tok-o">()</span>
    <span class="tok-o">.</span><span class="tok-na">processInstanceTenantId</span><span class="tok-o">(</span><span class="tok-s">&quot;myTenantId&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">processDefinitionKey</span><span class="tok-o">(</span><span class="tok-s">&quot;myProcessDefinitionKey&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">variableValueEquals</span><span class="tok-o">(</span><span class="tok-s">&quot;myVar&quot;</span><span class="tok-o">,</span> <span class="tok-s">&quot;someValue&quot;</span><span class="tok-o">)</span>
    <span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The query API&#8217;s also allow to filter on the tenant identifier with <em>like</em> semantics  and also to filter out entities without tenant id.</p>
</div>
<div class="paragraph">
<p><strong>Important implementation detail:</strong> due to database quirks (more specifically: null handling in unique constraints) the <em>default</em> tenant identifier value indicating <em>no tenant</em> is the <strong>empty string</strong>. The combination of (process definition key, process definition version, tenant identifier) needs to be unique (and there is a database constraint checking this). Also note that the tenant identifier shouldn&#8217;t be set to null, as this will affect the queries since certain databases (Oracle) treat empty string as a null value (that&#8217;s why the query <em>.withoutTenantId</em> does a check against the empty string or null). This means that the same process definition (with same process definition key) can be deployed for multiple tenants, each with their own versioning. This does not affect the usage when tenancy is not used.</p>
</div>
<div class="paragraph">
<p><strong>Do note that all of the above does not conflict with running multiple Flowable instances in a cluster.</strong></p>
</div>
<div class="paragraph">
<p>[Experimental] It is possible to change the tenant identifier by calling the <em>changeDeploymentTenantId(String deploymentId, String newTenantId)</em> method on the <em>repositoryService</em>. This will change the tenant identifier everywhere it was inherited before. This can be useful when going from a non-multitenant setup to a multitenant configuration. See the Javadoc on the method for more detailed information.</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced.custom.sql.queries">16.5. Execute custom SQL</h3>
<div class="paragraph">
<p>The Flowable API allows for interacting with the database using a high level API. For example, for retrieving data the Query API and the Native Query API are powerful in its usage. However, for some use cases they might not be flexible enough. The following section describes how a completely custom SQL statement (select, insert, update and delete are possible) can be executed against the Flowable data store, but completely within the configured Process Engine (and thus levering the transaction setup for example).</p>
</div>
<div class="paragraph">
<p>To define custom SQL statements, the Flowable engine leverages the capabilities of its underlying framework, MyBatis. More info can be read  <a href="http://mybatis.github.io/mybatis-3/java-api.html">in the MyBatis user guide</a>.</p>
</div>
<div class="sect3">
<h4 id="_annotation_based_mapped_statements">16.5.1. Annotation based Mapped Statements</h4>
<div class="paragraph">
<p>The first thing to do when using Annotation based Mapped Statements, is to create a MyBatis mapper class. For example, suppose that for some use case not the whole task data is needed, but only a small subset of it. A Mapper that could do this, looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">interface</span> <span class="tok-nc">MyTestMapper</span> <span class="tok-o">{</span>

    <span class="tok-nd">@Select</span><span class="tok-o">(</span><span class="tok-s">&quot;SELECT ID_ as id, NAME_ as name, CREATE_TIME_ as createTime FROM ACT_RU_TASK&quot;</span><span class="tok-o">)</span>
    <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">selectTasks</span><span class="tok-o">();</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This mapper must be provided to the Process Engine configuration as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span>...
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;customMybatisMappers&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;set&gt;</span>
    <span class="tok-nt">&lt;value&gt;</span>org.activiti.standalone.cfg.MyTestMapper<span class="tok-nt">&lt;/value&gt;</span>
  <span class="tok-nt">&lt;/set&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that this is an interface. The underlying MyBatis framework will make an instance of it that can be used at runtime. Also notice that the return value of the method is not typed, but a list of maps (which corresponds to the list of rows with column values). Typing is possible with the MyBatis mappers if wanted.</p>
</div>
<div class="paragraph">
<p>To execute the query above, the <em>managementService.executeCustomSql</em> method must be used. This method takes in a <em>CustomSqlExecution</em> instance. This is a wrapper that hides the internal bits of the engine otherwise needed to make it work.</p>
</div>
<div class="paragraph">
<p>Unfortunately, Java generics make it a bit less readable than it could have been. The two generic types below are the mapper class and the return type class. However, the actual logic is simply to call the mapper method and return its results (if applicable).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-n">CustomSqlExecution</span><span class="tok-o">&lt;</span><span class="tok-n">MyTestMapper</span><span class="tok-o">,</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;&gt;</span> <span class="tok-n">customSqlExecution</span> <span class="tok-o">=</span>
          <span class="tok-k">new</span> <span class="tok-n">AbstractCustomSqlExecution</span><span class="tok-o">&lt;</span><span class="tok-n">MyTestMapper</span><span class="tok-o">,</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;&gt;(</span><span class="tok-n">MyTestMapper</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">)</span> <span class="tok-o">{</span>

  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">MyTestMapper</span> <span class="tok-n">customMapper</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">customMapper</span><span class="tok-o">.</span><span class="tok-na">selectTasks</span><span class="tok-o">();</span>
  <span class="tok-o">}</span>

<span class="tok-o">};</span>

<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;</span> <span class="tok-n">results</span> <span class="tok-o">=</span> <span class="tok-n">managementService</span><span class="tok-o">.</span><span class="tok-na">executeCustomSql</span><span class="tok-o">(</span><span class="tok-n">customSqlExecution</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Map entries in the list above will only contain <em>id, name and create time</em> in this case and not the full task object.</p>
</div>
<div class="paragraph">
<p>Any SQL is possible when using the approach above. Another more complex example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6</div></td><td class="code"><span></span>    <span class="tok-nd">@Select</span><span class="tok-o">({</span>
        <span class="tok-s">&quot;SELECT task.ID_ as taskId, variable.LONG_ as variableValue FROM ACT_RU_VARIABLE variable&quot;</span><span class="tok-o">,</span>
        <span class="tok-s">&quot;inner join ACT_RU_TASK task on variable.TASK_ID_ = task.ID_&quot;</span><span class="tok-o">,</span>
        <span class="tok-s">&quot;where variable.NAME_ = #{variableName}&quot;</span>
    <span class="tok-o">})</span>
    <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Map</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">,</span> <span class="tok-n">Object</span><span class="tok-o">&gt;&gt;</span> <span class="tok-nf">selectTaskWithSpecificVariable</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">variableName</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this method, the task table will be joined with the variables table. Only where the variable has a certain name is retained, and the task id and the corresponding numerical value is returned.</p>
</div>
<div class="paragraph">
<p>For a working example on using Annotation based Mapped Statements check the unit test <em>org.activiti.standalone.cfg.CustomMybatisMapperTest</em> and other classes and resources in folders src/test/java/org/activiti/standalone/cfg/ and src/test/resources/org/activiti/standalone/cfg/</p>
</div>
</div>
<div class="sect3">
<h4 id="_xml_based_mapped_statements">16.5.2. XML based Mapped Statements</h4>
<div class="paragraph">
<p>When using XML based Mapped Statements, statements are defined in XML files. For the use case where not the whole task data is needed, but only a small subset of it. The XML file can look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-nt">&lt;mapper</span> <span class="tok-na">namespace=</span><span class="tok-s">&quot;org.activiti.standalone.cfg.TaskMapper&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;resultMap</span> <span class="tok-na">id=</span><span class="tok-s">&quot;customTaskResultMap&quot;</span> <span class="tok-na">type=</span><span class="tok-s">&quot;org.activiti.standalone.cfg.CustomTask&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;id</span> <span class="tok-na">property=</span><span class="tok-s">&quot;id&quot;</span> <span class="tok-na">column=</span><span class="tok-s">&quot;ID_&quot;</span> <span class="tok-na">jdbcType=</span><span class="tok-s">&quot;VARCHAR&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;result</span> <span class="tok-na">property=</span><span class="tok-s">&quot;name&quot;</span> <span class="tok-na">column=</span><span class="tok-s">&quot;NAME_&quot;</span> <span class="tok-na">jdbcType=</span><span class="tok-s">&quot;VARCHAR&quot;</span><span class="tok-nt">/&gt;</span>
    <span class="tok-nt">&lt;result</span> <span class="tok-na">property=</span><span class="tok-s">&quot;createTime&quot;</span> <span class="tok-na">column=</span><span class="tok-s">&quot;CREATE_TIME_&quot;</span> <span class="tok-na">jdbcType=</span><span class="tok-s">&quot;TIMESTAMP&quot;</span> <span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/resultMap&gt;</span>

  <span class="tok-nt">&lt;select</span> <span class="tok-na">id=</span><span class="tok-s">&quot;selectCustomTaskList&quot;</span> <span class="tok-na">resultMap=</span><span class="tok-s">&quot;customTaskResultMap&quot;</span><span class="tok-nt">&gt;</span>
    select RES.ID_, RES.NAME_, RES.CREATE_TIME_ from ACT_RU_TASK RES
  <span class="tok-nt">&lt;/select&gt;</span>

<span class="tok-nt">&lt;/mapper&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Results are mapped to instances of <em>org.activiti.standalone.cfg.CustomTask</em> class which can look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">CustomTask</span> <span class="tok-o">{</span>

  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">id</span><span class="tok-o">;</span>
  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">name</span><span class="tok-o">;</span>
  <span class="tok-kd">protected</span> <span class="tok-n">Date</span> <span class="tok-n">createTime</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getId</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">id</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
  <span class="tok-kd">public</span> <span class="tok-n">String</span> <span class="tok-nf">getName</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">name</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
  <span class="tok-kd">public</span> <span class="tok-n">Date</span> <span class="tok-nf">getCreateTime</span><span class="tok-o">()</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">createTime</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Mapper XML files must be provided to the Process Engine configuration as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7</div></td><td class="code"><span></span>...
<span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;customMybatisXMLMappers&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;set&gt;</span>
    <span class="tok-nt">&lt;value&gt;</span>org/activiti/standalone/cfg/custom-mappers/CustomTaskMapper.xml<span class="tok-nt">&lt;/value&gt;</span>
  <span class="tok-nt">&lt;/set&gt;</span>
<span class="tok-nt">&lt;/property&gt;</span>
...
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The statement can be executed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">CustomTask</span><span class="tok-o">&gt;</span> <span class="tok-n">tasks</span> <span class="tok-o">=</span> <span class="tok-n">managementService</span><span class="tok-o">.</span><span class="tok-na">executeCommand</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Command</span><span class="tok-o">&lt;</span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">CustomTask</span><span class="tok-o">&gt;&gt;()</span> <span class="tok-o">{</span>

      <span class="tok-nd">@SuppressWarnings</span><span class="tok-o">(</span><span class="tok-s">&quot;unchecked&quot;</span><span class="tok-o">)</span>
      <span class="tok-nd">@Override</span>
      <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">CustomTask</span><span class="tok-o">&gt;</span> <span class="tok-nf">execute</span><span class="tok-o">(</span><span class="tok-n">CommandContext</span> <span class="tok-n">commandContext</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">return</span> <span class="tok-o">(</span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">CustomTask</span><span class="tok-o">&gt;)</span> <span class="tok-n">commandContext</span><span class="tok-o">.</span><span class="tok-na">getDbSqlSession</span><span class="tok-o">().</span><span class="tok-na">selectList</span><span class="tok-o">(</span><span class="tok-s">&quot;selectCustomTaskList&quot;</span><span class="tok-o">);</span>
      <span class="tok-o">}</span>
    <span class="tok-o">});</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For uses cases that require more complicated statements, XML Mapped Statements can be helpful. Since Flowable uses XML Mapped Statements internally, it&#8217;s possible to make use of the underlying capabilities.</p>
</div>
<div class="paragraph">
<p>Suppose that for some use case the ability to query attachments data is required based on id, name, type, userId, etc! To fulfill the use case a query class <em>AttachmentQuery</em> that extends  <em>org.activiti.engine.impl.AbstractQuery</em> can be created as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">AttachmentQuery</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractQuery</span><span class="tok-o">&lt;</span><span class="tok-n">AttachmentQuery</span><span class="tok-o">,</span> <span class="tok-n">Attachment</span><span class="tok-o">&gt;</span> <span class="tok-o">{</span>

  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">attachmentId</span><span class="tok-o">;</span>
  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">attachmentName</span><span class="tok-o">;</span>
  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">attachmentType</span><span class="tok-o">;</span>
  <span class="tok-kd">protected</span> <span class="tok-n">String</span> <span class="tok-n">userId</span><span class="tok-o">;</span>

  <span class="tok-kd">public</span> <span class="tok-nf">AttachmentQuery</span><span class="tok-o">(</span><span class="tok-n">ManagementService</span> <span class="tok-n">managementService</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-kd">super</span><span class="tok-o">(</span><span class="tok-n">managementService</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">AttachmentQuery</span> <span class="tok-nf">attachmentId</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">attachmentId</span><span class="tok-o">){</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">attachmentId</span> <span class="tok-o">=</span> <span class="tok-n">attachmentId</span><span class="tok-o">;</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">AttachmentQuery</span> <span class="tok-nf">attachmentName</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">attachmentName</span><span class="tok-o">){</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">attachmentName</span> <span class="tok-o">=</span> <span class="tok-n">attachmentName</span><span class="tok-o">;</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">AttachmentQuery</span> <span class="tok-nf">attachmentType</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">attachmentType</span><span class="tok-o">){</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">attachmentType</span> <span class="tok-o">=</span> <span class="tok-n">attachmentType</span><span class="tok-o">;</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-kd">public</span> <span class="tok-n">AttachmentQuery</span> <span class="tok-nf">userId</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">userId</span><span class="tok-o">){</span>
    <span class="tok-k">this</span><span class="tok-o">.</span><span class="tok-na">userId</span> <span class="tok-o">=</span> <span class="tok-n">userId</span><span class="tok-o">;</span>
    <span class="tok-k">return</span> <span class="tok-k">this</span><span class="tok-o">;</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-kt">long</span> <span class="tok-nf">executeCount</span><span class="tok-o">(</span><span class="tok-n">CommandContext</span> <span class="tok-n">commandContext</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-o">(</span><span class="tok-n">Long</span><span class="tok-o">)</span> <span class="tok-n">commandContext</span><span class="tok-o">.</span><span class="tok-na">getDbSqlSession</span><span class="tok-o">()</span>
                   <span class="tok-o">.</span><span class="tok-na">selectOne</span><span class="tok-o">(</span><span class="tok-s">&quot;selectAttachmentCountByQueryCriteria&quot;</span><span class="tok-o">,</span> <span class="tok-k">this</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>

  <span class="tok-nd">@Override</span>
  <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Attachment</span><span class="tok-o">&gt;</span> <span class="tok-nf">executeList</span><span class="tok-o">(</span><span class="tok-n">CommandContext</span> <span class="tok-n">commandContext</span><span class="tok-o">,</span> <span class="tok-n">Page</span> <span class="tok-n">page</span><span class="tok-o">)</span> <span class="tok-o">{</span>
    <span class="tok-k">return</span> <span class="tok-n">commandContext</span><span class="tok-o">.</span><span class="tok-na">getDbSqlSession</span><span class="tok-o">()</span>
            <span class="tok-o">.</span><span class="tok-na">selectList</span><span class="tok-o">(</span><span class="tok-s">&quot;selectAttachmentByQueryCriteria&quot;</span><span class="tok-o">,</span> <span class="tok-k">this</span><span class="tok-o">);</span>
  <span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that when extending <em>AbstractQuery</em> extended classes should pass an instance of <em>ManagementService</em> to super constructor and methods <em>executeCount</em> and <em>executeList</em> need to be implemented to call the mapped statements.</p>
</div>
<div class="paragraph">
<p>The XML file containing the mapped statements can look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</div></td><td class="code"><span></span><span class="tok-nt">&lt;mapper</span> <span class="tok-na">namespace=</span><span class="tok-s">&quot;org.activiti.standalone.cfg.AttachmentMapper&quot;</span><span class="tok-nt">&gt;</span>

  <span class="tok-nt">&lt;select</span> <span class="tok-na">id=</span><span class="tok-s">&quot;selectAttachmentCountByQueryCriteria&quot;</span> <span class="tok-na">parameterType=</span><span class="tok-s">&quot;org.activiti.standalone.cfg.AttachmentQuery&quot;</span> <span class="tok-na">resultType=</span><span class="tok-s">&quot;long&quot;</span><span class="tok-nt">&gt;</span>
    select count(distinct RES.ID_)
    <span class="tok-nt">&lt;include</span> <span class="tok-na">refid=</span><span class="tok-s">&quot;selectAttachmentByQueryCriteriaSql&quot;</span><span class="tok-nt">/&gt;</span>
  <span class="tok-nt">&lt;/select&gt;</span>

  <span class="tok-nt">&lt;select</span> <span class="tok-na">id=</span><span class="tok-s">&quot;selectAttachmentByQueryCriteria&quot;</span> <span class="tok-na">parameterType=</span><span class="tok-s">&quot;org.activiti.standalone.cfg.AttachmentQuery&quot;</span> <span class="tok-na">resultMap=</span><span class="tok-s">&quot;org.activiti.engine.impl.persistence.entity.AttachmentEntity.attachmentResultMap&quot;</span><span class="tok-nt">&gt;</span>
    ${limitBefore}
    select distinct RES.* ${limitBetween}
    <span class="tok-nt">&lt;include</span> <span class="tok-na">refid=</span><span class="tok-s">&quot;selectAttachmentByQueryCriteriaSql&quot;</span><span class="tok-nt">/&gt;</span>
    ${orderBy}
    ${limitAfter}
  <span class="tok-nt">&lt;/select&gt;</span>

  <span class="tok-nt">&lt;sql</span> <span class="tok-na">id=</span><span class="tok-s">&quot;selectAttachmentByQueryCriteriaSql&quot;</span><span class="tok-nt">&gt;</span>
  from ${prefix}ACT_HI_ATTACHMENT RES
  <span class="tok-nt">&lt;where&gt;</span>
   <span class="tok-nt">&lt;if</span> <span class="tok-na">test=</span><span class="tok-s">&quot;attachmentId != null&quot;</span><span class="tok-nt">&gt;</span>
     RES.ID_ = #{attachmentId}
   <span class="tok-nt">&lt;/if&gt;</span>
   <span class="tok-nt">&lt;if</span> <span class="tok-na">test=</span><span class="tok-s">&quot;attachmentName != null&quot;</span><span class="tok-nt">&gt;</span>
     and RES.NAME_ = #{attachmentName}
   <span class="tok-nt">&lt;/if&gt;</span>
   <span class="tok-nt">&lt;if</span> <span class="tok-na">test=</span><span class="tok-s">&quot;attachmentType != null&quot;</span><span class="tok-nt">&gt;</span>
     and RES.TYPE_ = #{attachmentType}
   <span class="tok-nt">&lt;/if&gt;</span>
   <span class="tok-nt">&lt;if</span> <span class="tok-na">test=</span><span class="tok-s">&quot;userId != null&quot;</span><span class="tok-nt">&gt;</span>
     and RES.USER_ID_ = #{userId}
   <span class="tok-nt">&lt;/if&gt;</span>
  <span class="tok-nt">&lt;/where&gt;</span>
  <span class="tok-nt">&lt;/sql&gt;</span>
<span class="tok-nt">&lt;/mapper&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Capabilities such as pagination, ordering, table name prefixing are available and can be used in the statements (since the parameterType is a subclass of <em>AbstractQuery</em>). Note that to map results the predefined <em>org.activiti.engine.impl.persistence.entity.AttachmentEntity.attachmentResultMap</em> resultMap can be used.</p>
</div>
<div class="paragraph">
<p>Finally, the <em>AttachmentQuery</em> can be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</div></td><td class="code"><span></span><span class="tok-o">....</span>
<span class="tok-c1">// Get the total number of attachments</span>
<span class="tok-kt">long</span> <span class="tok-n">count</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AttachmentQuery</span><span class="tok-o">(</span><span class="tok-n">managementService</span><span class="tok-o">).</span><span class="tok-na">count</span><span class="tok-o">();</span>

<span class="tok-c1">// Get attachment with id 10025</span>
<span class="tok-n">Attachment</span> <span class="tok-n">attachment</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AttachmentQuery</span><span class="tok-o">(</span><span class="tok-n">managementService</span><span class="tok-o">).</span><span class="tok-na">attachmentId</span><span class="tok-o">(</span><span class="tok-s">&quot;10025&quot;</span><span class="tok-o">).</span><span class="tok-na">singleResult</span><span class="tok-o">();</span>

<span class="tok-c1">// Get first 10 attachments</span>
<span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Attachment</span><span class="tok-o">&gt;</span> <span class="tok-n">attachments</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AttachmentQuery</span><span class="tok-o">(</span><span class="tok-n">managementService</span><span class="tok-o">).</span><span class="tok-na">listPage</span><span class="tok-o">(</span><span class="tok-mi">0</span><span class="tok-o">,</span> <span class="tok-mi">10</span><span class="tok-o">);</span>

<span class="tok-c1">// Get all attachments uploaded by user kermit</span>
<span class="tok-n">attachments</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">AttachmentQuery</span><span class="tok-o">(</span><span class="tok-n">managementService</span><span class="tok-o">).</span><span class="tok-na">userId</span><span class="tok-o">(</span><span class="tok-s">&quot;kermit&quot;</span><span class="tok-o">).</span><span class="tok-na">list</span><span class="tok-o">();</span>
<span class="tok-o">....</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For working examples on using XML Mapped Statements check the unit test <em>org.activiti.standalone.cfg.CustomMybatisXMLMapperTest</em> and other classes and resources in folders src/test/java/org/activiti/standalone/cfg/ and src/test/resources/org/activiti/standalone/cfg/</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced.process.engine.configurators">16.6. Advanced Process Engine configuration with a ProcessEngineConfigurator</h3>
<div class="paragraph">
<p>An advanced way of hooking into the process engine configuration is through the use of a  <em>ProcessEngineConfigurator</em>. The idea is that an implementation of the  <em>org.activiti.engine.cfg.ProcessEngineConfigurator</em> interface is created and injected  into the process engine configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;...SomeProcessEngineConfigurationClass&quot;</span><span class="tok-nt">&gt;</span>

    ...

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;configurators&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;list&gt;</span>
            <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;com.mycompany.MyConfigurator&quot;</span><span class="tok-nt">&gt;</span>
                ...
            <span class="tok-nt">&lt;/bean&gt;</span>
        <span class="tok-nt">&lt;/list&gt;</span>
    <span class="tok-nt">&lt;/property&gt;</span>

    ...

<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are two methods required to implement this interface. The <em>configure</em> method, which gets a <em>ProcessEngineConfiguration</em> instance as parameter. The custom configuration can be added this way, and this method will guaranteed be called <strong>before the process engine is created, but after all default configuration has been done</strong>. The other method is the <em>getPriority</em> method, which allows for ordering the configurators in the case where some configurators are dependent on each other.</p>
</div>
<div class="paragraph">
<p>An example of such a configurator is the <a href="#chapter_ldap">LDAP integration</a>, where the  configurator is used to replace the default user and group manager classes with one that is capable of handling an LDAP user store.	 So basically a configurator allows to change or tweak the process engine quite heavily and is meant for very advanced use cases. Another example is to swap the  process definition cache with a customized version:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">ProcessDefinitionCacheConfigurator</span> <span class="tok-kd">extends</span> <span class="tok-n">AbstractProcessEngineConfigurator</span> <span class="tok-o">{</span>

    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">configure</span><span class="tok-o">(</span><span class="tok-n">ProcessEngineConfigurationImpl</span> <span class="tok-n">processEngineConfiguration</span><span class="tok-o">)</span> <span class="tok-o">{</span>
            <span class="tok-n">MyCache</span> <span class="tok-n">myCache</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">MyCache</span><span class="tok-o">();</span>
            <span class="tok-n">processEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">setProcessDefinitionCache</span><span class="tok-o">(</span><span class="tok-n">enterpriseProcessDefinitionCache</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Process Engine configurators can also be auto discovered from the classpath using the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/ServiceLoader.html">ServiceLoader</a> approach. This means that a jar with the configurator implementation must be put on the classpath, containing a file in the <em>META-INF/services</em> folder in the jar called <strong>org.activiti.engine.cfg.ProcessEngineConfigurator</strong>. The content of the file needs to be the fully qualified classname of the custom implementation. When the process engine is booted, the logging will show that these configurators are found:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>INFO  org.activiti.engine.impl.cfg.ProcessEngineConfigurationImpl  - Found 1 auto-discoverable Process Engine Configurators
INFO  org.activiti.engine.impl.cfg.ProcessEngineConfigurationImpl  - Found 1 Process Engine Configurators in total:
INFO  org.activiti.engine.impl.cfg.ProcessEngineConfigurationImpl  - class org.activiti.MyCustomConfigurator</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this ServiceLoader approach might not work in certain environments. It can be  explicitly disabled using the <em>enableConfiguratorServiceLoader</em> property of the ProcessEngineConfiguration (true by default).</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced.task.query.switching">16.7. Advanced query API: seamless switching between runtime and historic task querying</h3>
<div class="paragraph">
<p>One core component of any BPM user interface is the task list. Typically, end users work on open, runtime tasks, filtering  their inbox with various setting. Often also the historic tasks need to be displayed in those lists, with similar filtering. To make that code-wise easier, the <em>TaskQuery</em> and <em>HistoricTaskInstanceQuery</em> both have a shared parent interface, which contains all common operations (and most of the operations are common).</p>
</div>
<div class="paragraph">
<p>This common interface is the <em>org.activiti.engine.task.TaskInfoQuery</em> class. Both <em>org.activiti.engine.task.Task</em> and <em>org.activiti.engine.task.HistoricTaskInstance</em>  have a common superclass <em>org.activiti.engine.task.TaskInfo</em> (with common properties) which is returned from e.g. the <em>list()</em> method. However, Java generics are sometimes more harming than helping: if you want to use the <em>TaskInfoQuery</em> type directly, it would look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">TaskInfoQuery</span><span class="tok-o">&lt;?</span> <span class="tok-kd">extends</span> <span class="tok-n">TaskInfoQuery</span><span class="tok-o">&lt;?,?&gt;,</span> <span class="tok-o">?</span> <span class="tok-kd">extends</span> <span class="tok-n">TaskInfo</span><span class="tok-o">&gt;</span> <span class="tok-n">taskInfoQuery</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Ugh, Right. To <em>solve</em> this, a <em>org.activiti.engine.task.TaskInfoQueryWrapper</em> class that can be used to avoid the generics  (the following code could come from REST code that returns a task list where the user can switch between open and completed tasks):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</div></td><td class="code"><span></span><span class="tok-n">TaskInfoQueryWrapper</span> <span class="tok-n">taskInfoQueryWrapper</span> <span class="tok-o">=</span> <span class="tok-kc">null</span><span class="tok-o">;</span>
<span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">runtimeQuery</span><span class="tok-o">)</span> <span class="tok-o">{</span>
	<span class="tok-n">taskInfoQueryWrapper</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">TaskInfoQueryWrapper</span><span class="tok-o">(</span><span class="tok-n">taskService</span><span class="tok-o">.</span><span class="tok-na">createTaskQuery</span><span class="tok-o">());</span>
<span class="tok-o">}</span> <span class="tok-k">else</span> <span class="tok-o">{</span>
	<span class="tok-n">taskInfoQueryWrapper</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">TaskInfoQueryWrapper</span><span class="tok-o">(</span><span class="tok-n">historyService</span><span class="tok-o">.</span><span class="tok-na">createHistoricTaskInstanceQuery</span><span class="tok-o">());</span>
<span class="tok-o">}</span>

<span class="tok-n">List</span><span class="tok-o">&lt;?</span> <span class="tok-kd">extends</span> <span class="tok-n">TaskInfo</span><span class="tok-o">&gt;</span> <span class="tok-n">taskInfos</span> <span class="tok-o">=</span> <span class="tok-n">taskInfoQueryWrapper</span><span class="tok-o">.</span><span class="tok-na">getTaskInfoQuery</span><span class="tok-o">().</span><span class="tok-na">or</span><span class="tok-o">()</span>
	<span class="tok-o">.</span><span class="tok-na">taskNameLike</span><span class="tok-o">(</span><span class="tok-s">&quot;%k1%&quot;</span><span class="tok-o">)</span>
	<span class="tok-o">.</span><span class="tok-na">taskDueAfter</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">Date</span><span class="tok-o">(</span><span class="tok-n">now</span><span class="tok-o">.</span><span class="tok-na">getTime</span><span class="tok-o">()</span> <span class="tok-o">+</span> <span class="tok-o">(</span><span class="tok-mi">3</span> <span class="tok-o">*</span> <span class="tok-mi">24L</span> <span class="tok-o">*</span> <span class="tok-mi">60L</span> <span class="tok-o">*</span> <span class="tok-mi">60L</span> <span class="tok-o">*</span> <span class="tok-mi">1000L</span><span class="tok-o">)))</span>
<span class="tok-o">.</span><span class="tok-na">endOr</span><span class="tok-o">()</span>
<span class="tok-o">.</span><span class="tok-na">list</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced.custom.session.manager">16.8. Custom identity management by overriding standard SessionFactory</h3>
<div class="paragraph">
<p>If you do not want to use a full <em>ProcessEngineConfigurator</em> implementation like in the  <a href="#chapter_ldap">LDAP integration</a>, but still want to plug in your custom identity management framework,  then you can also override the <em>SessionFactory</em> classes directly in the <em>ProcessEngineConfiguration</em>.  In Spring this can be easily done by adding the following to the <em>ProcessEngineConfiguration</em> bean definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;...SomeProcessEngineConfigurationClass&quot;</span><span class="tok-nt">&gt;</span>

    ...

    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;customSessionFactories&quot;</span><span class="tok-nt">&gt;</span>
        <span class="tok-nt">&lt;list&gt;</span>
            <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;com.mycompany.MyGroupManagerFactory&quot;</span><span class="tok-nt">/&gt;</span>
            <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;com.mycompany.MyUserManagerFactory&quot;</span><span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;/list&gt;</span>
    <span class="tok-nt">&lt;/property&gt;</span>

    ...

<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>MyGroupManagerFactory</em> and <em>MyUserManagerFactory</em> need to implement the <em>org.activiti.engine.impl.interceptor.SessionFactory</em> interface. The call to <em>openSession()</em> returns the custom class implementation that does the actual identity management. For groups this is a class that inherits from <em>org.activiti.engine.impl.persistence.entity.GroupEntityManager</em> and for managing users it must inherit from <em>org.activiti.engine.impl.persistence.entity.UserEntityManager</em>. The following code sample contains a custom manager factory for groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</div></td><td class="code"><span></span><span class="tok-kn">package</span> <span class="tok-nn">com.mycompany</span><span class="tok-o">;</span>

<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.impl.interceptor.Session</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.impl.interceptor.SessionFactory</span><span class="tok-o">;</span>
<span class="tok-kn">import</span> <span class="tok-nn">org.activiti.engine.impl.persistence.entity.GroupIdentityManager</span><span class="tok-o">;</span>

<span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyGroupManagerFactory</span> <span class="tok-kd">implements</span> <span class="tok-n">SessionFactory</span> <span class="tok-o">{</span>

	<span class="tok-nd">@Override</span>
	<span class="tok-kd">public</span> <span class="tok-n">Class</span><span class="tok-o">&lt;?&gt;</span> <span class="tok-n">getSessionType</span><span class="tok-o">()</span> <span class="tok-o">{</span>
		<span class="tok-k">return</span> <span class="tok-n">GroupIdentityManager</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">;</span>
	<span class="tok-o">}</span>

	<span class="tok-nd">@Override</span>
	<span class="tok-kd">public</span> <span class="tok-n">Session</span> <span class="tok-nf">openSession</span><span class="tok-o">()</span> <span class="tok-o">{</span>
		<span class="tok-k">return</span> <span class="tok-k">new</span> <span class="tok-n">MyCompanyGroupManager</span><span class="tok-o">();</span>
	<span class="tok-o">}</span>

<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>MyCompanyGroupManager</em> created by the factory is doing the actual work. You do not need to override all members of <em>GroupEntityManager</em> though, just the ones required for your use case. The following sample provides an indication of how this may look like (only a selection of members are shown):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</div></td><td class="code"><span></span><span class="tok-kd">public</span> <span class="tok-kd">class</span> <span class="tok-nc">MyCompanyGroupManager</span> <span class="tok-kd">extends</span> <span class="tok-n">GroupEntityManager</span> <span class="tok-o">{</span>

    <span class="tok-kd">private</span> <span class="tok-kd">static</span> <span class="tok-n">Logger</span> <span class="tok-n">log</span> <span class="tok-o">=</span> <span class="tok-n">LoggerFactory</span><span class="tok-o">.</span><span class="tok-na">getLogger</span><span class="tok-o">(</span><span class="tok-n">MyCompanyGroupManager</span><span class="tok-o">.</span><span class="tok-na">class</span><span class="tok-o">);</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Group</span><span class="tok-o">&gt;</span> <span class="tok-nf">findGroupsByUser</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">userId</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;findGroupByUser called with userId: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">userId</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">findGroupsByUser</span><span class="tok-o">(</span><span class="tok-n">userId</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">Group</span><span class="tok-o">&gt;</span> <span class="tok-nf">findGroupByQueryCriteria</span><span class="tok-o">(</span><span class="tok-n">GroupQueryImpl</span> <span class="tok-n">query</span><span class="tok-o">,</span> <span class="tok-n">Page</span> <span class="tok-n">page</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;findGroupByQueryCriteria called, query: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">query</span> <span class="tok-o">+</span> <span class="tok-s">&quot; page: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">page</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">findGroupByQueryCriteria</span><span class="tok-o">(</span><span class="tok-n">query</span><span class="tok-o">,</span> <span class="tok-n">page</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-kt">long</span> <span class="tok-nf">findGroupCountByQueryCriteria</span><span class="tok-o">(</span><span class="tok-n">GroupQueryImpl</span> <span class="tok-n">query</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-n">log</span><span class="tok-o">.</span><span class="tok-na">debug</span><span class="tok-o">(</span><span class="tok-s">&quot;findGroupCountByQueryCriteria called, query: &quot;</span> <span class="tok-o">+</span> <span class="tok-n">query</span><span class="tok-o">);</span>
        <span class="tok-k">return</span> <span class="tok-kd">super</span><span class="tok-o">.</span><span class="tok-na">findGroupCountByQueryCriteria</span><span class="tok-o">(</span><span class="tok-n">query</span><span class="tok-o">);</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-n">Group</span> <span class="tok-nf">createNewGroup</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">groupId</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-n">UnsupportedOperationException</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>

    <span class="tok-nd">@Override</span>
    <span class="tok-kd">public</span> <span class="tok-kt">void</span> <span class="tok-nf">deleteGroup</span><span class="tok-o">(</span><span class="tok-n">String</span> <span class="tok-n">groupId</span><span class="tok-o">)</span> <span class="tok-o">{</span>
        <span class="tok-k">throw</span> <span class="tok-k">new</span> <span class="tok-n">UnsupportedOperationException</span><span class="tok-o">();</span>
    <span class="tok-o">}</span>
<span class="tok-o">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Add your own implementation in the appropriate methods to plugin your own identity management solution.
You have to figure out which member of the base class must be overridden. For example the following call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-kt">long</span> <span class="tok-n">potentialOwners</span> <span class="tok-o">=</span> <span class="tok-n">identityService</span><span class="tok-o">.</span><span class="tok-na">createUserQuery</span><span class="tok-o">().</span><span class="tok-na">memberOfGroup</span><span class="tok-o">(</span><span class="tok-s">&quot;management&quot;</span><span class="tok-o">).</span><span class="tok-na">count</span><span class="tok-o">();</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>leads to a call on the following member of the <em>UserIdentityManager</em> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">List</span><span class="tok-o">&lt;</span><span class="tok-n">User</span><span class="tok-o">&gt;</span> <span class="tok-nf">findUserByQueryCriteria</span><span class="tok-o">(</span><span class="tok-n">UserQueryImpl</span> <span class="tok-n">query</span><span class="tok-o">,</span> <span class="tok-n">Page</span> <span class="tok-n">page</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The code for the <a href="#chapter_ldap">LDAP integration</a> contains full examples of how to implement this. Check out the code on Github, specifically the following classes
          <a href="https://github.com/flowable/flowable-engine/blob/master/modules/flowable-ldap/src/main/java/org/activiti/ldap/LDAPGroupManager.java">LDAPGroupManager</a> and
   <a href="https://github.com/flowable/flowable-engine/blob/master/modules/flowable-ldap/src/main/java/org/activiti/ldap/LDAPUserManager.java">LDAPUserManager</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced.safe.bpmn.xml">16.9. Enable safe BPMN 2.0 xml</h3>
<div class="paragraph">
<p>In most cases the BPMN 2.0 processes that are being deployed to the Flowable engine are under tight control of e.g. the development team. However, in some use cases it might be desirable to upload arbitrary BPMN 2.0 xml to the engine. In that case, take into consideration that a user with bad intentions can bring the server down as described <a href="http://www.jorambarrez.be/blog/2013/02/19/uploading-a-funny-xml-can-bring-down-your-server/">here</a>.</p>
</div>
<div class="paragraph">
<p>To avoid the attacks described in the link above, a property <em>enableSafeBpmnXml</em> can be set on the process engine configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;enableSafeBpmnXml&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;true&quot;</span><span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>By default this feature is disabled!</strong> The reason for this is that it relies on  the availability of the <a href="http://download.java.net/jdk7/archive/b123/docs/api/javax/xml/transform/stax/StAXSource.html">StaxSource</a> class. Unfortunately, on some platforms (e.g. JDK 6, JBoss, etc.) this class is unavailable (due to older xml parser implementation) and thus the safe BPMN 2.0 xml feature cannot be enabled.</p>
</div>
<div class="paragraph">
<p>If the platform on which Flowable runs does support it, do enable this feature.</p>
</div>
</div>
<div class="sect2">
<h3 id="advanced.event.logging">16.10. Event logging (Experimental)</h3>
<div class="paragraph">
<p>An (experimental) event logging mechanism has been introduced. The logging mechanism builds upon the general-purpose <a href="#eventDispatcher">event mechanism of the Flowable engine</a> and is disabled by default. The idea is that the events originating from the engine are caught, and a map containing all the event data (and some more) is created and provided to an <em>org.activiti.engine.impl.event.logger.EventFlusher</em> which will flush this data to somewhere else. By default, simple database-backed event handlers/flusher is used, which serializes the said map to JSON using Jackson and stores it in the database as an <em>EventLogEntryEntity</em> instance.  The table required for this database logging is  created by default (called <em>ACT_EVT_LOG</em>). This table can be deleted if the event logging is not used.</p>
</div>
<div class="paragraph">
<p>To enable the database logger:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-n">processEngineConfiguration</span><span class="tok-o">.</span><span class="tok-na">setEnableDatabaseEventLogging</span><span class="tok-o">(</span><span class="tok-kc">true</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>or at runtime:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2</div></td><td class="code"><span></span>databaseEventLogger = new EventLogger(processEngineConfiguration.getClock());
runtimeService.addEventListener(databaseEventLogger);
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The EventLogger class can be subclassed. In particular, the <em>createEventFlusher()</em> method needs to return an instance of the <em>org.activiti.engine.impl.event.logger.EventFlusher</em> interface if the default database logging is not wanted. The <em>managementService.getEventLogEntries(startLogNr, size);</em>  can be used to retrieve the <em>EventLogEntryEntity</em> instances through Flowable.</p>
</div>
<div class="paragraph">
<p>It is easy to see how this table data can now be used to feed the JSON into a big data NoSQL store such as MongoDB, Elastic Search, etc. It is also easy to see that the classes used here (org.activiti.engine.impl.event.logger.EventLogger/EventFlusher and many EventHandler classes) are pluggable and can be tweaked to your own use case (eg not storing the JSON in the database, but firing it straight onto a queue or big data store).</p>
</div>
<div class="paragraph">
<p>Note that this event logging mechanism is additional to the <em>traditional</em> history manager of Flowable. Although all the data is in the database tables,
it is not optimized for querying nor for easy retrieval. The real use case is audit trailing and feeding it into a big data store.</p>
</div>
</div>
<div class="sect2">
<h3 id="_disabling_bulk_inserts">16.11. Disabling bulk inserts</h3>
<div class="paragraph">
<p>By default, the engine will group multiple insert statements for the same database table together in a <em>bulk insert</em>, thus improving performance. This has been tested and implemented for all supported databases.</p>
</div>
<div class="paragraph">
<p>However, it could be a specific version of a supported and tested database does not allow bulk inserts (we have for example a report for DB2 on z/OS, although DB2 in general works), the bulk insert can be disabled on the process engine configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1</div></td><td class="code"><span></span><span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;bulkInsertEnabled&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;false&quot;</span> <span class="tok-nt">/&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advancedSecureScripting">16.12. Secure Scripting</h3>
<div class="paragraph">
<p><strong>Experimental</strong>: the secure scripting feature has been added as part of the Flowable 5.22 release.</p>
</div>
<div class="paragraph">
<p>By default, when using a <a href="#bpmnScriptTask">script task</a>, the script that is executed has similar capabilities as a Java delegate. It has full access to the JVM, can run forever (due to infinite loops) or use up a lot of memory. However, Java delegates need to be written and put on the classpath in a jar and they have a different lifecyle from a process definitions. End-users generally will not write Java delegates, as this is a typical the job of a developer.</p>
</div>
<div class="paragraph">
<p>Scripts on the other hand are part of the process definition and its lifecycle is the same. Script tasks don&#8217;t need the extra step of a jar deployment, but can be executed from the moment the process definition is deployed. Sometimes, scripts for script tasks are not written by developers. Yet, this poses a problem as stated above: a script has full access to the JVM and it is possible to block many system resources when executing the script. Allowing scripts from just about anyone is thus not a good idea.</p>
</div>
<div class="paragraph">
<p>To solve this problem, the <em>secure scripting</em> feature can be enabled. Currently, this feature is implemented for <em>javascript</em> scripting only. To enable it, add the <em>flowable-secure-javascript</em> dependency to your project. When using maven:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
    <span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
    <span class="tok-nt">&lt;artifactId&gt;</span>flowable-secure-javascript<span class="tok-nt">&lt;/artifactId&gt;</span>
    <span class="tok-nt">&lt;version&gt;</span>${flowable.version}<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding this dependency will transitively bring in the Rhino dependency (see <a href="$https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino$$"><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino" class="bare">https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino</a></a>). Rhino is a javascript engine for the JDK. It used to be included in JDK version 6 and 7 and was superseded by the Nashorn engine. However, the Rhino project continued development after it was included in the JDK. Many features (including the ones Flowable uses to implement the secure scripting) were added afterwards. At the time of writing, the Nashorn engine <strong>does not</strong> have the features that are needed to implement the secure scripting feature.</p>
</div>
<div class="paragraph">
<p>This does mean that there could be (typically small) differences between scripts (for example, <em>importPackage</em> works on Rhino, but <em>load()</em> has to be used on Nashorn). The changes would be similar to switching from JDK 7 to 8 scripts.</p>
</div>
<div class="paragraph">
<p>Configuring the secure scripting is done through a dedicated <em>Configurator</em> object that is passed to the process engine configuration before the process engine is instantiated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5
6
7
8</div></td><td class="code"><span></span><span class="tok-n">SecureJavascriptConfigurator</span> <span class="tok-n">configurator</span> <span class="tok-o">=</span> <span class="tok-k">new</span> <span class="tok-n">SecureJavascriptConfigurator</span><span class="tok-o">()</span>
  <span class="tok-o">.</span><span class="tok-na">setWhiteListedClasses</span><span class="tok-o">(</span><span class="tok-k">new</span> <span class="tok-n">HashSet</span><span class="tok-o">&lt;</span><span class="tok-n">String</span><span class="tok-o">&gt;(</span><span class="tok-n">Arrays</span><span class="tok-o">.</span><span class="tok-na">asList</span><span class="tok-o">(</span><span class="tok-s">&quot;java.util.ArrayList&quot;</span><span class="tok-o">)))</span>
  <span class="tok-o">.</span><span class="tok-na">setMaxStackDepth</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">setMaxScriptExecutionTime</span><span class="tok-o">(</span><span class="tok-mi">3000L</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">setMaxMemoryUsed</span><span class="tok-o">(</span><span class="tok-mi">3145728L</span><span class="tok-o">)</span>
  <span class="tok-o">.</span><span class="tok-na">setNrOfInstructionsBeforeStateCheckCallback</span><span class="tok-o">(</span><span class="tok-mi">10</span><span class="tok-o">);</span>

<span class="tok-n">processEngineConfig</span><span class="tok-o">.</span><span class="tok-na">addConfigurator</span><span class="tok-o">(</span><span class="tok-n">configurator</span><span class="tok-o">);</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Following settings are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>enableClassWhiteListing</strong>: When true, all classes will be blacklisted and all classes that want to be used will need to be whitelisted individually. This gives tight control over what is exposed to scripts. By default <em>false</em>.</p>
</li>
<li>
<p><strong>whiteListedClasses</strong>: a Set of Strings corresponding with fully qualified classnames of the classes that are allowed to be used in the script. For example, to expose the <em>execution</em> object in a script, the <em>org.activiti.engine.impl.persistence.entity.ExecutionEntityImpl</em> String needs to be added to this Set. By default <em>empty</em>.</p>
</li>
<li>
<p><strong>maxStackDepth</strong>: Limits the stack depth while calling functions within a script. This can be used to avoid stackoverflow exceptions that occur when recursively calling a method defined in the script. By default <em>-1</em> (disabled).</p>
</li>
<li>
<p><strong>maxScriptExecutionTime</strong>: The maximum time a script is allowed to run. By default <em>-1</em> (disabled).</p>
</li>
<li>
<p><strong>maxMemoryUsed</strong>: The maximum memory, in bytes, that the script is allowed to use. Note that the script engine itself takes a a certain amount of memory that is counted here too. By default <em>-1</em> (disabled).</p>
</li>
<li>
<p><strong>nrOfInstructionsBeforeStateCheckCallback</strong>: The maximum script execution time and memory usage is implemented using a callback that is called every x instructions of the script. Note that these are not script instructions, but java byte code instructions (which means one script line could be hundreds of byte code instructions). By default 100.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Note:</em> the <em>maxMemoryUsed</em> setting can only be used by a JVM that supports the com.sun.management.ThreadMXBean#getThreadAllocatedBytes() method. The Oracle JDK has this.</p>
</div>
<div class="paragraph">
<p>There is also a secure variant of the ScriptExecutionListener and ScriptTaskListener: <em>org.activiti.scripting.secure.listener.SecureJavascriptExecutionListener</em> and <em>org.activiti.scripting.secure.listener.SecureJavascriptTaskListener</em>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span></span><span class="tok-nt">&lt;activiti:executionListener</span> <span class="tok-na">event=</span><span class="tok-s">&quot;start&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.scripting.secure.listener.SecureJavascriptExecutionListener&quot;</span><span class="tok-nt">&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;script&quot;</span><span class="tok-nt">&gt;</span>
	  <span class="tok-nt">&lt;activiti:string&gt;</span>
		  <span class="tok-cp">&lt;![CDATA[</span>
<span class="tok-cp">        execution.setVariable(&#39;test&#39;);</span>
<span class="tok-cp">			]]&gt;</span>
	  <span class="tok-nt">&lt;/activiti:string&gt;</span>
	<span class="tok-nt">&lt;/activiti:field&gt;</span>
  <span class="tok-nt">&lt;activiti:field</span> <span class="tok-na">name=</span><span class="tok-s">&quot;language&quot;</span> <span class="tok-na">stringValue=</span><span class="tok-s">&quot;javascript&quot;</span> <span class="tok-nt">/&gt;</span>
<span class="tok-nt">&lt;/activiti:executionListener&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For examples that demonstrate unsecure scripts and how they are made secure by the <em>secure scripting</em> feature, please check the  <a href="https://github.com/flowable/flowable-engine/tree/master/modules/flowable-secure-javascript/src/test/resources">unit tests on Github</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Tooling">17. Tooling</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="JMX">17.1. JMX</h3>
<div class="sect3">
<h4 id="jmxIntroduction">17.1.1. Introduction</h4>
<div class="paragraph">
<p>It is possible to connect to Flowable engine using standard Java Management Extensions (JMX) technology in order to get information or to change its behavior. Any standard JMX client can be used for that purpose. Enabling and disabling Job Executor, deploy new process definition files and deleting them are just samples of what could be done using JMX without writing a single line of code.</p>
</div>
</div>
<div class="sect3">
<h4 id="jmxQuickStart">17.1.2. Quick Start</h4>
<div class="paragraph">
<p>By default JMX is not enabled. To enable JMX in its default configuration, it is enough to add the flowable-jmx jar file to your classpath, using Maven or by any other means. In case you are using Maven, you can add proper dependency by adding the following lines in your pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv">1
2
3
4
5</div></td><td class="code"><span></span><span class="tok-nt">&lt;dependency&gt;</span>
  <span class="tok-nt">&lt;groupId&gt;</span>org.flowable<span class="tok-nt">&lt;/groupId&gt;</span>
  <span class="tok-nt">&lt;artifactId&gt;</span>flowable-jmx<span class="tok-nt">&lt;/artifactId&gt;</span>
  <span class="tok-nt">&lt;version&gt;</span>latest.version<span class="tok-nt">&lt;/version&gt;</span>
<span class="tok-nt">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the dependency and building process engine, the JMX connection is ready to be used. Just run jconsole available in a standard JDK distribution. In the list of local processes, you will see the JVM containing Flowable. If for any reason the proper JVM is not listed in "local processes" section, try connecting to it using this URL in "Remote Process" section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service:jmx:rmi:///jndi/rmi://localhost:1099/jmxrmi/activiti</pre>
</div>
</div>
<div class="paragraph">
<p>You can find the exact local URL in your log files. After connecting, you can see the standard JVM statistics and MBeans. You can view Flowable specific MBeans by selecting MBeans tab and select "org.activiti.jmx.Mbeans" on the right panel. By selecting any MBean, you can query information or change configuration. This snapshot shows how the jconsole looks like:</p>
</div>
<div class="paragraph">
<p>Any JMX client not limited to jconsole can be used to access MBeans. Most of data center monitoring tools have some connectors which enables them to connect to JMX MBeans.</p>
</div>
</div>
<div class="sect3">
<h4 id="_attributes_and_operations">17.1.3. Attributes and operations</h4>
<div class="paragraph">
<p>Here is a list available attributes and operations at this moment. This list may extend in future releases based on needs.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MBean</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProcessDefinitionsMBean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">processDefinitions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Id</code>, <code>Name</code>, <code>Version</code>, <code>IsSuspended</code> properties of deployed process definitions as a list of list of Strings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Id</code>, <code>Name</code>, <code>TenantId</code> properties of current deployments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getProcessDefinitionById(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Id</code>, <code>Name</code>, <code>Version</code> and <code>IsSuspended</code> properties of the process definition with given id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deleteDeployment(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes deployment with the given <code>Id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendProcessDefinitionById(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suspends the process definition with the given <code>Id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">activatedProcessDefinitionById(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activates the process definition with the given <code>Id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspendProcessDefinitionByKey(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suspends the process definition with the given <code>key</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">activatedProcessDefinitionByKey(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activates the process definition with the given <code>key</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployProcessDefinition(String resourceName, String processDefinitionFile)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deploys the process definition file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JobExecutorMBean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">attribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">isJobExecutorActivated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns true if job executor is activated, false otherwise</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setJobExecutorActivate(Boolean active)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activates and Deactivates Job executor based on the given boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_configuration_3">17.1.4. Configuration</h4>
<div class="paragraph">
<p>JMX uses default configuration to make it easy to deploy with the most used configuration. However it is easy to change the default configuration. You can do it programmatically or via configuration file. The following code excerpt shows  how this could be done in the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td class="linenos"><div class="linenodiv"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</div></td><td class="code"><span></span><span class="tok-nt">&lt;bean</span> <span class="tok-na">id=</span><span class="tok-s">&quot;processEngineConfiguration&quot;</span> <span class="tok-na">class=</span><span class="tok-s">&quot;...SomeProcessEngineConfigurationClass&quot;</span><span class="tok-nt">&gt;</span>
  ...
  <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;configurators&quot;</span><span class="tok-nt">&gt;</span>
    <span class="tok-nt">&lt;list&gt;</span>
	  <span class="tok-nt">&lt;bean</span> <span class="tok-na">class=</span><span class="tok-s">&quot;org.activiti.management.jmx.JMXConfigurator&quot;</span><span class="tok-nt">&gt;</span>

	    <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;connectorPort&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;1912&quot;</span> <span class="tok-nt">/&gt;</span>
        <span class="tok-nt">&lt;property</span> <span class="tok-na">name=</span><span class="tok-s">&quot;serviceUrlPath&quot;</span> <span class="tok-na">value=</span><span class="tok-s">&quot;/jmxrmi/activiti&quot;</span> <span class="tok-nt">/&gt;</span>

		...
      <span class="tok-nt">&lt;/bean&gt;</span>
    <span class="tok-nt">&lt;/list&gt;</span>
  <span class="tok-nt">&lt;/property&gt;</span>
<span class="tok-nt">&lt;/bean&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>This table shows what parameters you can configure along with their default values:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if set, JMX will not be started even in presence of the dependency</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.activiti.jmx.Mbeans</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Domain of MBean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">createConnector</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if true, creates a connector for the started MbeanServer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MBeanDomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DefaultDomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain of MBean server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">registryPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1099</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">appears in the service URL as registry port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">serviceUrlPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/jmxrmi/activiti</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">appears in the service URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connectorPort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if greater than zero, will appear in service URL as connector port</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_jmx_service_url">17.1.5. JMX Service URL</h4>
<div class="paragraph">
<p>The JMX service URL has the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service:jmx:rmi://&lt;hostName&gt;:&lt;connectorPort&gt;/jndi/rmi://&lt;hostName&gt;:&lt;registryPort&gt;/&lt;serviceUrlPath&gt;</pre>
</div>
</div>
<div class="paragraph">
<p><code>hostName</code> will be automatically set to the network name of the machine.
<code>connectorPort</code>, <code>registryPort</code> and <code>serviceUrlPath</code> can be configured.</p>
</div>
<div class="paragraph">
<p>If <code>connectionPort</code> is less than zero, the corresponding part of service URL will be dropped and it will be simplified to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service:jmx:rmi:///jndi/rmi://:&lt;hostname&gt;:&lt;registryPort&gt;/&lt;serviceUrlPath&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mavenArchetypes">17.2. Maven archetypes</h3>
<div class="sect3">
<h4 id="_create_test_case">17.2.1. Create Test Case</h4>
<div class="paragraph">
<p>During development, sometimes it is helpful to create a small test case to test an idea or a feature,
before implementing it in the real application.
This helps to isolate the subject under test. JUnit test cases are also the preferred tools for communicating
bug reports and feature requests.
Having a test case attached to a bug report or feature request jira issue, considerably reduces its fixing time.</p>
</div>
<div class="paragraph">
<p>To facilitate creation of a test case, a maven archetype is available. By use of this archetype, one can rapidly create a standard test case.
The archetype should be already available in the standard repository. If not, you can easily install it in your local maven repository folder by just typing
  <strong>mvn install</strong> in <strong>tooling/archtypes</strong> folder.</p>
</div>
<div class="paragraph">
<p>The following command creates the unit test project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code>mvn archetype:generate \
-DarchetypeGroupId=org.flowable \
-DarchetypeArtifactId=flowable-archetype-unittest \
-DarchetypeVersion=&lt;current version&gt; \
-DgroupId=org.myGroup \
-DartifactId=myArtifact</code></pre>
</div>
</div>
<div class="paragraph">
<p>The effect of each parameter is explained in the following table:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 262. Unittest Generation archetype parameters</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Row</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Explanation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">archetypeGroupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group id of the archetype. should be <strong>org.flowable</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">archetypeArtifactId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifact if of the archetype. should be <strong>flowable-archetype-unittest</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">archetypeVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flowable version used in the generated test project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group id of the generated test project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">artifactId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Artifact id of the generated test project</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The directory structure of the generated project would be like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
â”œâ”€â”€ pom.xml
â””â”€â”€ src
    â””â”€â”€ test
        â”œâ”€â”€ java
        â”‚Â Â  â””â”€â”€ org
        â”‚Â Â      â””â”€â”€ myGroup
        â”‚Â Â          â””â”€â”€ MyUnitTest.java
        â””â”€â”€ resources
            â”œâ”€â”€ activiti.cfg.xml
            â”œâ”€â”€ log4j.properties
            â””â”€â”€ org
                â””â”€â”€ myGroup
                    â””â”€â”€ my-process.bpmn20.xml</pre>
</div>
</div>
<div class="paragraph">
<p>You can modify java unit test case and its corresponding process model, or add new test cases and process models.
If you are using the project to articulate a bug or a feature, test case should fail initially. It should then pass
after the desired bug is fixed or the desired feature is implemented.
Please make sure to clean the project by typing <strong>mvn clean</strong> before sending it.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
