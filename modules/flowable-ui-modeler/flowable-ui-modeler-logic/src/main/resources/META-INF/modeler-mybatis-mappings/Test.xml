<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.flowable.app.domain.editor.Test">

    <!-- RESULTMAP -->

    <resultMap id="eventLogEntryResultMap" type="org.flowable.engine.impl.persistence.entity.EventLogEntryEntityImpl">
        <id property="logNumber" column="LOG_NR_" jdbcType="BIGINT"/>
        <result property="id" column="LOG_NR_" jdbcType="BIGINT"/>
        <result property="type" column="TYPE_" jdbcType="VARCHAR"/>
        <result property="processDefinitionId" column="PROC_DEF_ID_" jdbcType="VARCHAR"/>
        <result property="processInstanceId" column="PROC_INST_ID_" jdbcType="VARCHAR"/>
        <result property="executionId" column="EXECUTION_ID_" jdbcType="VARCHAR"/>
        <result property="taskId" column="TASK_ID_" jdbcType="VARCHAR"/>
        <result property="timeStamp" column="TIME_STAMP_" jdbcType="TIMESTAMP"/>
        <result property="userId" column="USER_ID_" jdbcType="VARCHAR"/>
        <result property="data" column="DATA_" jdbcType="${blobType}"/>
        <result property="lockOwner" column="LOCK_OWNER_" jdbcType="VARCHAR"/>
        <result property="lockTime" column="LOCK_TIME_" jdbcType="TIMESTAMP"/>
        <result property="isProcessed" column="IS_PROCESSED_" jdbcType="INTEGER"/>
    </resultMap>

    <!-- SELECTS -->

    <select id="selectEventLogEntriesByProcessInstanceId"
            parameterType="org.flowable.engine.common.impl.db.ListQueryParameterObject"
            resultMap="eventLogEntryResultMap">
        select * from ${prefix}ACT_EVT_LOG
        WHERE PROC_INST_ID_ = #{processInstanceId}
        ORDER BY LOG_NR_
    </select>

    <select id="selectProcessDefinitionKeyById" parameterType="string" resultType="string">
        select KEY_ from ${prefix}ACT_RE_PROCDEF where ID_ = #{processDefinitionId}
    </select>

</mapper>
